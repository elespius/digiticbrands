var FinderIndexer=function(){var e=null,r=null,n=null,t=!1,s="index.php?option=com_finder&tmpl=component&format=json",o=function(e){Joomla.request({url:s,method:"GET",data:{task:e},perform:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},onSuccess:function(e,r){d()},onError:function(e){i()}})},a=function(e){var r=document.getElementById(e);if(r)return r.parentNode.removeChild(r)},d=function(n,s){var d=document.getElementById("finder-progress-header"),i=document.getElementById("finder-progress-message");try{if(null===n)throw s;if(n.error)throw n;n.start&&(e=n.totalItems),r+=n.batchOffset,l(n.header,n.message),r<e?o("indexer.batch"):t||(t=!0,o("indexer.optimize"))}catch(e){a("progress");try{n.error&&(d&&(d.innerText=n.header,d.classList.add("finder-error")),i&&(i.innerHTML=n.message,i.classList.add("finder-error")))}catch(r){""===e&&(e=Joomla.JText._("COM_FINDER_NO_ERROR_RETURNED")),d&&(d.innerText=Joomla.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED"),d.classList.add("finder-error")),i&&(i.innerHTML=e,i.classList.add("finder-error"))}}return!0},i=function(e){var r=document.getElementById("finder-progress-header"),n=document.getElementById("finder-progress-message");json="object"==typeof e&&e.responseText?e.responseText:null,json=json?JSON.parse(json):null,a("progress"),json&&(json=null!=json.responseText?Json.evaluate(json.responseText,!0):json);var t=json?json.header:Joomla.JText._("COM_FINDER_AN_ERROR_HAS_OCCURRED"),s=json?json.message:Joomla.JText._("COM_FINDER_MESSAGE_RETURNED")+"<br>"+json;r&&(r.innerText=t,r.classList.add("finder-error")),n&&(n.innerHTML=s,n.classList.add("finder-error"))},l=function(t,s){n=r/e*100;var o=document.getElementById("progress-bar"),d=document.getElementById("finder-progress-header"),i=document.getElementById("finder-progress-message");d&&(d.innerText=t),i&&(i.innerHTML=s),o&&(n<100?(o.style.width=n+"%",o.setAttribute("aria-valuenow",n)):(o.classList.remove("bar-success"),o.classList.add("bar-warning"),o.setAttribute("aria-valuemin",100),o.setAttribute("aria-valuemax",200),o.style.width=n+"%",o.setAttribute("aria-valuenow",n)),s==msg&&(a("progress"),window.parent.jQuery("#modal-archive",parent.document).modal("hide")))};r=0,n=0,s=s+"&"+document.getElementById("finder-indexer-token").getAttribute("name")+"=1",o("indexer.start")};document.addEventListener("DOMContentLoaded",function(){Indexer=new FinderIndexer});