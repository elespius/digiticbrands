(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
'use strict';var _typeof='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},_createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}customElements.define('joomla-field-tags',function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return a.actualInput='',a.activeInput='',a.tagsContainer='',a.tags=[],a.values=[],a.dragSrcEl=null,a.prefixValue='#new#',a}return _inherits(b,a),_createClass(b,[{key:'connectedCallback',value:function connectedCallback(){var a=this;if(this.actualInput=this.querySelector('input'),!this.actualInput)throw new Error('`joomla-field-tags` UI component is missing the input element');this.insert.bind(this),this.appendNewTag.bind(this);var b=JSON.parse(''===this.actualInput.value?{}:this.actualInput.value);for(var c in b)this.tags.push(c),this.values.push(b[c]);this.tagsContainer=document.createElement('div'),this.tagsContainer.classList.add('inline'),this.actualInput.insertAdjacentElement('afterend',this.tagsContainer),this.activeInput=this.actualInput.cloneNode(),this.actualInput.setAttribute('type','hidden'),this.actualInput.removeAttribute('id'),this.activeInput.setAttribute('type','text'),this.tagsContainer.appendChild(this.activeInput),this.activeInput.addEventListener('input',function(b){b.preventDefault(),b.stopPropagation(),a.insert(!1,b.target,!1)}),this.activeInput.addEventListener('keydown',function(b){if(13===b.keyCode&&(b.preventDefault(),b.stopPropagation(),''!==a.activeInput.value&&(a.insert(!0,a.activeInput,!0),a.activeInput.focus())),8===b.keyCode&&''===a.activeInput.value){b.preventDefault(),b.stopPropagation();var c=a.activeInput.previousElementSibling.querySelector('span');console.log(a.activeInput.previousElementSibling),c.click(),a.activeInput.focus()}}),this.render(),this.activeInput.value=''}},{key:'render',value:function render(){for(var a=[].slice.call(this.tagsContainer.querySelectorAll('span.tag')),b=0;b<this.tags.length;b++)a[b]?a[b].childNodes[0].nodeValue=this.tags[b]:this.appendNewTag(this.tags[b],this.values[b]);for(;b<a.length;b++)this.tagsContainer.removeChild(a[b]);for(var c={},b=0;b<this.tags.length;b++)c[this.tags[b]]=this.values[b];var d=JSON.stringify(c);d=d.replace(/\"/g,'&quot;'),this.actualInput.setAttribute('value',d),this.tagsContainer.insertAdjacentElement('beforeend',this.activeInput)}},{key:'insert',value:function insert(a,b){var c=this;if(-1!=b.value.indexOf(',')||a){','===b.value.substring(b.value.length-1)&&(b.value=b.value.substring(0,b.value.length-1));var d=b.value.split(',');d.forEach(function(a){-1===c.tags.indexOf(a)&&(c.tags.push(a),c.values.push(c.prefixValue+a))}),b.value='',this.render()}}},{key:'removeTag',value:function removeTag(a){if(this.tags.length){var b='';b=a&&'object'===('undefined'==typeof a?'undefined':_typeof(a))&&a.target?a.target.parentNode:a.parentNode,this.tags.splice(this.tags.indexOf(b.childNodes[0].nodeValue),1),this.values.splice(this.values.indexOf(b.getAttribute('data-value')),1),this.render()}}},{key:'handleDragStart',value:function handleDragStart(a){a.target.style.opacity='0.9',a.target.classList.remove('delete'),this.dragSrcEl=a.target,a.dataTransfer.effectAllowed='move'}},{key:'handleDragEnter',value:function handleDragEnter(a){a.target.style.opacity='0.6',a.target.classList.add('over')}},{key:'handleDragLeave',value:function handleDragLeave(a){a.srcElement.style.opacity=null,a.srcElement.classList.remove('over')}},{key:'handleDragEnd',value:function handleDragEnd(a){this.dragSrcEl.style.opacity=null,a.target.style.opacity=null,a.target.classList.add('delete'),this.dragSrcEl.classList.add('delete')}},{key:'handleDragOver',value:function handleDragOver(a){a.preventDefault&&a.preventDefault(),a.dataTransfer.dropEffect='move'}},{key:'handleDrop',value:function handleDrop(a){if(a.stopPropagation&&a.stopPropagation(),a.target.classList.remove('over'),this.dragSrcEl!=a.target){var b=this.tags.indexOf(a.target.childNodes[0].nodeValue);this.tags[this.tags.indexOf(this.dragSrcEl.childNodes[0].nodeValue)]=a.target.childNodes[0].nodeValue,this.values[this.values.indexOf(this.dragSrcEl.getAttribute('data-value'))]=a.target.getAttribute('data-value'),this.tags[b]=this.dragSrcEl.childNodes[0].nodeValue,this.values[b]=this.dragSrcEl.getAttribute('data-value'),this.render()}a.target.style.opacity=null}},{key:'appendNewTag',value:function appendNewTag(a,b){var c=this,d=document.createElement('span');d.className='tag delete',d.setAttribute('tabindex',0),d.draggable=!0,d.addEventListener('keyup',function(a){(8===a.keyCode||46===a.keyCode)&&(document.activeElement.previousSibling&&d.previousSibling.focus(),c.removeTag.bind(c)(a.target.querySelector('span.remove')))}),d.addEventListener('dragstart',this.handleDragStart.bind(this)),d.addEventListener('dragenter',this.handleDragEnter.bind(this)),d.addEventListener('dragleave',this.handleDragLeave.bind(this)),d.addEventListener('dragover',this.handleDragOver.bind(this)),d.addEventListener('dragend',this.handleDragEnd.bind(this)),d.addEventListener('drop',this.handleDrop.bind(this)),d.setAttribute('data-value',b),d.appendChild(document.createTextNode(a));var e=document.createElement('span');e.appendChild(document.createTextNode('\u2716')),e.className='remove',e.addEventListener('click',this.removeTag.bind(this)),d.appendChild(e),this.tagsContainer.appendChild(d)}}]),b}(HTMLElement));

},{}]},{},[1]);
