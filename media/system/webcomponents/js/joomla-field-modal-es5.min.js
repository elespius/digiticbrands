(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
'use strict';var _createClass=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();function _toConsumableArray(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function _classCallCheck(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}function _possibleConstructorReturn(a,b){if(!a)throw new ReferenceError('this hasn\'t been initialised - super() hasn\'t been called');return b&&('object'==typeof b||'function'==typeof b)?b:a}function _inherits(a,b){if('function'!=typeof b&&null!==b)throw new TypeError('Super expression must either be null or a function, not '+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}(function(customElements,Joomla,$){function getElement(a,b){var c=document.createElement(a);if(b)for(var g in b)b.hasOwnProperty(g)&&c.setAttribute(g,b[g]);for(var d=arguments.length,e=Array(2<d?d-2:0),f=2;f<d;f++)e[f-2]=arguments[f];return e.forEach(function(a){'string'==typeof a?c.appendChild(document.createTextNode(a)):a instanceof HTMLElement&&c.appendChild(a)}),c}function templateFactory(tmpl){function template(a){for(var b=arguments.length,c=Array(1<b?b-1:0),d=1;d<b;d++)c[d-1]=arguments[d];return function(){for(var b=arguments.length,d=Array(b),e=0;e<b;e++)d[e]=arguments[e];var f=c.map(function(b,c){return a[c]+d[parseInt(b)]});return f.push(a[a.length-1]),f.join('')}}return tmpl=tmpl.replace(/\\|`/g,'\\$&'),eval('template`'+tmpl+'`')}var ALLOW_NEW=1,ALLOW_EDIT=2,ALLOW_CLEAR=4,ALLOW_SELECT=8;customElements.define('joomla-field-modal',function(a){function b(){_classCallCheck(this,b);var a=_possibleConstructorReturn(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));if(!Joomla)throw new Error('Joomla API is not properly initiated');return a.initialText=a.innerText,a.innerText='','function'==typeof Joomla.renderModalField?Joomla.renderModalField.call(a):a.render(),a}return _inherits(b,a),_createClass(b,[{key:'render',value:function render(){this.createElements(),this.assembleElements()}},{key:'createElements',value:function createElements(){var a=this,b=!!this.getAttribute('value');this.elements={},this.elements.wrapper=getElement('span',{class:this.allow?'input-group':''}),this.elements.fieldTitle=getElement('input',{class:'form-control',id:this.getAttribute('id')+'_name',type:'text',value:this.initialText,placeholder:this.getAttribute('text-placeholder'),disabled:'disabled',size:'35'}),this.elements.fieldId=getElement('input',{name:this.getAttribute('name'),id:this.getAttribute('id')+'_id',type:'hidden',value:this.getAttribute('value'),required:this.getAttribute('required')});var c={role:'button',class:'btn',"aria-hidden":'true'};if(this.elements.modalButtonClose=getElement('a',c,this.getAttribute('text-modal-button-close')),this.elements.modalButtonClose.classList.add('btn-secondary'),this.elements.modalButtonClose.setAttribute('data-task','cancel'),this.elements.modalButtonSave=getElement('a',c,this.getAttribute('text-modal-button-save')),this.elements.modalButtonSave.classList.add('btn-primary'),this.elements.modalButtonSave.setAttribute('data-task','save'),this.elements.modalButtonApply=getElement('a',c,this.getAttribute('text-modal-button-apply')),this.elements.modalButtonApply.classList.add('btn-success'),this.elements.modalButtonApply.setAttribute('data-task','apply'),!!this.allow){this.elements.buttonGroup=getElement('span',{class:'input-group-append'});var d={class:'btn hasTooltip',type:'button'};this.allow&ALLOW_SELECT&&(this.elements.buttonSelect=getElement('button',d,getElement('span',{class:'icon-file',"aria-hidden":'true'}),' ',this.getAttribute('text-button-select')),this.elements.buttonSelect.classList.add('btn-primary'),this.elements.buttonSelect.classList[b?'add':'remove']('sr-only'),this.elements.buttonSelect.addEventListener('click',function(b){return a.modalSelect(b)},!0)),this.allow&ALLOW_NEW&&(this.elements.buttonNew=getElement('button',d,getElement('span',{class:'icon-new',"aria-hidden":'true'}),' ',this.getAttribute('text-button-create')),this.elements.buttonNew.classList.add('btn-secondary'),this.elements.buttonNew.classList[b?'add':'remove']('sr-only'),this.elements.buttonNew.addEventListener('click',function(b){return a.modalNew(b)},!0)),this.allow&ALLOW_EDIT&&(this.elements.buttonEdit=getElement('button',d,getElement('span',{class:'icon-edit',"aria-hidden":'true'}),' ',this.getAttribute('text-button-edit')),this.elements.buttonEdit.classList.add('btn-secondary'),this.elements.buttonEdit.classList[b?'remove':'add']('sr-only'),this.elements.buttonEdit.addEventListener('click',function(b){return a.modalEdit(b)},!0)),this.allow&ALLOW_CLEAR&&(this.elements.buttonClear=getElement('button',d,getElement('span',{class:'icon-remove',"aria-hidden":'true'}),' ',this.getAttribute('text-button-clear')),this.elements.buttonClear.classList.add('btn-secondary'),this.elements.buttonClear.classList[b?'remove':'add']('sr-only'),this.elements.buttonClear.addEventListener('click',function(b){return a.clear(b)},!0))}}},{key:'assembleElements',value:function assembleElements(){this.elements.wrapper.appendChild(this.elements.fieldId),this.elements.wrapper.appendChild(this.elements.fieldTitle),this.elements.buttonGroup&&(this.elements.wrapper.appendChild(this.elements.buttonGroup),this.elements.buttonSelect&&this.elements.buttonGroup.appendChild(this.elements.buttonSelect),this.elements.buttonNew&&this.elements.buttonGroup.appendChild(this.elements.buttonNew),this.elements.buttonEdit&&this.elements.buttonGroup.appendChild(this.elements.buttonEdit),this.elements.buttonClear&&this.elements.buttonGroup.appendChild(this.elements.buttonClear)),this.appendChild(this.elements.wrapper)}},{key:'modalSelect',value:function modalSelect(){var a=this,b=this.getAttribute('text-title-select'),c=getElement('iframe',{class:'iframe',src:this.getAttribute('url-select'),name:''}),d=getElement('a',{role:'button',class:'btn btn-secondary',"data-dismiss":'modal',"aria-hidden":'true'},'Close');this.openModal(b,c,d,{closeButton:!0}).then(function(b){return a.processResult.apply(a,_toConsumableArray(b))},function(){})}},{key:'modalNew',value:function modalNew(){var a=this,b=this.getAttribute('text-title-new'),c=getElement('iframe',{class:'iframe',src:this.getAttribute('url-new'),name:''}),d=[this.elements.modalButtonClose,this.elements.modalButtonSave,this.elements.modalButtonApply];this.openModal(b,c,d,{backdrop:'static',keyboard:!1,closeButton:!1}).then(function(b){return a.processResult.apply(a,_toConsumableArray(b))},function(){})}},{key:'modalEdit',value:function modalEdit(){var a=this,b=templateFactory(this.getAttribute('url-edit')),c=this.getAttribute('text-title-edit'),d=getElement('iframe',{class:'iframe',src:b(this.elements.fieldId.value),name:''}),e=[this.elements.modalButtonClose,this.elements.modalButtonSave,this.elements.modalButtonApply];this.openModal(c,d,e,{backdrop:'static',keyboard:!1,closeButton:!1}).then(function(b){return a.processResult.apply(a,_toConsumableArray(b))},function(){})}},{key:'clear',value:function clear(){this.processResult()}},{key:'openModal',value:function openModal(a,b,c,d){var e=this;b=b instanceof Array?b:[b],c=c instanceof Array?c:[c];var f=getElement('div',{role:'dialog',tabindex:'-1',class:'joomla-modal modal fade show'},getElement('div',{class:'modal-dialog modal-lg jviewport-width80',role:'document'},getElement('div',{class:'modal-content'},getElement('div',{class:'modal-header'},getElement('h3',{class:'modal-title'},a||'Title'),d.closeButton?getElement('button',{type:'button',class:'close novalidate',"data-dismiss":'modal'},'\xD7'):''),getElement.apply(void 0,['div',{class:'modal-body jviewport-height70'}].concat(_toConsumableArray(b))),getElement.apply(void 0,['div',{class:'modal-footer'}].concat(_toConsumableArray(c)))))),g=[].slice.call(f.getElementsByTagName('iframe')).shift();if(g){var k=function(){f.classList.remove('sr-only'),g.removeEventListener('load',k)};f.classList.add('sr-only'),g.addEventListener('load',k)}var h=null;window.jModalSelect=function(){for(var a=arguments.length,b=Array(a),c=0;c<a;c++)b[c]=arguments[c];h=b,$(f).modal('hide')};var i=function(a){function b(){k.removeEventListener('load',b);var a=k.contentDocument,e=a.getElementById(i),g=a.getElementById(j);e&&'0'!=e.value&&(h=[e.value,g&&g.value],'save'===c&&(l.Joomla.submitbutton(d+'.cancel'),$(f).modal('hide'))),k.classList.remove('sr-only')}var c=a.target.getAttribute('data-task')||'cancel',d=(e.getAttribute('item-type')||'item').toLowerCase(),g=e.getAttribute('form-id')||d+'-form',i=e.getAttribute('id-field-id')||'jform_id',j=e.getAttribute('title-field-id')||'jform_title',k=[].slice.call(f.getElementsByTagName('iframe')).shift(),l=k.contentWindow,m=k.contentDocument;'cancel'===c&&(l.Joomla.submitbutton(d+'.'+c),$(f).modal('hide')),m.formvalidator.isValid(m.getElementById(g))&&(k.addEventListener('load',b),'save'===c&&k.classList.add('sr-only'),l.Joomla.submitbutton(d+'.apply'))};[this.elements.modalButtonClose,this.elements.modalButtonSave,this.elements.modalButtonApply].forEach(function(a){if(a.parentNode){var b=a.cloneNode(!0);a.parentNode.replaceChild(b,a),b.addEventListener('click',function(a){return i(a)})}}),$(f).modal(d).one('hidden.bs.modal',function(){return f.parentNode.removeChild(f)});var j=new Promise(function(a,b){$(f).one('hide.bs.modal',function(){return h?a(h):b()})});return j.finally(function(){window.jModalSelect=null}),j}},{key:'processResult',value:function processResult(){var a=0<arguments.length&&void 0!==arguments[0]?arguments[0]:'',b=1<arguments.length&&void 0!==arguments[1]?arguments[1]:'',c=2<arguments.length&&void 0!==arguments[2]?arguments[2]:'',d=3<arguments.length&&void 0!==arguments[3]?arguments[3]:'',e=4<arguments.length&&void 0!==arguments[4]?arguments[4]:'',f=5<arguments.length&&void 0!==arguments[5]?arguments[5]:'';this.elements.fieldId.value=a||'',this.elements.fieldTitle.value=a?b:'',this.elements.buttonSelect&&this.elements.buttonSelect.classList[a?'add':'remove']('sr-only'),this.elements.buttonNew&&this.elements.buttonNew.classList[a?'add':'remove']('sr-only'),this.elements.buttonEdit&&this.elements.buttonEdit.classList[a?'remove':'add']('sr-only'),this.elements.buttonClear&&this.elements.buttonClear.classList[a?'remove':'add']('sr-only'),'1'===this.elements.fieldId.getAttribute('data-required')&&(document.formvalidator.validate(this.elements.fieldId),document.formvalidator.validate(this.elements.fieldTitle))}},{key:'allow',get:function get(){return('true'===this.getAttribute('allow-new')?ALLOW_NEW:0)|('true'===this.getAttribute('allow-edit')?ALLOW_EDIT:0)|('false'===this.getAttribute('allow-clear')?0:ALLOW_CLEAR)|('false'===this.getAttribute('allow-select')?0:ALLOW_SELECT)}}]),b}(HTMLElement))})(customElements,Joomla,jQuery);

},{}]},{},[1]);
