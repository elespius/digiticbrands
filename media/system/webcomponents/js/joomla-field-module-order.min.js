customElements.define("joomla-field-module-order",class extends HTMLElement{constructor(){super(),this.linkedField=this.getAttribute("data-linked-field")||"jform_position",this.linkedFieldEl="",this.originalPos="",this.writeDynaList.bind(this),this.getNewOrder.bind(this)}connectedCallback(){if(this.linkedFieldEl=document.getElementById(this.linkedField),!this.linkedFieldEl)throw new Error("No linked field defined!");const e=this;this.originalPos=this.linkedFieldEl.value,this.getNewOrder(this.originalPos),this.linkedFieldEl.addEventListener("change",()=>{e.originalPos=e.linkedFieldEl.value,e.getNewOrder(e.linkedFieldEl.value)})}writeDynaList(e,t,i,s){const d=document.createElement("select");d.classList.add(e.itemClass),d.setAttribute("name",e.name),d.id=e.id;let n,l,a=i,o=0;for(n in t)t.hasOwnProperty(n)&&(l=t[n],node=document.createElement("option"),node.value=l[1],node.innerHTML=l[2],(a&&s==l[1]||!a&&0===o)&&node.setAttribute("selected","selected"),d.appendChild(node),o++);this.innerHTML="",this.appendChild(d)}getNewOrder(e){const t=this.getAttribute("data-url"),i=this.getAttribute("data-client-id"),s=this.getAttribute("data-ordering"),d=this.getAttribute("data-name"),n=this.getAttribute("data-client-attr")?this.getAttribute("data-client-attr"):"custom-select",l=this.getAttribute("id")+"_1",a=[],o=this;Joomla.request({url:t,method:"GET",data:"client_id="+i+"&position="+e,perform:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},onSuccess:function(e,t){if(e&&(e=JSON.parse(e)).data.length>0){for(let t=0;t<e.data.length;++t)a[t]=e.data[t].split(",");o.writeDynaList({name:d,id:l,itemClass:n},a,o.originalPos,s)}"object"==typeof e.messages&&null!==e.messages&&(Joomla.renderMessages(e.messages),window.scrollTo(0,0))}})}});