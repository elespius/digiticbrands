customElements.define("joomla-field-module-order",class extends HTMLElement{constructor(){if(super(),!window.Joomla)throw new Error("Joomla API is not properly initialised");this.linkedField=this.getAttribute("data-linked-field")||"jform_position",this.linkedFieldEl="",this.originalPos="",this.writeDynaList.bind(this),this.getNewOrder.bind(this)}connectedCallback(){this.originalPos=this.linkedFieldEl.value,this.linkedFieldEl=document.getElementById(this.linkedField),this.getNewOrder(this.originalPos),this.linkedFieldEl.addEventListener("change",()=>{this.originalPos=this.linkedFieldEl.value,this.getNewOrder(this.originalPos)})}disconnectedCallback(){}writeDynaList(e,t,i,s){let n="";const l=document.createElement("select");l.classList.add(e.itemClass),l.setAttribute("name",e.name),l.id=e.id,this.innerHTML="",this.appendChild(l);var d,a,r=i,o=0;for(d in t)t.hasOwnProperty(d)&&(a=t[d],(n=document.createElement("option")).value=a[1],n.innerHTML=a[2],(r&&s==a[1]||!r&&0===o)&&n.setAttribute("selected","selected"),l.appendChild(n),l.parentNode.innerHtml="",l.parentNode.appendChild(l),o++)}getNewOrder(e){console.log("dfgd");var t=this.getAttribute("data-url"),i=this.getAttribute("data-client-id"),s=(document.getElementById(this.getAttribute("data-element")),this.getAttribute("data-ordering")),n=this.getAttribute("data-name"),l=this.getAttribute("data-client-attr")?this.getAttribute("data-client-attr"):"custom-select",d=this.getAttribute("id")+"_1",a=[],r=this;Joomla.request({url:t,method:"GET",data:"client_id="+i+"&position="+e,perform:!0,headers:{"Content-Type":"application/x-www-form-urlencoded"},onSuccess:function(e,t){if(e&&(e=JSON.parse(e)).data.length>0){for(var i=0;i<e.data.length;++i)a[i]=e.data[i].split(",");r.writeDynaList({name:n,id:d,itemClass:l},a,r.originalPos,s)}"object"==typeof e.messages&&null!==e.messages&&(Joomla.renderMessages(e.messages),window.scrollTo(0,0))}})}});