(function(t){"use strict";t.fieldUser=function(e,i){this.options=t.extend({},t.fieldUser.defaults,i);this.$container=t(e);this.$modal=this.$container.find(this.options.modal);this.$modalBody=this.$modal.find(".modal-body");this.$input=this.$container.find(this.options.input);this.$inputName=this.$container.find(this.options.inputName);this.$buttonSelect=this.$container.find(this.options.buttonSelect);this.$buttonSelect.on("click",this.modalOpen.bind(this));this.$modal.on("hide",this.removeIframe.bind(this));var o=this.$input.attr("data-onchange"),n;if(o){n=new Function(o);this.$input.on("change",n.bind(this.$input))}};t.fieldUser.prototype.modalOpen=function(){var e=document.createElement("iframe");e.name="field-user-modal";e.src=this.options.url.replace("{field-user-id}",this.$input.attr("id"));e.width=this.options.modalWidth;e.height=this.options.modalHeight;var i=this;e.onload=function(){var e=t(this).contents();e.on("click",".button-select",function(){i.setValue(t(this).data("user-value"),t(this).data("user-name"));i.modalClose();t("body").removeClass("modal-open")})};this.$modalBody.append(e);this.$modal.modal("show");t("body").addClass("modal-open")};t.fieldUser.prototype.modalClose=function(){this.$modal.modal("hide");this.$modalBody.empty();t("body").removeClass("modal-open")};t.fieldUser.prototype.removeIframe=function(){this.$modalBody.empty();t("body").removeClass("modal-open")};t.fieldUser.prototype.setValue=function(t,e){this.$input.val(t).trigger("change");this.$inputName.val(e||t).trigger("change")};t.fieldUser.defaults={buttonSelect:".button-select",input:".field-user-input",inputName:".field-user-input-name",modal:".modal",url:"index.php?option=com_users&view=users&layout=modal&tmpl=component",modalWidth:"100%",modalHeight:"300px"};t.fn.fieldUser=function(e){return this.each(function(){var e=t(this),i=e.data("fieldUser");if(!i){var o=o||{},n=e.data();for(var s in n){if(n.hasOwnProperty(s)){o[s]=n[s]}}i=new t.fieldUser(this,o);e.data("fieldUser",i)}})};t(document).ready(function(){t(".field-user-wrapper").fieldUser()})})(jQuery);