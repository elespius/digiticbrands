Joomla=window.Joomla||{},Joomla.MediaManager=Joomla.MediaManager||{},function(){"use strict";var a=Joomla.getOptions("com_media",{});a&&(Joomla.MediaManager.Edit.original={filename:a.uploadPath.split("/").pop(),extension:a.uploadPath.split(".").pop(),contents:"data:image/"+a.uploadPath.split(".").pop()+";base64,"+a.contents},Joomla.MediaManager.Edit.history={},Joomla.MediaManager.Edit.current={},Joomla.MediaManager.Edit.Reset=function(a){(!a||a&&!0!==a)&&(Joomla.MediaManager.Edit.current.contents=Joomla.MediaManager.Edit.original.contents),document.getElementById("media-manager-edit-container").innerHTML="";for(var e=[].slice.call(document.querySelectorAll('[data-toggle="tab"]')),o=0,t=e.length;o<t;o++)if(e[o].classList.contains("active")){Joomla.MediaManager.Edit[e[o].hash.replace("#attrib-","").toLowerCase()].Deactivate(),!a||a&&!0!==a?Joomla.MediaManager.Edit[e[o].hash.replace("#attrib-","").toLowerCase()].Activate(Joomla.MediaManager.Edit.original):Joomla.MediaManager.Edit[e[o].hash.replace("#attrib-","").toLowerCase()].Activate(Joomla.MediaManager.Edit.current);break}},window.addEventListener("mediaManager.history.point",function(){if(Joomla.MediaManager.Edit.original!==Joomla.MediaManager.Edit.current.contents){var a=Object.keys(Joomla.MediaManager.Edit.history).length;if(Joomla.MediaManager.Edit.history[a]&&Joomla.MediaManager.Edit.history[a-1]&&Joomla.MediaManager.Edit.history[a]===Joomla.MediaManager.Edit.history[a-1])return;Joomla.MediaManager.Edit.history[a+1]=Joomla.MediaManager.Edit.current.contents}}),Joomla.MediaManager.Edit.Undo=function(){},Joomla.MediaManager.Edit.Redo=function(){},Joomla.MediaManager.Edit.createProgressBar=function(){},Joomla.MediaManager.Edit.updateProgressBar=function(a){},Joomla.MediaManager.Edit.removeProgressBar=function(){},Joomla.submitbutton=function(e){var o="jpg"===Joomla.MediaManager.Edit.original.extension?"jpeg":Joomla.MediaManager.Edit.original.extension,t=window.location.pathname.replace(/&view=file.*/g,""),i=a.uploadPath.split("/").pop(),n={name:i,content:Joomla.MediaManager.Edit.current.contents.replace("data:image/"+o+";base64,","")},r=a.uploadPath,d=a.apiBaseUrl+"&task=api.files&path="+r,l="application/json";n[a.csrfToken]="1";var s=r.split("/");switch(s.pop(),(s=s.join("/")).endsWith(":")&&(s+="/"),e){case"apply":Joomla.UploadFile.exec(i,JSON.stringify(n),r,d,l),Joomla.MediaManager.Edit.Reset(!0);break;case"save":Joomla.UploadFile.exec(i,JSON.stringify(n),r,d,l),window.location=t+"?option=com_media&path="+s;break;case"cancel":window.location=t+"?option=com_media&path="+s;break;case"reset":Joomla.MediaManager.Edit.Reset("initial")}},Joomla.UploadFile={},Joomla.UploadFile.exec=function(a,e,o,t,i){var n=new XMLHttpRequest;n.upload.onprogress=function(a){Joomla.MediaManager.Edit.updateProgressBar(a.loaded/a.total*100)},n.onload=function(){try{a=JSON.parse(n.responseText)}catch(e){var a=null}a?200==n.status&&(1==a.success&&Joomla.MediaManager.Edit.removeProgressBar(),"1"==a.status&&(Joomla.renderMessages({success:[a.message]},"true"),Joomla.MediaManager.Edit.removeProgressBar())):Joomla.MediaManager.Edit.removeProgressBar()},n.onerror=function(){Joomla.MediaManager.Edit.removeProgressBar()},n.open("PUT",t,!0),n.setRequestHeader("Content-Type",i),Joomla.MediaManager.Edit.createProgressBar(),n.send(e)},document.addEventListener("DOMContentLoaded",function(){setTimeout(function(){var a=[].slice.call(document.querySelectorAll('[data-toggle="tab"]'));if(a.length){for(var e=0,o=a.length;e<o;e++)jQuery(a[e]).on("shown.bs.tab",function(a){var e;a.relatedTarget&&(Joomla.MediaManager.Edit[a.relatedTarget.hash.replace("#attrib-","").toLowerCase()].Deactivate(),document.getElementById("media-manager-edit-container").innerHTML=""),e=!0 in Joomla.MediaManager.Edit.current?Joomla.MediaManager.Edit.original:Joomla.MediaManager.Edit.current,Joomla.MediaManager.Edit[a.target.hash.replace("#attrib-","").toLowerCase()].Activate(e)});Joomla.MediaManager.Edit[a[0].hash.replace("#attrib-","").toLowerCase()].Activate(Joomla.MediaManager.Edit.original)}},100)}))}();