!function(e,t,r){var n={ajaxUrl:null,returnUrl:null,nextFrag:-1,minWait:3e3,run:function(){var e=Joomla.getOptions("com_joomlaupdate");n.ajaxUrl=e.ajaxUrl,n.returnUrl=e.returnUrl,t.getElementById("download-error").style.display="none";var a=t.getElementById("progress-bar");a.classList.remove("active","progress-striped","bar-success","bar-danger"),a.style.width="0%",a.attributes["aria-valuenow"]="0",a.innerText="0%",t.getElementById("dlpercent").innerText="0%",t.getElementById("dlbytesin").innerText="0",t.getElementById("dlbytestotal").innerText="0",n.nextFrag=-1,r.setTimeout(n.step,50)},error:function(e){var r=t.getElementById("progress-bar");r.classList.remove("active","progress-striped","bar-success","bar-danger"),r.classList.add("bar-danger"),t.getElementById("download-error").style.display="",t.getElementById("dlerror").innerHTML=e},step:function(){var a=new Date;e.ajax({type:"GET",url:n.ajaxUrl+"&frag="+n.nextFrag,cache:!1,timeout:6e5,success:function(e,s){var l="",d=t.getElementById("progress-bar");try{var i=JSON.parse(e)}catch(t){l=t.message+"\n<br/>\n<pre>\n"+e+"\n</pre>",n.error(l)}i.error&&(l=i.message??"Error",n.error(l)),i.done&&(d.classList.remove("active","progress-striped","bar-success","bar-danger"),d.classList.add("bar-success"),d.style.width="100%",d.attributes["aria-valuenow"]="100",d.innerText="100%",r.location=n.returnUrl),n.nextFrag=i.frag;var o=1*i.downloaded,c=1*i.totalSize,u=c>0?100*o/c:null;u?(d.style.width=u.toFixed(1)+"%",d.attributes["aria-valuenow"]=u.toFixed(1)+"",d.innerText=u.toFixed(1)+"%",t.getElementById("dlpercent").innerText=u.toFixed(1)+"%",t.getElementById("dlbytestotal").innerText=c+""):(d.style.width="100%",d.innerText="",t.getElementById("dlpercent").innerText="",t.getElementById("dlbytestotal").innerText=""),t.getElementById("dlbytesin").innerText=o+"";var g=new Date-a,m=n.minWait-g;m<50&&(m=50),setTimeout(n.step,m)},error:function(e){n.error("AJAX Loading Error: "+e.statusText)}})}};t.addEventListener("DOMContentLoaded",(function(){t.getElementById("dlrestart").addEventListener("click",n.run),t.getElementById("dlcancel").addEventListener("click",(function(){r.location="index.php?option=com_joomlaupdate"})),n.run()}))}(jQuery,document,window);
