class JoomlaAdminMenu extends HTMLElement{constructor(){super(),this.wrapper=document.getElementById("wrapper"),this.sidebar=document.getElementById("sidebar-wrapper"),this.allLinks="",this.currentUrl="",this.mainNav="",this.menuParents="",this.subMenuClose="",this.menuToggle="",this.first=""}connectedCallback(){if(!this.wrapper||!this.sidebar)throw new Error("HTML markup error initialising menu");const e=this;if(Joomla.localStorageEnabled()){const e=localStorage.getItem("atum-sidebar");"open"===e||null===e?(this.wrapper.classList.remove("closed"),localStorage.setItem("atum-sidebar","open")):(this.wrapper.classList.add("closed"),localStorage.setItem("atum-sidebar","closed"))}this.sidebar||this.wrapper.classList.remove("closed"),this.wrapper.classList.contains("wrapper0")&&(document.querySelector(".subhead")&&(document.querySelector(".subhead").style.left=0),document.getElementById("status")&&(document.getElementById("status").style.marginLeft=0)),this.allLinks=[].slice.call(this.wrapper.querySelectorAll("a.no-dropdown, a.collapse-arrow")),this.currentUrl=window.location.href.toLowerCase(),this.mainNav=document.getElementById("menu"),this.menuParents=[].slice.call(this.mainNav.querySelectorAll("li.parent > a")),this.subMenuClose=[].slice.call(this.mainNav.querySelectorAll("li.parent .close")),this.menuToggle=document.getElementById("menu-collapse"),this.first=[].slice.call(this.sidebar.querySelectorAll(".collapse-level-1")),this.first.forEach(e=>{[].slice.call(e.querySelectorAll(".collapse-level-1")).forEach(e=>{e&&(e.classList.remove("collapse-level-1"),e.classList.add("collapse-level-2"))})}),this.menuToggle.addEventListener("click",s=>{e.wrapper.classList.toggle("closed"),[].slice.call(document.querySelectorAll(".main-nav > li")).forEach(e=>{e.classList.remove("open")});const t=document.querySelector(".child-open");t&&t.classList.remove("child-open"),Joomla.localStorageEnabled()&&(e.wrapper.classList.contains("closed")?localStorage.setItem("atum-sidebar","closed"):localStorage.setItem("atum-sidebar","open"))}),this.allLinks.forEach(s=>{if(e.currentUrl===s.href&&(s.classList.add("active"),!s.parentNode.classList.contains("parent"))){e.mainNav.classList.add("child-open");const t=e.closest(s,".collapse-level-1");t&&t.parentNode.classList.add("open")}}),(document.body.classList.contains("com_cpanel")||document.body.classList.contains("com_media"))&&([].slice.call(this.mainNav.querySelectorAll(".open")).forEach(e=>{e.classList.remove("open")}),this.mainNav.classList.remove("child-open")),this.menuParents.forEach(s=>{s.addEventListener("click",e.openToggle.bind(e))}),this.subMenuClose.forEach(s=>{s.addEventListener("click",()=>{e.mainNav.querySelectorAll(".open").forEach(e=>{e.classList.remove("open")}),e.mainNav.classList.remove("child-open")})}),this.setMenuHeight(),window.addEventListener("resize",e.setMenuHeight.bind(e)),Joomla.localStorageEnabled()&&"true"==localStorage.getItem("adminMenuState")&&e.menuClose.bind(e)}closest(e,s){let t;["matches","msMatchesSelector"].some(function(e){return"function"==typeof document.body[e]&&(t=e,!0)});let l;for(;e;){if((l=e.parentElement)&&l[t](s))return l;e=l}return null}setMenuHeight(){const e=document.getElementById("header").offsetHeight+document.getElementById("main-brand").offsetHeight;document.getElementById("menu").height=window.height-e}openToggle(e){const s=this.findAncestor(e.target,"li");s.classList.contains("open")?(this.mainNav.classList.remove("child-open"),s.classList.remove("open")):([].slice.call(s.parentNode.children).forEach(e=>{e.classList.remove("open")}),this.wrapper.classList.remove("closed"),this.mainNav.classList.add("child-open"),s.parentNode.classList.contains("main-nav")&&s.classList.add("open"))}menuClose(){this.sidebar.querySelector(".collapse").classList.remove("in"),this.sidebar.querySelector(".collapse-arrow").classList.add("collapsed")}findAncestor(e,s){for(;(e=e.parentElement)&&e.nodeName.toLowerCase()!==s;);return e}}customElements.define("joomla-admin-menu",JoomlaAdminMenu);