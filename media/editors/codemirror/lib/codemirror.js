(function(a){if(typeof exports=="object"&&typeof module=="object"){module.exports=a()}else{if(typeof define=="function"&&define.amd){return define([],a)}else{this.CodeMirror=a()}}})(function(){var cb=/gecko\/\d/i.test(navigator.userAgent);var ek=/MSIE \d/.test(navigator.userAgent);var bY=ek&&(document.documentMode==null||document.documentMode<8);var bV=ek&&(document.documentMode==null||document.documentMode<9);var bU=ek&&(document.documentMode==null||document.documentMode<10);var bv=/Trident\/([7-9]|\d{2,})\./.test(navigator.userAgent);var dj=ek||bv;var cF=/WebKit\//.test(navigator.userAgent);var dm=cF&&/Qt\/\d+\.\d+/.test(navigator.userAgent);var cR=/Chrome\//.test(navigator.userAgent);var dB=/Opera\//.test(navigator.userAgent);var ax=/Apple Computer/.test(navigator.vendor);var aZ=/KHTML\//.test(navigator.userAgent);var cL=/Mac OS X 1\d\D([8-9]|\d\d)\D/.test(navigator.userAgent);var e1=/PhantomJS/.test(navigator.userAgent);var ez=/AppleWebKit/.test(navigator.userAgent)&&/Mobile\/\w+/.test(navigator.userAgent);var dO=ez||/Android|webOS|BlackBerry|Opera Mini|Opera Mobi|IEMobile/i.test(navigator.userAgent);var bR=ez||/Mac/.test(navigator.platform);var aF=/win/i.test(navigator.platform);var aM=dB&&navigator.userAgent.match(/Version\/(\d*\.\d*)/);if(aM){aM=Number(aM[1])}if(aM&&aM>=15){dB=false;cF=true}var bC=bR&&(dm||dB&&(aM==null||aM<12.11));var fA=cb||(dj&&!bV);var fD=false,aV=false;function I(fK,fL){if(!(this instanceof I)){return new I(fK,fL)}this.options=fL=fL||{};aD(eB,fL,false);b1(fL);var fN=fL.value;if(typeof fN=="string"){fN=new ao(fN,fL.mode)}this.doc=fN;var fM=this.display=new ei(fK,fN);fM.wrapper.CodeMirror=this;dK(this);cx(this);if(fL.lineWrapping){this.display.wrapper.className+=" CodeMirror-wrap"}if(fL.autofocus&&!dO){d9(this)}this.state={keyMaps:[],overlays:[],modeGen:0,overwrite:false,focused:false,suppressEdits:false,pasteIncoming:false,cutIncoming:false,draggingText:false,highlight:new fI()};if(ek){setTimeout(ci(eV,this,true),20)}fl(this);var fJ=this;cv(this,function(){fJ.curOp.forceUpdate=true;dJ(fJ,fN);if((fL.autofocus&&!dO)||dn()==fM.input){setTimeout(ci(cn,fJ),20)}else{aJ(fJ)}for(var fP in a2){if(a2.hasOwnProperty(fP)){a2[fP](fJ,fL[fP],bZ)}}for(var fO=0;fO<aW.length;++fO){aW[fO](fJ)}})}function ei(fJ,fL){var fM=this;var fK=fM.input=fs("textarea",null,null,"position: absolute; padding: 0; width: 1px; height: 1em; outline: none");if(cF){fK.style.width="1000px"}else{fK.setAttribute("wrap","off")}if(ez){fK.style.border="1px solid black"}fK.setAttribute("autocorrect","off");fK.setAttribute("autocapitalize","off");fK.setAttribute("spellcheck","false");fM.inputDiv=fs("div",[fK],null,"overflow: hidden; position: relative; width: 3px; height: 0px;");fM.scrollbarH=fs("div",[fs("div",null,null,"height: 100%; min-height: 1px")],"CodeMirror-hscrollbar");fM.scrollbarV=fs("div",[fs("div",null,null,"min-width: 1px")],"CodeMirror-vscrollbar");fM.scrollbarFiller=fs("div",null,"CodeMirror-scrollbar-filler");fM.gutterFiller=fs("div",null,"CodeMirror-gutter-filler");fM.lineDiv=fs("div",null,"CodeMirror-code");fM.selectionDiv=fs("div",null,null,"position: relative; z-index: 1");fM.cursorDiv=fs("div",null,"CodeMirror-cursors");fM.measure=fs("div",null,"CodeMirror-measure");fM.lineMeasure=fs("div",null,"CodeMirror-measure");fM.lineSpace=fs("div",[fM.measure,fM.lineMeasure,fM.selectionDiv,fM.cursorDiv,fM.lineDiv],null,"position: relative; outline: none");fM.mover=fs("div",[fs("div",[fM.lineSpace],"CodeMirror-lines")],null,"position: relative");fM.sizer=fs("div",[fM.mover],"CodeMirror-sizer");fM.heightForcer=fs("div",null,null,"position: absolute; height: "+a7+"px; width: 1px;");fM.gutters=fs("div",null,"CodeMirror-gutters");fM.lineGutter=null;fM.scroller=fs("div",[fM.sizer,fM.heightForcer,fM.gutters],"CodeMirror-scroll");fM.scroller.setAttribute("tabIndex","-1");fM.wrapper=fs("div",[fM.inputDiv,fM.scrollbarH,fM.scrollbarV,fM.scrollbarFiller,fM.gutterFiller,fM.scroller],"CodeMirror");if(bY){fM.gutters.style.zIndex=-1;fM.scroller.style.paddingRight=0}if(ez){fK.style.width="0px"}if(!cF){fM.scroller.draggable=true}if(aZ){fM.inputDiv.style.height="1px";fM.inputDiv.style.position="absolute"}if(bY){fM.scrollbarH.style.minHeight=fM.scrollbarV.style.minWidth="18px"}if(fJ.appendChild){fJ.appendChild(fM.wrapper)}else{fJ(fM.wrapper)}fM.viewFrom=fM.viewTo=fL.first;fM.view=[];fM.externalMeasured=null;fM.viewOffset=0;fM.lastSizeC=0;fM.updateLineNumbers=null;fM.lineNumWidth=fM.lineNumInnerWidth=fM.lineNumChars=null;fM.prevInput="";fM.alignWidgets=false;fM.pollingFast=false;fM.poll=new fI();fM.cachedCharWidth=fM.cachedTextHeight=fM.cachedPaddingH=null;fM.inaccurateSelection=false;fM.maxLine=null;fM.maxLineLength=0;fM.maxLineChanged=false;fM.wheelDX=fM.wheelDY=fM.wheelStartX=fM.wheelStartY=null;fM.shift=false}function be(fJ){fJ.doc.mode=I.getMode(fJ.options,fJ.doc.modeOption);dT(fJ)}function dT(fJ){fJ.doc.iter(function(fK){if(fK.stateAfter){fK.stateAfter=null}if(fK.styles){fK.styles=null}});fJ.doc.frontier=fJ.doc.first;dN(fJ,100);fJ.state.modeGen++;if(fJ.curOp){af(fJ)}}function eg(fJ){if(fJ.options.lineWrapping){e8(fJ.display.wrapper,"CodeMirror-wrap");fJ.display.sizer.style.minWidth=""}else{g(fJ.display.wrapper,"CodeMirror-wrap");h(fJ)}X(fJ);af(fJ);ai(fJ);setTimeout(function(){ex(fJ)},100)}function a1(fJ){var fL=aL(fJ.display),fK=fJ.options.lineWrapping;var fM=fK&&Math.max(5,fJ.display.scroller.clientWidth/de(fJ.display)-3);return function(fO){if(e3(fJ.doc,fO)){return 0}var fN=0;if(fO.widgets){for(var fP=0;fP<fO.widgets.length;fP++){if(fO.widgets[fP].height){fN+=fO.widgets[fP].height}}}if(fK){return fN+(Math.ceil(fO.text.length/fM)||1)*fL}else{return fN+fL}}}function X(fJ){var fL=fJ.doc,fK=a1(fJ);fL.iter(function(fM){var fN=fK(fM);if(fN!=fM.height){fw(fM,fN)}})}function fG(fJ){var fL=eG[fJ.options.keyMap],fK=fL.style;fJ.display.wrapper.className=fJ.display.wrapper.className.replace(/\s*cm-keymap-\S+/g,"")+(fK?" cm-keymap-"+fK:"")}function cx(fJ){fJ.display.wrapper.className=fJ.display.wrapper.className.replace(/\s*cm-s-\S+/g,"")+fJ.options.theme.replace(/(^|\s)\s*/g," cm-s-");ai(fJ)}function c7(fJ){dK(fJ);af(fJ);setTimeout(function(){ee(fJ)},20)}function dK(fJ){var fK=fJ.display.gutters,fO=fJ.options.gutters;dA(fK);for(var fL=0;fL<fO.length;++fL){var fM=fO[fL];var fN=fK.appendChild(fs("div",null,"CodeMirror-gutter "+fM));if(fM=="CodeMirror-linenumbers"){fJ.display.lineGutter=fN;fN.style.width=(fJ.display.lineNumWidth||1)+"px"}}fK.style.display=fL?"":"none";cJ(fJ)}function cJ(fJ){var fK=fJ.display.gutters.offsetWidth;fJ.display.sizer.style.marginLeft=fK+"px";fJ.display.scrollbarH.style.left=fJ.options.fixedGutter?fK+"px":0}function dU(fL){if(fL.height==0){return 0}var fK=fL.text.length,fJ,fN=fL;while(fJ=en(fN)){var fM=fJ.find(0,true);fN=fM.from.line;fK+=fM.from.ch-fM.to.ch}fN=fL;while(fJ=d3(fN)){var fM=fJ.find(0,true);fK-=fN.text.length-fM.from.ch;fN=fM.to.line;fK+=fN.text.length-fM.to.ch}return fK}function h(fJ){var fL=fJ.display,fK=fJ.doc;fL.maxLine=eL(fK,fK.first);fL.maxLineLength=dU(fL.maxLine);fL.maxLineChanged=true;fK.iter(function(fN){var fM=dU(fN);if(fM>fL.maxLineLength){fL.maxLineLength=fM;fL.maxLine=fN}})}function b1(fJ){var fK=cX(fJ.gutters,"CodeMirror-linenumbers");if(fK==-1&&fJ.lineNumbers){fJ.gutters=fJ.gutters.concat(["CodeMirror-linenumbers"])}else{if(fK>-1&&!fJ.lineNumbers){fJ.gutters=fJ.gutters.slice(0);fJ.gutters.splice(fK,1)}}}function db(fK){var fJ=fK.display.scroller;return{clientHeight:fJ.clientHeight,barHeight:fK.display.scrollbarV.clientHeight,scrollWidth:fJ.scrollWidth,clientWidth:fJ.clientWidth,barWidth:fK.display.scrollbarH.clientWidth,docHeight:Math.round(fK.doc.height+bu(fK.display))}}function ex(fJ,fO){if(!fO){fO=db(fJ)}var fQ=fJ.display;var fN=fO.docHeight+a7;var fP=fO.scrollWidth>fO.clientWidth;var fL=fN>fO.clientHeight;if(fL){fQ.scrollbarV.style.display="block";fQ.scrollbarV.style.bottom=fP?l(fQ.measure)+"px":"0";fQ.scrollbarV.firstChild.style.height=Math.max(0,fN-fO.clientHeight+(fO.barHeight||fQ.scrollbarV.clientHeight))+"px"}else{fQ.scrollbarV.style.display="";fQ.scrollbarV.firstChild.style.height="0"}if(fP){fQ.scrollbarH.style.display="block";fQ.scrollbarH.style.right=fL?l(fQ.measure)+"px":"0";fQ.scrollbarH.firstChild.style.width=(fO.scrollWidth-fO.clientWidth+(fO.barWidth||fQ.scrollbarH.clientWidth))+"px"}else{fQ.scrollbarH.style.display="";fQ.scrollbarH.firstChild.style.width="0"}if(fP&&fL){fQ.scrollbarFiller.style.display="block";fQ.scrollbarFiller.style.height=fQ.scrollbarFiller.style.width=l(fQ.measure)+"px"}else{fQ.scrollbarFiller.style.display=""}if(fP&&fJ.options.coverGutterNextToScrollbar&&fJ.options.fixedGutter){fQ.gutterFiller.style.display="block";fQ.gutterFiller.style.height=l(fQ.measure)+"px";fQ.gutterFiller.style.width=fQ.gutters.offsetWidth+"px"}else{fQ.gutterFiller.style.display=""}if(!fJ.state.checkedOverlayScrollbar&&fO.clientHeight>0){if(l(fQ.measure)===0){var fK=bR&&!cL?"12px":"18px";fQ.scrollbarV.style.minWidth=fQ.scrollbarH.style.minHeight=fK;var fM=function(fR){if(L(fR)!=fQ.scrollbarV&&L(fR)!=fQ.scrollbarH){cH(fJ,d1)(fR)}};bJ(fQ.scrollbarV,"mousedown",fM);bJ(fQ.scrollbarH,"mousedown",fM)}fJ.state.checkedOverlayScrollbar=true}}function bQ(fL,fP,fR){var fM=fR&&fR.top!=null?fR.top:fL.scroller.scrollTop;fM=Math.floor(fM-eE(fL));var fJ=fR&&fR.bottom!=null?fR.bottom:fM+fL.wrapper.clientHeight;var fN=bs(fP,fM),fO=bs(fP,fJ);if(fR&&fR.ensure){var fK=fR.ensure.from.line,fQ=fR.ensure.to.line;if(fK<fN){return{from:fK,to:bs(fP,by(eL(fP,fK))+fL.wrapper.clientHeight)}}if(Math.min(fQ,fP.lastLine())>=fO){return{from:bs(fP,by(eL(fP,fQ))-fL.wrapper.clientHeight),to:fQ}}}return{from:fN,to:fO}}function ee(fR){var fP=fR.display,fQ=fP.view;if(!fP.alignWidgets&&(!fP.gutters.firstChild||!fR.options.fixedGutter)){return}var fN=dw(fP)-fP.scroller.scrollLeft+fR.doc.scrollLeft;var fJ=fP.gutters.offsetWidth,fK=fN+"px";for(var fM=0;fM<fQ.length;fM++){if(!fQ[fM].hidden){if(fR.options.fixedGutter&&fQ[fM].gutter){fQ[fM].gutter.style.left=fK}var fO=fQ[fM].alignable;if(fO){for(var fL=0;fL<fO.length;fL++){fO[fL].style.left=fK}}}}if(fR.options.fixedGutter){fP.gutters.style.left=(fN+fJ)+"px"}}function dE(fJ){if(!fJ.options.lineNumbers){return false}var fO=fJ.doc,fK=d0(fJ.options,fO.first+fO.size-1),fN=fJ.display;if(fK.length!=fN.lineNumChars){var fP=fN.measure.appendChild(fs("div",[fs("div",fK)],"CodeMirror-linenumber CodeMirror-gutter-elt"));var fL=fP.firstChild.offsetWidth,fM=fP.offsetWidth-fL;fN.lineGutter.style.width="";fN.lineNumInnerWidth=Math.max(fL,fN.lineGutter.offsetWidth-fM);fN.lineNumWidth=fN.lineNumInnerWidth+fM;fN.lineNumChars=fN.lineNumInnerWidth?fK.length:-1;fN.lineGutter.style.width=fN.lineNumWidth+"px";cJ(fJ);return true}return false}function d0(fJ,fK){return String(fJ.lineNumberFormatter(fK+fJ.firstLineNumber))}function dw(fJ){return fJ.scroller.getBoundingClientRect().left-fJ.sizer.getBoundingClientRect().left}function dk(fO,fR,fS){var fQ=fO.display.viewFrom,fP=fO.display.viewTo,fM;var fJ=bQ(fO.display,fO.doc,fR);for(var fL=true;;fL=false){var fK=fO.display.scroller.clientWidth;if(!cV(fO,fJ,fS)){break}fM=true;if(fO.display.maxLineChanged&&!fO.options.lineWrapping){b(fO)}var fN=db(fO);bo(fO);da(fO,fN);ex(fO,fN);if(cF&&fO.options.lineWrapping){fv(fO,fN)}if(fL&&fO.options.lineWrapping&&fK!=fO.display.scroller.clientWidth){fS=true;continue}fS=false;if(fR&&fR.top!=null){fR={top:Math.min(fN.docHeight-a7-fN.clientHeight,fR.top)}}fJ=bQ(fO.display,fO.doc,fR);if(fJ.from>=fO.display.viewFrom&&fJ.to<=fO.display.viewTo){break}}fO.display.updateLineNumbers=null;if(fM){ac(fO,"update",fO);if(fO.display.viewFrom!=fQ||fO.display.viewTo!=fP){ac(fO,"viewportChange",fO,fO.display.viewFrom,fO.display.viewTo)}}return fM}function cV(fT,fL,fU){var fN=fT.display,fS=fT.doc;if(!fN.wrapper.offsetWidth){d5(fT);return}if(!fU&&fL.from>=fN.viewFrom&&fL.to<=fN.viewTo&&cQ(fT)==0){return}if(dE(fT)){d5(fT)}var fR=eI(fT);var fM=fS.first+fS.size;var fQ=Math.max(fL.from-fT.options.viewportMargin,fS.first);var fP=Math.min(fM,fL.to+fT.options.viewportMargin);if(fN.viewFrom<fQ&&fQ-fN.viewFrom<20){fQ=Math.max(fS.first,fN.viewFrom)}if(fN.viewTo>fP&&fN.viewTo-fP<20){fP=Math.min(fM,fN.viewTo)}if(aV){fQ=aK(fT.doc,fQ);fP=dC(fT.doc,fP)}var fK=fQ!=fN.viewFrom||fP!=fN.viewTo||fN.lastSizeC!=fN.wrapper.clientHeight;cz(fT,fQ,fP);fN.viewOffset=by(eL(fT.doc,fN.viewFrom));fT.display.mover.style.top=fN.viewOffset+"px";var fJ=cQ(fT);if(!fK&&fJ==0&&!fU){return}var fO=dn();if(fJ>4){fN.lineDiv.style.display="none"}b9(fT,fN.updateLineNumbers,fR);if(fJ>4){fN.lineDiv.style.display=""}if(fO&&dn()!=fO&&fO.offsetHeight){fO.focus()}dA(fN.cursorDiv);dA(fN.selectionDiv);if(fK){fN.lastSizeC=fN.wrapper.clientHeight;dN(fT,400)}aX(fT);return true}function b(fJ){var fN=fJ.display;var fL=dP(fJ,fN.maxLine,fN.maxLine.text.length).left;fN.maxLineChanged=false;var fK=Math.max(0,fL+3);var fM=Math.max(0,fN.sizer.offsetLeft+fK+a7-fN.scroller.clientWidth);fN.sizer.style.minWidth=fK+"px";if(fM<fJ.doc.scrollLeft){bq(fJ,Math.min(fN.scroller.scrollLeft,fM),true)}}function da(fJ,fK){fJ.display.sizer.style.minHeight=fJ.display.heightForcer.style.top=fK.docHeight+"px";fJ.display.gutters.style.height=Math.max(fK.docHeight,fK.clientHeight-a7)+"px"}function fv(fJ,fK){if(fJ.display.sizer.offsetWidth+fJ.display.gutters.offsetWidth<fJ.display.scroller.clientWidth-1){fJ.display.sizer.style.minHeight=fJ.display.heightForcer.style.top="0px";fJ.display.gutters.style.height=fK.docHeight+"px"}}function aX(fQ){var fO=fQ.display;var fK=fO.lineDiv.offsetTop;for(var fL=0;fL<fO.view.length;fL++){var fR=fO.view[fL],fS;if(fR.hidden){continue}if(bY){var fN=fR.node.offsetTop+fR.node.offsetHeight;fS=fN-fK;fK=fN}else{var fM=fR.node.getBoundingClientRect();fS=fM.bottom-fM.top}var fP=fR.line.height-fS;if(fS<2){fS=aL(fO)}if(fP>0.001||fP<-0.001){fw(fR.line,fS);bX(fR.line);if(fR.rest){for(var fJ=0;fJ<fR.rest.length;fJ++){bX(fR.rest[fJ])}}}}}function bX(fJ){if(fJ.widgets){for(var fK=0;fK<fJ.widgets.length;++fK){fJ.widgets[fK].height=fJ.widgets[fK].node.offsetHeight}}}function eI(fJ){var fN=fJ.display,fM={},fL={};for(var fO=fN.gutters.firstChild,fK=0;fO;fO=fO.nextSibling,++fK){fM[fJ.options.gutters[fK]]=fO.offsetLeft;fL[fJ.options.gutters[fK]]=fO.offsetWidth}return{fixedPos:dw(fN),gutterTotalWidth:fN.gutters.offsetWidth,gutterLeft:fM,gutterWidth:fL,wrapperWidth:fN.wrapper.clientWidth}}function b9(fU,fL,fT){var fQ=fU.display,fW=fU.options.lineNumbers;var fJ=fQ.lineDiv,fV=fJ.firstChild;function fP(fY){var fX=fY.nextSibling;if(cF&&bR&&fU.display.currentWheelTarget==fY){fY.style.display="none"}else{fY.parentNode.removeChild(fY)}return fX}var fR=fQ.view,fO=fQ.viewFrom;for(var fM=0;fM<fR.length;fM++){var fN=fR[fM];if(fN.hidden){}else{if(!fN.node){var fK=az(fU,fN,fO,fT);fJ.insertBefore(fK,fV)}else{while(fV!=fN.node){fV=fP(fV)}var fS=fW&&fL!=null&&fL<=fO&&fN.lineNumber;if(fN.changes){if(cX(fN.changes,"gutter")>-1){fS=false}Z(fU,fN,fO,fT)}if(fS){dA(fN.lineNumber);fN.lineNumber.appendChild(document.createTextNode(d0(fU.options,fO)))}fV=fN.node.nextSibling}}fO+=fN.size}while(fV){fV=fP(fV)}}function Z(fJ,fL,fN,fO){for(var fK=0;fK<fL.changes.length;fK++){var fM=fL.changes[fK];if(fM=="text"){eR(fJ,fL)}else{if(fM=="gutter"){cU(fJ,fL,fN,fO)}else{if(fM=="class"){dh(fL)}else{if(fM=="widget"){al(fL,fO)}}}}}fL.changes=null}function fe(fJ){if(fJ.node==fJ.text){fJ.node=fs("div",null,null,"position: relative");if(fJ.text.parentNode){fJ.text.parentNode.replaceChild(fJ.node,fJ.text)}fJ.node.appendChild(fJ.text);if(bY){fJ.node.style.zIndex=2}}return fJ.node}function d2(fK){var fJ=fK.bgClass?fK.bgClass+" "+(fK.line.bgClass||""):fK.line.bgClass;if(fJ){fJ+=" CodeMirror-linebackground"}if(fK.background){if(fJ){fK.background.className=fJ}else{fK.background.parentNode.removeChild(fK.background);fK.background=null}}else{if(fJ){var fL=fe(fK);fK.background=fL.insertBefore(fs("div",null,fJ),fL.firstChild)}}}function du(fJ,fK){var fL=fJ.display.externalMeasured;if(fL&&fL.line==fK.line){fJ.display.externalMeasured=null;fK.measure=fL.measure;return fL.built}return er(fJ,fK)}function eR(fJ,fM){var fK=fM.text.className;var fL=du(fJ,fM);if(fM.text==fM.node){fM.node=fL.pre}fM.text.parentNode.replaceChild(fL.pre,fM.text);fM.text=fL.pre;if(fL.bgClass!=fM.bgClass||fL.textClass!=fM.textClass){fM.bgClass=fL.bgClass;fM.textClass=fL.textClass;dh(fM)}else{if(fK){fM.text.className=fK}}}function dh(fK){d2(fK);if(fK.line.wrapClass){fe(fK).className=fK.line.wrapClass}else{if(fK.node!=fK.text){fK.node.className=""}}var fJ=fK.textClass?fK.textClass+" "+(fK.line.textClass||""):fK.line.textClass;fK.text.className=fJ||""}function cU(fR,fP,fO,fQ){if(fP.gutter){fP.node.removeChild(fP.gutter);fP.gutter=null}var fM=fP.line.gutterMarkers;if(fR.options.lineNumbers||fM){var fK=fe(fP);var fN=fP.gutter=fK.insertBefore(fs("div",null,"CodeMirror-gutter-wrapper","position: absolute; left: "+(fR.options.fixedGutter?fQ.fixedPos:-fQ.gutterTotalWidth)+"px"),fP.text);if(fR.options.lineNumbers&&(!fM||!fM["CodeMirror-linenumbers"])){fP.lineNumber=fN.appendChild(fs("div",d0(fR.options,fO),"CodeMirror-linenumber CodeMirror-gutter-elt","left: "+fQ.gutterLeft["CodeMirror-linenumbers"]+"px; width: "+fR.display.lineNumInnerWidth+"px"))}if(fM){for(var fL=0;fL<fR.options.gutters.length;++fL){var fJ=fR.options.gutters[fL],fS=fM.hasOwnProperty(fJ)&&fM[fJ];if(fS){fN.appendChild(fs("div",[fS],"CodeMirror-gutter-elt","left: "+fQ.gutterLeft[fJ]+"px; width: "+fQ.gutterWidth[fJ]+"px"))}}}}}function al(fJ,fM){if(fJ.alignable){fJ.alignable=null}for(var fL=fJ.node.firstChild,fK;fL;fL=fK){var fK=fL.nextSibling;if(fL.className=="CodeMirror-linewidget"){fJ.node.removeChild(fL)}}e0(fJ,fM)}function az(fJ,fL,fM,fN){var fK=du(fJ,fL);fL.text=fL.node=fK.pre;if(fK.bgClass){fL.bgClass=fK.bgClass}if(fK.textClass){fL.textClass=fK.textClass}dh(fL);cU(fJ,fL,fM,fN);e0(fL,fN);return fL.node}function e0(fK,fL){fx(fK.line,fK,fL,true);if(fK.rest){for(var fJ=0;fJ<fK.rest.length;fJ++){fx(fK.rest[fJ],fK,fL,false)}}}function fx(fR,fO,fQ,fM){if(!fR.widgets){return}var fJ=fe(fO);for(var fL=0,fP=fR.widgets;fL<fP.length;++fL){var fN=fP[fL],fK=fs("div",[fN.node],"CodeMirror-linewidget");if(!fN.handleMouseEvents){fK.ignoreEvents=true}br(fN,fK,fO,fQ);if(fM&&fN.above){fJ.insertBefore(fK,fO.gutter||fO.text)}else{fJ.appendChild(fK)}ac(fN,"redraw")}}function br(fM,fL,fJ,fN){if(fM.noHScroll){(fJ.alignable||(fJ.alignable=[])).push(fL);var fK=fN.wrapperWidth;fL.style.left=fN.fixedPos+"px";if(!fM.coverGutter){fK-=fN.gutterTotalWidth;fL.style.paddingLeft=fN.gutterTotalWidth+"px"}fL.style.width=fK+"px"}if(fM.coverGutter){fL.style.zIndex=5;fL.style.position="relative";if(!fM.noHScroll){fL.style.marginLeft=-fN.gutterTotalWidth+"px"}}}var W=I.Pos=function(fJ,fK){if(!(this instanceof W)){return new W(fJ,fK)}this.line=fJ;this.ch=fK};var b2=I.cmpPos=function(fK,fJ){return fK.line-fJ.line||fK.ch-fJ.ch};function b6(fJ){return W(fJ.line,fJ.ch)}function bk(fK,fJ){return b2(fK,fJ)<0?fJ:fK}function am(fK,fJ){return b2(fK,fJ)<0?fK:fJ}function ft(fJ,fK){this.ranges=fJ;this.primIndex=fK}ft.prototype={primary:function(){return this.ranges[this.primIndex]},equals:function(fJ){if(fJ==this){return true}if(fJ.primIndex!=this.primIndex||fJ.ranges.length!=this.ranges.length){return false}for(var fL=0;fL<this.ranges.length;fL++){var fK=this.ranges[fL],fM=fJ.ranges[fL];if(b2(fK.anchor,fM.anchor)!=0||b2(fK.head,fM.head)!=0){return false}}return true},deepCopy:function(){for(var fJ=[],fK=0;fK<this.ranges.length;fK++){fJ[fK]=new dx(b6(this.ranges[fK].anchor),b6(this.ranges[fK].head))}return new ft(fJ,this.primIndex)},somethingSelected:function(){for(var fJ=0;fJ<this.ranges.length;fJ++){if(!this.ranges[fJ].empty()){return true}}return false},contains:function(fM,fJ){if(!fJ){fJ=fM}for(var fL=0;fL<this.ranges.length;fL++){var fK=this.ranges[fL];if(b2(fJ,fK.from())>=0&&b2(fM,fK.to())<=0){return fL}}return -1}};function dx(fJ,fK){this.anchor=fJ;this.head=fK}dx.prototype={from:function(){return am(this.anchor,this.head)},to:function(){return bk(this.anchor,this.head)},empty:function(){return this.head.line==this.anchor.line&&this.head.ch==this.anchor.ch}};function cj(fJ,fQ){var fL=fJ[fQ];fJ.sort(function(fT,fS){return b2(fT.from(),fS.from())});fQ=cX(fJ,fL);for(var fN=1;fN<fJ.length;fN++){var fR=fJ[fN],fK=fJ[fN-1];if(b2(fK.to(),fR.from())>=0){var fO=am(fK.from(),fR.from()),fP=bk(fK.to(),fR.to());var fM=fK.empty()?fR.from()==fR.head:fK.from()==fK.head;if(fN<=fQ){--fQ}fJ.splice(--fN,2,new dx(fM?fP:fO,fM?fO:fP))}}return new ft(fJ,fQ)}function eq(fJ,fK){return new ft([new dx(fJ,fK||fJ)],0)}function cK(fJ,fK){return Math.max(fJ.first,Math.min(fK,fJ.first+fJ.size-1))}function ff(fK,fL){if(fL.line<fK.first){return W(fK.first,0)}var fJ=fK.first+fK.size-1;if(fL.line>fJ){return W(fJ,eL(fK,fJ).text.length)}return eZ(fL,eL(fK,fL.line).text.length)}function eZ(fL,fK){var fJ=fL.ch;if(fJ==null||fJ>fK){return W(fL.line,fK)}else{if(fJ<0){return W(fL.line,0)}else{return fL}}}function bT(fK,fJ){return fJ>=fK.first&&fJ<fK.first+fK.size}function dy(fL,fM){for(var fJ=[],fK=0;fK<fM.length;fK++){fJ[fK]=ff(fL,fM[fK])}return fJ}function e2(fO,fK,fN,fJ){if(fO.cm&&fO.cm.display.shift||fO.extend){var fM=fK.anchor;if(fJ){var fL=b2(fN,fM)<0;if(fL!=(b2(fJ,fM)<0)){fM=fN;fN=fJ}else{if(fL!=(b2(fN,fJ)<0)){fN=fJ}}}return new dx(fM,fN)}else{return new dx(fJ||fN,fN)}}function fp(fM,fL,fJ,fK){bG(fM,new ft([e2(fM,fM.sel.primary(),fL,fJ)],0),fK)}function at(fO,fN,fL){for(var fK=[],fM=0;fM<fO.sel.ranges.length;fM++){fK[fM]=e2(fO,fO.sel.ranges[fM],fN[fM],null)}var fJ=cj(fK,fO.sel.primIndex);bG(fO,fJ,fL)}function f(fN,fM,fK,fL){var fJ=fN.sel.ranges.slice(0);fJ[fM]=fK;bG(fN,cj(fJ,fN.sel.primIndex),fL)}function G(fM,fK,fL,fJ){bG(fM,eq(fK,fL),fJ)}function d(fL,fJ){var fK={ranges:fJ.ranges,update:function(fM){this.ranges=[];for(var fN=0;fN<fM.length;fN++){this.ranges[fN]=new dx(ff(fL,fM[fN].anchor),ff(fL,fM[fN].head))}}};ay(fL,"beforeSelectionChange",fL,fK);if(fL.cm){ay(fL.cm,"beforeSelectionChange",fL.cm,fK)}if(fK.ranges!=fJ.ranges){return cj(fK.ranges,fK.ranges.length-1)}else{return fJ}}function eD(fN,fM,fK){var fJ=fN.history.done,fL=fd(fJ);if(fL&&fL.ranges){fJ[fJ.length-1]=fM;dX(fN,fM,fK)}else{bG(fN,fM,fK)}}function bG(fL,fK,fJ){dX(fL,fK,fJ);fC(fL,fL.sel,fL.cm?fL.cm.curOp.id:NaN,fJ)}function dX(fM,fL,fK){if(eO(fM,"beforeSelectionChange")||fM.cm&&eO(fM.cm,"beforeSelectionChange")){fL=d(fM,fL)}var fJ=b2(fL.primary().head,fM.sel.primary().head)<0?-1:1;cO(fM,o(fM,fL,fJ,true));if(!(fK&&fK.scroll===false)&&fM.cm){fc(fM.cm)}}function cO(fK,fJ){if(fJ.equals(fK.sel)){return}fK.sel=fJ;if(fK.cm){fK.cm.curOp.updateInput=fK.cm.curOp.selectionChanged=true;V(fK.cm)}ac(fK,"cursorActivity",fK)}function d6(fJ){cO(fJ,o(fJ,fJ.sel,null,false),Y)}function o(fR,fJ,fO,fP){var fL;for(var fM=0;fM<fJ.ranges.length;fM++){var fN=fJ.ranges[fM];var fQ=bH(fR,fN.anchor,fO,fP);var fK=bH(fR,fN.head,fO,fP);if(fL||fQ!=fN.anchor||fK!=fN.head){if(!fL){fL=fJ.ranges.slice(0,fM)}fL[fM]=new dx(fQ,fK)}}return fL?cj(fL,fJ.primIndex):fJ}function bH(fS,fR,fO,fP){var fT=false,fL=fR;var fM=fO||1;fS.cantEdit=false;search:for(;;){var fU=eL(fS,fL.line);if(fU.markedSpans){for(var fN=0;fN<fU.markedSpans.length;++fN){var fJ=fU.markedSpans[fN],fK=fJ.marker;if((fJ.from==null||(fK.inclusiveLeft?fJ.from<=fL.ch:fJ.from<fL.ch))&&(fJ.to==null||(fK.inclusiveRight?fJ.to>=fL.ch:fJ.to>fL.ch))){if(fP){ay(fK,"beforeCursorEnter");if(fK.explicitlyCleared){if(!fU.markedSpans){break}else{--fN;continue}}}if(!fK.atomic){continue}var fQ=fK.find(fM<0?-1:1);if(b2(fQ,fL)==0){fQ.ch+=fM;if(fQ.ch<0){if(fQ.line>fS.first){fQ=ff(fS,W(fQ.line-1))}else{fQ=null}}else{if(fQ.ch>fU.text.length){if(fQ.line<fS.first+fS.size-1){fQ=W(fQ.line+1,0)}else{fQ=null}}}if(!fQ){if(fT){if(!fP){return bH(fS,fR,fO,true)}fS.cantEdit=true;return W(fS.first,0)}fT=true;fQ=fR;fM=-fM}}fL=fQ;continue search}}}return fL}}function bo(fV){var fQ=fV.display,fU=fV.doc;var fS=document.createDocumentFragment();var fM=document.createDocumentFragment();for(var fO=0;fO<fU.sel.ranges.length;fO++){var fP=fU.sel.ranges[fO];var fN=fP.empty();if(fN||fV.options.showCursorWhenSelecting){B(fV,fP,fS)}if(!fN){bp(fV,fP,fM)}}if(fV.options.moveInputWithCursor){var fR=dt(fV,fU.sel.primary().head,"div");var fJ=fQ.wrapper.getBoundingClientRect(),fL=fQ.lineDiv.getBoundingClientRect();var fT=Math.max(0,Math.min(fQ.wrapper.clientHeight-10,fR.top+fL.top-fJ.top));var fK=Math.max(0,Math.min(fQ.wrapper.clientWidth-10,fR.left+fL.left-fJ.left));fQ.inputDiv.style.top=fT+"px";fQ.inputDiv.style.left=fK+"px"}bD(fQ.cursorDiv,fS);bD(fQ.selectionDiv,fM)}function B(fJ,fM,fL){var fO=dt(fJ,fM.head,"div");var fN=fL.appendChild(fs("div","\u00a0","CodeMirror-cursor"));fN.style.left=fO.left+"px";fN.style.top=fO.top+"px";fN.style.height=Math.max(0,fO.bottom-fO.top)*fJ.options.cursorHeight+"px";if(fO.other){var fK=fL.appendChild(fs("div","\u00a0","CodeMirror-cursor CodeMirror-secondarycursor"));fK.style.display="";fK.style.left=fO.other.left+"px";fK.style.top=fO.other.top+"px";fK.style.height=(fO.other.bottom-fO.other.top)*0.85+"px"}}function bp(fN,fT,fO){var fW=fN.display,f0=fN.doc;var fJ=document.createDocumentFragment();var fS=eC(fN.display),fM=fS.left,fX=fW.lineSpace.offsetWidth-fS.right;function fU(f4,f3,f2,f1){if(f3<0){f3=0}f3=Math.round(f3);f1=Math.round(f1);fJ.appendChild(fs("div",null,"CodeMirror-selected","position: absolute; left: "+f4+"px; top: "+f3+"px; width: "+(f2==null?fX-f4:f2)+"px; height: "+(f1-f3)+"px"))}function fK(f2,f4,f7){var f3=eL(f0,f2);var f5=f3.text.length;var f8,f1;function f6(ga,f9){return ct(fN,W(f2,ga),"div",f3,f9)}dD(a(f3),f4||0,f7==null?f5:f7,function(gg,gf,f9){var gc=f6(gg,"left"),gd,ge,gb;if(gg==gf){gd=gc;ge=gb=gc.left}else{gd=f6(gf-1,"right");if(f9=="rtl"){var ga=gc;gc=gd;gd=ga}ge=gc.left;gb=gd.right}if(f4==null&&gg==0){ge=fM}if(gd.top-gc.top>3){fU(ge,gc.top,null,gc.bottom);ge=fM;if(gc.bottom<gd.top){fU(ge,gc.bottom,null,gd.top)}}if(f7==null&&gf==f5){gb=fX}if(!f8||gc.top<f8.top||gc.top==f8.top&&gc.left<f8.left){f8=gc}if(!f1||gd.bottom>f1.bottom||gd.bottom==f1.bottom&&gd.right>f1.right){f1=gd}if(ge<fM+1){ge=fM}fU(ge,gd.top,gb-ge,gd.bottom)});return{start:f8,end:f1}}var fZ=fT.from(),fY=fT.to();if(fZ.line==fY.line){fK(fZ.line,fZ.ch,fY.ch)}else{var fL=eL(f0,fZ.line),fQ=eL(f0,fY.line);var fP=z(fL)==z(fQ);var fR=fK(fZ.line,fZ.ch,fP?fL.text.length+1:null).end;var fV=fK(fY.line,fP?0:null,fY.ch).start;if(fP){if(fR.top<fV.top-2){fU(fR.right,fR.top,null,fR.bottom);fU(fM,fV.top,fV.left,fV.bottom)}else{fU(fR.right,fR.top,fV.left-fR.right,fR.bottom)}}if(fR.bottom<fV.top){fU(fM,fR.bottom,null,fV.top)}}fO.appendChild(fJ)}function p(fJ){if(!fJ.state.focused){return}var fL=fJ.display;clearInterval(fL.blinker);var fK=true;fL.cursorDiv.style.visibility="";if(fJ.options.cursorBlinkRate>0){fL.blinker=setInterval(function(){fL.cursorDiv.style.visibility=(fK=!fK)?"":"hidden"},fJ.options.cursorBlinkRate)}}function dN(fJ,fK){if(fJ.doc.mode.startState&&fJ.doc.frontier<fJ.display.viewTo){fJ.state.highlight.set(fK,ci(cy,fJ))}}function cy(fJ){var fM=fJ.doc;if(fM.frontier<fM.first){fM.frontier=fM.first}if(fM.frontier>=fJ.display.viewTo){return}var fK=+new Date+fJ.options.workTime;var fL=bO(fM.mode,dc(fJ,fM.frontier));cv(fJ,function(){fM.iter(fM.frontier,Math.min(fM.first+fM.size,fJ.display.viewTo+500),function(fN){if(fM.frontier>=fJ.display.viewFrom){var fP=fN.styles;var fQ=e6(fJ,fN,fL,true);fN.styles=fQ.styles;if(fQ.classes){fN.styleClasses=fQ.classes}else{if(fN.styleClasses){fN.styleClasses=null}}var fR=!fP||fP.length!=fN.styles.length;for(var fO=0;!fR&&fO<fP.length;++fO){fR=fP[fO]!=fN.styles[fO]}if(fR){R(fJ,fM.frontier,"text")}fN.stateAfter=bO(fM.mode,fL)}else{c8(fJ,fN.text,fL);fN.stateAfter=fM.frontier%5==0?bO(fM.mode,fL):null}++fM.frontier;if(+new Date>fK){dN(fJ,fJ.options.workDelay);return true}})})}function cl(fP,fJ,fM){var fK,fN,fO=fP.doc;var fL=fM?-1:fJ-(fP.doc.mode.innerMode?1000:100);for(var fS=fJ;fS>fL;--fS){if(fS<=fO.first){return fO.first}var fR=eL(fO,fS-1);if(fR.stateAfter&&(!fM||fS<=fO.frontier)){return fS}var fQ=bF(fR.text,null,fP.options.tabSize);if(fN==null||fK>fQ){fN=fS-1;fK=fQ}}return fN}function dc(fJ,fP,fK){var fN=fJ.doc,fM=fJ.display;if(!fN.mode.startState){return true}var fO=cl(fJ,fP,fK),fL=fO>fN.first&&eL(fN,fO-1).stateAfter;if(!fL){fL=bM(fN.mode)}else{fL=bO(fN.mode,fL)}fN.iter(fO,fP,function(fQ){c8(fJ,fQ.text,fL);var fR=fO==fP-1||fO%5==0||fO>=fM.viewFrom&&fO<fM.viewTo;fQ.stateAfter=fR?bO(fN.mode,fL):null;++fO});if(fK){fN.frontier=fO}return fL}function eE(fJ){return fJ.lineSpace.offsetTop}function bu(fJ){return fJ.mover.offsetHeight-fJ.lineSpace.offsetHeight}function eC(fM){if(fM.cachedPaddingH){return fM.cachedPaddingH}var fL=bD(fM.measure,fs("pre","x"));var fJ=window.getComputedStyle?window.getComputedStyle(fL):fL.currentStyle;var fK={left:parseInt(fJ.paddingLeft),right:parseInt(fJ.paddingRight)};if(!isNaN(fK.left)&&!isNaN(fK.right)){fM.cachedPaddingH=fK}return fK}function b5(fQ,fM,fP){var fL=fQ.options.lineWrapping;var fN=fL&&fQ.display.scroller.clientWidth;if(!fM.measure.heights||fL&&fM.measure.width!=fN){var fO=fM.measure.heights=[];if(fL){fM.measure.width=fN;var fS=fM.text.firstChild.getClientRects();for(var fJ=0;fJ<fS.length-1;fJ++){var fR=fS[fJ],fK=fS[fJ+1];if(Math.abs(fR.bottom-fK.bottom)>2){fO.push((fR.bottom+fK.top)/2-fP.top)}}}fO.push(fP.bottom-fP.top)}}function cg(fL,fJ,fM){if(fL.line==fJ){return{map:fL.measure.map,cache:fL.measure.cache}}for(var fK=0;fK<fL.rest.length;fK++){if(fL.rest[fK]==fJ){return{map:fL.measure.maps[fK],cache:fL.measure.caches[fK]}}}for(var fK=0;fK<fL.rest.length;fK++){if(bz(fL.rest[fK])>fM){return{map:fL.measure.maps[fK],cache:fL.measure.caches[fK],before:true}}}}function cG(fJ,fL){fL=z(fL);var fN=bz(fL);var fK=fJ.display.externalMeasured=new bi(fJ.doc,fL,fN);fK.lineN=fN;var fM=fK.built=er(fJ,fK);fK.text=fM.pre;bD(fJ.display.lineMeasure,fM.pre);return fK}function dP(fJ,fK,fM,fL){return D(fJ,aS(fJ,fK),fM,fL)}function eH(fJ,fL){if(fL>=fJ.display.viewFrom&&fL<fJ.display.viewTo){return fJ.display.view[c3(fJ,fL)]}var fK=fJ.display.externalMeasured;if(fK&&fL>=fK.lineN&&fL<fK.lineN+fK.size){return fK}}function aS(fJ,fL){var fM=bz(fL);var fK=eH(fJ,fM);if(fK&&!fK.text){fK=null}else{if(fK&&fK.changes){Z(fJ,fK,fM,eI(fJ))}}if(!fK){fK=cG(fJ,fL)}var fN=cg(fK,fL,fM);return{line:fL,view:fK,rect:null,map:fN.map,cache:fN.cache,before:fN.before,hasHeights:false}}function D(fJ,fO,fM,fK){if(fO.before){fM=-1}var fL=fM+(fK||""),fN;if(fO.cache.hasOwnProperty(fL)){fN=fO.cache[fL]}else{if(!fO.rect){fO.rect=fO.view.text.getBoundingClientRect()}if(!fO.hasHeights){b5(fJ,fO.view,fO.rect);fO.hasHeights=true}fN=k(fJ,fO,fM,fK);if(!fN.bogus){fO.cache[fL]=fN}}return{left:fN.left,right:fN.right,top:fN.top,bottom:fN.bottom}}var ea={left:0,right:0,top:0,bottom:0};function k(fQ,fY,fS,fO){var f1=fY.map;var fV,fN,fM,fJ;for(var fX=0;fX<f1.length;fX+=3){var f0=f1[fX],fW=f1[fX+1];if(fS<f0){fN=0;fM=1;fJ="left"}else{if(fS<fW){fN=fS-f0;fM=fN+1}else{if(fX==f1.length-3||fS==fW&&f1[fX+3]>fS){fM=fW-f0;fN=fM-1;if(fS>=fW){fJ="right"}}}}if(fN!=null){fV=f1[fX+2];if(f0==fW&&fO==(fV.insertLeft?"left":"right")){fJ=fO}if(fO=="left"&&fN==0){while(fX&&f1[fX-2]==f1[fX-3]&&f1[fX-1].insertLeft){fV=f1[(fX-=3)+2];fJ="left"}}if(fO=="right"&&fN==fW-f0){while(fX<f1.length-3&&f1[fX+3]==f1[fX+4]&&!f1[fX+5].insertLeft){fV=f1[(fX+=3)+2];fJ="right"}}break}}var fK;if(fV.nodeType==3){while(fN&&eW(fY.line.text.charAt(f0+fN))){--fN}while(f0+fM<fW&&eW(fY.line.text.charAt(f0+fM))){++fM}if(bV&&fN==0&&fM==fW-f0){fK=fV.parentNode.getBoundingClientRect()}else{if(dj&&fQ.options.lineWrapping){var fL=b8(fV,fN,fM).getClientRects();if(fL.length){fK=fL[fO=="right"?fL.length-1:0]}else{fK=ea}}else{fK=b8(fV,fN,fM).getBoundingClientRect()}}}else{if(fN>0){fJ=fO="right"}var fL;if(fQ.options.lineWrapping&&(fL=fV.getClientRects()).length>1){fK=fL[fO=="right"?fL.length-1:0]}else{fK=fV.getBoundingClientRect()}}if(bV&&!fN&&(!fK||!fK.left&&!fK.right)){var fP=fV.parentNode.getClientRects()[0];if(fP){fK={left:fP.left,right:fP.left+de(fQ.display),top:fP.top,bottom:fP.bottom}}else{fK=ea}}var fU,fT=(fK.bottom+fK.top)/2-fY.rect.top;var fZ=fY.view.measure.heights;for(var fX=0;fX<fZ.length-1;fX++){if(fT<fZ[fX]){break}}fU=fX?fZ[fX-1]:0;fT=fZ[fX];var fR={left:(fJ=="right"?fK.right:fK.left)-fY.rect.left,right:(fJ=="left"?fK.left:fK.right)-fY.rect.left,top:fU,bottom:fT};if(!fK.left&&!fK.right){fR.bogus=true}return fR}function ap(fK){if(fK.measure){fK.measure.cache={};fK.measure.heights=null;if(fK.rest){for(var fJ=0;fJ<fK.rest.length;fJ++){fK.measure.caches[fJ]={}}}}}function aE(fJ){fJ.display.externalMeasure=null;dA(fJ.display.lineMeasure);for(var fK=0;fK<fJ.display.view.length;fK++){ap(fJ.display.view[fK])}}function ai(fJ){aE(fJ);fJ.display.cachedCharWidth=fJ.display.cachedTextHeight=fJ.display.cachedPaddingH=null;if(!fJ.options.lineWrapping){fJ.display.maxLineChanged=true}fJ.display.lineNumChars=null}function ch(){return window.pageXOffset||(document.documentElement||document.body).scrollLeft}function cf(){return window.pageYOffset||(document.documentElement||document.body).scrollTop}function ep(fP,fM,fO,fK){if(fM.widgets){for(var fL=0;fL<fM.widgets.length;++fL){if(fM.widgets[fL].above){var fR=cD(fM.widgets[fL]);fO.top+=fR;fO.bottom+=fR}}}if(fK=="line"){return fO}if(!fK){fK="local"}var fN=by(fM);if(fK=="local"){fN+=eE(fP.display)}else{fN-=fP.display.viewOffset}if(fK=="page"||fK=="window"){var fJ=fP.display.lineSpace.getBoundingClientRect();fN+=fJ.top+(fK=="window"?0:cf());var fQ=fJ.left+(fK=="window"?0:ch());fO.left+=fQ;fO.right+=fQ}fO.top+=fN;fO.bottom+=fN;return fO}function fF(fK,fN,fL){if(fL=="div"){return fN}var fP=fN.left,fO=fN.top;if(fL=="page"){fP-=ch();fO-=cf()}else{if(fL=="local"||!fL){var fM=fK.display.sizer.getBoundingClientRect();fP+=fM.left;fO+=fM.top}}var fJ=fK.display.lineSpace.getBoundingClientRect();return{left:fP-fJ.left,top:fO-fJ.top}}function ct(fJ,fN,fM,fL,fK){if(!fL){fL=eL(fJ.doc,fN.line)}return ep(fJ,fL,dP(fJ,fL,fN.ch,fK),fM)}function dt(fR,fQ,fL,fP,fT){fP=fP||eL(fR.doc,fQ.line);if(!fT){fT=aS(fR,fP)}function fN(fW,fV){var fU=D(fR,fT,fW,fV?"right":"left");if(fV){fU.left=fU.right}else{fU.right=fU.left}return ep(fR,fP,fU,fL)}function fS(fX,fU){var fV=fO[fU],fW=fV.level%2;if(fX==c9(fV)&&fU&&fV.level<fO[fU-1].level){fV=fO[--fU];fX=fE(fV)-(fV.level%2?0:1);fW=true}else{if(fX==fE(fV)&&fU<fO.length-1&&fV.level<fO[fU+1].level){fV=fO[++fU];fX=c9(fV)-fV.level%2;fW=false}}if(fW&&fX==fV.to&&fX>fV.from){return fN(fX-1)}return fN(fX,fW)}var fO=a(fP),fJ=fQ.ch;if(!fO){return fN(fJ)}var fK=aA(fO,fJ);var fM=fS(fJ,fK);if(eA!=null){fM.other=fS(fJ,eA)}return fM}function di(fJ,fN){var fM=0,fN=ff(fJ.doc,fN);if(!fJ.options.lineWrapping){fM=de(fJ.display)*fN.ch}var fK=eL(fJ.doc,fN.line);var fL=by(fK)+eE(fJ.display);return{left:fM,right:fM,top:fL,bottom:fL+fK.height}}function fr(fJ,fK,fL,fN){var fM=W(fJ,fK);fM.xRel=fN;if(fL){fM.outside=true}return fM}function fk(fQ,fN,fM){var fP=fQ.doc;fM+=fQ.display.viewOffset;if(fM<0){return fr(fP.first,0,true,-1)}var fL=bs(fP,fM),fR=fP.first+fP.size-1;if(fL>fR){return fr(fP.first+fP.size-1,eL(fP,fR).text.length,true,1)}if(fN<0){fN=0}var fK=eL(fP,fL);for(;;){var fS=cE(fQ,fK,fL,fN,fM);var fO=d3(fK);var fJ=fO&&fO.find(0,true);if(fO&&(fS.ch>fJ.from.ch||fS.ch==fJ.from.ch&&fS.xRel>0)){fL=bz(fK=fJ.to.line)}else{return fS}}}function cE(fT,fL,fW,fV,fU){var fS=fU-by(fL);var fP=false,f2=2*fT.display.wrapper.clientWidth;var fZ=aS(fT,fL);function f6(f8){var f9=dt(fT,W(fW,f8),"line",fL,fZ);fP=true;if(fS>f9.bottom){return f9.left-f2}else{if(fS<f9.top){return f9.left+f2}else{fP=false}}return f9.left}var fY=a(fL),f1=fL.text.length;var f3=cp(fL),fM=cA(fL);var f0=f6(f3),fJ=fP,fK=f6(fM),fO=fP;if(fV>fK){return fr(fW,fM,fO,1)}for(;;){if(fY?fM==f3||fM==v(fL,f3,1):fM-f3<=1){var fX=fV<f0||fV-f0<=fK-fV?f3:fM;var f5=fV-(fX==f3?f0:fK);while(eW(fL.text.charAt(fX))){++fX}var fR=fr(fW,fX,fX==f3?fJ:fO,f5<-1?-1:f5>1?1:0);return fR}var fQ=Math.ceil(f1/2),f7=f3+fQ;if(fY){f7=f3;for(var f4=0;f4<fQ;++f4){f7=v(fL,f7,1)}}var fN=f6(f7);if(fN>fV){fM=f7;fK=fN;if(fO=fP){fK+=1000}f1=fQ}else{f3=f7;f0=fN;fJ=fP;f1-=fQ}}}var aB;function aL(fL){if(fL.cachedTextHeight!=null){return fL.cachedTextHeight}if(aB==null){aB=fs("pre");for(var fK=0;fK<49;++fK){aB.appendChild(document.createTextNode("x"));aB.appendChild(fs("br"))}aB.appendChild(document.createTextNode("x"))}bD(fL.measure,aB);var fJ=aB.offsetHeight/50;if(fJ>3){fL.cachedTextHeight=fJ}dA(fL.measure);return fJ||1}function de(fN){if(fN.cachedCharWidth!=null){return fN.cachedCharWidth}var fJ=fs("span","xxxxxxxxxx");var fM=fs("pre",[fJ]);bD(fN.measure,fM);var fL=fJ.getBoundingClientRect(),fK=(fL.right-fL.left)/10;if(fK>2){fN.cachedCharWidth=fK}return fK||10}var dH=0;function cs(fJ){fJ.curOp={viewChanged:false,startHeight:fJ.doc.height,forceUpdate:false,updateInput:null,typing:false,changeObjs:null,cursorActivityHandlers:null,selectionChanged:false,updateMaxLine:false,scrollLeft:null,scrollTop:null,scrollToPos:null,id:++dH};if(!ce++){bb=[]}}function aj(fU){var fP=fU.curOp,fT=fU.doc,fQ=fU.display;fU.curOp=null;if(fP.updateMaxLine){h(fU)}if(fP.viewChanged||fP.forceUpdate||fP.scrollTop!=null||fP.scrollToPos&&(fP.scrollToPos.from.line<fQ.viewFrom||fP.scrollToPos.to.line>=fQ.viewTo)||fQ.maxLineChanged&&fU.options.lineWrapping){var fN=dk(fU,{top:fP.scrollTop,ensure:fP.scrollToPos},fP.forceUpdate);if(fU.display.scroller.offsetHeight){fU.doc.scrollTop=fU.display.scroller.scrollTop}}if(!fN&&fP.selectionChanged){bo(fU)}if(!fN&&fP.startHeight!=fU.doc.height){ex(fU)}if(fP.scrollTop!=null&&fQ.scroller.scrollTop!=fP.scrollTop){var fR=Math.max(0,Math.min(fQ.scroller.scrollHeight-fQ.scroller.clientHeight,fP.scrollTop));fQ.scroller.scrollTop=fQ.scrollbarV.scrollTop=fT.scrollTop=fR}if(fP.scrollLeft!=null&&fQ.scroller.scrollLeft!=fP.scrollLeft){var fK=Math.max(0,Math.min(fQ.scroller.scrollWidth-fQ.scroller.clientWidth,fP.scrollLeft));fQ.scroller.scrollLeft=fQ.scrollbarH.scrollLeft=fT.scrollLeft=fK;ee(fU)}if(fP.scrollToPos){var fS=E(fU,ff(fU.doc,fP.scrollToPos.from),ff(fU.doc,fP.scrollToPos.to),fP.scrollToPos.margin);if(fP.scrollToPos.isCursor&&fU.state.focused){dF(fU,fS)}}if(fP.selectionChanged){p(fU)}if(fU.state.focused&&fP.updateInput){eV(fU,fP.typing)}var fO=fP.maybeHiddenMarkers,fJ=fP.maybeUnhiddenMarkers;if(fO){for(var fM=0;fM<fO.length;++fM){if(!fO[fM].lines.length){ay(fO[fM],"hide")}}}if(fJ){for(var fM=0;fM<fJ.length;++fM){if(fJ[fM].lines.length){ay(fJ[fM],"unhide")}}}var fL;if(!--ce){fL=bb;bb=null}if(fP.changeObjs){ay(fU,"changes",fU,fP.changeObjs)}if(fL){for(var fM=0;fM<fL.length;++fM){fL[fM]()}}if(fP.cursorActivityHandlers){for(var fM=0;fM<fP.cursorActivityHandlers.length;fM++){fP.cursorActivityHandlers[fM](fU)}}}function cv(fJ,fK){if(fJ.curOp){return fK()}cs(fJ);try{return fK()}finally{aj(fJ)}}function cH(fJ,fK){return function(){if(fJ.curOp){return fK.apply(fJ,arguments)}cs(fJ);try{return fK.apply(fJ,arguments)}finally{aj(fJ)}}}function cN(fJ){return function(){if(this.curOp){return fJ.apply(this,arguments)}cs(this);try{return fJ.apply(this,arguments)}finally{aj(this)}}}function co(fJ){return function(){var fK=this.cm;if(!fK||fK.curOp){return fJ.apply(this,arguments)}cs(fK);try{return fJ.apply(this,arguments)}finally{aj(fK)}}}function bi(fL,fJ,fK){this.line=fJ;this.rest=i(fJ);this.size=this.rest?bz(fd(this.rest))-fK+1:1;this.node=this.text=null;this.hidden=e3(fL,fJ)}function eu(fJ,fP,fO){var fN=[],fL;for(var fM=fP;fM<fO;fM=fL){var fK=new bi(fJ.doc,eL(fJ.doc,fM),fM);fL=fM+fK.size;fN.push(fK)}return fN}function af(fQ,fO,fP,fR){if(fO==null){fO=fQ.doc.first}if(fP==null){fP=fQ.doc.first+fQ.doc.size}if(!fR){fR=0}var fL=fQ.display;if(fR&&fP<fL.viewTo&&(fL.updateLineNumbers==null||fL.updateLineNumbers>fO)){fL.updateLineNumbers=fO}fQ.curOp.viewChanged=true;if(fO>=fL.viewTo){if(aV&&aK(fQ.doc,fO)<fL.viewTo){d5(fQ)}}else{if(fP<=fL.viewFrom){if(aV&&dC(fQ.doc,fP+fR)>fL.viewFrom){d5(fQ)}else{fL.viewFrom+=fR;fL.viewTo+=fR}}else{if(fO<=fL.viewFrom&&fP>=fL.viewTo){d5(fQ)}else{if(fO<=fL.viewFrom){var fN=cT(fQ,fP,fP+fR,1);if(fN){fL.view=fL.view.slice(fN.index);fL.viewFrom=fN.lineN;fL.viewTo+=fR}else{d5(fQ)}}else{if(fP>=fL.viewTo){var fN=cT(fQ,fO,fO,-1);if(fN){fL.view=fL.view.slice(0,fN.index);fL.viewTo=fN.lineN}else{d5(fQ)}}else{var fM=cT(fQ,fO,fO,-1);var fK=cT(fQ,fP,fP+fR,1);if(fM&&fK){fL.view=fL.view.slice(0,fM.index).concat(eu(fQ,fM.lineN,fK.lineN)).concat(fL.view.slice(fK.index));fL.viewTo+=fR}else{d5(fQ)}}}}}}var fJ=fL.externalMeasured;if(fJ){if(fP<fJ.lineN){fJ.lineN+=fR}else{if(fO<fJ.lineN+fJ.size){fL.externalMeasured=null}}}}function R(fK,fL,fO){fK.curOp.viewChanged=true;var fP=fK.display,fN=fK.display.externalMeasured;if(fN&&fL>=fN.lineN&&fL<fN.lineN+fN.size){fP.externalMeasured=null}if(fL<fP.viewFrom||fL>=fP.viewTo){return}var fM=fP.view[c3(fK,fL)];if(fM.node==null){return}var fJ=fM.changes||(fM.changes=[]);if(cX(fJ,fO)==-1){fJ.push(fO)}}function d5(fJ){fJ.display.viewFrom=fJ.display.viewTo=fJ.doc.first;fJ.display.view=[];fJ.display.viewOffset=0}function c3(fJ,fM){if(fM>=fJ.display.viewTo){return null}fM-=fJ.display.viewFrom;if(fM<0){return null}var fK=fJ.display.view;for(var fL=0;fL<fK.length;fL++){fM-=fK[fL].size;if(fM<0){return fL}}}function cT(fR,fL,fN,fK){var fO=c3(fR,fL),fQ,fP=fR.display.view;if(!aV){return{index:fO,lineN:fN}}for(var fM=0,fJ=fR.display.viewFrom;fM<fO;fM++){fJ+=fP[fM].size}if(fJ!=fL){if(fK>0){if(fO==fP.length-1){return null}fQ=(fJ+fP[fO].size)-fL;fO++}else{fQ=fJ-fL}fL+=fQ;fN+=fQ}while(aK(fR.doc,fN)!=fN){if(fO==(fK<0?0:fP.length-1)){return null}fN+=fK*fP[fO-(fK<0?1:0)].size;fO+=fK}return{index:fO,lineN:fN}}function cz(fJ,fN,fM){var fL=fJ.display,fK=fL.view;if(fK.length==0||fN>=fL.viewTo||fM<=fL.viewFrom){fL.view=eu(fJ,fN,fM);fL.viewFrom=fN}else{if(fL.viewFrom>fN){fL.view=eu(fJ,fN,fL.viewFrom).concat(fL.view)}else{if(fL.viewFrom<fN){fL.view=fL.view.slice(c3(fJ,fN))}}fL.viewFrom=fN;if(fL.viewTo<fM){fL.view=fL.view.concat(eu(fJ,fL.viewTo,fM))}else{if(fL.viewTo>fM){fL.view=fL.view.slice(0,c3(fJ,fM))}}}fL.viewTo=fM}function cQ(fJ){var fK=fJ.display.view,fN=0;for(var fM=0;fM<fK.length;fM++){var fL=fK[fM];if(!fL.hidden&&(!fL.node||fL.changes)){++fN}}return fN}function a9(fJ){if(fJ.display.pollingFast){return}fJ.display.poll.set(fJ.options.pollInterval,function(){b4(fJ);if(fJ.state.focused){a9(fJ)}})}function C(fJ){var fK=false;fJ.display.pollingFast=true;function fL(){var fM=b4(fJ);if(!fM&&!fK){fK=true;fJ.display.poll.set(60,fL)}else{fJ.display.pollingFast=false;a9(fJ)}}fJ.display.poll.set(20,fL)}function b4(fN){var fO=fN.display.input,fR=fN.display.prevInput,f2=fN.doc;if(!fN.state.focused||(bf(fO)&&!fR)||ah(fN)||fN.options.disableInput){return false}if(fN.state.pasteIncoming&&fN.state.fakedLastChar){fO.value=fO.value.substring(0,fO.value.length-1);fN.state.fakedLastChar=false}var fQ=fO.value;if(fQ==fR&&!fN.somethingSelected()){return false}if(dj&&!bV&&fN.display.inputHasSelection===fQ){eV(fN);return false}var fY=!fN.curOp;if(fY){cs(fN)}fN.display.shift=false;var fX=0,fU=Math.min(fR.length,fQ.length);while(fX<fU&&fR.charCodeAt(fX)==fQ.charCodeAt(fX)){++fX}var fK=fQ.slice(fX),fS=aO(fK);var f1=fN.state.pasteIncoming&&fS.length>1&&f2.sel.ranges.length==fS.length;for(var fZ=f2.sel.ranges.length-1;fZ>=0;fZ--){var fT=f2.sel.ranges[fZ];var fV=fT.from(),fJ=fT.to();if(fX<fR.length){fV=W(fV.line,fV.ch-(fR.length-fX))}else{if(fN.state.overwrite&&fT.empty()&&!fN.state.pasteIncoming){fJ=W(fJ.line,Math.min(eL(f2,fJ.line).text.length,fJ.ch+fd(fS).length))}}var fM=fN.curOp.updateInput;var f0={from:fV,to:fJ,text:f1?[fS[fZ]]:fS,origin:fN.state.pasteIncoming?"paste":fN.state.cutIncoming?"cut":"+input"};a3(fN.doc,f0);ac(fN,"inputRead",fN,f0);if(fK&&!fN.state.pasteIncoming&&fN.options.electricChars&&fN.options.smartIndent&&fT.head.ch<100&&(!fZ||f2.sel.ranges[fZ-1].head.line!=fT.head.line)){var fP=fN.getModeAt(fT.head);if(fP.electricChars){for(var fW=0;fW<fP.electricChars.length;fW++){if(fK.indexOf(fP.electricChars.charAt(fW))>-1){ab(fN,fT.head.line,"smart");break}}}else{if(fP.electricInput){var fL=cC(f0);if(fP.electricInput.test(eL(f2,fL.line).text.slice(0,fL.ch))){ab(fN,fT.head.line,"smart")}}}}}fc(fN);fN.curOp.updateInput=fM;fN.curOp.typing=true;if(fQ.length>1000||fQ.indexOf("\n")>-1){fO.value=fN.display.prevInput=""}else{fN.display.prevInput=fQ}if(fY){aj(fN)}fN.state.pasteIncoming=fN.state.cutIncoming=false;return true}function eV(fJ,fN){var fK,fM,fP=fJ.doc;if(fJ.somethingSelected()){fJ.display.prevInput="";var fL=fP.sel.primary();fK=cP&&(fL.to().line-fL.from().line>100||(fM=fJ.getSelection()).length>1000);var fO=fK?"-":fM||fJ.getSelection();fJ.display.input.value=fO;if(fJ.state.focused){dl(fJ.display.input)}if(dj&&!bV){fJ.display.inputHasSelection=fO}}else{if(!fN){fJ.display.prevInput=fJ.display.input.value="";if(dj&&!bV){fJ.display.inputHasSelection=null}}}fJ.display.inaccurateSelection=fK}function d9(fJ){if(fJ.options.readOnly!="nocursor"&&(!dO||dn()!=fJ.display.input)){fJ.display.input.focus()}}function s(fJ){if(!fJ.state.focused){d9(fJ);cn(fJ)}}function ah(fJ){return fJ.options.readOnly||fJ.doc.cantEdit}function fl(fK){var fO=fK.display;bJ(fO.scroller,"mousedown",cH(fK,d1));if(ek){bJ(fO.scroller,"dblclick",cH(fK,function(fS){if(aH(fK,fS)){return}var fT=ca(fK,fS);if(!fT||m(fK,fS)||aY(fK.display,fS)){return}cq(fS);var fR=ar(fK.doc,fT);fp(fK.doc,fR.anchor,fR.head)}))}else{bJ(fO.scroller,"dblclick",function(fR){aH(fK,fR)||cq(fR)})}bJ(fO.lineSpace,"selectstart",function(fR){if(!aY(fO,fR)){cq(fR)}});if(!fA){bJ(fO.scroller,"contextmenu",function(fR){av(fK,fR)})}bJ(fO.scroller,"scroll",function(){if(fO.scroller.clientHeight){N(fK,fO.scroller.scrollTop);bq(fK,fO.scroller.scrollLeft,true);ay(fK,"scroll",fK)}});bJ(fO.scrollbarV,"scroll",function(){if(fO.scroller.clientHeight){N(fK,fO.scrollbarV.scrollTop)}});bJ(fO.scrollbarH,"scroll",function(){if(fO.scroller.clientHeight){bq(fK,fO.scrollbarH.scrollLeft)}});bJ(fO.scroller,"mousewheel",function(fR){c(fK,fR)});bJ(fO.scroller,"DOMMouseScroll",function(fR){c(fK,fR)});function fQ(){if(fK.state.focused){setTimeout(ci(d9,fK),0)}}bJ(fO.scrollbarH,"mousedown",fQ);bJ(fO.scrollbarV,"mousedown",fQ);bJ(fO.wrapper,"scroll",function(){fO.wrapper.scrollTop=fO.wrapper.scrollLeft=0});var fJ;function fN(){if(fJ==null){fJ=setTimeout(function(){fJ=null;fO.cachedCharWidth=fO.cachedTextHeight=fO.cachedPaddingH=d4=null;fK.setSize()},100)}}bJ(window,"resize",fN);function fM(){if(fB(document.body,fO.wrapper)){setTimeout(fM,5000)}else{dL(window,"resize",fN)}}setTimeout(fM,5000);bJ(fO.input,"keyup",cH(fK,a5));bJ(fO.input,"input",function(){if(dj&&!bV&&fK.display.inputHasSelection){fK.display.inputHasSelection=null}C(fK)});bJ(fO.input,"keydown",cH(fK,q));bJ(fO.input,"keypress",cH(fK,ck));bJ(fO.input,"focus",ci(cn,fK));bJ(fO.input,"blur",ci(aJ,fK));function fL(fR){if(!aH(fK,fR)){dZ(fR)}}if(fK.options.dragDrop){bJ(fO.scroller,"dragstart",function(fR){Q(fK,fR)});bJ(fO.scroller,"dragenter",fL);bJ(fO.scroller,"dragover",fL);bJ(fO.scroller,"drop",cH(fK,a6))}bJ(fO.scroller,"paste",function(fR){if(aY(fO,fR)){return}fK.state.pasteIncoming=true;d9(fK);C(fK)});bJ(fO.input,"paste",function(){if(cF&&!fK.state.fakedLastChar&&!(new Date-fK.state.lastMiddleDown<200)){var fS=fO.input.selectionStart,fR=fO.input.selectionEnd;fO.input.value+="$";fO.input.selectionStart=fS;fO.input.selectionEnd=fR;fK.state.fakedLastChar=true}fK.state.pasteIncoming=true;C(fK)});function fP(fV){if(fK.somethingSelected()){if(fO.inaccurateSelection){fO.prevInput="";fO.inaccurateSelection=false;fO.input.value=fK.getSelection();dl(fO.input)}}else{var fW="",fS=[];for(var fT=0;fT<fK.doc.sel.ranges.length;fT++){var fR=fK.doc.sel.ranges[fT].head.line;var fU={anchor:W(fR,0),head:W(fR+1,0)};fS.push(fU);fW+=fK.getRange(fU.anchor,fU.head)}if(fV.type=="cut"){fK.setSelections(fS,null,Y)}else{fO.prevInput="";fO.input.value=fW;dl(fO.input)}}if(fV.type=="cut"){fK.state.cutIncoming=true}}bJ(fO.input,"cut",fP);bJ(fO.input,"copy",fP);if(aZ){bJ(fO.sizer,"mouseup",function(){if(dn()==fO.input){fO.input.blur()}d9(fK)})}}function aY(fK,fJ){for(var fL=L(fJ);fL!=fK.wrapper;fL=fL.parentNode){if(!fL||fL.ignoreEvents||fL.parentNode==fK.sizer&&fL!=fK.mover){return true}}}function ca(fT,fN,fK,fL){var fP=fT.display;if(!fK){var fO=L(fN);if(fO==fP.scrollbarH||fO==fP.scrollbarV||fO==fP.scrollbarFiller||fO==fP.gutterFiller){return null}}var fS,fQ,fJ=fP.lineSpace.getBoundingClientRect();try{fS=fN.clientX-fJ.left;fQ=fN.clientY-fJ.top}catch(fN){return null}var fR=fk(fT,fS,fQ),fU;if(fL&&fR.xRel==1&&(fU=eL(fT.doc,fR.line).text).length==fR.ch){var fM=bF(fU,fU.length,fT.options.tabSize)-fU.length;fR=W(fR.line,Math.max(0,Math.round((fS-eC(fT.display).left)/de(fT.display))-fM))}return fR}function d1(fL){if(aH(this,fL)){return}var fJ=this,fK=fJ.display;fK.shift=fL.shiftKey;if(aY(fK,fL)){if(!cF){fK.scroller.draggable=false;setTimeout(function(){fK.scroller.draggable=true},100)}return}if(m(fJ,fL)){return}var fM=ca(fJ,fL);window.focus();switch(fj(fL)){case 1:if(fM){au(fJ,fL,fM)}else{if(L(fL)==fK.scroller){cq(fL)}}break;case 2:if(cF){fJ.state.lastMiddleDown=+new Date}if(fM){fp(fJ.doc,fM)}setTimeout(ci(d9,fJ),20);cq(fL);break;case 3:if(fA){av(fJ,fL)}break}}var c0,cS;function au(fJ,fO,fP){setTimeout(ci(s,fJ),0);var fK=+new Date,fL;if(cS&&cS.time>fK-400&&b2(cS.pos,fP)==0){fL="triple"}else{if(c0&&c0.time>fK-400&&b2(c0.pos,fP)==0){fL="double";cS={time:fK,pos:fP}}else{fL="single";c0={time:fK,pos:fP}}}var fM=fJ.doc.sel,fN=bR?fO.metaKey:fO.ctrlKey;if(fJ.options.dragDrop&&el&&!fN&&!ah(fJ)&&fL=="single"&&fM.contains(fP)>-1&&fM.somethingSelected()){aR(fJ,fO,fP)}else{n(fJ,fO,fP,fL,fN)}}function aR(fK,fM,fN){var fL=fK.display;var fJ=cH(fK,function(fO){if(cF){fL.scroller.draggable=false}fK.state.draggingText=false;dL(document,"mouseup",fJ);dL(fL.scroller,"drop",fJ);if(Math.abs(fM.clientX-fO.clientX)+Math.abs(fM.clientY-fO.clientY)<10){cq(fO);fp(fK.doc,fN);d9(fK);if(ek&&!bV){setTimeout(function(){document.body.focus();d9(fK)},20)}}});if(cF){fL.scroller.draggable=true}fK.state.draggingText=fJ;if(fL.scroller.dragDrop){fL.scroller.dragDrop()}bJ(document,"mouseup",fJ);bJ(fL.scroller,"drop",fJ)}function n(fM,f0,fL,fJ,fO){var fX=fM.display,f2=fM.doc;cq(f0);var fK,f1,fN=f2.sel;if(fO&&!f0.shiftKey){f1=f2.sel.contains(fL);if(f1>-1){fK=f2.sel.ranges[f1]}else{fK=new dx(fL,fL)}}else{fK=f2.sel.primary()}if(f0.altKey){fJ="rect";if(!fO){fK=new dx(fL,fL)}fL=ca(fM,f0,true,true);f1=-1}else{if(fJ=="double"){var fY=ar(f2,fL);if(fM.display.shift||f2.extend){fK=e2(f2,fK,fY.anchor,fY.head)}else{fK=fY}}else{if(fJ=="triple"){var fR=new dx(W(fL.line,0),ff(f2,W(fL.line+1,0)));if(fM.display.shift||f2.extend){fK=e2(f2,fK,fR.anchor,fR.head)}else{fK=fR}}else{fK=e2(f2,fK,fL)}}}if(!fO){f1=0;bG(f2,new ft([fK],0),M);fN=f2.sel}else{if(f1>-1){f(f2,f1,fK,M)}else{f1=f2.sel.ranges.length;bG(f2,cj(f2.sel.ranges.concat([fK]),f1),{scroll:false,origin:"*mouse"})}}var fW=fL;function fV(gd){if(b2(fW,gd)==0){return}fW=gd;if(fJ=="rect"){var f4=[],ga=fM.options.tabSize;var f3=bF(eL(f2,fL.line).text,fL.ch,ga);var gg=bF(eL(f2,gd.line).text,gd.ch,ga);var f5=Math.min(f3,gg),ge=Math.max(f3,gg);for(var gh=Math.min(fL.line,gd.line),f7=Math.min(fM.lastLine(),Math.max(fL.line,gd.line));gh<=f7;gh++){var gf=eL(f2,gh).text,f6=dY(gf,f5,ga);if(f5==ge){f4.push(new dx(W(gh,f6),W(gh,f6)))}else{if(gf.length>f6){f4.push(new dx(W(gh,f6),W(gh,dY(gf,ge,ga))))}}}if(!f4.length){f4.push(new dx(fL,fL))}bG(f2,cj(fN.ranges.slice(0,f1).concat(f4),f1),M)}else{var gb=fK;var f8=gb.anchor,gc=gd;if(fJ!="single"){if(fJ=="double"){var f9=ar(f2,gd)}else{var f9=new dx(W(gd.line,0),ff(f2,W(gd.line+1,0)))}if(b2(f9.anchor,f8)>0){gc=f9.head;f8=am(gb.from(),f9.anchor)}else{gc=f9.anchor;f8=bk(gb.to(),f9.head)}}var f4=fN.ranges.slice(0);f4[f1]=new dx(ff(f2,f8),gc);bG(f2,cj(f4,f1),M)}}var fT=fX.wrapper.getBoundingClientRect();var fP=0;function fZ(f5){var f3=++fP;var f7=ca(fM,f5,true,fJ=="rect");if(!f7){return}if(b2(f7,fW)!=0){s(fM);fV(f7);var f6=bQ(fX,f2);if(f7.line>=f6.to||f7.line<f6.from){setTimeout(cH(fM,function(){if(fP==f3){fZ(f5)}}),150)}}else{var f4=f5.clientY<fT.top?-20:f5.clientY>fT.bottom?20:0;if(f4){setTimeout(cH(fM,function(){if(fP!=f3){return}fX.scroller.scrollTop+=f4;fZ(f5)}),50)}}}function fS(f3){fP=Infinity;cq(f3);d9(fM);dL(document,"mousemove",fU);dL(document,"mouseup",fQ);f2.history.lastSelOrigin=null}var fU=cH(fM,function(f3){if((dj&&!bU)?!f3.buttons:!fj(f3)){fS(f3)}else{fZ(f3)}});var fQ=cH(fM,fS);bJ(document,"mousemove",fU);bJ(document,"mouseup",fQ)}function fH(fU,fQ,fS,fT,fM){try{var fK=fQ.clientX,fJ=fQ.clientY}catch(fQ){return false}if(fK>=Math.floor(fU.display.gutters.getBoundingClientRect().right)){return false}if(fT){cq(fQ)}var fR=fU.display;var fP=fR.lineDiv.getBoundingClientRect();if(fJ>fP.bottom||!eO(fU,fS)){return bx(fQ)}fJ-=fP.top-fR.viewOffset;for(var fN=0;fN<fU.options.gutters.length;++fN){var fO=fR.gutters.childNodes[fN];if(fO&&fO.getBoundingClientRect().right>=fK){var fV=bs(fU.doc,fJ);var fL=fU.options.gutters[fN];fM(fU,fS,fU,fV,fL,fQ);return bx(fQ)}}}function m(fJ,fK){return fH(fJ,fK,"gutterClick",true,ac)}var ae=0;function a6(fP){var fR=this;if(aH(fR,fP)||aY(fR.display,fP)){return}cq(fP);if(dj){ae=+new Date}var fQ=ca(fR,fP,true),fJ=fP.dataTransfer.files;if(!fQ||ah(fR)){return}if(fJ&&fJ.length&&window.FileReader&&window.File){var fL=fJ.length,fS=Array(fL),fK=0;var fN=function(fV,fU){var fT=new FileReader;fT.onload=cH(fR,function(){fS[fU]=fT.result;if(++fK==fL){fQ=ff(fR.doc,fQ);var fW={from:fQ,to:fQ,text:aO(fS.join("\n")),origin:"paste"};a3(fR.doc,fW);eD(fR.doc,eq(fQ,cC(fW)))}});fT.readAsText(fV)};for(var fO=0;fO<fL;++fO){fN(fJ[fO],fO)}}else{if(fR.state.draggingText&&fR.doc.sel.contains(fQ)>-1){fR.state.draggingText(fP);setTimeout(ci(d9,fR),20);return}try{var fS=fP.dataTransfer.getData("Text");if(fS){var fM=fR.state.draggingText&&fR.listSelections();dX(fR.doc,eq(fQ,fQ));if(fM){for(var fO=0;fO<fM.length;++fO){aP(fR.doc,"",fM[fO].anchor,fM[fO].head,"drag")}}fR.replaceSelection(fS,"around","paste");d9(fR)}}catch(fP){}}}function Q(fJ,fL){if(dj&&(!fJ.state.draggingText||+new Date-ae<100)){dZ(fL);return}if(aH(fJ,fL)||aY(fJ.display,fL)){return}fL.dataTransfer.setData("Text",fJ.getSelection());if(fL.dataTransfer.setDragImage&&!ax){var fK=fs("img",null,null,"position: fixed; left: 0; top: 0;");fK.src="data:image/gif;base64,R0lGODlhAQABAAAAACH5BAEKAAEALAAAAAABAAEAAAICTAEAOw==";if(dB){fK.width=fK.height=1;fJ.display.wrapper.appendChild(fK);fK._top=fK.offsetTop}fL.dataTransfer.setDragImage(fK,0,0);if(dB){fK.parentNode.removeChild(fK)}}}function N(fJ,fK){if(Math.abs(fJ.doc.scrollTop-fK)<2){return}fJ.doc.scrollTop=fK;if(!cb){dk(fJ,{top:fK})}if(fJ.display.scroller.scrollTop!=fK){fJ.display.scroller.scrollTop=fK}if(fJ.display.scrollbarV.scrollTop!=fK){fJ.display.scrollbarV.scrollTop=fK}if(cb){dk(fJ)}dN(fJ,100)}function bq(fJ,fL,fK){if(fK?fL==fJ.doc.scrollLeft:Math.abs(fJ.doc.scrollLeft-fL)<2){return}fL=Math.min(fL,fJ.display.scroller.scrollWidth-fJ.display.scroller.clientWidth);fJ.doc.scrollLeft=fL;ee(fJ);if(fJ.display.scroller.scrollLeft!=fL){fJ.display.scroller.scrollLeft=fL}if(fJ.display.scrollbarH.scrollLeft!=fL){fJ.display.scrollbarH.scrollLeft=fL}}var eS=0,b3=null;if(dj){b3=-0.53}else{if(cb){b3=15}else{if(cR){b3=-0.7}else{if(ax){b3=-1/3}}}}function c(fR,fL){var fU=fL.wheelDeltaX,fT=fL.wheelDeltaY;if(fU==null&&fL.detail&&fL.axis==fL.HORIZONTAL_AXIS){fU=fL.detail}if(fT==null&&fL.detail&&fL.axis==fL.VERTICAL_AXIS){fT=fL.detail}else{if(fT==null){fT=fL.wheelDelta}}var fN=fR.display,fQ=fN.scroller;if(!(fU&&fQ.scrollWidth>fQ.clientWidth||fT&&fQ.scrollHeight>fQ.clientHeight)){return}if(fT&&bR&&cF){outer:for(var fS=fL.target,fP=fN.view;fS!=fQ;fS=fS.parentNode){for(var fK=0;fK<fP.length;fK++){if(fP[fK].node==fS){fR.display.currentWheelTarget=fS;break outer}}}}if(fU&&!cb&&!dB&&b3!=null){if(fT){N(fR,Math.max(0,Math.min(fQ.scrollTop+fT*b3,fQ.scrollHeight-fQ.clientHeight)))}bq(fR,Math.max(0,Math.min(fQ.scrollLeft+fU*b3,fQ.scrollWidth-fQ.clientWidth)));cq(fL);fN.wheelStartX=null;return}if(fT&&b3!=null){var fJ=fT*b3;var fO=fR.doc.scrollTop,fM=fO+fN.wrapper.clientHeight;if(fJ<0){fO=Math.max(0,fO+fJ-50)}else{fM=Math.min(fR.doc.height,fM+fJ+50)}dk(fR,{top:fO,bottom:fM})}if(eS<20){if(fN.wheelStartX==null){fN.wheelStartX=fQ.scrollLeft;fN.wheelStartY=fQ.scrollTop;fN.wheelDX=fU;fN.wheelDY=fT;setTimeout(function(){if(fN.wheelStartX==null){return}var fV=fQ.scrollLeft-fN.wheelStartX;var fX=fQ.scrollTop-fN.wheelStartY;var fW=(fX&&fN.wheelDY&&fX/fN.wheelDY)||(fV&&fN.wheelDX&&fV/fN.wheelDX);fN.wheelStartX=fN.wheelStartY=null;if(!fW){return}b3=(b3*eS+fW)/(eS+1);++eS},200)}else{fN.wheelDX+=fU;fN.wheelDY+=fT}}}function fm(fK,fN,fJ){if(typeof fN=="string"){fN=ed[fN];if(!fN){return false}}if(fK.display.pollingFast&&b4(fK)){fK.display.pollingFast=false}var fM=fK.display.shift,fL=false;try{if(ah(fK)){fK.state.suppressEdits=true}if(fJ){fK.display.shift=false}fL=fN(fK)!=bW}finally{fK.display.shift=fM;fK.state.suppressEdits=false}return fL}function c5(fJ){var fK=fJ.state.keyMaps.slice(0);if(fJ.options.extraKeys){fK.push(fJ.options.extraKeys)}fK.push(fJ.options.keyMap);return fK}var an;function eP(fJ,fP){var fK=fq(fJ.options.keyMap),fN=fK.auto;clearTimeout(an);if(fN&&!ec(fP)){an=setTimeout(function(){if(fq(fJ.options.keyMap)==fK){fJ.options.keyMap=(fN.call?fN.call(null,fJ):fN);fG(fJ)}},50)}var fM=eY(fP,true),fO=false;if(!fM){return false}var fL=c5(fJ);if(fP.shiftKey){fO=j("Shift-"+fM,fL,function(fQ){return fm(fJ,fQ,true)})||j(fM,fL,function(fQ){if(typeof fQ=="string"?/^go[A-Z]/.test(fQ):fQ.motion){return fm(fJ,fQ)}})}else{fO=j(fM,fL,function(fQ){return fm(fJ,fQ)})}if(fO){cq(fP);p(fJ);ac(fJ,"keyHandled",fJ,fM,fP)}return fO}function dR(fJ,fM,fK){var fL=j("'"+fK+"'",c5(fJ),function(fN){return fm(fJ,fN,true)});if(fL){cq(fM);p(fJ);ac(fJ,"keyHandled",fJ,"'"+fK+"'",fM)}return fL}var cZ=null;function q(fM){var fJ=this;s(fJ);if(aH(fJ,fM)){return}if(ek&&fM.keyCode==27){fM.returnValue=false}var fK=fM.keyCode;fJ.display.shift=fK==16||fM.shiftKey;var fL=eP(fJ,fM);if(dB){cZ=fL?fK:null;if(!fL&&fK==88&&!cP&&(bR?fM.metaKey:fM.ctrlKey)){fJ.replaceSelection("",null,"cut")}}if(fK==18&&!/\bCodeMirror-crosshair\b/.test(fJ.display.lineDiv.className)){aq(fJ)}}function aq(fK){var fL=fK.display.lineDiv;e8(fL,"CodeMirror-crosshair");function fJ(fM){if(fM.keyCode==18||!fM.altKey){g(fL,"CodeMirror-crosshair");dL(document,"keyup",fJ);dL(document,"mouseover",fJ)}}bJ(document,"keyup",fJ);bJ(document,"mouseover",fJ)}function a5(fJ){if(aH(this,fJ)){return}if(fJ.keyCode==16){this.doc.sel.shift=false}}function ck(fN){var fJ=this;if(aH(fJ,fN)){return}var fM=fN.keyCode,fK=fN.charCode;if(dB&&fM==cZ){cZ=null;cq(fN);return}if(((dB&&(!fN.which||fN.which<10))||aZ)&&eP(fJ,fN)){return}var fL=String.fromCharCode(fK==null?fM:fK);if(dR(fJ,fN,fL)){return}if(dj&&!bV){fJ.display.inputHasSelection=null}C(fJ)}function cn(fJ){if(fJ.options.readOnly=="nocursor"){return}if(!fJ.state.focused){ay(fJ,"focus",fJ);fJ.state.focused=true;e8(fJ.display.wrapper,"CodeMirror-focused");if(!fJ.curOp&&fJ.display.selForContextMenu==fJ.doc.sel){eV(fJ);if(cF){setTimeout(ci(eV,fJ,true),0)}}}a9(fJ);p(fJ)}function aJ(fJ){if(fJ.state.focused){ay(fJ,"blur",fJ);fJ.state.focused=false;g(fJ.display.wrapper,"CodeMirror-focused")}clearInterval(fJ.display.blinker);setTimeout(function(){if(!fJ.state.focused){fJ.display.shift=false}},150)}var e7;function av(fS,fN){if(aH(fS,fN,"contextmenu")){return}var fP=fS.display;if(aY(fP,fN)||cW(fS,fN)){return}var fR=ca(fS,fN),fJ=fP.scroller.scrollTop;if(!fR||dB){return}var fL=fS.options.resetSelectionOnContextMenu;if(fL&&fS.doc.sel.contains(fR)==-1){cH(fS,bG)(fS.doc,eq(fR),Y)}var fO=fP.input.style.cssText;fP.inputDiv.style.position="absolute";fP.input.style.cssText="position: fixed; width: 30px; height: 30px; top: "+(fN.clientY-5)+"px; left: "+(fN.clientX-5)+"px; z-index: 1000; background: "+(dj?"rgba(255, 255, 255, .05)":"transparent")+"; outline: none; border-width: 0; outline: none; overflow: hidden; opacity: .05; filter: alpha(opacity=5);";d9(fS);eV(fS);if(!fS.somethingSelected()){fP.input.value=fP.prevInput=" "}fP.selForContextMenu=fS.doc.sel;function fM(){if(fP.input.selectionStart!=null){var fT=fS.somethingSelected();var fU=fP.input.value="\u200b"+(fT?fP.input.value:"");fP.prevInput=fT?"":"\u200b";fP.input.selectionStart=1;fP.input.selectionEnd=fU.length}}function fQ(){fP.inputDiv.style.position="relative";fP.input.style.cssText=fO;if(bV){fP.scrollbarV.scrollTop=fP.scroller.scrollTop=fJ}a9(fS);if(fP.input.selectionStart!=null){if(!dj||bV){fM()}clearTimeout(e7);var fT=0,fU=function(){if(fP.selForContextMenu==fS.doc.sel&&fP.input.selectionStart==0){cH(fS,ed.selectAll)(fS)}else{if(fT++<10){e7=setTimeout(fU,500)}else{eV(fS)}}};e7=setTimeout(fU,200)}}if(dj&&!bV){fM()}if(fA){dZ(fN);var fK=function(){dL(window,"mouseup",fK);setTimeout(fQ,20)};bJ(window,"mouseup",fK)}else{setTimeout(fQ,50)}}function cW(fJ,fK){if(!eO(fJ,"gutterContextMenu")){return false}return fH(fJ,fK,"gutterContextMenu",false,ay)}var cC=I.changeEnd=function(fJ){if(!fJ.text){return fJ.to}return W(fJ.from.line+fJ.text.length-1,fd(fJ.text).length+(fJ.text.length==1?fJ.from.ch:0))};function bL(fM,fL){if(b2(fM,fL.from)<0){return fM}if(b2(fM,fL.to)<=0){return cC(fL)}var fJ=fM.line+fL.text.length-(fL.to.line-fL.from.line)-1,fK=fM.ch;if(fM.line==fL.to.line){fK+=cC(fL).ch-fL.to.ch}return W(fJ,fK)}function eQ(fM,fN){var fK=[];for(var fL=0;fL<fM.sel.ranges.length;fL++){var fJ=fM.sel.ranges[fL];fK.push(new dx(bL(fJ.anchor,fN),bL(fJ.head,fN)))}return cj(fK,fM.sel.primIndex)}function bh(fL,fK,fJ){if(fL.line==fK.line){return W(fJ.line,fL.ch-fK.ch+fJ.ch)}else{return W(fJ.line+(fL.line-fK.line),fL.ch)}}function ad(fT,fQ,fK){var fL=[];var fJ=W(fT.first,0),fU=fJ;for(var fN=0;fN<fQ.length;fN++){var fP=fQ[fN];var fS=bh(fP.from,fJ,fU);var fR=bh(cC(fP),fJ,fU);fJ=fP.to;fU=fR;if(fK=="around"){var fO=fT.sel.ranges[fN],fM=b2(fO.head,fO.anchor)<0;fL[fN]=new dx(fM?fR:fS,fM?fS:fR)}else{fL[fN]=new dx(fS,fS)}}return new ft(fL,fT.sel.primIndex)}function dr(fK,fM,fL){var fJ={canceled:false,from:fM.from,to:fM.to,text:fM.text,origin:fM.origin,cancel:function(){this.canceled=true}};if(fL){fJ.update=function(fQ,fP,fO,fN){if(fQ){this.from=ff(fK,fQ)}if(fP){this.to=ff(fK,fP)}if(fO){this.text=fO}if(fN!==undefined){this.origin=fN}}}ay(fK,"beforeChange",fK,fJ);if(fK.cm){ay(fK.cm,"beforeChange",fK.cm,fJ)}if(fJ.canceled){return null}return{from:fJ.from,to:fJ.to,text:fJ.text,origin:fJ.origin}}function a3(fM,fN,fL){if(fM.cm){if(!fM.cm.curOp){return cH(fM.cm,a3)(fM,fN,fL)}if(fM.cm.state.suppressEdits){return}}if(eO(fM,"beforeChange")||fM.cm&&eO(fM.cm,"beforeChange")){fN=dr(fM,fN,true);if(!fN){return}}var fK=fD&&!fL&&cr(fM,fN.from,fN.to);if(fK){for(var fJ=fK.length-1;fJ>=0;--fJ){K(fM,{from:fK[fJ].from,to:fK[fJ].to,text:fJ?[""]:fN.text})}}else{K(fM,fN)}}function K(fL,fM){if(fM.text.length==1&&fM.text[0]==""&&b2(fM.from,fM.to)==0){return}var fK=eQ(fL,fM);fi(fL,fM,fK,fL.cm?fL.cm.curOp.id:NaN);dM(fL,fM,fK,dS(fL,fM));var fJ=[];dG(fL,function(fO,fN){if(!fN&&cX(fJ,fO.history)==-1){df(fO.history,fM);fJ.push(fO.history)}dM(fO,fM,null,dS(fO,fM))})}function bS(fU,fS,fW){if(fU.cm&&fU.cm.state.suppressEdits){return}var fR=fU.history,fL,fN=fU.sel;var fJ=fS=="undo"?fR.done:fR.undone,fV=fS=="undo"?fR.undone:fR.done;for(var fO=0;fO<fJ.length;fO++){fL=fJ[fO];if(fW?fL.ranges&&!fL.equals(fU.sel):!fL.ranges){break}}if(fO==fJ.length){return}fR.lastOrigin=fR.lastSelOrigin=null;for(;;){fL=fJ.pop();if(fL.ranges){cw(fL,fV);if(fW&&!fL.equals(fU.sel)){bG(fU,fL,{clearRedo:false});return}fN=fL}else{break}}var fQ=[];cw(fN,fV);fV.push({changes:fQ,generation:fR.generation});fR.generation=fL.generation||++fR.maxGeneration;var fM=eO(fU,"beforeChange")||fU.cm&&eO(fU.cm,"beforeChange");for(var fO=fL.changes.length-1;fO>=0;--fO){var fT=fL.changes[fO];fT.origin=fS;if(fM&&!dr(fU,fT,false)){fJ.length=0;return}fQ.push(c6(fU,fT));var fK=fO?eQ(fU,fT,null):fd(fJ);dM(fU,fT,fK,dI(fU,fT));if(fU.cm){fc(fU.cm)}var fP=[];dG(fU,function(fY,fX){if(!fX&&cX(fP,fY.history)==-1){df(fY.history,fT);fP.push(fY.history)}dM(fY,fT,null,dI(fY,fT))})}}function eT(fJ,fK){fJ.first+=fK;fJ.sel=new ft(bE(fJ.sel.ranges,function(fL){return new dx(W(fL.anchor.line+fK,fL.anchor.ch),W(fL.head.line+fK,fL.head.ch))}),fJ.sel.primIndex);if(fJ.cm){af(fJ.cm,fJ.first,fJ.first-fK,fK)}}function dM(fN,fO,fM,fK){if(fN.cm&&!fN.cm.curOp){return cH(fN.cm,dM)(fN,fO,fM,fK)}if(fO.to.line<fN.first){eT(fN,fO.text.length-1-(fO.to.line-fO.from.line));return}if(fO.from.line>fN.lastLine()){return}if(fO.from.line<fN.first){var fJ=fO.text.length-1-(fN.first-fO.from.line);eT(fN,fJ);fO={from:W(fN.first,0),to:W(fO.to.line+fJ,fO.to.ch),text:[fd(fO.text)],origin:fO.origin}}var fL=fN.lastLine();if(fO.to.line>fL){fO={from:fO.from,to:W(fL,eL(fN,fL).text.length),text:[fO.text[0]],origin:fO.origin}}fO.removed=fu(fN,fO.from,fO.to);if(!fM){fM=eQ(fN,fO,null)}if(fN.cm){aC(fN.cm,fO,fK)}else{e5(fN,fO,fK)}dX(fN,fM,Y)}function aC(fU,fQ,fO){var fT=fU.doc,fP=fU.display,fR=fQ.from,fS=fQ.to;var fJ=false,fN=fR.line;if(!fU.options.lineWrapping){fN=bz(z(eL(fT,fR.line)));fT.iter(fN,fS.line+1,function(fW){if(fW==fP.maxLine){fJ=true;return true}})}if(fT.sel.contains(fQ.from,fQ.to)>-1){V(fU)}e5(fT,fQ,fO,a1(fU));if(!fU.options.lineWrapping){fT.iter(fN,fR.line+fQ.text.length,function(fX){var fW=dU(fX);if(fW>fP.maxLineLength){fP.maxLine=fX;fP.maxLineLength=fW;fP.maxLineChanged=true;fJ=false}});if(fJ){fU.curOp.updateMaxLine=true}}fT.frontier=Math.min(fT.frontier,fR.line);dN(fU,400);var fV=fQ.text.length-(fS.line-fR.line)-1;if(fR.line==fS.line&&fQ.text.length==1&&!ds(fU.doc,fQ)){R(fU,fR.line,"text")}else{af(fU,fR.line,fS.line+1,fV)}var fL=eO(fU,"changes"),fM=eO(fU,"change");if(fM||fL){var fK={from:fR,to:fS,text:fQ.text,removed:fQ.removed,origin:fQ.origin};if(fM){ac(fU,"change",fU,fK)}if(fL){(fU.curOp.changeObjs||(fU.curOp.changeObjs=[])).push(fK)}}}function aP(fM,fL,fO,fN,fJ){if(!fN){fN=fO}if(b2(fN,fO)<0){var fK=fN;fN=fO;fO=fK}if(typeof fL=="string"){fL=aO(fL)}a3(fM,{from:fO,to:fN,text:fL,origin:fJ})}function dF(fK,fN){var fO=fK.display,fL=fO.sizer.getBoundingClientRect(),fJ=null;if(fN.top+fL.top<0){fJ=true}else{if(fN.bottom+fL.top>(window.innerHeight||document.documentElement.clientHeight)){fJ=false}}if(fJ!=null&&!e1){var fM=fs("div","\u200b",null,"position: absolute; top: "+(fN.top-fO.viewOffset-eE(fK.display))+"px; height: "+(fN.bottom-fN.top+a7)+"px; left: "+fN.left+"px; width: 2px;");fK.display.lineSpace.appendChild(fM);fM.scrollIntoView(fJ);fK.display.lineSpace.removeChild(fM)}}function E(fS,fQ,fN,fM){if(fM==null){fM=0}for(;;){var fO=false,fR=dt(fS,fQ);var fJ=!fN||fN==fQ?fR:dt(fS,fN);var fL=H(fS,Math.min(fR.left,fJ.left),Math.min(fR.top,fJ.top)-fM,Math.max(fR.left,fJ.left),Math.max(fR.bottom,fJ.bottom)+fM);var fP=fS.doc.scrollTop,fK=fS.doc.scrollLeft;if(fL.scrollTop!=null){N(fS,fL.scrollTop);if(Math.abs(fS.doc.scrollTop-fP)>1){fO=true}}if(fL.scrollLeft!=null){bq(fS,fL.scrollLeft);if(Math.abs(fS.doc.scrollLeft-fK)>1){fO=true}}if(!fO){return fR}}}function F(fJ,fL,fN,fK,fM){var fO=H(fJ,fL,fN,fK,fM);if(fO.scrollTop!=null){N(fJ,fO.scrollTop)}if(fO.scrollLeft!=null){bq(fJ,fO.scrollLeft)}}function H(fP,fX,fM,fW,fL){var fU=fP.display,fT=aL(fP.display);if(fM<0){fM=0}var fS=fP.curOp&&fP.curOp.scrollTop!=null?fP.curOp.scrollTop:fU.scroller.scrollTop;var fK=fU.scroller.clientHeight-a7,fR={};var fZ=fP.doc.height+bu(fU);var f0=fM<fT,fV=fL>fZ-fT;if(fM<fS){fR.scrollTop=f0?0:fM}else{if(fL>fS+fK){var fQ=Math.min(fM,(fV?fZ:fL)-fK);if(fQ!=fS){fR.scrollTop=fQ}}}var fJ=fP.curOp&&fP.curOp.scrollLeft!=null?fP.curOp.scrollLeft:fU.scroller.scrollLeft;var fO=fU.scroller.clientWidth-a7;fX+=fU.gutters.offsetWidth;fW+=fU.gutters.offsetWidth;var fN=fU.gutters.offsetWidth;var fY=fX<fN+10;if(fX<fJ+fN||fY){if(fY){fX=0}fR.scrollLeft=Math.max(0,fX-10-fN)}else{if(fW>fO+fJ-3){fR.scrollLeft=fW+10-fO}}return fR}function cu(fJ,fL,fK){if(fL!=null||fK!=null){fa(fJ)}if(fL!=null){fJ.curOp.scrollLeft=(fJ.curOp.scrollLeft==null?fJ.doc.scrollLeft:fJ.curOp.scrollLeft)+fL}if(fK!=null){fJ.curOp.scrollTop=(fJ.curOp.scrollTop==null?fJ.doc.scrollTop:fJ.curOp.scrollTop)+fK}}function fc(fJ){fa(fJ);var fK=fJ.getCursor(),fM=fK,fL=fK;if(!fJ.options.lineWrapping){fM=fK.ch?W(fK.line,fK.ch-1):fK;fL=W(fK.line,fK.ch+1)}fJ.curOp.scrollToPos={from:fM,to:fL,margin:fJ.options.cursorScrollMargin,isCursor:true}}function fa(fJ){var fL=fJ.curOp.scrollToPos;if(fL){fJ.curOp.scrollToPos=null;var fN=di(fJ,fL.from),fM=di(fJ,fL.to);var fK=H(fJ,Math.min(fN.left,fM.left),Math.min(fN.top,fM.top)-fL.margin,Math.max(fN.right,fM.right),Math.max(fN.bottom,fM.bottom)+fL.margin);fJ.scrollTo(fK.scrollLeft,fK.scrollTop)}}function ab(fW,fM,fV,fL){var fU=fW.doc,fK;if(fV==null){fV="add"}if(fV=="smart"){if(!fW.doc.mode.indent){fV="prev"}else{fK=dc(fW,fM)}}var fQ=fW.options.tabSize;var fX=eL(fU,fM),fP=bF(fX.text,null,fQ);if(fX.stateAfter){fX.stateAfter=null}var fJ=fX.text.match(/^\s*/)[0],fS;if(!fL&&!/\S/.test(fX.text)){fS=0;fV="not"}else{if(fV=="smart"){fS=fW.doc.mode.indent(fK,fX.text.slice(fJ.length),fX.text);if(fS==bW){if(!fL){return}fV="prev"}}}if(fV=="prev"){if(fM>fU.first){fS=bF(eL(fU,fM-1).text,null,fQ)}else{fS=0}}else{if(fV=="add"){fS=fP+fW.options.indentUnit}else{if(fV=="subtract"){fS=fP-fW.options.indentUnit}else{if(typeof fV=="number"){fS=fP+fV}}}}fS=Math.max(0,fS);var fT="",fR=0;if(fW.options.indentWithTabs){for(var fN=Math.floor(fS/fQ);fN;--fN){fR+=fQ;fT+="\t"}}if(fR<fS){fT+=cc(fS-fR)}if(fT!=fJ){aP(fW.doc,fT,W(fM,0),W(fM,fJ.length),"+input")}else{for(var fN=0;fN<fU.sel.ranges.length;fN++){var fO=fU.sel.ranges[fN];if(fO.head.line==fM&&fO.head.ch<fJ.length){var fR=W(fM,fJ.length);f(fU,fN,new dx(fR,fR));break}}}fX.stateAfter=null}function d7(fK,fM,fJ,fP){var fO=fM,fL=fM,fN=fK.doc;if(typeof fM=="number"){fL=eL(fN,cK(fN,fM))}else{fO=bz(fM)}if(fO==null){return null}if(fP(fL,fO)){R(fK,fO,fJ)}return fL}function ew(fJ,fP){var fK=fJ.doc.sel.ranges,fN=[];for(var fM=0;fM<fK.length;fM++){var fL=fP(fK[fM]);while(fN.length&&b2(fL.from,fd(fN).to)<=0){var fO=fN.pop();if(b2(fO.from,fL.from)<0){fL.from=fO.from;break}}fN.push(fL)}cv(fJ,function(){for(var fQ=fN.length-1;fQ>=0;fQ--){aP(fJ.doc,"",fN[fQ].from,fN[fQ].to,"+delete")}fc(fJ)})}function bj(f0,fM,fU,fT,fO){var fR=fM.line,fS=fM.ch,fZ=fU;var fJ=eL(f0,fR);var fX=true;function fY(){var f1=fR+fU;if(f1<f0.first||f1>=f0.first+f0.size){return(fX=false)}fR=f1;return fJ=eL(f0,f1)}function fW(f2){var f1=(fO?v:ag)(fJ,fS,fU,true);if(f1==null){if(!f2&&fY()){if(fO){fS=(fU<0?cA:cp)(fJ)}else{fS=fU<0?fJ.text.length:0}}else{return(fX=false)}}else{fS=f1}return true}if(fT=="char"){fW()}else{if(fT=="column"){fW(true)}else{if(fT=="word"||fT=="group"){var fV=null,fP=fT=="group";for(var fN=true;;fN=false){if(fU<0&&!fW(!fN)){break}var fK=fJ.text.charAt(fS)||"\n";var fL=cm(fK)?"w":fP&&fK=="\n"?"n":!fP||/\s/.test(fK)?null:"p";if(fP&&!fN&&!fL){fL="s"}if(fV&&fV!=fL){if(fU<0){fU=1;fW()}break}if(fL){fV=fL}if(fU>0&&!fW(!fN)){break}}}}}var fQ=bH(f0,W(fR,fS),fZ,true);if(!fX){fQ.hitSide=true}return fQ}function bd(fR,fM,fJ,fQ){var fP=fR.doc,fO=fM.left,fN;if(fQ=="page"){var fL=Math.min(fR.display.wrapper.clientHeight,window.innerHeight||document.documentElement.clientHeight);fN=fM.top+fJ*(fL-(fJ<0?1.5:0.5)*aL(fR.display))}else{if(fQ=="line"){fN=fJ>0?fM.bottom+3:fM.top-3}}for(;;){var fK=fk(fR,fO,fN);if(!fK.outside){break}if(fJ<0?fN<=0:fN>=fP.height){fK.hitSide=true;break}fN+=fJ*5}return fK}function ar(fN,fP){var fM=eL(fN,fP.line).text;var fO=fP.ch,fL=fP.ch;if(fM){if((fP.xRel<0||fL==fM.length)&&fO){--fO}else{++fL}var fK=fM.charAt(fO);var fJ=cm(fK)?cm:/\s/.test(fK)?function(fQ){return/\s/.test(fQ)}:function(fQ){return !/\s/.test(fQ)&&!cm(fQ)};while(fO>0&&fJ(fM.charAt(fO-1))){--fO}while(fL<fM.length&&fJ(fM.charAt(fL))){++fL}}return new dx(W(fP.line,fO),W(fP.line,fL))}I.prototype={constructor:I,focus:function(){window.focus();d9(this);C(this)},setOption:function(fL,fM){var fK=this.options,fJ=fK[fL];if(fK[fL]==fM&&fL!="mode"){return}fK[fL]=fM;if(a2.hasOwnProperty(fL)){cH(this,a2[fL])(this,fM,fJ)}},getOption:function(fJ){return this.options[fJ]},getDoc:function(){return this.doc},addKeyMap:function(fK,fJ){this.state.keyMaps[fJ?"push":"unshift"](fK)},removeKeyMap:function(fK){var fL=this.state.keyMaps;for(var fJ=0;fJ<fL.length;++fJ){if(fL[fJ]==fK||(typeof fL[fJ]!="string"&&fL[fJ].name==fK)){fL.splice(fJ,1);return true}}},addOverlay:cN(function(fJ,fK){var fL=fJ.token?fJ:I.getMode(this.options,fJ);if(fL.startState){throw new Error("Overlays may not be stateful.")}this.state.overlays.push({mode:fL,modeSpec:fJ,opaque:fK&&fK.opaque});this.state.modeGen++;af(this)}),removeOverlay:cN(function(fJ){var fL=this.state.overlays;for(var fK=0;fK<fL.length;++fK){var fM=fL[fK].modeSpec;if(fM==fJ||typeof fJ=="string"&&fM.name==fJ){fL.splice(fK,1);this.state.modeGen++;af(this);return}}}),indentLine:cN(function(fL,fJ,fK){if(typeof fJ!="string"&&typeof fJ!="number"){if(fJ==null){fJ=this.options.smartIndent?"smart":"prev"}else{fJ=fJ?"add":"subtract"}}if(bT(this.doc,fL)){ab(this,fL,fJ,fK)}}),indentSelection:cN(function(fO){var fK=this.doc.sel.ranges,fJ=-1;for(var fN=0;fN<fK.length;fN++){var fL=fK[fN];if(!fL.empty()){var fQ=Math.max(fJ,fL.from().line);var fP=fL.to();fJ=Math.min(this.lastLine(),fP.line-(fP.ch?0:1))+1;for(var fM=fQ;fM<fJ;++fM){ab(this,fM,fO)}}else{if(fL.head.line>fJ){ab(this,fL.head.line,fO,true);fJ=fL.head.line;if(fN==this.doc.sel.primIndex){fc(this)}}}}}),getTokenAt:function(fQ,fK){var fN=this.doc;fQ=ff(fN,fQ);var fM=dc(this,fQ.line,fK),fP=this.doc.mode;var fJ=eL(fN,fQ.line);var fO=new es(fJ.text,this.options.tabSize);while(fO.pos<fQ.ch&&!fO.eol()){fO.start=fO.pos;var fL=eb(fP,fO,fM)}return{start:fO.start,end:fO.pos,string:fO.current(),type:fL||null,state:fM}},getTokenTypeAt:function(fQ){fQ=ff(this.doc,fQ);var fM=cM(this,eL(this.doc,fQ.line));var fO=0,fP=(fM.length-1)/2,fL=fQ.ch;var fK;if(fL==0){fK=fM[2]}else{for(;;){var fJ=(fO+fP)>>1;if((fJ?fM[fJ*2-1]:0)>=fL){fP=fJ}else{if(fM[fJ*2+1]<fL){fO=fJ+1}else{fK=fM[fJ*2+2];break}}}}var fN=fK?fK.indexOf("cm-overlay "):-1;return fN<0?fK:fN==0?null:fK.slice(0,fN-1)},getModeAt:function(fK){var fJ=this.doc.mode;if(!fJ.innerMode){return fJ}return I.innerMode(fJ,this.getTokenAt(fK).state).mode},getHelper:function(fK,fJ){return this.getHelpers(fK,fJ)[0]},getHelpers:function(fQ,fL){var fM=[];if(!eU.hasOwnProperty(fL)){return eU}var fJ=eU[fL],fP=this.getModeAt(fQ);if(typeof fP[fL]=="string"){if(fJ[fP[fL]]){fM.push(fJ[fP[fL]])}}else{if(fP[fL]){for(var fK=0;fK<fP[fL].length;fK++){var fO=fJ[fP[fL][fK]];if(fO){fM.push(fO)}}}else{if(fP.helperType&&fJ[fP.helperType]){fM.push(fJ[fP.helperType])}else{if(fJ[fP.name]){fM.push(fJ[fP.name])}}}}for(var fK=0;fK<fJ._global.length;fK++){var fN=fJ._global[fK];if(fN.pred(fP,this)&&cX(fM,fN.val)==-1){fM.push(fN.val)}}return fM},getStateAfter:function(fK,fJ){var fL=this.doc;fK=cK(fL,fK==null?fL.first+fL.size-1:fK);return dc(this,fK+1,fJ)},cursorCoords:function(fM,fK){var fL,fJ=this.doc.sel.primary();if(fM==null){fL=fJ.head}else{if(typeof fM=="object"){fL=ff(this.doc,fM)}else{fL=fM?fJ.from():fJ.to()}}return dt(this,fL,fK||"page")},charCoords:function(fK,fJ){return ct(this,ff(this.doc,fK),fJ||"page")},coordsChar:function(fJ,fK){fJ=fF(this,fJ,fK||"page");return fk(this,fJ.left,fJ.top)},lineAtHeight:function(fJ,fK){fJ=fF(this,{top:fJ,left:0},fK||"page").top;return bs(this.doc,fJ+this.display.viewOffset)},heightAtLine:function(fK,fN){var fJ=false,fM=this.doc.first+this.doc.size-1;if(fK<this.doc.first){fK=this.doc.first}else{if(fK>fM){fK=fM;fJ=true}}var fL=eL(this.doc,fK);return ep(this,fL,{top:0,left:0},fN||"page").top+(fJ?this.doc.height-by(fL):0)},defaultTextHeight:function(){return aL(this.display)},defaultCharWidth:function(){return de(this.display)},setGutterMarker:cN(function(fJ,fK,fL){return d7(this,fJ,"gutter",function(fM){var fN=fM.gutterMarkers||(fM.gutterMarkers={});fN[fK]=fL;if(!fL&&et(fN)){fM.gutterMarkers=null}return true})}),clearGutter:cN(function(fL){var fJ=this,fM=fJ.doc,fK=fM.first;fM.iter(function(fN){if(fN.gutterMarkers&&fN.gutterMarkers[fL]){fN.gutterMarkers[fL]=null;R(fJ,fK,"gutter");if(et(fN.gutterMarkers)){fN.gutterMarkers=null}}++fK})}),addLineClass:cN(function(fL,fK,fJ){return d7(this,fL,"class",function(fM){var fN=fK=="text"?"textClass":fK=="background"?"bgClass":"wrapClass";if(!fM[fN]){fM[fN]=fJ}else{if(new RegExp("(?:^|\\s)"+fJ+"(?:$|\\s)").test(fM[fN])){return false}else{fM[fN]+=" "+fJ}}return true})}),removeLineClass:cN(function(fL,fK,fJ){return d7(this,fL,"class",function(fN){var fQ=fK=="text"?"textClass":fK=="background"?"bgClass":"wrapClass";var fP=fN[fQ];if(!fP){return false}else{if(fJ==null){fN[fQ]=null}else{var fO=fP.match(new RegExp("(?:^|\\s+)"+fJ+"(?:$|\\s+)"));if(!fO){return false}var fM=fO.index+fO[0].length;fN[fQ]=fP.slice(0,fO.index)+(!fO.index||fM==fP.length?"":" ")+fP.slice(fM)||null}}return true})}),addLineWidget:cN(function(fL,fK,fJ){return bt(this,fL,fK,fJ)}),removeLineWidget:function(fJ){fJ.clear()},lineInfo:function(fJ){if(typeof fJ=="number"){if(!bT(this.doc,fJ)){return null}var fK=fJ;fJ=eL(this.doc,fJ);if(!fJ){return null}}else{var fK=bz(fJ);if(fK==null){return null}}return{line:fK,handle:fJ,text:fJ.text,gutterMarkers:fJ.gutterMarkers,textClass:fJ.textClass,bgClass:fJ.bgClass,wrapClass:fJ.wrapClass,widgets:fJ.widgets}},getViewport:function(){return{from:this.display.viewFrom,to:this.display.viewTo}},addWidget:function(fO,fL,fQ,fM,fS){var fN=this.display;fO=dt(this,ff(this.doc,fO));var fP=fO.bottom,fK=fO.left;fL.style.position="absolute";fN.sizer.appendChild(fL);if(fM=="over"){fP=fO.top}else{if(fM=="above"||fM=="near"){var fJ=Math.max(fN.wrapper.clientHeight,this.doc.height),fR=Math.max(fN.sizer.clientWidth,fN.lineSpace.clientWidth);if((fM=="above"||fO.bottom+fL.offsetHeight>fJ)&&fO.top>fL.offsetHeight){fP=fO.top-fL.offsetHeight}else{if(fO.bottom+fL.offsetHeight<=fJ){fP=fO.bottom}}if(fK+fL.offsetWidth>fR){fK=fR-fL.offsetWidth}}}fL.style.top=fP+"px";fL.style.left=fL.style.right="";if(fS=="right"){fK=fN.sizer.clientWidth-fL.offsetWidth;fL.style.right="0px"}else{if(fS=="left"){fK=0}else{if(fS=="middle"){fK=(fN.sizer.clientWidth-fL.offsetWidth)/2}}fL.style.left=fK+"px"}if(fQ){F(this,fK,fP,fK+fL.offsetWidth,fP+fL.offsetHeight)}},triggerOnKeyDown:cN(q),triggerOnKeyPress:cN(ck),triggerOnKeyUp:cN(a5),execCommand:function(fJ){if(ed.hasOwnProperty(fJ)){return ed[fJ](this)}},findPosH:function(fP,fM,fN,fK){var fJ=1;if(fM<0){fJ=-1;fM=-fM}for(var fL=0,fO=ff(this.doc,fP);fL<fM;++fL){fO=bj(this.doc,fO,fJ,fN,fK);if(fO.hitSide){break}}return fO},moveH:cN(function(fK,fL){var fJ=this;fJ.extendSelectionsBy(function(fM){if(fJ.display.shift||fJ.doc.extend||fM.empty()){return bj(fJ.doc,fM.head,fK,fL,fJ.options.rtlMoveVisually)}else{return fK<0?fM.from():fM.to()}},cB)}),deleteH:cN(function(fJ,fK){var fL=this.doc.sel,fM=this.doc;if(fL.somethingSelected()){fM.replaceSelection("",null,"+delete")}else{ew(this,function(fO){var fN=bj(fM,fO.head,fJ,fK,false);return fJ<0?{from:fN,to:fO.head}:{from:fO.head,to:fN}})}}),findPosV:function(fO,fL,fP,fR){var fJ=1,fN=fR;if(fL<0){fJ=-1;fL=-fL}for(var fK=0,fQ=ff(this.doc,fO);fK<fL;++fK){var fM=dt(this,fQ,"div");if(fN==null){fN=fM.left}else{fM.left=fN}fQ=bd(this,fM,fJ,fP);if(fQ.hitSide){break}}return fQ},moveV:cN(function(fK,fM){var fJ=this,fO=this.doc,fN=[];var fP=!fJ.display.shift&&!fO.extend&&fO.sel.somethingSelected();fO.extendSelectionsBy(function(fQ){if(fP){return fK<0?fQ.from():fQ.to()}var fS=dt(fJ,fQ.head,"div");if(fQ.goalColumn!=null){fS.left=fQ.goalColumn}fN.push(fS.left);var fR=bd(fJ,fS,fK,fM);if(fM=="page"&&fQ==fO.sel.primary()){cu(fJ,null,ct(fJ,fR,"div").top-fS.top)}return fR},cB);if(fN.length){for(var fL=0;fL<fO.sel.ranges.length;fL++){fO.sel.ranges[fL].goalColumn=fN[fL]}}}),toggleOverwrite:function(fJ){if(fJ!=null&&fJ==this.state.overwrite){return}if(this.state.overwrite=!this.state.overwrite){e8(this.display.cursorDiv,"CodeMirror-overwrite")}else{g(this.display.cursorDiv,"CodeMirror-overwrite")}ay(this,"overwriteToggle",this,this.state.overwrite)},hasFocus:function(){return dn()==this.display.input},scrollTo:cN(function(fJ,fK){if(fJ!=null||fK!=null){fa(this)}if(fJ!=null){this.curOp.scrollLeft=fJ}if(fK!=null){this.curOp.scrollTop=fK}}),getScrollInfo:function(){var fJ=this.display.scroller,fK=a7;return{left:fJ.scrollLeft,top:fJ.scrollTop,height:fJ.scrollHeight-fK,width:fJ.scrollWidth-fK,clientHeight:fJ.clientHeight-fK,clientWidth:fJ.clientWidth-fK}},scrollIntoView:cN(function(fK,fL){if(fK==null){fK={from:this.doc.sel.primary().head,to:null};if(fL==null){fL=this.options.cursorScrollMargin}}else{if(typeof fK=="number"){fK={from:W(fK,0),to:null}}else{if(fK.from==null){fK={from:fK,to:null}}}}if(!fK.to){fK.to=fK.from}fK.margin=fL||0;if(fK.from.line!=null){fa(this);this.curOp.scrollToPos=fK}else{var fJ=H(this,Math.min(fK.from.left,fK.to.left),Math.min(fK.from.top,fK.to.top)-fK.margin,Math.max(fK.from.right,fK.to.right),Math.max(fK.from.bottom,fK.to.bottom)+fK.margin);this.scrollTo(fJ.scrollLeft,fJ.scrollTop)}}),setSize:cN(function(fL,fJ){function fK(fM){return typeof fM=="number"||/^\d+$/.test(String(fM))?fM+"px":fM}if(fL!=null){this.display.wrapper.style.width=fK(fL)}if(fJ!=null){this.display.wrapper.style.height=fK(fJ)}if(this.options.lineWrapping){aE(this)}this.curOp.forceUpdate=true;ay(this,"refresh",this)}),operation:function(fJ){return cv(this,fJ)},refresh:cN(function(){var fJ=this.display.cachedTextHeight;af(this);this.curOp.forceUpdate=true;ai(this);this.scrollTo(this.doc.scrollLeft,this.doc.scrollTop);cJ(this);if(fJ==null||Math.abs(fJ-aL(this.display))>0.5){X(this)}ay(this,"refresh",this)}),swapDoc:cN(function(fK){var fJ=this.doc;fJ.cm=null;dJ(this,fK);ai(this);eV(this);this.scrollTo(fK.scrollLeft,fK.scrollTop);ac(this,"swapDoc",this,fJ);return fJ}),getInputField:function(){return this.display.input},getWrapperElement:function(){return this.display.wrapper},getScrollerElement:function(){return this.display.scroller},getGutterElement:function(){return this.display.gutters}};bl(I);var eB=I.defaults={};var a2=I.optionHandlers={};function t(fJ,fM,fL,fK){I.defaults[fJ]=fM;if(fL){a2[fJ]=fK?function(fN,fP,fO){if(fO!=bZ){fL(fN,fP,fO)}}:fL}}var bZ=I.Init={toString:function(){return"CodeMirror.Init"}};t("value","",function(fJ,fK){fJ.setValue(fK)},true);t("mode",null,function(fJ,fK){fJ.doc.modeOption=fK;be(fJ)},true);t("indentUnit",2,be,true);t("indentWithTabs",false);t("smartIndent",true);t("tabSize",4,function(fJ){dT(fJ);ai(fJ);af(fJ)},true);t("specialChars",/[\t\u0000-\u0019\u00ad\u200b\u2028\u2029\ufeff]/g,function(fJ,fK){fJ.options.specialChars=new RegExp(fK.source+(fK.test("\t")?"":"|\t"),"g");fJ.refresh()},true);t("specialCharPlaceholder",eJ,function(fJ){fJ.refresh()},true);t("electricChars",true);t("rtlMoveVisually",!aF);t("wholeLineUpdateBefore",true);t("theme","default",function(fJ){cx(fJ);c7(fJ)},true);t("keyMap","default",fG);t("extraKeys",null);t("lineWrapping",false,eg,true);t("gutters",[],function(fJ){b1(fJ.options);c7(fJ)},true);t("fixedGutter",true,function(fJ,fK){fJ.display.gutters.style.left=fK?dw(fJ.display)+"px":"0";fJ.refresh()},true);t("coverGutterNextToScrollbar",false,ex,true);t("lineNumbers",false,function(fJ){b1(fJ.options);c7(fJ)},true);t("firstLineNumber",1,c7,true);t("lineNumberFormatter",function(fJ){return fJ},c7,true);t("showCursorWhenSelecting",false,bo,true);t("resetSelectionOnContextMenu",true);t("readOnly",false,function(fJ,fK){if(fK=="nocursor"){aJ(fJ);fJ.display.input.blur();fJ.display.disabled=true}else{fJ.display.disabled=false;if(!fK){eV(fJ)}}});t("disableInput",false,function(fJ,fK){if(!fK){eV(fJ)}},true);t("dragDrop",true);t("cursorBlinkRate",530);t("cursorScrollMargin",0);t("cursorHeight",1);t("workTime",100);t("workDelay",100);t("flattenSpans",true,dT,true);t("addModeClass",false,dT,true);t("pollInterval",100);t("undoDepth",200,function(fJ,fK){fJ.doc.history.undoDepth=fK});t("historyEventDelay",1250);t("viewportMargin",10,function(fJ){fJ.refresh()},true);t("maxHighlightLength",10000,dT,true);t("moveInputWithCursor",true,function(fJ,fK){if(!fK){fJ.display.inputDiv.style.top=fJ.display.inputDiv.style.left=0}});t("tabindex",null,function(fJ,fK){fJ.display.input.tabIndex=fK||""});t("autofocus",null);var c4=I.modes={},aI=I.mimeModes={};I.defineMode=function(fJ,fL){if(!I.defaults.mode&&fJ!="null"){I.defaults.mode=fJ}if(arguments.length>2){fL.dependencies=[];for(var fK=2;fK<arguments.length;++fK){fL.dependencies.push(arguments[fK])}}c4[fJ]=fL};I.defineMIME=function(fK,fJ){aI[fK]=fJ};I.resolveMode=function(fJ){if(typeof fJ=="string"&&aI.hasOwnProperty(fJ)){fJ=aI[fJ]}else{if(fJ&&typeof fJ.name=="string"&&aI.hasOwnProperty(fJ.name)){var fK=aI[fJ.name];if(typeof fK=="string"){fK={name:fK}}fJ=b7(fK,fJ);fJ.name=fK.name}else{if(typeof fJ=="string"&&/^[\w\-]+\/[\w\-]+\+xml$/.test(fJ)){return I.resolveMode("application/xml")}}}if(typeof fJ=="string"){return{name:fJ}}else{return fJ||{name:"null"}}};I.getMode=function(fK,fJ){var fJ=I.resolveMode(fJ);var fM=c4[fJ.name];if(!fM){return I.getMode(fK,"text/plain")}var fN=fM(fK,fJ);if(c1.hasOwnProperty(fJ.name)){var fL=c1[fJ.name];for(var fO in fL){if(!fL.hasOwnProperty(fO)){continue}if(fN.hasOwnProperty(fO)){fN["_"+fO]=fN[fO]}fN[fO]=fL[fO]}}fN.name=fJ.name;if(fJ.helperType){fN.helperType=fJ.helperType}if(fJ.modeProps){for(var fO in fJ.modeProps){fN[fO]=fJ.modeProps[fO]}}return fN};I.defineMode("null",function(){return{token:function(fJ){fJ.skipToEnd()}}});I.defineMIME("text/plain","null");var c1=I.modeExtensions={};I.extendMode=function(fL,fK){var fJ=c1.hasOwnProperty(fL)?c1[fL]:(c1[fL]={});aD(fK,fJ)};I.defineExtension=function(fJ,fK){I.prototype[fJ]=fK};I.defineDocExtension=function(fJ,fK){ao.prototype[fJ]=fK};I.defineOption=t;var aW=[];I.defineInitHook=function(fJ){aW.push(fJ)};var eU=I.helpers={};I.registerHelper=function(fK,fJ,fL){if(!eU.hasOwnProperty(fK)){eU[fK]=I[fK]={_global:[]}}eU[fK][fJ]=fL};I.registerGlobalHelper=function(fL,fK,fJ,fM){I.registerHelper(fL,fK,fM);eU[fL]._global.push({pred:fJ,val:fM})};var bO=I.copyState=function(fM,fJ){if(fJ===true){return fJ}if(fM.copyState){return fM.copyState(fJ)}var fL={};for(var fN in fJ){var fK=fJ[fN];if(fK instanceof Array){fK=fK.concat([])}fL[fN]=fK}return fL};var bM=I.startState=function(fL,fK,fJ){return fL.startState?fL.startState(fK,fJ):true};I.innerMode=function(fL,fJ){while(fL.innerMode){var fK=fL.innerMode(fJ);if(!fK||fK.mode==fL){break}fJ=fK.state;fL=fK.mode}return fK||{mode:fL,state:fJ}};var ed=I.commands={selectAll:function(fJ){fJ.setSelection(W(fJ.firstLine(),0),W(fJ.lastLine()),Y)},singleSelection:function(fJ){fJ.setSelection(fJ.getCursor("anchor"),fJ.getCursor("head"),Y)},killLine:function(fJ){ew(fJ,function(fL){if(fL.empty()){var fK=eL(fJ.doc,fL.head.line).text.length;if(fL.head.ch==fK&&fL.head.line<fJ.lastLine()){return{from:fL.head,to:W(fL.head.line+1,0)}}else{return{from:fL.head,to:W(fL.head.line,fK)}}}else{return{from:fL.from(),to:fL.to()}}})},deleteLine:function(fJ){ew(fJ,function(fK){return{from:W(fK.from().line,0),to:ff(fJ.doc,W(fK.to().line+1,0))}})},delLineLeft:function(fJ){ew(fJ,function(fK){return{from:W(fK.from().line,0),to:fK.from()}})},undo:function(fJ){fJ.undo()},redo:function(fJ){fJ.redo()},undoSelection:function(fJ){fJ.undoSelection()},redoSelection:function(fJ){fJ.redoSelection()},goDocStart:function(fJ){fJ.extendSelection(W(fJ.firstLine(),0))},goDocEnd:function(fJ){fJ.extendSelection(W(fJ.lastLine()))},goLineStart:function(fJ){fJ.extendSelectionsBy(function(fK){return bg(fJ,fK.head.line)},cB)},goLineStartSmart:function(fJ){fJ.extendSelectionsBy(function(fM){var fP=bg(fJ,fM.head.line);var fL=fJ.getLineHandle(fP.line);var fK=a(fL);if(!fK||fK[0].level==0){var fO=Math.max(0,fL.text.search(/\S/));var fN=fM.head.line==fP.line&&fM.head.ch<=fO&&fM.head.ch;return W(fP.line,fN?0:fO)}return fP},cB)},goLineEnd:function(fJ){fJ.extendSelectionsBy(function(fK){return dp(fJ,fK.head.line)},cB)},goLineRight:function(fJ){fJ.extendSelectionsBy(function(fK){var fL=fJ.charCoords(fK.head,"div").top+5;return fJ.coordsChar({left:fJ.display.lineDiv.offsetWidth+100,top:fL},"div")},cB)},goLineLeft:function(fJ){fJ.extendSelectionsBy(function(fK){var fL=fJ.charCoords(fK.head,"div").top+5;return fJ.coordsChar({left:0,top:fL},"div")},cB)},goLineUp:function(fJ){fJ.moveV(-1,"line")},goLineDown:function(fJ){fJ.moveV(1,"line")},goPageUp:function(fJ){fJ.moveV(-1,"page")},goPageDown:function(fJ){fJ.moveV(1,"page")},goCharLeft:function(fJ){fJ.moveH(-1,"char")},goCharRight:function(fJ){fJ.moveH(1,"char")},goColumnLeft:function(fJ){fJ.moveH(-1,"column")},goColumnRight:function(fJ){fJ.moveH(1,"column")},goWordLeft:function(fJ){fJ.moveH(-1,"word")},goGroupRight:function(fJ){fJ.moveH(1,"group")},goGroupLeft:function(fJ){fJ.moveH(-1,"group")},goWordRight:function(fJ){fJ.moveH(1,"word")},delCharBefore:function(fJ){fJ.deleteH(-1,"char")},delCharAfter:function(fJ){fJ.deleteH(1,"char")},delWordBefore:function(fJ){fJ.deleteH(-1,"word")},delWordAfter:function(fJ){fJ.deleteH(1,"word")},delGroupBefore:function(fJ){fJ.deleteH(-1,"group")},delGroupAfter:function(fJ){fJ.deleteH(1,"group")},indentAuto:function(fJ){fJ.indentSelection("smart")},indentMore:function(fJ){fJ.indentSelection("add")},indentLess:function(fJ){fJ.indentSelection("subtract")},insertTab:function(fJ){fJ.replaceSelection("\t")},insertSoftTab:function(fJ){var fL=[],fK=fJ.listSelections(),fO=fJ.options.tabSize;for(var fN=0;fN<fK.length;fN++){var fP=fK[fN].from();var fM=bF(fJ.getLine(fP.line),fP.ch,fO);fL.push(new Array(fO-fM%fO+1).join(" "))}fJ.replaceSelections(fL)},defaultTab:function(fJ){if(fJ.somethingSelected()){fJ.indentSelection("add")}else{fJ.execCommand("insertTab")}},transposeChars:function(fJ){cv(fJ,function(){var fL=fJ.listSelections();for(var fM=0;fM<fL.length;fM++){var fN=fL[fM].head,fK=eL(fJ.doc,fN.line).text;if(fN.ch>0&&fN.ch<fK.length-1){fJ.replaceRange(fK.charAt(fN.ch)+fK.charAt(fN.ch-1),W(fN.line,fN.ch-1),W(fN.line,fN.ch+1))}}})},newlineAndIndent:function(fJ){cv(fJ,function(){var fK=fJ.listSelections().length;for(var fM=0;fM<fK;fM++){var fL=fJ.listSelections()[fM];fJ.replaceRange("\n",fL.anchor,fL.head,"+input");fJ.indentLine(fL.from().line+1,null,true);fc(fJ)}})},toggleOverwrite:function(fJ){fJ.toggleOverwrite()}};var eG=I.keyMap={};eG.basic={Left:"goCharLeft",Right:"goCharRight",Up:"goLineUp",Down:"goLineDown",End:"goLineEnd",Home:"goLineStartSmart",PageUp:"goPageUp",PageDown:"goPageDown",Delete:"delCharAfter",Backspace:"delCharBefore","Shift-Backspace":"delCharBefore",Tab:"defaultTab","Shift-Tab":"indentAuto",Enter:"newlineAndIndent",Insert:"toggleOverwrite",Esc:"singleSelection"};eG.pcDefault={"Ctrl-A":"selectAll","Ctrl-D":"deleteLine","Ctrl-Z":"undo","Shift-Ctrl-Z":"redo","Ctrl-Y":"redo","Ctrl-Home":"goDocStart","Ctrl-Up":"goDocStart","Ctrl-End":"goDocEnd","Ctrl-Down":"goDocEnd","Ctrl-Left":"goGroupLeft","Ctrl-Right":"goGroupRight","Alt-Left":"goLineStart","Alt-Right":"goLineEnd","Ctrl-Backspace":"delGroupBefore","Ctrl-Delete":"delGroupAfter","Ctrl-S":"save","Ctrl-F":"find","Ctrl-G":"findNext","Shift-Ctrl-G":"findPrev","Shift-Ctrl-F":"replace","Shift-Ctrl-R":"replaceAll","Ctrl-[":"indentLess","Ctrl-]":"indentMore","Ctrl-U":"undoSelection","Shift-Ctrl-U":"redoSelection","Alt-U":"redoSelection",fallthrough:"basic"};eG.macDefault={"Cmd-A":"selectAll","Cmd-D":"deleteLine","Cmd-Z":"undo","Shift-Cmd-Z":"redo","Cmd-Y":"redo","Cmd-Up":"goDocStart","Cmd-End":"goDocEnd","Cmd-Down":"goDocEnd","Alt-Left":"goGroupLeft","Alt-Right":"goGroupRight","Cmd-Left":"goLineStart","Cmd-Right":"goLineEnd","Alt-Backspace":"delGroupBefore","Ctrl-Alt-Backspace":"delGroupAfter","Alt-Delete":"delGroupAfter","Cmd-S":"save","Cmd-F":"find","Cmd-G":"findNext","Shift-Cmd-G":"findPrev","Cmd-Alt-F":"replace","Shift-Cmd-Alt-F":"replaceAll","Cmd-[":"indentLess","Cmd-]":"indentMore","Cmd-Backspace":"delLineLeft","Cmd-U":"undoSelection","Shift-Cmd-U":"redoSelection",fallthrough:["basic","emacsy"]};eG.emacsy={"Ctrl-F":"goCharRight","Ctrl-B":"goCharLeft","Ctrl-P":"goLineUp","Ctrl-N":"goLineDown","Alt-F":"goWordRight","Alt-B":"goWordLeft","Ctrl-A":"goLineStart","Ctrl-E":"goLineEnd","Ctrl-V":"goPageDown","Shift-Ctrl-V":"goPageUp","Ctrl-D":"delCharAfter","Ctrl-H":"delCharBefore","Alt-D":"delWordAfter","Alt-Backspace":"delWordBefore","Ctrl-K":"killLine","Ctrl-T":"transposeChars"};eG["default"]=bR?eG.macDefault:eG.pcDefault;function fq(fJ){if(typeof fJ=="string"){return eG[fJ]}else{return fJ}}var j=I.lookupKey=function(fK,fO,fM){function fN(fT){fT=fq(fT);var fS=fT[fK];if(fS===false){return"stop"}if(fS!=null&&fM(fS)){return true}if(fT.nofallthrough){return"stop"}var fR=fT.fallthrough;if(fR==null){return false}if(Object.prototype.toString.call(fR)!="[object Array]"){return fN(fR)}for(var fQ=0;fQ<fR.length;++fQ){var fP=fN(fR[fQ]);if(fP){return fP}}return false}for(var fL=0;fL<fO.length;++fL){var fJ=fN(fO[fL]);if(fJ){return fJ!="stop"}}};var ec=I.isModifierKey=function(fK){var fJ=eM[fK.keyCode];return fJ=="Ctrl"||fJ=="Alt"||fJ=="Shift"||fJ=="Mod"};var eY=I.keyName=function(fK,fL){if(dB&&fK.keyCode==34&&fK["char"]){return false}var fJ=eM[fK.keyCode];if(fJ==null||fK.altGraphKey){return false}if(fK.altKey){fJ="Alt-"+fJ}if(bC?fK.metaKey:fK.ctrlKey){fJ="Ctrl-"+fJ}if(bC?fK.ctrlKey:fK.metaKey){fJ="Cmd-"+fJ}if(!fL&&fK.shiftKey){fJ="Shift-"+fJ}return fJ};I.fromTextArea=function(fQ,fR){if(!fR){fR={}}fR.value=fQ.value;if(!fR.tabindex&&fQ.tabindex){fR.tabindex=fQ.tabindex}if(!fR.placeholder&&fQ.placeholder){fR.placeholder=fQ.placeholder}if(fR.autofocus==null){var fJ=dn();fR.autofocus=fJ==fQ||fQ.getAttribute("autofocus")!=null&&fJ==document.body}function fN(){fQ.value=fP.getValue()}if(fQ.form){bJ(fQ.form,"submit",fN);if(!fR.leaveSubmitMethodAlone){var fK=fQ.form,fO=fK.submit;try{var fM=fK.submit=function(){fN();fK.submit=fO;fK.submit();fK.submit=fM}}catch(fL){}}}fQ.style.display="none";var fP=I(function(fS){fQ.parentNode.insertBefore(fS,fQ.nextSibling)},fR);fP.save=fN;fP.getTextArea=function(){return fQ};fP.toTextArea=function(){fN();fQ.parentNode.removeChild(fP.getWrapperElement());fQ.style.display="";if(fQ.form){dL(fQ.form,"submit",fN);if(typeof fQ.form.submit=="function"){fQ.form.submit=fO}}};return fP};var es=I.StringStream=function(fJ,fK){this.pos=this.start=0;this.string=fJ;this.tabSize=fK||8;this.lastColumnPos=this.lastColumnValue=0;this.lineStart=0};es.prototype={eol:function(){return this.pos>=this.string.length},sol:function(){return this.pos==this.lineStart},peek:function(){return this.string.charAt(this.pos)||undefined},next:function(){if(this.pos<this.string.length){return this.string.charAt(this.pos++)}},eat:function(fJ){var fL=this.string.charAt(this.pos);if(typeof fJ=="string"){var fK=fL==fJ}else{var fK=fL&&(fJ.test?fJ.test(fL):fJ(fL))}if(fK){++this.pos;return fL}},eatWhile:function(fJ){var fK=this.pos;while(this.eat(fJ)){}return this.pos>fK},eatSpace:function(){var fJ=this.pos;while(/[\s\u00a0]/.test(this.string.charAt(this.pos))){++this.pos}return this.pos>fJ},skipToEnd:function(){this.pos=this.string.length},skipTo:function(fJ){var fK=this.string.indexOf(fJ,this.pos);if(fK>-1){this.pos=fK;return true}},backUp:function(fJ){this.pos-=fJ},column:function(){if(this.lastColumnPos<this.start){this.lastColumnValue=bF(this.string,this.start,this.tabSize,this.lastColumnPos,this.lastColumnValue);this.lastColumnPos=this.start}return this.lastColumnValue-(this.lineStart?bF(this.string,this.lineStart,this.tabSize):0)},indentation:function(){return bF(this.string,null,this.tabSize)-(this.lineStart?bF(this.string,this.lineStart,this.tabSize):0)},match:function(fN,fK,fJ){if(typeof fN=="string"){var fO=function(fP){return fJ?fP.toLowerCase():fP};var fM=this.string.substr(this.pos,fN.length);if(fO(fM)==fO(fN)){if(fK!==false){this.pos+=fN.length}return true}}else{var fL=this.string.slice(this.pos).match(fN);if(fL&&fL.index>0){return null}if(fL&&fK!==false){this.pos+=fL[0].length}return fL}},current:function(){return this.string.slice(this.start,this.pos)},hideFirstChars:function(fK,fJ){this.lineStart+=fK;try{return fJ()}finally{this.lineStart-=fK}}};var P=I.TextMarker=function(fK,fJ){this.lines=[];this.type=fJ;this.doc=fK};bl(P);P.prototype.clear=function(){if(this.explicitlyCleared){return}var fQ=this.doc.cm,fK=fQ&&!fQ.curOp;if(fK){cs(fQ)}if(eO(this,"clear")){var fR=this.find();if(fR){ac(this,"clear",fR.from,fR.to)}}var fL=null,fO=null;for(var fM=0;fM<this.lines.length;++fM){var fS=this.lines[fM];var fP=eF(fS.markedSpans,this);if(fQ&&!this.collapsed){R(fQ,bz(fS),"text")}else{if(fQ){if(fP.to!=null){fO=bz(fS)}if(fP.from!=null){fL=bz(fS)}}}fS.markedSpans=eh(fS.markedSpans,fP);if(fP.from==null&&this.collapsed&&!e3(this.doc,fS)&&fQ){fw(fS,aL(fQ.display))}}if(fQ&&this.collapsed&&!fQ.options.lineWrapping){for(var fM=0;fM<this.lines.length;++fM){var fJ=z(this.lines[fM]),fN=dU(fJ);if(fN>fQ.display.maxLineLength){fQ.display.maxLine=fJ;fQ.display.maxLineLength=fN;fQ.display.maxLineChanged=true}}}if(fL!=null&&fQ&&this.collapsed){af(fQ,fL,fO+1)}this.lines.length=0;this.explicitlyCleared=true;if(this.atomic&&this.doc.cantEdit){this.doc.cantEdit=false;if(fQ){d6(fQ.doc)}}if(fQ){ac(fQ,"markerCleared",fQ,this)}if(fK){aj(fQ)}if(this.parent){this.parent.clear()}};P.prototype.find=function(fM,fK){if(fM==null&&this.type=="bookmark"){fM=1}var fP,fO;for(var fL=0;fL<this.lines.length;++fL){var fJ=this.lines[fL];var fN=eF(fJ.markedSpans,this);if(fN.from!=null){fP=W(fK?fJ:bz(fJ),fN.from);if(fM==-1){return fP}}if(fN.to!=null){fO=W(fK?fJ:bz(fJ),fN.to);if(fM==1){return fO}}}return fP&&{from:fP,to:fO}};P.prototype.changed=function(){var fL=this.find(-1,true),fK=this,fJ=this.doc.cm;if(!fL||!fJ){return}cv(fJ,function(){var fN=fL.line,fO=bz(fL.line);var fM=eH(fJ,fO);if(fM){ap(fM);fJ.curOp.selectionChanged=fJ.curOp.forceUpdate=true}fJ.curOp.updateMaxLine=true;if(!e3(fK.doc,fN)&&fK.height!=null){var fQ=fK.height;fK.height=null;var fP=cD(fK)-fQ;if(fP){fw(fN,fN.height+fP)}}})};P.prototype.attachLine=function(fJ){if(!this.lines.length&&this.doc.cm){var fK=this.doc.cm.curOp;if(!fK.maybeHiddenMarkers||cX(fK.maybeHiddenMarkers,this)==-1){(fK.maybeUnhiddenMarkers||(fK.maybeUnhiddenMarkers=[])).push(this)}}this.lines.push(fJ)};P.prototype.detachLine=function(fJ){this.lines.splice(cX(this.lines,fJ),1);if(!this.lines.length&&this.doc.cm){var fK=this.doc.cm.curOp;(fK.maybeHiddenMarkers||(fK.maybeHiddenMarkers=[])).push(this)}};var aT=0;function ef(fR,fP,fQ,fT,fN){if(fT&&fT.shared){return O(fR,fP,fQ,fT,fN)}if(fR.cm&&!fR.cm.curOp){return cH(fR.cm,ef)(fR,fP,fQ,fT,fN)}var fM=new P(fR,fN),fS=b2(fP,fQ);if(fT){aD(fT,fM,false)}if(fS>0||fS==0&&fM.clearWhenEmpty!==false){return fM}if(fM.replacedWith){fM.collapsed=true;fM.widgetNode=fs("span",[fM.replacedWith],"CodeMirror-widget");if(!fT.handleMouseEvents){fM.widgetNode.ignoreEvents=true}if(fT.insertLeft){fM.widgetNode.insertLeft=true}}if(fM.collapsed){if(A(fR,fP.line,fP,fQ,fM)||fP.line!=fQ.line&&A(fR,fQ.line,fP,fQ,fM)){throw new Error("Inserting collapsed marker partially overlapping an existing one")}aV=true}if(fM.addToHistory){fi(fR,{from:fP,to:fQ,origin:"markText"},fR.sel,NaN)}var fK=fP.line,fO=fR.cm,fJ;fR.iter(fK,fQ.line+1,function(fU){if(fO&&fM.collapsed&&!fO.options.lineWrapping&&z(fU)==fO.display.maxLine){fJ=true}if(fM.collapsed&&fK!=fP.line){fw(fU,0)}b0(fU,new dQ(fM,fK==fP.line?fP.ch:null,fK==fQ.line?fQ.ch:null));++fK});if(fM.collapsed){fR.iter(fP.line,fQ.line+1,function(fU){if(e3(fR,fU)){fw(fU,0)}})}if(fM.clearOnEnter){bJ(fM,"beforeCursorEnter",function(){fM.clear()})}if(fM.readOnly){fD=true;if(fR.history.done.length||fR.history.undone.length){fR.clearHistory()}}if(fM.collapsed){fM.id=++aT;fM.atomic=true}if(fO){if(fJ){fO.curOp.updateMaxLine=true}if(fM.collapsed){af(fO,fP.line,fQ.line+1)}else{if(fM.className||fM.title||fM.startStyle||fM.endStyle){for(var fL=fP.line;fL<=fQ.line;fL++){R(fO,fL,"text")}}}if(fM.atomic){d6(fO.doc)}ac(fO,"markerAdded",fO,fM)}return fM}var y=I.SharedTextMarker=function(fL,fK){this.markers=fL;this.primary=fK;for(var fJ=0;fJ<fL.length;++fJ){fL[fJ].parent=this}};bl(y);y.prototype.clear=function(){if(this.explicitlyCleared){return}this.explicitlyCleared=true;for(var fJ=0;fJ<this.markers.length;++fJ){this.markers[fJ].clear()}ac(this,"clear")};y.prototype.find=function(fK,fJ){return this.primary.find(fK,fJ)};function O(fN,fQ,fP,fJ,fL){fJ=aD(fJ);fJ.shared=false;var fO=[ef(fN,fQ,fP,fJ,fL)],fK=fO[0];var fM=fJ.widgetNode;dG(fN,function(fS){if(fM){fJ.widgetNode=fM.cloneNode(true)}fO.push(ef(fS,ff(fS,fQ),ff(fS,fP),fJ,fL));for(var fR=0;fR<fS.linked.length;++fR){if(fS.linked[fR].isParent){return}}fK=fd(fO)});return new y(fO,fK)}function eo(fJ){return fJ.findMarks(W(fJ.first,0),fJ.clipPos(W(fJ.lastLine())),function(fK){return fK.parent})}function dg(fO,fP){for(var fM=0;fM<fP.length;fM++){var fK=fP[fM],fQ=fK.find();var fJ=fO.clipPos(fQ.from),fN=fO.clipPos(fQ.to);if(b2(fJ,fN)){var fL=ef(fO,fJ,fN,fK.primary,fK.primary.type);fK.markers.push(fL);fL.parent=fK}}}function dW(fM){for(var fL=0;fL<fM.length;fL++){var fJ=fM[fL],fO=[fJ.primary.doc];dG(fJ.primary.doc,function(fP){fO.push(fP)});for(var fK=0;fK<fJ.markers.length;fK++){var fN=fJ.markers[fK];if(cX(fO,fN.doc)==-1){fN.parent=null;fJ.markers.splice(fK--,1)}}}}function dQ(fJ,fL,fK){this.marker=fJ;this.from=fL;this.to=fK}function eF(fL,fJ){if(fL){for(var fK=0;fK<fL.length;++fK){var fM=fL[fK];if(fM.marker==fJ){return fM}}}}function eh(fK,fL){for(var fM,fJ=0;fJ<fK.length;++fJ){if(fK[fJ]!=fL){(fM||(fM=[])).push(fK[fJ])}}return fM}function b0(fJ,fK){fJ.markedSpans=fJ.markedSpans?fJ.markedSpans.concat([fK]):[fK];fK.marker.attachLine(fJ)}function aG(fK,fL,fP){if(fK){for(var fN=0,fQ;fN<fK.length;++fN){var fR=fK[fN],fO=fR.marker;var fJ=fR.from==null||(fO.inclusiveLeft?fR.from<=fL:fR.from<fL);if(fJ||fR.from==fL&&fO.type=="bookmark"&&(!fP||!fR.marker.insertLeft)){var fM=fR.to==null||(fO.inclusiveRight?fR.to>=fL:fR.to>fL);(fQ||(fQ=[])).push(new dQ(fO,fR.from,fM?null:fR.to))}}}return fQ}function aw(fK,fM,fP){if(fK){for(var fN=0,fQ;fN<fK.length;++fN){var fR=fK[fN],fO=fR.marker;var fL=fR.to==null||(fO.inclusiveRight?fR.to>=fM:fR.to>fM);if(fL||fR.from==fM&&fO.type=="bookmark"&&(!fP||fR.marker.insertLeft)){var fJ=fR.from==null||(fO.inclusiveLeft?fR.from<=fM:fR.from<fM);(fQ||(fQ=[])).push(new dQ(fO,fJ?null:fR.from-fM,fR.to==null?null:fR.to-fM))}}}return fQ}function dS(fV,fS){var fR=bT(fV,fS.from.line)&&eL(fV,fS.from.line).markedSpans;var fY=bT(fV,fS.to.line)&&eL(fV,fS.to.line).markedSpans;if(!fR&&!fY){return null}var fK=fS.from.ch,fN=fS.to.ch,fQ=b2(fS.from,fS.to)==0;var fP=aG(fR,fK,fQ);var fX=aw(fY,fN,fQ);var fW=fS.text.length==1,fL=fd(fS.text).length+(fW?fK:0);if(fP){for(var fM=0;fM<fP.length;++fM){var fU=fP[fM];if(fU.to==null){var fZ=eF(fX,fU.marker);if(!fZ){fU.to=fK}else{if(fW){fU.to=fZ.to==null?null:fZ.to+fL}}}}}if(fX){for(var fM=0;fM<fX.length;++fM){var fU=fX[fM];if(fU.to!=null){fU.to+=fL}if(fU.from==null){var fZ=eF(fP,fU.marker);if(!fZ){fU.from=fL;if(fW){(fP||(fP=[])).push(fU)}}}else{fU.from+=fL;if(fW){(fP||(fP=[])).push(fU)}}}}if(fP){fP=r(fP)}if(fX&&fX!=fP){fX=r(fX)}var fO=[fP];if(!fW){var fT=fS.text.length-2,fJ;if(fT>0&&fP){for(var fM=0;fM<fP.length;++fM){if(fP[fM].to==null){(fJ||(fJ=[])).push(new dQ(fP[fM].marker,null,null))}}}for(var fM=0;fM<fT;++fM){fO.push(fJ)}fO.push(fX)}return fO}function r(fK){for(var fJ=0;fJ<fK.length;++fJ){var fL=fK[fJ];if(fL.from!=null&&fL.from==fL.to&&fL.marker.clearWhenEmpty!==false){fK.splice(fJ--,1)}}if(!fK.length){return null}return fK}function dI(fR,fP){var fJ=bP(fR,fP);var fS=dS(fR,fP);if(!fJ){return fS}if(!fS){return fJ}for(var fM=0;fM<fJ.length;++fM){var fN=fJ[fM],fO=fS[fM];if(fN&&fO){spans:for(var fL=0;fL<fO.length;++fL){var fQ=fO[fL];for(var fK=0;fK<fN.length;++fK){if(fN[fK].marker==fQ.marker){continue spans}}fN.push(fQ)}}else{if(fO){fJ[fM]=fO}}}return fJ}function cr(fV,fT,fU){var fN=null;fV.iter(fT.line,fU.line+1,function(fW){if(fW.markedSpans){for(var fX=0;fX<fW.markedSpans.length;++fX){var fY=fW.markedSpans[fX].marker;if(fY.readOnly&&(!fN||cX(fN,fY)==-1)){(fN||(fN=[])).push(fY)}}}});if(!fN){return null}var fO=[{from:fT,to:fU}];for(var fP=0;fP<fN.length;++fP){var fQ=fN[fP],fL=fQ.find(0);for(var fM=0;fM<fO.length;++fM){var fK=fO[fM];if(b2(fK.to,fL.from)<0||b2(fK.from,fL.to)>0){continue}var fS=[fM,1],fJ=b2(fK.from,fL.from),fR=b2(fK.to,fL.to);if(fJ<0||!fQ.inclusiveLeft&&!fJ){fS.push({from:fK.from,to:fL.from})}if(fR>0||!fQ.inclusiveRight&&!fR){fS.push({from:fL.to,to:fK.to})}fO.splice.apply(fO,fS);fM+=fS.length-1}}return fO}function fz(fJ){var fL=fJ.markedSpans;if(!fL){return}for(var fK=0;fK<fL.length;++fK){fL[fK].marker.detachLine(fJ)}fJ.markedSpans=null}function cI(fJ,fL){if(!fL){return}for(var fK=0;fK<fL.length;++fK){fL[fK].marker.attachLine(fJ)}fJ.markedSpans=fL}function w(fJ){return fJ.inclusiveLeft?-1:0}function bI(fJ){return fJ.inclusiveRight?1:0}function dq(fM,fK){var fO=fM.lines.length-fK.lines.length;if(fO!=0){return fO}var fL=fM.find(),fP=fK.find();var fJ=b2(fL.from,fP.from)||w(fM)-w(fK);if(fJ){return -fJ}var fN=b2(fL.to,fP.to)||bI(fM)-bI(fK);if(fN){return fN}return fK.id-fM.id}function aU(fK,fO){var fJ=aV&&fK.markedSpans,fN;if(fJ){for(var fM,fL=0;fL<fJ.length;++fL){fM=fJ[fL];if(fM.marker.collapsed&&(fO?fM.from:fM.to)==null&&(!fN||dq(fN,fM.marker)<0)){fN=fM.marker}}}return fN}function en(fJ){return aU(fJ,true)}function d3(fJ){return aU(fJ,false)}function A(fR,fL,fP,fQ,fN){var fU=eL(fR,fL);var fJ=aV&&fU.markedSpans;if(fJ){for(var fM=0;fM<fJ.length;++fM){var fK=fJ[fM];if(!fK.marker.collapsed){continue}var fT=fK.marker.find(0);var fS=b2(fT.from,fP)||w(fK.marker)-w(fN);var fO=b2(fT.to,fQ)||bI(fK.marker)-bI(fN);if(fS>=0&&fO<=0||fS<=0&&fO>=0){continue}if(fS<=0&&(b2(fT.to,fP)||bI(fK.marker)-w(fN))>0||fS>=0&&(b2(fT.from,fQ)||w(fK.marker)-bI(fN))<0){return true}}}}function z(fK){var fJ;while(fJ=en(fK)){fK=fJ.find(-1,true).line}return fK}function i(fL){var fJ,fK;while(fJ=d3(fL)){fL=fJ.find(1,true).line;(fK||(fK=[])).push(fL)}return fK}function aK(fM,fK){var fJ=eL(fM,fK),fL=z(fJ);if(fJ==fL){return fK}return bz(fL)}function dC(fM,fL){if(fL>fM.lastLine()){return fL}var fK=eL(fM,fL),fJ;if(!e3(fM,fK)){return fL}while(fJ=d3(fK)){fK=fJ.find(1,true).line}return bz(fK)+1}function e3(fN,fK){var fJ=aV&&fK.markedSpans;if(fJ){for(var fM,fL=0;fL<fJ.length;++fL){fM=fJ[fL];if(!fM.marker.collapsed){continue}if(fM.from==null){return true}if(fM.marker.widgetNode){continue}if(fM.from==0&&fM.marker.inclusiveLeft&&T(fN,fK,fM)){return true}}}}function T(fO,fK,fM){if(fM.to==null){var fJ=fM.marker.find(1,true);return T(fO,fJ.line,eF(fJ.line.markedSpans,fM.marker))}if(fM.marker.inclusiveRight&&fM.to==fK.text.length){return true}for(var fN,fL=0;fL<fK.markedSpans.length;++fL){fN=fK.markedSpans[fL];if(fN.marker.collapsed&&!fN.marker.widgetNode&&fN.from==fM.to&&(fN.to==null||fN.to!=fM.from)&&(fN.marker.inclusiveLeft||fM.marker.inclusiveRight)&&T(fO,fK,fN)){return true}}}var dd=I.LineWidget=function(fJ,fM,fK){if(fK){for(var fL in fK){if(fK.hasOwnProperty(fL)){this[fL]=fK[fL]}}}this.cm=fJ;this.node=fM};bl(dd);function dz(fJ,fK,fL){if(by(fK)<((fJ.curOp&&fJ.curOp.scrollTop)||fJ.doc.scrollTop)){cu(fJ,null,fL)}}dd.prototype.clear=function(){var fK=this.cm,fM=this.line.widgets,fL=this.line,fO=bz(fL);if(fO==null||!fM){return}for(var fN=0;fN<fM.length;++fN){if(fM[fN]==this){fM.splice(fN--,1)}}if(!fM.length){fL.widgets=null}var fJ=cD(this);cv(fK,function(){dz(fK,fL,-fJ);R(fK,fO,"widget");fw(fL,Math.max(0,fL.height-fJ))})};dd.prototype.changed=function(){var fK=this.height,fJ=this.cm,fL=this.line;this.height=null;var fM=cD(this)-fK;if(!fM){return}cv(fJ,function(){fJ.curOp.forceUpdate=true;dz(fJ,fL,fM);fw(fL,fL.height+fM)})};function cD(fJ){if(fJ.height!=null){return fJ.height}if(!fB(document.body,fJ.node)){bD(fJ.cm.display.measure,fs("div",[fJ.node],null,"position: relative"))}return fJ.height=fJ.node.offsetHeight}function bt(fJ,fN,fL,fK){var fM=new dd(fJ,fL,fK);if(fM.noHScroll){fJ.display.alignWidgets=true}d7(fJ,fN,"widget",function(fP){var fQ=fP.widgets||(fP.widgets=[]);if(fM.insertAt==null){fQ.push(fM)}else{fQ.splice(Math.min(fQ.length-1,Math.max(0,fM.insertAt)),0,fM)}fM.line=fP;if(!e3(fJ.doc,fP)){var fO=by(fP)<fJ.doc.scrollTop;fw(fP,fP.height+cD(fM));if(fO){cu(fJ,null,fM.height)}fJ.curOp.forceUpdate=true}return true});return fM}var fy=I.Line=function(fL,fK,fJ){this.text=fL;cI(this,fK);this.height=fJ?fJ(this):1};bl(fy);fy.prototype.lineNo=function(){return bz(this)};function dV(fK,fN,fL,fJ){fK.text=fN;if(fK.stateAfter){fK.stateAfter=null}if(fK.styles){fK.styles=null}if(fK.order!=null){fK.order=null}fz(fK);cI(fK,fL);var fM=fJ?fJ(fK):1;if(fM!=fK.height){fw(fK,fM)}}function bn(fJ){fJ.parent=null;fz(fJ)}function cY(fL,fK){if(fL){for(;;){var fJ=fL.match(/(?:^|\s+)line-(background-)?(\S+)/);if(!fJ){break}fL=fL.slice(0,fJ.index)+fL.slice(fJ.index+fJ[0].length);var fM=fJ[1]?"bgClass":"textClass";if(fK[fM]==null){fK[fM]=fJ[2]}else{if(!(new RegExp("(?:^|s)"+fJ[2]+"(?:$|s)")).test(fK[fM])){fK[fM]+=" "+fJ[2]}}}}return fL}function eX(fL,fK){if(fL.blankLine){return fL.blankLine(fK)}if(!fL.innerMode){return}var fJ=I.innerMode(fL,fK);if(fJ.mode.blankLine){return fJ.mode.blankLine(fJ.state)}}function eb(fM,fL,fK){var fJ=fM.token(fL,fK);if(fL.pos<=fL.start){throw new Error("Mode "+fM.name+" failed to advance stream.")}return fJ}function x(fT,fV,fO,fK,fP,fM,fN){var fL=fO.flattenSpans;if(fL==null){fL=fT.options.flattenSpans}var fR=0,fQ=null;var fU=new es(fV,fT.options.tabSize),fJ;if(fV==""){cY(eX(fO,fK),fM)}while(!fU.eol()){if(fU.pos>fT.options.maxHighlightLength){fL=false;if(fN){c8(fT,fV,fK,fU.pos)}fU.pos=fV.length;fJ=null}else{fJ=cY(eb(fO,fU,fK),fM)}if(fT.options.addModeClass){var fW=I.innerMode(fO,fK).mode.name;if(fW){fJ="m-"+(fJ?fW+" "+fJ:fW)}}if(!fL||fQ!=fJ){if(fR<fU.start){fP(fU.start,fQ)}fR=fU.start;fQ=fJ}fU.start=fU.pos}while(fR<fU.pos){var fS=Math.min(fU.pos,fR+50000);fP(fS,fQ);fR=fS}}function e6(fQ,fS,fJ,fN){var fR=[fQ.state.modeGen],fM={};x(fQ,fS.text,fQ.doc.mode,fJ,function(fT,fU){fR.push(fT,fU)},fM,fN);for(var fK=0;fK<fQ.state.overlays.length;++fK){var fO=fQ.state.overlays[fK],fP=1,fL=0;x(fQ,fS.text,fO.mode,true,function(fT,fV){var fX=fP;while(fL<fT){var fU=fR[fP];if(fU>fT){fR.splice(fP,1,fT,fR[fP+1],fU)}fP+=2;fL=Math.min(fT,fU)}if(!fV){return}if(fO.opaque){fR.splice(fX,fP-fX,fT,"cm-overlay "+fV);fP=fX+2}else{for(;fX<fP;fX+=2){var fW=fR[fX+1];fR[fX+1]=(fW?fW+" ":"")+"cm-overlay "+fV}}},fM)}return{styles:fR,classes:fM.bgClass||fM.textClass?fM:null}}function cM(fK,fL){if(!fL.styles||fL.styles[0]!=fK.state.modeGen){var fJ=e6(fK,fL,fL.stateAfter=dc(fK,bz(fL)));fL.styles=fJ.styles;if(fJ.classes){fL.styleClasses=fJ.classes}else{if(fL.styleClasses){fL.styleClasses=null}}}return fL.styles}function c8(fJ,fO,fL,fK){var fN=fJ.doc.mode;var fM=new es(fO,fJ.options.tabSize);fM.start=fM.pos=fK||0;if(fO==""){eX(fN,fL)}while(!fM.eol()&&fM.pos<=fJ.options.maxHighlightLength){eb(fN,fM,fL);fM.start=fM.pos}}var dv={},bN={};function ev(fL,fK){if(!fL||/^\s*$/.test(fL)){return null}var fJ=fK.addModeClass?bN:dv;return fJ[fL]||(fJ[fL]=fL.replace(/\S+/g,"cm-$&"))}function er(fK,fO){var fP=fs("span",null,null,cF?"padding-right: .1px":null);var fM={pre:fs("pre",[fP]),content:fP,col:0,pos:0,cm:fK};fO.measure={};for(var fN=0;fN<=(fO.rest?fO.rest.length:0);fN++){var fL=fN?fO.rest[fN-1]:fO.line,fJ;fM.pos=0;fM.addToken=u;if((dj||cF)&&fK.getOption("lineWrapping")){fM.addToken=fb(fM.addToken)}if(bA(fK.display.measure)&&(fJ=a(fL))){fM.addToken=U(fM.addToken,fJ)}fM.map=[];bc(fL,fM,cM(fK,fL));if(fL.styleClasses){if(fL.styleClasses.bgClass){fM.bgClass=fn(fL.styleClasses.bgClass,fM.bgClass||"")}if(fL.styleClasses.textClass){fM.textClass=fn(fL.styleClasses.textClass,fM.textClass||"")}}if(fM.map.length==0){fM.map.push(0,0,fM.content.appendChild(ba(fK.display.measure)))}if(fN==0){fO.measure.map=fM.map;fO.measure.cache={}}else{(fO.measure.maps||(fO.measure.maps=[])).push(fM.map);(fO.measure.caches||(fO.measure.caches=[])).push({})}}ay(fK,"renderLine",fK,fO.line,fM.pre);return fM}function eJ(fK){var fJ=fs("span","\u2022","cm-invalidchar");fJ.title="\\u"+fK.charCodeAt(0).toString(16);return fJ}function u(fO,fY,fJ,fM,fZ,fX){if(!fY){return}var fT=fO.cm.options.specialChars,fS=false;if(!fT.test(fY)){fO.col+=fY.length;var fR=document.createTextNode(fY);fO.map.push(fO.pos,fO.pos+fY.length,fR);if(bV){fS=true}fO.pos+=fY.length}else{var fR=document.createDocumentFragment(),fV=0;while(true){fT.lastIndex=fV;var fK=fT.exec(fY);var fQ=fK?fK.index-fV:fY.length-fV;if(fQ){var fN=document.createTextNode(fY.slice(fV,fV+fQ));if(bV){fR.appendChild(fs("span",[fN]))}else{fR.appendChild(fN)}fO.map.push(fO.pos,fO.pos+fQ,fN);fO.col+=fQ;fO.pos+=fQ}if(!fK){break}fV+=fQ+1;if(fK[0]=="\t"){var fP=fO.cm.options.tabSize,fU=fP-fO.col%fP;var fN=fR.appendChild(fs("span",cc(fU),"cm-tab"));fO.col+=fU}else{var fN=fO.cm.options.specialCharPlaceholder(fK[0]);if(bV){fR.appendChild(fs("span",[fN]))}else{fR.appendChild(fN)}fO.col+=1}fO.map.push(fO.pos,fO.pos+1,fN);fO.pos++}}if(fJ||fM||fZ||fS){var fW=fJ||"";if(fM){fW+=fM}if(fZ){fW+=fZ}var fL=fs("span",[fR],fW);if(fX){fL.title=fX}return fO.content.appendChild(fL)}fO.content.appendChild(fR)}function fb(fJ){function fK(fL){var fM=" ";for(var fN=0;fN<fL.length-2;++fN){fM+=fN%2?" ":"\u00a0"}fM+=" ";return fM}return function(fM,fQ,fN,fL,fP,fO){fJ(fM,fQ.replace(/ {3,}/g,fK),fN,fL,fP,fO)}}function U(fK,fJ){return function(fR,fT,fL,fP,fU,fS){fL=fL?fL+" cm-force-border":"cm-force-border";var fM=fR.pos,fO=fM+fT.length;for(;;){for(var fQ=0;fQ<fJ.length;fQ++){var fN=fJ[fQ];if(fN.to>fM&&fN.from<=fM){break}}if(fN.to>=fO){return fK(fR,fT,fL,fP,fU,fS)}fK(fR,fT.slice(0,fN.to-fM),fL,fP,null,fS);fP=null;fT=fT.slice(fN.to-fM);fM=fN.to}}}function aa(fK,fM,fJ,fL){var fN=!fL&&fJ.widgetNode;if(fN){fK.map.push(fK.pos,fK.pos+fM,fN);fK.content.appendChild(fN)}fK.pos+=fM}function bc(fS,fY,fR){var fO=fS.markedSpans,fQ=fS.text,fW=0;if(!fO){for(var f1=1;f1<fR.length;f1+=2){fY.addToken(fY,fQ.slice(fW,fW=fR[f1]),ev(fR[f1+1],fY.cm.options))}return}var f2=fQ.length,fN=0,f1=1,fU="",f3;var f5=0,fJ,f4,fV,f6,fL;for(;;){if(f5==fN){fJ=f4=fV=f6="";fL=null;f5=Infinity;var fP=[];for(var fZ=0;fZ<fO.length;++fZ){var f0=fO[fZ],fX=f0.marker;if(f0.from<=fN&&(f0.to==null||f0.to>fN)){if(f0.to!=null&&f5>f0.to){f5=f0.to;f4=""}if(fX.className){fJ+=" "+fX.className}if(fX.startStyle&&f0.from==fN){fV+=" "+fX.startStyle}if(fX.endStyle&&f0.to==f5){f4+=" "+fX.endStyle}if(fX.title&&!f6){f6=fX.title}if(fX.collapsed&&(!fL||dq(fL.marker,fX)<0)){fL=f0}}else{if(f0.from>fN&&f5>f0.from){f5=f0.from}}if(fX.type=="bookmark"&&f0.from==fN&&fX.widgetNode){fP.push(fX)}}if(fL&&(fL.from||0)==fN){aa(fY,(fL.to==null?f2+1:fL.to)-fN,fL.marker,fL.from==null);if(fL.to==null){return}}if(!fL&&fP.length){for(var fZ=0;fZ<fP.length;++fZ){aa(fY,0,fP[fZ])}}}if(fN>=f2){break}var fT=Math.min(f2,f5);while(true){if(fU){var fK=fN+fU.length;if(!fL){var fM=fK>fT?fU.slice(0,fT-fN):fU;fY.addToken(fY,fM,f3?f3+fJ:fJ,fV,fN+fM.length==f5?f4:"",f6)}if(fK>=fT){fU=fU.slice(fT-fN);fN=fT;break}fN=fK;fV=""}fU=fQ.slice(fW,fW=fR[f1++]);f3=ev(fR[f1++],fY.cm.options)}}}function ds(fJ,fK){return fK.from.ch==0&&fK.to.ch==0&&fd(fK.text)==""&&(!fJ.cm||fJ.cm.options.wholeLineUpdateBefore)}function e5(fW,fR,fJ,fN){function fX(fZ){return fJ?fJ[fZ]:null}function fK(fZ,f1,f0){dV(fZ,f1,f0,fN);ac(fZ,"change",fZ,fR)}var fU=fR.from,fV=fR.to,fY=fR.text;var fS=eL(fW,fU.line),fT=eL(fW,fV.line);var fQ=fd(fY),fM=fX(fY.length-1),fP=fV.line-fU.line;if(ds(fW,fR)){for(var fL=0,fO=[];fL<fY.length-1;++fL){fO.push(new fy(fY[fL],fX(fL),fN))}fK(fT,fT.text,fM);if(fP){fW.remove(fU.line,fP)}if(fO.length){fW.insert(fU.line,fO)}}else{if(fS==fT){if(fY.length==1){fK(fS,fS.text.slice(0,fU.ch)+fQ+fS.text.slice(fV.ch),fM)}else{for(var fO=[],fL=1;fL<fY.length-1;++fL){fO.push(new fy(fY[fL],fX(fL),fN))}fO.push(new fy(fQ+fS.text.slice(fV.ch),fM,fN));fK(fS,fS.text.slice(0,fU.ch)+fY[0],fX(0));fW.insert(fU.line+1,fO)}}else{if(fY.length==1){fK(fS,fS.text.slice(0,fU.ch)+fY[0]+fT.text.slice(fV.ch),fX(0));fW.remove(fU.line+1,fP)}else{fK(fS,fS.text.slice(0,fU.ch)+fY[0],fX(0));fK(fT,fQ+fT.text.slice(fV.ch),fM);for(var fL=1,fO=[];fL<fY.length-1;++fL){fO.push(new fy(fY[fL],fX(fL),fN))}if(fP>1){fW.remove(fU.line+1,fP-1)}fW.insert(fU.line+1,fO)}}}ac(fW,"change",fW,fR)}function ey(fK){this.lines=fK;this.parent=null;for(var fL=0,fJ=0;fL<fK.length;++fL){fK[fL].parent=this;fJ+=fK[fL].height}this.height=fJ}ey.prototype={chunkSize:function(){return this.lines.length},removeInner:function(fJ,fN){for(var fL=fJ,fM=fJ+fN;fL<fM;++fL){var fK=this.lines[fL];this.height-=fK.height;bn(fK);ac(fK,"delete")}this.lines.splice(fJ,fN)},collapse:function(fJ){fJ.push.apply(fJ,this.lines)},insertInner:function(fK,fL,fJ){this.height+=fJ;this.lines=this.lines.slice(0,fK).concat(fL).concat(this.lines.slice(fK));for(var fM=0;fM<fL.length;++fM){fL[fM].parent=this}},iterN:function(fJ,fM,fL){for(var fK=fJ+fM;fJ<fK;++fJ){if(fL(this.lines[fJ])){return true}}}};function e4(fM){this.children=fM;var fL=0,fJ=0;for(var fK=0;fK<fM.length;++fK){var fN=fM[fK];fL+=fN.chunkSize();fJ+=fN.height;fN.parent=this}this.size=fL;this.height=fJ;this.parent=null}e4.prototype={chunkSize:function(){return this.size},removeInner:function(fJ,fQ){this.size-=fQ;for(var fL=0;fL<this.children.length;++fL){var fP=this.children[fL],fN=fP.chunkSize();if(fJ<fN){var fM=Math.min(fQ,fN-fJ),fO=fP.height;fP.removeInner(fJ,fM);this.height-=fO-fP.height;if(fN==fM){this.children.splice(fL--,1);fP.parent=null}if((fQ-=fM)==0){break}fJ=0}else{fJ-=fN}}if(this.size-fQ<25&&(this.children.length>1||!(this.children[0] instanceof ey))){var fK=[];this.collapse(fK);this.children=[new ey(fK)];this.children[0].parent=this}},collapse:function(fJ){for(var fK=0;fK<this.children.length;++fK){this.children[fK].collapse(fJ)}},insertInner:function(fK,fL,fJ){this.size+=fL.length;this.height+=fJ;for(var fO=0;fO<this.children.length;++fO){var fQ=this.children[fO],fP=fQ.chunkSize();if(fK<=fP){fQ.insertInner(fK,fL,fJ);if(fQ.lines&&fQ.lines.length>50){while(fQ.lines.length>50){var fN=fQ.lines.splice(fQ.lines.length-25,25);var fM=new ey(fN);fQ.height-=fM.height;this.children.splice(fO+1,0,fM);fM.parent=this}this.maybeSpill()}break}fK-=fP}},maybeSpill:function(){if(this.children.length<=10){return}var fM=this;do{var fK=fM.children.splice(fM.children.length-5,5);var fL=new e4(fK);if(!fM.parent){var fN=new e4(fM.children);fN.parent=fM;fM.children=[fN,fL];fM=fN}else{fM.size-=fL.size;fM.height-=fL.height;var fJ=cX(fM.parent.children,fM);fM.parent.children.splice(fJ+1,0,fL)}fL.parent=fM.parent}while(fM.children.length>10);fM.parent.maybeSpill()},iterN:function(fJ,fP,fO){for(var fK=0;fK<this.children.length;++fK){var fN=this.children[fK],fM=fN.chunkSize();if(fJ<fM){var fL=Math.min(fP,fM-fJ);if(fN.iterN(fJ,fL,fO)){return true}if((fP-=fL)==0){break}fJ=0}else{fJ-=fM}}}};var cd=0;var ao=I.Doc=function(fL,fK,fJ){if(!(this instanceof ao)){return new ao(fL,fK,fJ)}if(fJ==null){fJ=0}e4.call(this,[new ey([new fy("",null)])]);this.first=fJ;this.scrollTop=this.scrollLeft=0;this.cantEdit=false;this.cleanGeneration=1;this.frontier=fJ;var fM=W(fJ,0);this.sel=eq(fM);this.history=new fo(null);this.id=++cd;this.modeOption=fK;if(typeof fL=="string"){fL=aO(fL)}e5(this,{from:fM,to:fM,text:fL});bG(this,eq(fM),Y)};ao.prototype=b7(e4.prototype,{constructor:ao,iter:function(fL,fK,fJ){if(fJ){this.iterN(fL-this.first,fK-fL,fJ)}else{this.iterN(this.first,this.first+this.size,fL)}},insert:function(fK,fL){var fJ=0;for(var fM=0;fM<fL.length;++fM){fJ+=fL[fM].height}this.insertInner(fK-this.first,fL,fJ)},remove:function(fJ,fK){this.removeInner(fJ-this.first,fK)},getValue:function(fK){var fJ=aQ(this,this.first,this.first+this.size);if(fK===false){return fJ}return fJ.join(fK||"\n")},setValue:co(function(fK){var fL=W(this.first,0),fJ=this.first+this.size-1;a3(this,{from:fL,to:W(fJ,eL(this,fJ).text.length),text:aO(fK),origin:"setValue"},true);bG(this,eq(fL))}),replaceRange:function(fK,fM,fL,fJ){fM=ff(this,fM);fL=fL?ff(this,fL):fM;aP(this,fK,fM,fL,fJ)},getRange:function(fM,fL,fK){var fJ=fu(this,ff(this,fM),ff(this,fL));if(fK===false){return fJ}return fJ.join(fK||"\n")},getLine:function(fK){var fJ=this.getLineHandle(fK);return fJ&&fJ.text},getLineHandle:function(fJ){if(bT(this,fJ)){return eL(this,fJ)}},getLineNumber:function(fJ){return bz(fJ)},getLineHandleVisualStart:function(fJ){if(typeof fJ=="number"){fJ=eL(this,fJ)}return z(fJ)},lineCount:function(){return this.size},firstLine:function(){return this.first},lastLine:function(){return this.first+this.size-1},clipPos:function(fJ){return ff(this,fJ)},getCursor:function(fL){var fJ=this.sel.primary(),fK;if(fL==null||fL=="head"){fK=fJ.head}else{if(fL=="anchor"){fK=fJ.anchor}else{if(fL=="end"||fL=="to"||fL===false){fK=fJ.to()}else{fK=fJ.from()}}}return fK},listSelections:function(){return this.sel.ranges},somethingSelected:function(){return this.sel.somethingSelected()},setCursor:co(function(fJ,fL,fK){G(this,ff(this,typeof fJ=="number"?W(fJ,fL||0):fJ),null,fK)}),setSelection:co(function(fK,fL,fJ){G(this,ff(this,fK),ff(this,fL||fK),fJ)}),extendSelection:co(function(fL,fJ,fK){fp(this,ff(this,fL),fJ&&ff(this,fJ),fK)}),extendSelections:co(function(fK,fJ){at(this,dy(this,fK,fJ))}),extendSelectionsBy:co(function(fK,fJ){at(this,bE(this.sel.ranges,fK),fJ)}),setSelections:co(function(fJ,fN,fL){if(!fJ.length){return}for(var fM=0,fK=[];fM<fJ.length;fM++){fK[fM]=new dx(ff(this,fJ[fM].anchor),ff(this,fJ[fM].head))}if(fN==null){fN=Math.min(fJ.length-1,this.sel.primIndex)}bG(this,cj(fK,fN),fL)}),addSelection:co(function(fL,fM,fK){var fJ=this.sel.ranges.slice(0);fJ.push(new dx(ff(this,fL),ff(this,fM||fL)));bG(this,cj(fJ,fJ.length-1),fK)}),getSelection:function(fN){var fK=this.sel.ranges,fJ;for(var fL=0;fL<fK.length;fL++){var fM=fu(this,fK[fL].from(),fK[fL].to());fJ=fJ?fJ.concat(fM):fM}if(fN===false){return fJ}else{return fJ.join(fN||"\n")}},getSelections:function(fN){var fM=[],fJ=this.sel.ranges;for(var fK=0;fK<fJ.length;fK++){var fL=fu(this,fJ[fK].from(),fJ[fK].to());if(fN!==false){fL=fL.join(fN||"\n")}fM[fK]=fL}return fM},replaceSelection:function(fL,fN,fJ){var fM=[];for(var fK=0;fK<this.sel.ranges.length;fK++){fM[fK]=fL}this.replaceSelections(fM,fN,fJ||"+input")},replaceSelections:co(function(fO,fQ,fL){var fN=[],fP=this.sel;for(var fM=0;fM<fP.ranges.length;fM++){var fK=fP.ranges[fM];fN[fM]={from:fK.from(),to:fK.to(),text:aO(fO[fM]),origin:fL}}var fJ=fQ&&fQ!="end"&&ad(this,fN,fQ);for(var fM=fN.length-1;fM>=0;fM--){a3(this,fN[fM])}if(fJ){eD(this,fJ)}else{if(this.cm){fc(this.cm)}}}),undo:co(function(){bS(this,"undo")}),redo:co(function(){bS(this,"redo")}),undoSelection:co(function(){bS(this,"undo",true)}),redoSelection:co(function(){bS(this,"redo",true)}),setExtending:function(fJ){this.extend=fJ},getExtending:function(){return this.extend},historySize:function(){var fM=this.history,fJ=0,fL=0;for(var fK=0;fK<fM.done.length;fK++){if(!fM.done[fK].ranges){++fJ}}for(var fK=0;fK<fM.undone.length;fK++){if(!fM.undone[fK].ranges){++fL}}return{undo:fJ,redo:fL}},clearHistory:function(){this.history=new fo(this.history.maxGeneration)},markClean:function(){this.cleanGeneration=this.changeGeneration(true)},changeGeneration:function(fJ){if(fJ){this.history.lastOp=this.history.lastOrigin=null}return this.history.generation},isClean:function(fJ){return this.history.generation==(fJ||this.cleanGeneration)},getHistory:function(){return{done:bB(this.history.done),undone:bB(this.history.undone)}},setHistory:function(fK){var fJ=this.history=new fo(this.history.maxGeneration);fJ.done=bB(fK.done.slice(0),null,true);fJ.undone=bB(fK.undone.slice(0),null,true)},markText:function(fL,fK,fJ){return ef(this,ff(this,fL),ff(this,fK),fJ,"range")},setBookmark:function(fL,fJ){var fK={replacedWith:fJ&&(fJ.nodeType==null?fJ.widget:fJ),insertLeft:fJ&&fJ.insertLeft,clearWhenEmpty:false,shared:fJ&&fJ.shared};fL=ff(this,fL);return ef(this,fL,fL,fK,"bookmark")},findMarksAt:function(fN){fN=ff(this,fN);var fM=[],fK=eL(this,fN.line).markedSpans;if(fK){for(var fJ=0;fJ<fK.length;++fJ){var fL=fK[fJ];if((fL.from==null||fL.from<=fN.ch)&&(fL.to==null||fL.to>=fN.ch)){fM.push(fL.marker.parent||fL.marker)}}}return fM},findMarks:function(fN,fM,fJ){fN=ff(this,fN);fM=ff(this,fM);var fK=[],fL=fN.line;this.iter(fN.line,fM.line+1,function(fO){var fQ=fO.markedSpans;if(fQ){for(var fP=0;fP<fQ.length;fP++){var fR=fQ[fP];if(!(fL==fN.line&&fN.ch>fR.to||fR.from==null&&fL!=fN.line||fL==fM.line&&fR.from>fM.ch)&&(!fJ||fJ(fR.marker))){fK.push(fR.marker.parent||fR.marker)}}}++fL});return fK},getAllMarks:function(){var fJ=[];this.iter(function(fL){var fK=fL.markedSpans;if(fK){for(var fM=0;fM<fK.length;++fM){if(fK[fM].from!=null){fJ.push(fK[fM].marker)}}}});return fJ},posFromIndex:function(fK){var fJ,fL=this.first;this.iter(function(fM){var fN=fM.text.length+1;if(fN>fK){fJ=fK;return true}fK-=fN;++fL});return ff(this,W(fL,fJ))},indexFromPos:function(fK){fK=ff(this,fK);var fJ=fK.ch;if(fK.line<this.first||fK.ch<0){return 0}this.iter(this.first,fK.line,function(fL){fJ+=fL.text.length+1});return fJ},copy:function(fJ){var fK=new ao(aQ(this,this.first,this.first+this.size),this.modeOption,this.first);fK.scrollTop=this.scrollTop;fK.scrollLeft=this.scrollLeft;fK.sel=this.sel;fK.extend=false;if(fJ){fK.history.undoDepth=this.history.undoDepth;fK.setHistory(this.getHistory())}return fK},linkedDoc:function(fJ){if(!fJ){fJ={}}var fM=this.first,fL=this.first+this.size;if(fJ.from!=null&&fJ.from>fM){fM=fJ.from}if(fJ.to!=null&&fJ.to<fL){fL=fJ.to}var fK=new ao(aQ(this,fM,fL),fJ.mode||this.modeOption,fM);if(fJ.sharedHist){fK.history=this.history}(this.linked||(this.linked=[])).push({doc:fK,sharedHist:fJ.sharedHist});fK.linked=[{doc:this,isParent:true,sharedHist:fJ.sharedHist}];dg(fK,eo(this));return fK},unlinkDoc:function(fK){if(fK instanceof I){fK=fK.doc}if(this.linked){for(var fL=0;fL<this.linked.length;++fL){var fM=this.linked[fL];if(fM.doc!=fK){continue}this.linked.splice(fL,1);fK.unlinkDoc(this);dW(eo(this));break}}if(fK.history==this.history){var fJ=[fK.id];dG(fK,function(fN){fJ.push(fN.id)},true);fK.history=new fo(null);fK.history.done=bB(this.history.done,fJ);fK.history.undone=bB(this.history.undone,fJ)}},iterLinkedDocs:function(fJ){dG(this,fJ)},getMode:function(){return this.mode},getEditor:function(){return this.cm}});ao.prototype.eachLine=ao.prototype.iter;var e="iter insert remove copy getEditor".split(" ");for(var bw in ao.prototype){if(ao.prototype.hasOwnProperty(bw)&&cX(e,bw)<0){I.prototype[bw]=(function(fJ){return function(){return fJ.apply(this.doc,arguments)}})(ao.prototype[bw])}}bl(ao);function dG(fM,fL,fK){function fJ(fS,fQ,fO){if(fS.linked){for(var fP=0;fP<fS.linked.length;++fP){var fN=fS.linked[fP];if(fN.doc==fQ){continue}var fR=fO&&fN.sharedHist;if(fK&&!fR){continue}fL(fN.doc,fR);fJ(fN.doc,fS,fR)}}}fJ(fM,null,true)}function dJ(fJ,fK){if(fK.cm){throw new Error("This document is already in use.")}fJ.doc=fK;fK.cm=fJ;X(fJ);be(fJ);if(!fJ.options.lineWrapping){h(fJ)}fJ.options.mode=fK.modeOption;af(fJ)}function eL(fM,fO){fO-=fM.first;if(fO<0||fO>=fM.size){throw new Error("There is no line "+(fO+fM.first)+" in the document.")}for(var fJ=fM;!fJ.lines;){for(var fK=0;;++fK){var fN=fJ.children[fK],fL=fN.chunkSize();if(fO<fL){fJ=fN;break}fO-=fL}}return fJ.lines[fO]}function fu(fL,fN,fJ){var fK=[],fM=fN.line;fL.iter(fN.line,fJ.line+1,function(fO){var fP=fO.text;if(fM==fJ.line){fP=fP.slice(0,fJ.ch)}if(fM==fN.line){fP=fP.slice(fN.ch)}fK.push(fP);++fM});return fK}function aQ(fK,fM,fL){var fJ=[];fK.iter(fM,fL,function(fN){fJ.push(fN.text)});return fJ}function fw(fK,fJ){var fL=fJ-fK.height;if(fL){for(var fM=fK;fM;fM=fM.parent){fM.height+=fL}}}function bz(fJ){if(fJ.parent==null){return null}var fN=fJ.parent,fM=cX(fN.lines,fJ);for(var fK=fN.parent;fK;fN=fK,fK=fK.parent){for(var fL=0;;++fL){if(fK.children[fL]==fN){break}fM+=fK.children[fL].chunkSize()}}return fM+fN.first}function bs(fL,fO){var fQ=fL.first;outer:do{for(var fM=0;fM<fL.children.length;++fM){var fP=fL.children[fM],fN=fP.height;if(fO<fN){fL=fP;continue outer}fO-=fN;fQ+=fP.chunkSize()}return fQ}while(!fL.lines);for(var fM=0;fM<fL.lines.length;++fM){var fK=fL.lines[fM],fJ=fK.height;if(fO<fJ){break}fO-=fJ}return fQ+fM}function by(fL){fL=z(fL);var fN=0,fK=fL.parent;for(var fM=0;fM<fK.lines.length;++fM){var fJ=fK.lines[fM];if(fJ==fL){break}else{fN+=fJ.height}}for(var fO=fK.parent;fO;fK=fO,fO=fK.parent){for(var fM=0;fM<fO.children.length;++fM){var fP=fO.children[fM];if(fP==fK){break}else{fN+=fP.height}}}return fN}function a(fK){var fJ=fK.order;if(fJ==null){fJ=fK.order=a4(fK.text)}return fJ}function fo(fJ){this.done=[];this.undone=[];this.undoDepth=Infinity;this.lastModTime=this.lastSelTime=0;this.lastOp=null;this.lastOrigin=this.lastSelOrigin=null;this.generation=this.maxGeneration=fJ||1}function c6(fJ,fL){var fK={from:b6(fL.from),to:cC(fL),text:fu(fJ,fL.from,fL.to)};bK(fJ,fK,fL.from.line,fL.to.line+1);dG(fJ,function(fM){bK(fM,fK,fL.from.line,fL.to.line+1)},true);return fK}function e9(fK){while(fK.length){var fJ=fd(fK);if(fJ.ranges){fK.pop()}else{break}}}function em(fK,fJ){if(fJ){e9(fK.done);return fd(fK.done)}else{if(fK.done.length&&!fd(fK.done).ranges){return fd(fK.done)}else{if(fK.done.length>1&&!fK.done[fK.done.length-2].ranges){fK.done.pop();return fd(fK.done)}}}}function fi(fP,fN,fJ,fM){var fL=fP.history;fL.undone.length=0;var fK=+new Date,fQ;if((fL.lastOp==fM||fL.lastOrigin==fN.origin&&fN.origin&&((fN.origin.charAt(0)=="+"&&fP.cm&&fL.lastModTime>fK-fP.cm.options.historyEventDelay)||fN.origin.charAt(0)=="*"))&&(fQ=em(fL,fL.lastOp==fM))){var fR=fd(fQ.changes);if(b2(fN.from,fN.to)==0&&b2(fN.from,fR.to)==0){fR.to=cC(fN)}else{fQ.changes.push(c6(fP,fN))}}else{var fO=fd(fL.done);if(!fO||!fO.ranges){cw(fP.sel,fL.done)}fQ={changes:[c6(fP,fN)],generation:fL.generation};fL.done.push(fQ);while(fL.done.length>fL.undoDepth){fL.done.shift();if(!fL.done[0].ranges){fL.done.shift()}}}fL.done.push(fJ);fL.generation=++fL.maxGeneration;fL.lastModTime=fL.lastSelTime=fK;fL.lastOp=fM;fL.lastOrigin=fL.lastSelOrigin=fN.origin;if(!fR){ay(fP,"historyAdded")}}function bm(fN,fJ,fL,fM){var fK=fJ.charAt(0);return fK=="*"||fK=="+"&&fL.ranges.length==fM.ranges.length&&fL.somethingSelected()==fM.somethingSelected()&&new Date-fN.history.lastSelTime<=(fN.cm?fN.cm.options.historyEventDelay:500)}function fC(fO,fM,fJ,fL){var fN=fO.history,fK=fL&&fL.origin;if(fJ==fN.lastOp||(fK&&fN.lastSelOrigin==fK&&(fN.lastModTime==fN.lastSelTime&&fN.lastOrigin==fK||bm(fO,fK,fd(fN.done),fM)))){fN.done[fN.done.length-1]=fM}else{cw(fM,fN.done)}fN.lastSelTime=+new Date;fN.lastSelOrigin=fK;fN.lastOp=fJ;if(fL&&fL.clearRedo!==false){e9(fN.undone)}}function cw(fK,fJ){var fL=fd(fJ);if(!(fL&&fL.ranges&&fL.equals(fK))){fJ.push(fK)}}function bK(fK,fO,fN,fM){var fJ=fO["spans_"+fK.id],fL=0;fK.iter(Math.max(fK.first,fN),Math.min(fK.first+fK.size,fM),function(fP){if(fP.markedSpans){(fJ||(fJ=fO["spans_"+fK.id]={}))[fL]=fP.markedSpans}++fL})}function a8(fL){if(!fL){return null}for(var fK=0,fJ;fK<fL.length;++fK){if(fL[fK].marker.explicitlyCleared){if(!fJ){fJ=fL.slice(0,fK)}}else{if(fJ){fJ.push(fL[fK])}}}return !fJ?fL:fJ.length?fJ:null}function bP(fM,fN){var fL=fN["spans_"+fM.id];if(!fL){return null}for(var fK=0,fJ=[];fK<fN.text.length;++fK){fJ.push(a8(fL[fK]))}return fJ}function bB(fU,fM,fT){for(var fP=0,fK=[];fP<fU.length;++fP){var fL=fU[fP];if(fL.ranges){fK.push(fT?ft.prototype.deepCopy.call(fL):fL);continue}var fR=fL.changes,fS=[];fK.push({changes:fS});for(var fO=0;fO<fR.length;++fO){var fQ=fR[fO],fN;fS.push({from:fQ.from,to:fQ.to,text:fQ.text});if(fM){for(var fJ in fQ){if(fN=fJ.match(/^spans_(\d+)$/)){if(cX(fM,Number(fN[1]))>-1){fd(fS)[fJ]=fQ[fJ];delete fQ[fJ]}}}}}}return fK}function J(fM,fL,fK,fJ){if(fK<fM.line){fM.line+=fJ}else{if(fL<fM.line){fM.line=fL;fM.ch=0}}}function eN(fM,fO,fP,fQ){for(var fL=0;fL<fM.length;++fL){var fJ=fM[fL],fN=true;if(fJ.ranges){if(!fJ.copied){fJ=fM[fL]=fJ.deepCopy();fJ.copied=true}for(var fK=0;fK<fJ.ranges.length;fK++){J(fJ.ranges[fK].anchor,fO,fP,fQ);J(fJ.ranges[fK].head,fO,fP,fQ)}continue}for(var fK=0;fK<fJ.changes.length;++fK){var fR=fJ.changes[fK];if(fP<fR.from.line){fR.from=W(fR.from.line+fQ,fR.from.ch);fR.to=W(fR.to.line+fQ,fR.to.ch)}else{if(fO<=fR.to.line){fN=false;break}}}if(!fN){fM.splice(0,fL+1);fL=0}}}function df(fK,fN){var fM=fN.from.line,fL=fN.to.line,fJ=fN.text.length-(fL-fM)-1;eN(fK.done,fM,fL,fJ);eN(fK.undone,fM,fL,fJ)}var cq=I.e_preventDefault=function(fJ){if(fJ.preventDefault){fJ.preventDefault()}else{fJ.returnValue=false}};var c2=I.e_stopPropagation=function(fJ){if(fJ.stopPropagation){fJ.stopPropagation()}else{fJ.cancelBubble=true}};function bx(fJ){return fJ.defaultPrevented!=null?fJ.defaultPrevented:fJ.returnValue==false}var dZ=I.e_stop=function(fJ){cq(fJ);c2(fJ)};function L(fJ){return fJ.target||fJ.srcElement}function fj(fK){var fJ=fK.which;if(fJ==null){if(fK.button&1){fJ=1}else{if(fK.button&2){fJ=3}else{if(fK.button&4){fJ=2}}}}if(bR&&fK.ctrlKey&&fJ==1){fJ=3}return fJ}var bJ=I.on=function(fM,fK,fL){if(fM.addEventListener){fM.addEventListener(fK,fL,false)}else{if(fM.attachEvent){fM.attachEvent("on"+fK,fL)}else{var fN=fM._handlers||(fM._handlers={});var fJ=fN[fK]||(fN[fK]=[]);fJ.push(fL)}}};var dL=I.off=function(fN,fL,fM){if(fN.removeEventListener){fN.removeEventListener(fL,fM,false)}else{if(fN.detachEvent){fN.detachEvent("on"+fL,fM)}else{var fJ=fN._handlers&&fN._handlers[fL];if(!fJ){return}for(var fK=0;fK<fJ.length;++fK){if(fJ[fK]==fM){fJ.splice(fK,1);break}}}}};var ay=I.signal=function(fN,fM){var fJ=fN._handlers&&fN._handlers[fM];if(!fJ){return}var fK=Array.prototype.slice.call(arguments,2);for(var fL=0;fL<fJ.length;++fL){fJ[fL].apply(null,fK)}};var bb,ce=0;function ac(fO,fN){var fJ=fO._handlers&&fO._handlers[fN];if(!fJ){return}var fL=Array.prototype.slice.call(arguments,2);if(!bb){++ce;bb=[];setTimeout(d8,0)}function fK(fP){return function(){fP.apply(null,fL)}}for(var fM=0;fM<fJ.length;++fM){bb.push(fK(fJ[fM]))}}function d8(){--ce;var fJ=bb;bb=null;for(var fK=0;fK<fJ.length;++fK){fJ[fK]()}}function aH(fJ,fL,fK){ay(fJ,fK||fL.type,fJ,fL);return bx(fL)||fL.codemirrorIgnore}function V(fK){var fJ=fK._handlers&&fK._handlers.cursorActivity;if(!fJ){return}var fM=fK.curOp.cursorActivityHandlers||(fK.curOp.cursorActivityHandlers=[]);for(var fL=0;fL<fJ.length;++fL){if(cX(fM,fJ[fL])==-1){fM.push(fJ[fL])}}}function eO(fL,fK){var fJ=fL._handlers&&fL._handlers[fK];return fJ&&fJ.length>0}function bl(fJ){fJ.prototype.on=function(fK,fL){bJ(this,fK,fL)};fJ.prototype.off=function(fK,fL){dL(this,fK,fL)}}var a7=30;var bW=I.Pass={toString:function(){return"CodeMirror.Pass"}};var Y={scroll:false},M={origin:"*mouse"},cB={origin:"+move"};function fI(){this.id=null}fI.prototype.set=function(fJ,fK){clearTimeout(this.id);this.id=setTimeout(fK,fJ)};var bF=I.countColumn=function(fM,fK,fO,fP,fL){if(fK==null){fK=fM.search(/[^\s\u00a0]/);if(fK==-1){fK=fM.length}}for(var fN=fP||0,fQ=fL||0;;){var fJ=fM.indexOf("\t",fN);if(fJ<0||fJ>=fK){return fQ+(fK-fN)}fQ+=fJ-fN;fQ+=fO-(fQ%fO);fN=fJ+1}};function dY(fN,fM,fO){for(var fP=0,fL=0;;){var fK=fN.indexOf("\t",fP);if(fK==-1){fK=fN.length}var fJ=fK-fP;if(fK==fN.length||fL+fJ>=fM){return fP+Math.min(fJ,fM-fL)}fL+=fK-fP;fL+=fO-(fL%fO);fP=fK+1;if(fL>=fM){return fP}}}var aN=[""];function cc(fJ){while(aN.length<=fJ){aN.push(fd(aN)+" ")}return aN[fJ]}function fd(fJ){return fJ[fJ.length-1]}var dl=function(fJ){fJ.select()};if(ez){dl=function(fJ){fJ.selectionStart=0;fJ.selectionEnd=fJ.value.length}}else{if(dj){dl=function(fK){try{fK.select()}catch(fJ){}}}}function cX(fL,fJ){for(var fK=0;fK<fL.length;++fK){if(fL[fK]==fJ){return fK}}return -1}if([].indexOf){cX=function(fK,fJ){return fK.indexOf(fJ)}}function bE(fM,fL){var fJ=[];for(var fK=0;fK<fM.length;fK++){fJ[fK]=fL(fM[fK],fK)}return fJ}if([].map){bE=function(fK,fJ){return fK.map(fJ)}}function b7(fM,fJ){var fL;if(Object.create){fL=Object.create(fM)}else{var fK=function(){};fK.prototype=fM;fL=new fK()}if(fJ){aD(fJ,fL)}return fL}function aD(fL,fK,fJ){if(!fK){fK={}}for(var fM in fL){if(fL.hasOwnProperty(fM)&&(fJ!==false||!fK.hasOwnProperty(fM))){fK[fM]=fL[fM]}}return fK}function ci(fK){var fJ=Array.prototype.slice.call(arguments,1);return function(){return fK.apply(null,fJ)}}var a0=/[\u00df\u3040-\u309f\u30a0-\u30ff\u3400-\u4db5\u4e00-\u9fcc\uac00-\ud7af]/;var cm=I.isWordChar=function(fJ){return/\w/.test(fJ)||fJ>"\x80"&&(fJ.toUpperCase()!=fJ.toLowerCase()||a0.test(fJ))};function et(fJ){for(var fK in fJ){if(fJ.hasOwnProperty(fK)&&fJ[fK]){return false}}return true}var ej=/[\u0300-\u036f\u0483-\u0489\u0591-\u05bd\u05bf\u05c1\u05c2\u05c4\u05c5\u05c7\u0610-\u061a\u064b-\u065e\u0670\u06d6-\u06dc\u06de-\u06e4\u06e7\u06e8\u06ea-\u06ed\u0711\u0730-\u074a\u07a6-\u07b0\u07eb-\u07f3\u0816-\u0819\u081b-\u0823\u0825-\u0827\u0829-\u082d\u0900-\u0902\u093c\u0941-\u0948\u094d\u0951-\u0955\u0962\u0963\u0981\u09bc\u09be\u09c1-\u09c4\u09cd\u09d7\u09e2\u09e3\u0a01\u0a02\u0a3c\u0a41\u0a42\u0a47\u0a48\u0a4b-\u0a4d\u0a51\u0a70\u0a71\u0a75\u0a81\u0a82\u0abc\u0ac1-\u0ac5\u0ac7\u0ac8\u0acd\u0ae2\u0ae3\u0b01\u0b3c\u0b3e\u0b3f\u0b41-\u0b44\u0b4d\u0b56\u0b57\u0b62\u0b63\u0b82\u0bbe\u0bc0\u0bcd\u0bd7\u0c3e-\u0c40\u0c46-\u0c48\u0c4a-\u0c4d\u0c55\u0c56\u0c62\u0c63\u0cbc\u0cbf\u0cc2\u0cc6\u0ccc\u0ccd\u0cd5\u0cd6\u0ce2\u0ce3\u0d3e\u0d41-\u0d44\u0d4d\u0d57\u0d62\u0d63\u0dca\u0dcf\u0dd2-\u0dd4\u0dd6\u0ddf\u0e31\u0e34-\u0e3a\u0e47-\u0e4e\u0eb1\u0eb4-\u0eb9\u0ebb\u0ebc\u0ec8-\u0ecd\u0f18\u0f19\u0f35\u0f37\u0f39\u0f71-\u0f7e\u0f80-\u0f84\u0f86\u0f87\u0f90-\u0f97\u0f99-\u0fbc\u0fc6\u102d-\u1030\u1032-\u1037\u1039\u103a\u103d\u103e\u1058\u1059\u105e-\u1060\u1071-\u1074\u1082\u1085\u1086\u108d\u109d\u135f\u1712-\u1714\u1732-\u1734\u1752\u1753\u1772\u1773\u17b7-\u17bd\u17c6\u17c9-\u17d3\u17dd\u180b-\u180d\u18a9\u1920-\u1922\u1927\u1928\u1932\u1939-\u193b\u1a17\u1a18\u1a56\u1a58-\u1a5e\u1a60\u1a62\u1a65-\u1a6c\u1a73-\u1a7c\u1a7f\u1b00-\u1b03\u1b34\u1b36-\u1b3a\u1b3c\u1b42\u1b6b-\u1b73\u1b80\u1b81\u1ba2-\u1ba5\u1ba8\u1ba9\u1c2c-\u1c33\u1c36\u1c37\u1cd0-\u1cd2\u1cd4-\u1ce0\u1ce2-\u1ce8\u1ced\u1dc0-\u1de6\u1dfd-\u1dff\u200c\u200d\u20d0-\u20f0\u2cef-\u2cf1\u2de0-\u2dff\u302a-\u302f\u3099\u309a\ua66f-\ua672\ua67c\ua67d\ua6f0\ua6f1\ua802\ua806\ua80b\ua825\ua826\ua8c4\ua8e0-\ua8f1\ua926-\ua92d\ua947-\ua951\ua980-\ua982\ua9b3\ua9b6-\ua9b9\ua9bc\uaa29-\uaa2e\uaa31\uaa32\uaa35\uaa36\uaa43\uaa4c\uaab0\uaab2-\uaab4\uaab7\uaab8\uaabe\uaabf\uaac1\uabe5\uabe8\uabed\udc00-\udfff\ufb1e\ufe00-\ufe0f\ufe20-\ufe26\uff9e\uff9f]/;function eW(fJ){return fJ.charCodeAt(0)>=768&&ej.test(fJ)}function fs(fJ,fN,fM,fL){var fO=document.createElement(fJ);if(fM){fO.className=fM}if(fL){fO.style.cssText=fL}if(typeof fN=="string"){fO.appendChild(document.createTextNode(fN))}else{if(fN){for(var fK=0;fK<fN.length;++fK){fO.appendChild(fN[fK])}}}return fO}var b8;if(document.createRange){b8=function(fL,fM,fJ){var fK=document.createRange();fK.setEnd(fL,fJ);fK.setStart(fL,fM);return fK}}else{b8=function(fL,fM,fJ){var fK=document.body.createTextRange();fK.moveToElementText(fL.parentNode);fK.collapse(true);fK.moveEnd("character",fJ);fK.moveStart("character",fM);return fK}}function dA(fK){for(var fJ=fK.childNodes.length;fJ>0;--fJ){fK.removeChild(fK.firstChild)}return fK}function bD(fJ,fK){return dA(fJ).appendChild(fK)}function fB(fJ,fK){if(fJ.contains){return fJ.contains(fK)}while(fK=fK.parentNode){if(fK==fJ){return true}}}function dn(){return document.activeElement}if(ek){dn=function(){try{return document.activeElement}catch(fJ){return document.body}}}function S(fJ){return new RegExp("\\b"+fJ+"\\b\\s*")}function g(fK,fJ){var fL=S(fJ);if(fL.test(fK.className)){fK.className=fK.className.replace(fL,"")}}function e8(fK,fJ){if(!S(fJ).test(fK.className)){fK.className+=" "+fJ}}function fn(fL,fJ){var fK=fL.split(" ");for(var fM=0;fM<fK.length;fM++){if(fK[fM]&&!S(fK[fM]).test(fJ)){fJ+=" "+fK[fM]}}return fJ}var el=function(){if(bV){return false}var fJ=fs("div");return"draggable" in fJ||"dragDrop" in fJ}();var d4;function l(fJ){if(d4!=null){return d4}var fK=fs("div",null,null,"width: 50px; height: 50px; overflow-x: scroll");bD(fJ,fK);if(fK.offsetWidth){d4=fK.offsetHeight-fK.clientHeight}return d4||0}var fh;function ba(fJ){if(fh==null){var fK=fs("span","\u200b");bD(fJ,fs("span",[fK,document.createTextNode("x")]));if(fJ.firstChild.offsetHeight!=0){fh=fK.offsetWidth<=1&&fK.offsetHeight>2&&!bY}}if(fh){return fs("span","\u200b")}else{return fs("span","\u00a0",null,"display: inline-block; width: 1px; margin-right: -1px")}}var fg;function bA(fM){if(fg!=null){return fg}var fJ=bD(fM,document.createTextNode("A\u062eA"));var fL=b8(fJ,0,1).getBoundingClientRect();if(fL.left==fL.right){return false}var fK=b8(fJ,1,2).getBoundingClientRect();return fg=(fK.right-fL.right<3)}var aO=I.splitLines="\n\nb".split(/\n/).length!=3?function(fO){var fP=0,fJ=[],fN=fO.length;while(fP<=fN){var fM=fO.indexOf("\n",fP);if(fM==-1){fM=fO.length}var fL=fO.slice(fP,fO.charAt(fM-1)=="\r"?fM-1:fM);var fK=fL.indexOf("\r");if(fK!=-1){fJ.push(fL.slice(0,fK));fP+=fK+1}else{fJ.push(fL);fP=fM+1}}return fJ}:function(fJ){return fJ.split(/\r\n?|\n/)};var bf=window.getSelection?function(fK){try{return fK.selectionStart!=fK.selectionEnd}catch(fJ){return false}}:function(fL){try{var fJ=fL.ownerDocument.selection.createRange()}catch(fK){}if(!fJ||fJ.parentElement()!=fL){return false}return fJ.compareEndPoints("StartToEnd",fJ)!=0};var cP=(function(){var fJ=fs("div");if("oncopy" in fJ){return true}fJ.setAttribute("oncopy","return;");return typeof fJ.oncopy=="function"})();var eM={3:"Enter",8:"Backspace",9:"Tab",13:"Enter",16:"Shift",17:"Ctrl",18:"Alt",19:"Pause",20:"CapsLock",27:"Esc",32:"Space",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"Left",38:"Up",39:"Right",40:"Down",44:"PrintScrn",45:"Insert",46:"Delete",59:";",61:"=",91:"Mod",92:"Mod",93:"Mod",107:"=",109:"-",127:"Delete",173:"-",186:";",187:"=",188:",",189:"-",190:".",191:"/",192:"`",219:"[",220:"\\",221:"]",222:"'",63232:"Up",63233:"Down",63234:"Left",63235:"Right",63272:"Delete",63273:"Home",63275:"End",63276:"PageUp",63277:"PageDown",63302:"Insert"};I.keyNames=eM;(function(){for(var fJ=0;fJ<10;fJ++){eM[fJ+48]=eM[fJ+96]=String(fJ)}for(var fJ=65;fJ<=90;fJ++){eM[fJ]=String.fromCharCode(fJ)}for(var fJ=1;fJ<=12;fJ++){eM[fJ+111]=eM[fJ+63235]="F"+fJ}})();function dD(fJ,fP,fO,fN){if(!fJ){return fN(fP,fO,"ltr")}var fM=false;for(var fL=0;fL<fJ.length;++fL){var fK=fJ[fL];if(fK.from<fO&&fK.to>fP||fP==fO&&fK.to==fP){fN(Math.max(fK.from,fP),Math.min(fK.to,fO),fK.level==1?"rtl":"ltr");fM=true}}if(!fM){fN(fP,fO,"ltr")}}function c9(fJ){return fJ.level%2?fJ.to:fJ.from}function fE(fJ){return fJ.level%2?fJ.from:fJ.to}function cp(fK){var fJ=a(fK);return fJ?c9(fJ[0]):0}function cA(fK){var fJ=a(fK);if(!fJ){return fK.text.length}return fE(fd(fJ))}function bg(fK,fN){var fL=eL(fK.doc,fN);var fO=z(fL);if(fO!=fL){fN=bz(fO)}var fJ=a(fO);var fM=!fJ?0:fJ[0].level%2?cA(fO):cp(fO);return W(fN,fM)}function dp(fL,fO){var fK,fM=eL(fL.doc,fO);while(fK=d3(fM)){fM=fK.find(1,true).line;fO=null}var fJ=a(fM);var fN=!fJ?fM.text.length:fJ[0].level%2?cp(fM):cA(fM);return W(fO==null?bz(fM):fO,fN)}function ak(fK,fL,fJ){var fM=fK[0].level;if(fL==fM){return true}if(fJ==fM){return false}return fL<fJ}var eA;function aA(fJ,fN){eA=null;for(var fK=0,fL;fK<fJ.length;++fK){var fM=fJ[fK];if(fM.from<fN&&fM.to>fN){return fK}if((fM.from==fN||fM.to==fN)){if(fL==null){fL=fK}else{if(ak(fJ,fM.level,fJ[fL].level)){if(fM.from!=fM.to){eA=fL}return fK}else{if(fM.from!=fM.to){eA=fK}return fL}}}}return fL}function eK(fJ,fM,fK,fL){if(!fL){return fM+fK}do{fM+=fK}while(fM>0&&eW(fJ.text.charAt(fM)));return fM}function v(fJ,fQ,fL,fM){var fN=a(fJ);if(!fN){return ag(fJ,fQ,fL,fM)}var fP=aA(fN,fQ),fK=fN[fP];var fO=eK(fJ,fQ,fK.level%2?-fL:fL,fM);for(;;){if(fO>fK.from&&fO<fK.to){return fO}if(fO==fK.from||fO==fK.to){if(aA(fN,fO)==fP){return fO}fK=fN[fP+=fL];return(fL>0)==fK.level%2?fK.to:fK.from}else{fK=fN[fP+=fL];if(!fK){return null}if((fL>0)==fK.level%2){fO=eK(fJ,fK.to,-1,fM)}else{fO=eK(fJ,fK.from,1,fM)}}}}function ag(fJ,fN,fK,fL){var fM=fN+fK;if(fL){while(fM>0&&eW(fJ.text.charAt(fM))){fM+=fK}}return fM<0||fM>fJ.text.length?null:fM}var a4=(function(){var fP="bbbbbbbbbtstwsbbbbbbbbbbbbbbssstwNN%%%NNNNNN,N,N1111111111NNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNNNLLLLLLLLLLLLLLLLLLLLLLLLLLNNNNbbbbbbsbbbbbbbbbbbbbbbbbbbbbbbbbb,N%%%%NNNNLNNNNN%%11NLNNN1LNNNNNLLLLLLLLLLLLLLLLLLLLLLLNLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLLN";var fN="rrrrrrrrrrrr,rNNmmmmmmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmrrrrrrrnnnnnnnnnn%nnrrrmrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrrmmmmmmmmmmmmmmmmmmmNmmmm";function fM(fT){if(fT<=247){return fP.charAt(fT)}else{if(1424<=fT&&fT<=1524){return"R"}else{if(1536<=fT&&fT<=1773){return fN.charAt(fT-1536)}else{if(1774<=fT&&fT<=2220){return"r"}else{if(8192<=fT&&fT<=8203){return"w"}else{if(fT==8204){return"b"}else{return"L"}}}}}}}var fJ=/[\u0590-\u05f4\u0600-\u06ff\u0700-\u08ac]/;var fS=/[stwN]/,fL=/[LRr]/,fK=/[Lb1n]/,fO=/[1n]/;var fR="L";function fQ(fV,fU,fT){this.level=fV;this.from=fU;this.to=fT}return function(f3){if(!fJ.test(f3)){return false}var f9=f3.length,fZ=[];for(var f8=0,fV;f8<f9;++f8){fZ.push(fV=fM(f3.charCodeAt(f8)))}for(var f8=0,f2=fR;f8<f9;++f8){var fV=fZ[f8];if(fV=="m"){fZ[f8]=f2}else{f2=fV}}for(var f8=0,fT=fR;f8<f9;++f8){var fV=fZ[f8];if(fV=="1"&&fT=="r"){fZ[f8]="n"}else{if(fL.test(fV)){fT=fV;if(fV=="r"){fZ[f8]="R"}}}}for(var f8=1,f2=fZ[0];f8<f9-1;++f8){var fV=fZ[f8];if(fV=="+"&&f2=="1"&&fZ[f8+1]=="1"){fZ[f8]="1"}else{if(fV==","&&f2==fZ[f8+1]&&(f2=="1"||f2=="n")){fZ[f8]=f2}}f2=fV}for(var f8=0;f8<f9;++f8){var fV=fZ[f8];if(fV==","){fZ[f8]="N"}else{if(fV=="%"){for(var fW=f8+1;fW<f9&&fZ[fW]=="%";++fW){}var ga=(f8&&fZ[f8-1]=="!")||(fW<f9&&fZ[fW]=="1")?"1":"N";for(var f6=f8;f6<fW;++f6){fZ[f6]=ga}f8=fW-1}}}for(var f8=0,fT=fR;f8<f9;++f8){var fV=fZ[f8];if(fT=="L"&&fV=="1"){fZ[f8]="L"}else{if(fL.test(fV)){fT=fV}}}for(var f8=0;f8<f9;++f8){if(fS.test(fZ[f8])){for(var fW=f8+1;fW<f9&&fS.test(fZ[fW]);++fW){}var f0=(f8?fZ[f8-1]:fR)=="L";var fU=(fW<f9?fZ[fW]:fR)=="L";var ga=f0||fU?"L":"R";for(var f6=f8;f6<fW;++f6){fZ[f6]=ga}f8=fW-1}}var f7=[],f4;for(var f8=0;f8<f9;){if(fK.test(fZ[f8])){var fX=f8;for(++f8;f8<f9&&fK.test(fZ[f8]);++f8){}f7.push(new fQ(0,fX,f8))}else{var fY=f8,f1=f7.length;for(++f8;f8<f9&&fZ[f8]!="L";++f8){}for(var f6=fY;f6<f8;){if(fO.test(fZ[f6])){if(fY<f6){f7.splice(f1,0,new fQ(1,fY,f6))}var f5=f6;for(++f6;f6<f8&&fO.test(fZ[f6]);++f6){}f7.splice(f1,0,new fQ(2,f5,f6));fY=f6}else{++f6}}if(fY<f8){f7.splice(f1,0,new fQ(1,fY,f8))}}}if(f7[0].level==1&&(f4=f3.match(/^\s+/))){f7[0].from=f4[0].length;f7.unshift(new fQ(0,0,f4[0].length))}if(fd(f7).level==1&&(f4=f3.match(/\s+$/))){fd(f7).to-=f4[0].length;f7.push(new fQ(0,f9-f4[0].length,f9))}if(f7[0].level!=fd(f7).level){f7.push(new fQ(f7[0].level,f9,f9))}return f7}})();I.version="4.1.0";return I});