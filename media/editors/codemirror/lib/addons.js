/**
 *    active-line.js
 *    brace-fold.js
 *    closebrackets.js
 *    closetag.js
 *    comment-fold.js
 *    foldcode.js
 *    foldgutter.js
 *    fullscreen.js
 *    matchbrackets.js
 *    matchtags.js
 *    xml-fold.js
 *    vim.js
 **/
!function(){"use strict";function c(c){"activeLine"in c.state&&(c.removeLineClass(c.state.activeLine,"wrap",a),c.removeLineClass(c.state.activeLine,"background",b))}function d(d){var e=d.getLineHandleVisualStart(d.getCursor().line);d.state.activeLine!=e&&(c(d),d.addLineClass(e,"wrap",a),d.addLineClass(e,"background",b),d.state.activeLine=e)}var a="CodeMirror-activeline",b="CodeMirror-activeline-background";CodeMirror.defineOption("styleActiveLine",!1,function(a,b,e){var f=e&&e!=CodeMirror.Init;b&&!f?(d(a),a.on("cursorActivity",d)):!b&&f&&(a.off("cursorActivity",d),c(a),delete a.state.activeLine)})}(),CodeMirror.registerHelper("fold","brace",function(a,b){function g(e){for(var g=b.ch,h=0;;){var i=0>=g?-1:d.lastIndexOf(e,g-1);if(-1!=i){if(1==h&&i<b.ch)break;if(f=a.getTokenTypeAt(CodeMirror.Pos(c,i+1)),!/^(comment|string)/.test(f))return i+1;g=i-1}else{if(1==h)break;h=1,g=d.length}}}var e,f,c=b.line,d=a.getLine(c),h="{",i="}",e=g("{");if(null==e&&(h="[",i="]",e=g("[")),null!=e){var l,m,j=1,k=a.lastLine();a:for(var n=c;k>=n;++n)for(var o=a.getLine(n),p=n==c?e:0;;){var q=o.indexOf(h,p),r=o.indexOf(i,p);if(0>q&&(q=o.length),0>r&&(r=o.length),p=Math.min(q,r),p==o.length)break;if(a.getTokenTypeAt(CodeMirror.Pos(n,p+1))==f)if(p==q)++j;else if(!--j){l=n,m=p;break a}++p}if(null!=l&&(c!=l||m!=e))return{from:CodeMirror.Pos(c,e),to:CodeMirror.Pos(l,m)}}}),CodeMirror.braceRangeFinder=CodeMirror.fold.brace,CodeMirror.registerHelper("fold","import",function(a,b){function c(b){if(b<a.firstLine()||b>a.lastLine())return null;var c=a.getTokenAt(CodeMirror.Pos(b,1));if(/\S/.test(c.string)||(c=a.getTokenAt(CodeMirror.Pos(b,c.end+1))),"keyword"!=c.type||"import"!=c.string)return null;for(var d=b,e=Math.min(a.lastLine(),b+10);e>=d;++d){var f=a.getLine(d),g=f.indexOf(";");if(-1!=g)return{startCh:c.end,end:CodeMirror.Pos(d,g)}}}var e,b=b.line,d=c(b);if(!d||c(b-1)||(e=c(b-2))&&e.end.line==b-1)return null;for(var f=d.end;;){var g=c(f.line+1);if(null==g)break;f=g.end}return{from:a.clipPos(CodeMirror.Pos(b,d.startCh+1)),to:f}}),CodeMirror.importRangeFinder=CodeMirror.fold["import"],CodeMirror.registerHelper("fold","include",function(a,b){function c(b){if(b<a.firstLine()||b>a.lastLine())return null;var c=a.getTokenAt(CodeMirror.Pos(b,1));return/\S/.test(c.string)||(c=a.getTokenAt(CodeMirror.Pos(b,c.end+1))),"meta"==c.type&&"#include"==c.string.slice(0,8)?c.start+8:void 0}var b=b.line,d=c(b);if(null==d||null!=c(b-1))return null;for(var e=b;;){var f=c(e+1);if(null==f)break;++e}return{from:CodeMirror.Pos(b,d+1),to:a.clipPos(CodeMirror.Pos(e))}}),CodeMirror.includeRangeFinder=CodeMirror.fold.include,function(){function d(a,b){var c=a.getRange(CodeMirror.Pos(b.line,b.ch-1),CodeMirror.Pos(b.line,b.ch+1));return 2==c.length?c:null}function e(a){for(var b={name:"autoCloseBrackets",Backspace:function(b){if(b.somethingSelected())return CodeMirror.Pass;var c=b.getCursor(),e=d(b,c);return e&&0==a.indexOf(e)%2?(b.replaceRange("",CodeMirror.Pos(c.line,c.ch-1),CodeMirror.Pos(c.line,c.ch+1)),void 0):CodeMirror.Pass}},e="",f=0;f<a.length;f+=2)!function(a,d){function f(b){var c=b.getSelection();b.replaceSelection(a+c+d)}function g(a){var b=a.getCursor(),c=a.getRange(b,CodeMirror.Pos(b.line,b.ch+1));return c!=d||a.somethingSelected()?CodeMirror.Pass:(a.execCommand("goCharRight"),void 0)}a!=d&&(e+=d),b["'"+a+"'"]=function(b){if("'"==a&&"comment"==b.getTokenAt(b.getCursor()).type)return CodeMirror.Pass;if(b.somethingSelected())return f(b);if(a!=d||g(b)==CodeMirror.Pass){var h=b.getCursor(),i=CodeMirror.Pos(h.line,h.ch+1),j=b.getLine(h.line),k=j.charAt(h.ch),l=h.ch>0?j.charAt(h.ch-1):"";return a==d&&CodeMirror.isWordChar(l)?CodeMirror.Pass:j.length==h.ch||e.indexOf(k)>=0||c.test(k)?(b.replaceSelection(a+d,{head:i,anchor:i}),void 0):CodeMirror.Pass}},a!=d&&(b["'"+d+"'"]=g)}(a.charAt(f),a.charAt(f+1));return b}function f(a){return function(b){var c=b.getCursor(),e=d(b,c);return e&&0==a.indexOf(e)%2?(b.operation(function(){var a=CodeMirror.Pos(c.line+1,0);b.replaceSelection("\n\n",{anchor:a,head:a},"+input"),b.indentLine(c.line+1,null,!0),b.indentLine(c.line+2,null,!0)}),void 0):CodeMirror.Pass}}var a="()[]{}''\"\"",b="[]{}",c=/\s/;CodeMirror.defineOption("autoCloseBrackets",!1,function(c,d,g){if(g!=CodeMirror.Init&&g&&c.removeKeyMap("autoCloseBrackets"),d){var h=a,i=b;"string"==typeof d?h=d:"object"==typeof d&&(null!=d.pairs&&(h=d.pairs),null!=d.explode&&(i=d.explode));var j=e(h);i&&(j.Enter=f(i)),c.addKeyMap(j)}})}(),function(){function c(c){var d=c.getCursor(),f=c.getTokenAt(d),g=CodeMirror.innerMode(c.getMode(),f.state),h=g.state;if("xml"!=g.mode.name||!h.tagName)return CodeMirror.Pass;var i=c.getOption("autoCloseTags"),j="html"==g.mode.configuration,k="object"==typeof i&&i.dontCloseTags||j&&a,l="object"==typeof i&&i.indentTags||j&&b,m=h.tagName;f.end>d.ch&&(m=m.slice(0,m.length-f.end+d.ch));var n=m.toLowerCase();if("tag"==f.type&&"closeTag"==h.type||f.string.indexOf("/")==f.string.length-1||k&&e(k,n)>-1)return CodeMirror.Pass;var o=l&&e(l,n)>-1,p=o?CodeMirror.Pos(d.line+1,0):CodeMirror.Pos(d.line,d.ch+1);c.replaceSelection(">"+(o?"\n\n":"")+"</"+m+">",{head:p,anchor:p}),o&&(c.indentLine(d.line+1),c.indentLine(d.line+2))}function d(a){var b=a.getCursor(),c=a.getTokenAt(b),d=CodeMirror.innerMode(a.getMode(),c.state),e=d.state;if("<"!=c.string.charAt(0)||"xml"!=d.mode.name)return CodeMirror.Pass;var f=e.context&&e.context.tagName;f&&a.replaceSelection("/"+f+">","end")}function e(a,b){if(a.indexOf)return a.indexOf(b);for(var c=0,d=a.length;d>c;++c)if(a[c]==b)return c;return-1}CodeMirror.defineOption("autoCloseTags",!1,function(a,b,e){if(!b||e!=CodeMirror.Init&&e)!b&&e!=CodeMirror.Init&&e&&a.removeKeyMap("autoCloseTags");else{var f={name:"autoCloseTags"};("object"!=typeof b||b.whenClosing)&&(f["'/'"]=function(a){return d(a)}),("object"!=typeof b||b.whenOpening)&&(f["'>'"]=function(a){return c(a)}),a.addKeyMap(f)}});var a=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"],b=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"]}(),CodeMirror.registerHelper("fold","comment",function(a,b){var c=a.getModeAt(b),d=c.blockCommentStart,e=c.blockCommentEnd;if(d&&e){for(var h,f=b.line,g=a.getLine(f),i=b.ch,j=0;;){var k=0>=i?-1:g.lastIndexOf(d,i-1);if(-1!=k){if(1==j&&k<b.ch)return;if(/comment/.test(a.getTokenTypeAt(CodeMirror.Pos(f,k+1)))){h=k+d.length;break}i=k-1}else{if(1==j)return;j=1,i=g.length}}var n,o,l=1,m=a.lastLine();a:for(var p=f;m>=p;++p)for(var q=a.getLine(p),r=p==f?h:0;;){var s=q.indexOf(d,r),t=q.indexOf(e,r);if(0>s&&(s=q.length),0>t&&(t=q.length),r=Math.min(s,t),r==q.length)break;if(r==s)++l;else if(!--l){n=p,o=r;break a}++r}if(null!=n&&(f!=n||o!=h))return{from:CodeMirror.Pos(f,h),to:CodeMirror.Pos(n,o)}}}),function(){"use strict";function a(a,c,d){function g(b){var d=e(a,c);if(!d||d.to.line-d.from.line<f)return null;for(var g=a.findMarksAt(d.from),h=0;h<g.length;++h)if(g[h].__isFold){if(!b)return null;d.cleared=!0,g[h].clear()}return d}var e=d&&(d.call?d:d.rangeFinder);if(e||(e=a.getHelper(c,"fold")),e){"number"==typeof c&&(c=CodeMirror.Pos(c,0));var f=d&&d.minFoldSize||0,h=g(!0);if(d&&d.scanUp)for(;!h&&c.line>a.firstLine();)c=CodeMirror.Pos(c.line-1,0),h=g(!1);if(h&&!h.cleared){var i=b(d);CodeMirror.on(i,"mousedown",function(){j.clear()});var j=a.markText(h.from,h.to,{replacedWith:i,clearOnEnter:!0,__isFold:!0});j.on("clear",function(b,c){CodeMirror.signal(a,"unfold",a,b,c)}),CodeMirror.signal(a,"fold",a,h.from,h.to)}}}function b(a){var b=a&&a.widget||"\u2194";if("string"==typeof b){var c=document.createTextNode(b);b=document.createElement("span"),b.appendChild(c),b.className="CodeMirror-foldmarker"}return b}CodeMirror.newFoldFunction=function(b,c){return function(d,e){a(d,e,{rangeFinder:b,widget:c})}},CodeMirror.defineExtension("foldCode",function(b,c){a(this,b,c)}),CodeMirror.registerHelper("fold","combine",function(){var a=Array.prototype.slice.call(arguments,0);return function(b,c){for(var d=0;d<a.length;++d){var e=a[d](b,c);if(e)return e}}})}(),function(){"use strict";function b(a){this.options=a,this.from=this.to=0}function c(a){return a===!0&&(a={}),null==a.gutter&&(a.gutter="CodeMirror-foldgutter"),null==a.indicatorOpen&&(a.indicatorOpen="CodeMirror-foldgutter-open"),null==a.indicatorFolded&&(a.indicatorFolded="CodeMirror-foldgutter-folded"),a}function d(b,c){for(var d=b.findMarksAt(a(c)),e=0;e<d.length;++e)if(d[e].__isFold&&d[e].find().from.line==c)return!0}function e(a){if("string"==typeof a){var b=document.createElement("div");return b.className=a,b}return a.cloneNode(!0)}function f(b,c,f){var g=b.state.foldGutter.options,h=c;b.eachLine(c,f,function(c){var f=null;if(d(b,h))f=e(g.indicatorFolded);else{var i=a(h,0),j=g.rangeFinder||b.getHelper(i,"fold"),k=j&&j(b,i);k&&k.from.line+1<k.to.line&&(f=e(g.indicatorOpen))}b.setGutterMarker(c,g.gutter,f),++h})}function g(a){var b=a.getViewport(),c=a.state.foldGutter;c&&(a.operation(function(){f(a,b.from,b.to)}),c.from=b.from,c.to=b.to)}function h(b,c,d){var e=b.state.foldGutter.options;d==e.gutter&&b.foldCode(a(c,0),e.rangeFinder)}function i(a){var b=a.state.foldGutter;b.from=b.to=0,clearTimeout(b.changeUpdate),b.changeUpdate=setTimeout(function(){g(a)},600)}function j(a){var b=a.state.foldGutter;clearTimeout(b.changeUpdate),b.changeUpdate=setTimeout(function(){var c=a.getViewport();b.from==b.to||c.from-b.to>20||b.from-c.to>20?g(a):a.operation(function(){c.from<b.from&&(f(a,c.from,b.from),b.from=c.from),c.to>b.to&&(f(a,b.to,c.to),b.to=c.to)})},400)}function k(a,b){var c=a.state.foldGutter,d=b.line;d>=c.from&&d<c.to&&f(a,d,d+1)}CodeMirror.defineOption("foldGutter",!1,function(a,d,e){e&&e!=CodeMirror.Init&&(a.clearGutter(a.state.foldGutter.options.gutter),a.state.foldGutter=null,a.off("gutterClick",h),a.off("change",i),a.off("viewportChange",j),a.off("fold",k),a.off("unfold",k)),d&&(a.state.foldGutter=new b(c(d)),g(a),a.on("gutterClick",h),a.on("change",i),a.on("viewportChange",j),a.on("fold",k),a.on("unfold",k))});var a=CodeMirror.Pos}(),function(){"use strict";function a(a){var b=a.getWrapperElement();a.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:b.style.width,height:b.style.height},b.style.width=b.style.height="",b.className+=" CodeMirror-fullscreen",document.documentElement.style.overflow="hidden",a.refresh()}function b(a){var b=a.getWrapperElement();b.className=b.className.replace(/\s*CodeMirror-fullscreen\b/,""),document.documentElement.style.overflow="";var c=a.state.fullScreenRestore;b.style.width=c.width,b.style.height=c.height,window.scrollTo(c.scrollLeft,c.scrollTop),a.refresh()}CodeMirror.defineOption("fullScreen",!1,function(c,d,e){e==CodeMirror.Init&&(e=!1),!e!=!d&&(d?a(c):b(c))})}(),function(){function d(a,d,e){function q(d,e,f){if(d.text){var h=l?0:d.text.length-1,i=l?d.text.length:-1;if(d.text.length>g)return null;for(null!=f&&(h=f+m);h!=i;h+=m){var j=d.text.charAt(h);if(p.test(j)&&a.getTokenTypeAt(b(e,h+1))==n){var k=c[j];if(">"==k.charAt(1)==l)o.push(j);else{if(o.pop()!=k.charAt(0))return{pos:h,match:!1};if(!o.length)return{pos:h,match:!0}}}}}}var f=a.state.matchBrackets,g=f&&f.maxScanLineLength||1e4,h=d||a.getCursor(),i=a.getLineHandle(h.line),j=h.ch-1,k=j>=0&&c[i.text.charAt(j)]||c[i.text.charAt(++j)];if(!k)return null;var l=">"==k.charAt(1),m=l?1:-1;if(e&&l!=(j==h.ch))return null;for(var s,n=a.getTokenTypeAt(b(h.line,j+1)),o=[i.text.charAt(j)],p=/[(){}[\]]/,r=h.line,t=l?Math.min(r+100,a.lineCount()):Math.max(-1,r-100);r!=t&&!(s=r==h.line?q(i,r,j):q(a.getLineHandle(r),r));r+=m);return{from:b(h.line,j),to:s&&b(r,s.pos),match:s&&s.match,forward:l}}function e(c,e){var f=c.state.matchBrackets.maxHighlightLineLength||1e3,g=d(c);if(!(!g||c.getLine(g.from.line).length>f||g.to&&c.getLine(g.to.line).length>f)){var h=g.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket",i=c.markText(g.from,b(g.from.line,g.from.ch+1),{className:h}),j=g.to&&c.markText(g.to,b(g.to.line,g.to.ch+1),{className:h});a&&c.state.focused&&c.display.input.focus();var k=function(){c.operation(function(){i.clear(),j&&j.clear()})};return e?(setTimeout(k,800),void 0):k}}function g(a){a.operation(function(){f&&(f(),f=null),a.somethingSelected()||(f=e(a,!1))})}var a=/MSIE \d/.test(navigator.userAgent)&&(null==document.documentMode||document.documentMode<8),b=CodeMirror.Pos,c={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"},f=null;CodeMirror.defineOption("matchBrackets",!1,function(a,b,c){c&&c!=CodeMirror.Init&&a.off("cursorActivity",g),b&&(a.state.matchBrackets="object"==typeof b?b:{},a.on("cursorActivity",g))}),CodeMirror.defineExtension("matchBrackets",function(){e(this,!0)}),CodeMirror.defineExtension("findMatchingBracket",function(a,b){return d(this,a,b)})}(),function(){"use strict";function a(a){a.state.tagHit&&a.state.tagHit.clear(),a.state.tagOther&&a.state.tagOther.clear(),a.state.tagHit=a.state.tagOther=null}function b(b){b.state.failedTagMatch=!1,b.operation(function(){if(a(b),!b.somethingSelected()){var c=b.getCursor(),d=b.getViewport();d.from=Math.min(d.from,c.line),d.to=Math.max(c.line+1,d.to);var e=CodeMirror.findMatchingTag(b,c,d);if(e){if(b.state.matchBothTags){var f="open"==e.at?e.open:e.close;f&&(b.state.tagHit=b.markText(f.from,f.to,{className:"CodeMirror-matchingtag"}))}var g="close"==e.at?e.open:e.close;g?b.state.tagOther=b.markText(g.from,g.to,{className:"CodeMirror-matchingtag"}):b.state.failedTagMatch=!0}}})}function c(a){a.state.failedTagMatch&&b(a)}CodeMirror.defineOption("matchTags",!1,function(d,e,f){f&&f!=CodeMirror.Init&&(d.off("cursorActivity",b),d.off("viewportChange",c),a(d)),e&&(d.state.matchBothTags="object"==typeof e&&e.bothTags,d.on("cursorActivity",b),d.on("viewportChange",c),b(d))}),CodeMirror.commands.toMatchingTag=function(a){var b=CodeMirror.findMatchingTag(a,a.getCursor());if(b){var c="close"==b.at?b.open:b.close;c&&a.setSelection(c.to,c.from)}}}(),function(){"use strict";function b(a,b){return a.line-b.line||a.ch-b.ch}function f(a,b,c,d){this.line=b,this.ch=c,this.cm=a,this.text=a.getLine(b),this.min=d?d.from:a.firstLine(),this.max=d?d.to-1:a.lastLine()}function g(b,c){var d=b.cm.getTokenTypeAt(a(b.line,c));return d&&/\btag\b/.test(d)}function h(a){return a.line>=a.max?void 0:(a.ch=0,a.text=a.cm.getLine(++a.line),!0)}function i(a){return a.line<=a.min?void 0:(a.text=a.cm.getLine(--a.line),a.ch=a.text.length,!0)}function j(a){for(;;){var b=a.text.indexOf(">",a.ch);if(-1==b){if(h(a))continue;return}{if(g(a,b+1)){var c=a.text.lastIndexOf("/",b),d=c>-1&&!/\S/.test(a.text.slice(c+1,b));return a.ch=b+1,d?"selfClose":"regular"}a.ch=b+1}}}function k(a){for(;;){var b=a.ch?a.text.lastIndexOf("<",a.ch-1):-1;if(-1==b){if(i(a))continue;return}if(g(a,b+1)){e.lastIndex=b,a.ch=b;var c=e.exec(a.text);if(c&&c.index==b)return c}else a.ch=b}}function l(a){for(;;){e.lastIndex=a.ch;var b=e.exec(a.text);if(!b){if(h(a))continue;return}{if(g(a,b.index+1))return a.ch=b.index+b[0].length,b;a.ch=b.index+1}}}function m(a){for(;;){var b=a.ch?a.text.lastIndexOf(">",a.ch-1):-1;if(-1==b){if(i(a))continue;return}{if(g(a,b+1)){var c=a.text.lastIndexOf("/",b),d=c>-1&&!/\S/.test(a.text.slice(c+1,b));return a.ch=b+1,d?"selfClose":"regular"}a.ch=b}}}function n(b,c){for(var d=[];;){var f,e=l(b),g=b.line,h=b.ch-(e?e[0].length:0);if(!e||!(f=j(b)))return;if("selfClose"!=f)if(e[1]){for(var i=d.length-1;i>=0;--i)if(d[i]==e[2]){d.length=i;break}if(0>i&&(!c||c==e[2]))return{tag:e[2],from:a(g,h),to:a(b.line,b.ch)}}else d.push(e[2])}}function o(b,c){for(var d=[];;){var e=m(b);if(!e)return;if("selfClose"!=e){var f=b.line,g=b.ch,h=k(b);if(!h)return;if(h[1])d.push(h[2]);else{for(var i=d.length-1;i>=0;--i)if(d[i]==h[2]){d.length=i;break}if(0>i&&(!c||c==h[2]))return{tag:h[2],from:a(b.line,b.ch),to:a(f,g)}}}else k(b)}}var a=CodeMirror.Pos,c="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD",d=c+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040",e=new RegExp("<(/?)(["+c+"]["+d+"]*)","g");CodeMirror.registerHelper("fold","xml",function(b,c){for(var d=new f(b,c.line,0);;){var g,e=l(d);if(!e||d.line!=c.line||!(g=j(d)))return;if(!e[1]&&"selfClose"!=g){var c=a(d.line,d.ch),h=n(d,e[2]);return h&&{from:c,to:h.from}}}}),CodeMirror.tagRangeFinder=CodeMirror.fold.xml,CodeMirror.findMatchingTag=function(c,d,e){var g=new f(c,d.line,d.ch,e);if(-1!=g.text.indexOf(">")||-1!=g.text.indexOf("<")){var h=j(g),i=h&&a(g.line,g.ch),l=h&&k(g);if(h&&"selfClose"!=h&&l&&!(b(g,d)>0)){var m={from:a(g.line,g.ch),to:i,tag:l[2]};return l[1]?{open:o(g,l[2]),close:m,at:"close"}:(g=new f(c,i.line,i.ch,e),{open:m,close:n(g,l[2]),at:"open"})}}},CodeMirror.findEnclosingTag=function(a,b,c){for(var d=new f(a,b.line,b.ch,c);;){var e=o(d);if(!e)break;var g=new f(a,b.line,b.ch,c),h=n(g,e.tag);if(h)return{open:e,close:h}}}}(),function(){"use strict";var a=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["C-["],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"]},{keys:["S"],type:"keyToKey",toKeys:["c","c"]},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:!0,toJumplist:!0}},{keys:["h"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!1}},{keys:["l"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,linewise:!0}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,linewise:!0}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!0}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:!1}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!1,bigWord:!0}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,inclusive:!0}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!0,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!1,bigWord:!0}},{keys:["g","e"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,inclusive:!0}},{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:!1,wordEnd:!0,bigWord:!0,inclusive:!0}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!1,toJumplist:!0}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:!0,toJumplist:!0}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!0}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:!1}},{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!0,explicitRepeat:!0}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:!1,explicitRepeat:!0}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!0,explicitRepeat:!0,linewise:!0,toJumplist:!0}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:!1,toFirstChar:!0}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:!0,toFirstChar:!0,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:!0}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:!0,toJumplist:!0}},{keys:["f","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:!1}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!0,inclusive:!0}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:!1}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!0}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:!1}},{keys:["'","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:!0}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!0,linewise:!0}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:!1,linewise:!0}},{keys:["]","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!0,toJumplist:!0}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:!1,toJumplist:!0}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change"},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:!0}},{keys:["<"],type:"operator",operator:"indent",operatorArgs:{indentRight:!1}},{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:!0}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:!1,toJumplist:!0}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!0},operatorMotionArgs:{visualLine:!1}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:!1},operatorMotionArgs:{visualLine:!0}},{keys:["D"],type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["C"],type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:!0},operatorMotionArgs:{visualLine:!0}},{keys:["~"],type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:!0},motion:"moveByCharacters",motionArgs:{forward:!0}},{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!0}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:!1}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"eol"}},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{insertAt:"firstNonBlank"}},{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!0}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:!0,interlaceInsertRepeat:!0,actionArgs:{after:!1}},{keys:["v"],type:"action",action:"toggleVisualMode"},{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:!0}},{keys:["J"],type:"action",action:"joinLines",isEdit:!0},{keys:["p"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!0,isEdit:!0}},{keys:["P"],type:"action",action:"paste",isEdit:!0,actionArgs:{after:!1,isEdit:!0}},{keys:["r","character"],type:"action",action:"replace",isEdit:!0},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],type:"action",action:"enterInsertMode",isEdit:!0,actionArgs:{replace:!0}},{keys:["u"],type:"action",action:"undo"},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!0,backtrack:!1}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:!0,actionArgs:{increase:!1,backtrack:!1}},{keys:["a","character"],type:"motion",motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:!0}},{keys:["/"],type:"search",searchArgs:{forward:!0,querySrc:"prompt",toJumplist:!0}},{keys:["?"],type:"search",searchArgs:{forward:!1,querySrc:"prompt",toJumplist:!0}},{keys:["*"],type:"search",searchArgs:{forward:!0,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:["#"],type:"search",searchArgs:{forward:!1,querySrc:"wordUnderCursor",toJumplist:!0}},{keys:[":"],type:"ex"}],b=function(){function c(a,b){var c=a.state.vim;if(!c.insertMode&&!c.exMode){var d=b.head;d.ch&&d.ch==a.doc.getLine(d.line).length&&d.ch--}}function g(a,b){for(var c=[],d=a;a+b>d;d++)c.push(String.fromCharCode(d));return c}function o(a,b){return b>=a.firstLine()&&b<=a.lastLine()}function p(a){return/^[a-z]$/.test(a)}function q(a){return-1!="()[]{}".indexOf(a)}function r(a){return d.test(a)}function s(a){return/^[A-Z]$/.test(a)}function t(a){return/^\s*$/.test(a)}function u(a,b){for(var c=0;c<b.length;c++)if(b[c]==a)return!0;return!1}function x(a){return a.state.vim||(a.state.vim={inputState:new B,lastEditInputState:void 0,lastEditActionCommand:void 0,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},insertMode:!1,insertModeRepeat:void 0,visualMode:!1,visualLine:!1}),a.state.vim}function z(){y={searchQuery:null,searchIsReversed:!1,jumpList:v(),macroModeState:w(),lastChararacterSearch:{increment:0,forward:!0,selectedCharacter:""},registerController:new D({})}}function B(){this.prefixRepeat=[],this.motionRepeat=[],this.operator=null,this.operatorArgs=null,this.motion=null,this.motionArgs=null,this.keyBuffer=[],this.registerName=null}function C(a,b){this.clear(),a&&this.set(a,b)}function D(a){this.registers=a,this.unamedRegister=a['"']=new C}function J(a,b,c){var d=Math.min(Math.max(a.firstLine(),b.line),a.lastLine()),e=S(a,d)-1;e=c?e+1:e;var f=Math.min(Math.max(0,b.ch),e);return{line:d,ch:f}}function K(a){var b={};for(var c in a)a.hasOwnProperty(c)&&(b[c]=a[c]);return b}function L(a,b,c){return{line:a.line+b,ch:a.ch+c}}function M(a,b){for(var c=0;c<a.length;c++)if(a[c]!=b[c]&&"character"!=b[c])return!1;return!0}function N(a,b,c){return function(){for(var d=0;c>d;d++)b(a)}}function O(a){return{line:a.line,ch:a.ch}}function P(a,b){return a.ch==b.ch&&a.line==b.line}function Q(a,b){return a.line<b.line?!0:a.line==b.line&&a.ch<b.ch?!0:!1}function R(a,b,c){var d=Q(a,b),e=Q(b,c);return d&&e}function S(a,b){return a.getLine(b).length}function T(a){return a.split("").reverse().join("")}function U(a){return a.trim?a.trim():a.replace(/^\s+|\s+$/g,"")}function V(a){return a.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function W(a){a.off("mousedown",W);var b=a.state.vim;b.visualMode=!1,b.visualLine=!1;var c=a.getCursor("anchor"),d=a.getCursor("head");P(c,d)||a.setCursor(J(a,d)),CodeMirror.signal(a,"vim-mode-change",{mode:"normal"})}function X(a,b,c){var d=a.getRange(b,c);if(/\n\s*$/.test(d)){var e=d.split("\n");e.pop();for(var f,f=e.pop();e.length>0&&f&&t(f);f=e.pop())c.line--,c.ch=0;f?(c.line--,c.ch=S(a,c.line)):c.ch=0}}function Y(a,b,c){b.ch=0,c.ch=0,c.line++}function Z(a){if(!a)return 0;var b=a.search(/\S/);return-1==b?a.length:b}function $(a,b,c,d,e){var j,f=a.getCursor(),g=a.getLine(f.line),h=f.ch,i=g.substring(h);if(j=e?i.search(/\w/):i.search(/\S/),-1==j)return null;h+=j,i=g.substring(h);var l,k=g.substring(0,h);l=d?/^\S+/:/\w/.test(g.charAt(h))?/^\w+/:/^[^\w\s]+/;var m=l.exec(i),n=h,o=h+m[0].length,p=T(k),q=l.exec(p);if(q&&(n-=q[0].length),b){var r=g.substring(o),s=r.match(/^\s*/)[0].length;if(s>0)o+=s;else{var t=p.length-n,u=p.substring(t),v=u.match(/^\s*/)[0].length;n-=v}}return{start:{line:f.line,ch:n},end:{line:f.line,ch:o}}}function _(a,b,c){P(b,c)||y.jumpList.add(a,b,c)}function ab(a,b){y.lastChararacterSearch.increment=a,y.lastChararacterSearch.forward=b.forward,y.lastChararacterSearch.selectedCharacter=b.selectedCharacter}function db(a,b,c,d){var e=a.getCursor(),f=c?1:-1,g=c?a.lineCount():-1,h=e.ch,i=e.line,j=a.getLine(i),k={lineText:j,nextCh:j.charAt(h),lastCh:null,index:h,symb:d,reverseSymb:(c?{")":"(","}":"{"}:{"(":")","{":"}"})[d],forward:c,depth:0,curMoveThrough:!1},l=bb[d];if(!l)return e;var m=cb[l].init,n=cb[l].isComplete;for(m&&m(k);i!==g&&b;){if(k.index+=f,k.nextCh=k.lineText.charAt(k.index),!k.nextCh){if(i+=f,k.lineText=a.getLine(i)||"",f>0)k.index=0;else{var o=k.lineText.length;k.index=o>0?o-1:0}k.nextCh=k.lineText.charAt(k.index)}n(k)&&(e.line=i,e.ch=k.index,b--)}return k.nextCh||k.curMoveThrough?{line:i,ch:k.index}:e}function eb(a,b,c,d,g){var h=b.line,i=b.ch,j=a.getLine(h),k=c?1:-1,l=d?f:e;if(g&&""==j){if(h+=k,j=a.getLine(h),!o(a,h))return null;i=c?0:j.length}for(;;){if(g&&""==j)return{from:0,to:0,line:h};for(var m=k>0?j.length:-1,n=m,p=m;i!=m;){for(var q=!1,r=0;r<l.length&&!q;++r)if(l[r].test(j.charAt(i))){for(n=i;i!=m&&l[r].test(j.charAt(i));)i+=k;if(p=i,q=n!=p,n==b.ch&&h==b.line&&p==n+k)continue;return{from:Math.min(n,p+1),to:Math.max(n,p),line:h}}q||(i+=k)}if(h+=k,!o(a,h))return null;j=a.getLine(h),i=k>0?0:j.length}throw new Error("The impossible happened.")}function fb(a,b,c,d,e){var f=a.getCursor(),g=O(f),h=[];(c&&!d||!c&&d)&&b++;for(var i=!(c&&d),j=0;b>j;j++){var k=eb(a,f,c,e,i);if(!k){var l=S(a,a.lastLine());h.push(c?{line:a.lastLine(),from:l,to:l}:{line:0,from:0,to:0});break}h.push(k),f={line:k.line,ch:c?k.to-1:k.from}}var m=h.length!=b,n=h[0],o=h.pop();return c&&!d?(m||n.from==g.ch&&n.line==g.line||(o=h.pop()),{line:o.line,ch:o.from}):c&&d?{line:o.line,ch:o.to-1}:!c&&d?(m||n.to==g.ch&&n.line==g.line||(o=h.pop()),{line:o.line,ch:o.to}):{line:o.line,ch:o.from}}function gb(a,b,c,d){for(var g,e=a.getCursor(),f=e.ch,h=0;b>h;h++){var i=a.getLine(e.line);if(g=jb(f,i,d,c,!0),-1==g)return null;f=g}return{line:a.getCursor().line,ch:g}}function hb(a,b){var c=a.getCursor().line;return J(a,{line:c,ch:b-1})}function ib(a,b,c,d){u(c,m)&&(b.marks[c]&&b.marks[c].clear(),b.marks[c]=a.setBookmark(d))}function jb(a,b,c,d,e){var f;return d?(f=b.indexOf(c,a+1),-1==f||e||(f-=1)):(f=b.lastIndexOf(c,a-1),-1==f||e||(f+=1)),f
}function kb(a){return"string"===a||"comment"===a?1:0}function lb(a,b,c){var d=b.line,e=b.ch;c=c?c:a.getLine(d).charAt(e);var f=a.getTokenAt({line:d,ch:e+1}).type,g=kb(f),h={"(":")",")":"(","[":"]","]":"[","{":"}","}":"{"}[c];if(!h)return b;for(var i={"(":1,"{":1,"[":1}[c]||-1,j=1===i?a.lineCount():-1,k=1,l=c,m=e,n=a.getLine(d);d!==j&&k>0;){if(m+=i,l=n.charAt(m),!l){if(d+=i,n=a.getLine(d)||"",i>0)m=0;else{var o=n.length;m=o>0?o-1:0}l=n.charAt(m)}var p=a.getTokenAt({line:d,ch:m+1}).type,q=kb(p);g>=q&&(l===c?k++:l===h&&k--)}return l?{line:d,ch:m}:b}function mb(a,b,c){var d=a.getCursor(),e=lb(a,d,b),f=lb(a,e);return f.ch+=c?1:0,e.ch+=c?0:1,{start:f,end:e}}function nb(a,b,c){var g,h,i,j,d=a.getCursor(),e=a.getLine(d.line),f=e.split(""),k=f.indexOf(b);if(d.ch<k?d.ch=k:k<d.ch&&f[d.ch]==b&&(h=d.ch,--d.ch),f[d.ch]!=b||h)for(i=d.ch;i>-1&&!g;i--)f[i]==b&&(g=i+1);else g=d.ch+1;if(g&&!h)for(i=g,j=f.length;j>i&&!h;i++)f[i]==b&&(h=i);return g&&h?(c&&(--g,++h),{start:{line:d.line,ch:g},end:{line:d.line,ch:h}}):{start:d,end:d}}function ob(){}function pb(a){var b=a.state.vim;return b.searchState_||(b.searchState_=new ob)}function qb(a,b,c,d,e){a.openDialog?a.openDialog(b,d,{bottom:!0,value:e.value,onKeyDown:e.onKeyDown,onKeyUp:e.onKeyUp}):d(prompt(c,""))}function rb(a){for(var b=!1,c=[],d=0;d<a.length;d++){var e=a.charAt(d);b||"/"!=e||c.push(d),b="\\"==e}return c}function sb(a,b,c){if(a instanceof RegExp)return a;var e,f,d=rb(a);if(d.length){e=a.substring(0,d[0]);var g=a.substring(d[0]);f=-1!=g.indexOf("i")}else e=a;if(!e)return null;c&&(b=/^[^A-Z]*$/.test(e));var h=new RegExp(e,b||f?"i":void 0);return h}function tb(a,b){a.openConfirm?a.openConfirm('<span style="color: red">'+b+'</span> <button type="button">OK</button>',function(){},{bottom:!0}):alert(b)}function ub(a,b){var c="";return a&&(c+='<span style="font-family: monospace">'+a+"</span>"),c+='<input type="text"/> <span style="color: #888">',b&&(c+='<span style="color: #888">',c+=b,c+="</span>"),c}function wb(a,b){var c=(b.prefix||"")+" "+(b.desc||""),d=ub(b.prefix,b.desc);qb(a,d,c,b.onClose,b)}function xb(a,b){if(a instanceof RegExp&&b instanceof RegExp){for(var c=["global","multiline","ignoreCase","source"],d=0;d<c.length;d++){var e=c[d];if(a[e]!==b[e])return!1}return!0}return!1}function yb(a,b,c,d){if(b){var e=pb(a),f=sb(b,!!c,!!d);if(f)return Ab(a,f),xb(f,e.getQuery())?f:(e.setQuery(f),f)}}function zb(a){if("^"==a.source.charAt(0))var b=!0;return{token:function(c){if(b&&!c.sol())return c.skipToEnd(),void 0;var d=c.match(a,!1);if(d)return 0==d[0].length?(c.next(),"searching"):c.sol()||(c.backUp(1),a.exec(c.next()+d[0]))?(c.match(a),"searching"):(c.next(),null);for(;!c.eol()&&(c.next(),!c.match(a,!1)););},query:a}}function Ab(a,b){var c=pb(a).getOverlay();c&&b==c.query||(c&&a.removeOverlay(c),c=zb(b),a.addOverlay(c),pb(a).setOverlay(c))}function Bb(a,b,c,d){return void 0===d&&(d=1),a.operation(function(){for(var e=a.getCursor(),f=a.getSearchCursor(c,e),g=0;d>g;g++){var h=f.find(b);if(0==g&&h&&P(f.from(),e)&&(h=f.find(b)),!h&&(f=a.getSearchCursor(c,b?{line:a.lastLine()}:{line:a.firstLine(),ch:0}),!f.find(b)))return}return f.from()})}function Cb(a){a.removeOverlay(pb(a).getOverlay()),pb(a).setOverlay(null)}function Db(a,b,c){return"number"!=typeof a&&(a=a.line),b instanceof Array?u(a,b):c?a>=b&&c>=a:a==b}function Eb(a){var b=a.getScrollInfo(),c=6,d=10,e=a.coordsChar({left:0,top:c+b.top},"local"),f=b.clientHeight-d+b.top,g=a.coordsChar({left:0,top:f},"local");return{top:e.line,bottom:g.line}}function Gb(a){for(var b,c,d=[];a&&(c=/<\w+-.+?>|<\w+>|./.exec(a),null!==c);)b=c[0],a=a.substring(c.index+b.length),d.push(b);return d}function Jb(a,b,c,d,e,f,g){function j(){a.operation(function(){for(;!h;)k(),l();m()})}function k(){var b=a.getRange(e.from(),e.to()),c=b.replace(f,g);e.replace(c)}function l(){var b=e.findNext();b?Db(e.from(),c,d)?(a.scrollIntoView(e.from(),30),a.setSelection(e.from(),e.to()),i=e.from(),h=!1):h=!0:h=!0}function m(b){if(b&&b(),a.focus(),i){a.setCursor(i);var c=a.state.vim;c.exMode=!1,c.lastHPos=c.lastHSPos=i.ch}}function n(b,c,d){CodeMirror.e_stop(b);var e=CodeMirror.keyName(b);switch(e){case"Y":k(),l();break;case"N":l();break;case"A":a.operation(j);break;case"L":k();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":m(d)}h&&m(d)}a.state.vim.exMode=!0;var h=!1,i=e.from();if(l(),h)throw new Error("No matches for "+f.source);return b?(wb(a,{prefix:"replace with <strong>"+g+"</strong> (y/n/a/q/l)",onKeyDown:n}),void 0):(j(),void 0)}function Kb(){function a(a,b){var c=a;s(c)&&("Shift"==b?b=null:c=c.toLowerCase()),b&&(c=b.charAt(0)+"-"+c);var d={Enter:"CR",Backspace:"BS",Delete:"Del"}[c];return c=d?d:c,c=c.length>1?"<"+c+">":c}function b(a){return function(b){CodeMirror.Vim.handleKey(b,a)}}function d(d,e){for(var f=0;f<d.length;f++){var g=d[f];!e&&u(g,k)&&(g="'"+g+"'");var h=a(d[f],e),i=e?e+"-"+g:g;c[i]=b(h)}}var c={nofallthrough:!0,disableInput:!0,style:"fat-cursor"};return d(h),d(h,"Shift"),d(h,"Ctrl"),d(k),d(k,"Ctrl"),d(j),d(j,"Ctrl"),d(l),d(l,"Ctrl"),c}function Lb(a){var b=a.state.vim,c=y.macroModeState.inReplay;c||(a.off("change",Rb),a.off("cursorActivity",Sb),CodeMirror.off(a.getInputField(),"keydown",Ub)),!c&&b.insertModeRepeat>1&&(Vb(a,b,b.insertModeRepeat-1,!0),b.lastEditInputState.repeatOverride=b.insertModeRepeat),delete b.insertModeRepeat,a.setCursor(a.getCursor().line,a.getCursor().ch-1,!0),b.insertMode=!1,a.setOption("keyMap","vim"),a.toggleOverwrite(!1),CodeMirror.signal(a,"vim-mode-change",{mode:"normal"})}function Mb(a,b){var c,d,e=y.registerController.getRegister(b),f=e.toString(),g=a.macroKeyBuffer;Ob(a);do{if(c=/<\w+-.+?>|<\w+>|./.exec(f),null===c)break;d=c[0],f=f.substring(c.index+d.length),g.push(d)}while(f);return g}function Nb(a,b){var c=b.join("");y.registerController.setRegisterText(a,c)}function Ob(a){if(!a.isMacroPlaying){var b=a.macroKeyBuffer;b.length=0}}function Pb(a,b,c){b.isMacroPlaying=!0;for(var d=0,e=c.length;e>d;d++)CodeMirror.Vim.handleKey(a,c[d]);b.isMacroPlaying=!1}function Qb(a,b){if(!a.isMacroPlaying){var c=a.macroKeyBuffer;c.push(b)}}function Rb(a,b){for(var c=y.macroModeState,d=c.lastInsertModeChanges;b;){if(d.expectCursorActivityForChange=!0,"+input"==b.origin||"paste"==b.origin||void 0===b.origin){var e=b.text.join("\n");d.changes.push(e)}b=b.next}}function Sb(){var a=y.macroModeState,b=a.lastInsertModeChanges;b.expectCursorActivityForChange?b.expectCursorActivityForChange=!1:b.changes=[]}function Tb(a){this.keyName=a}function Ub(a){function e(){return c.changes.push(new Tb(d)),!0}var b=y.macroModeState,c=b.lastInsertModeChanges,d=CodeMirror.keyName(a);(-1!=d.indexOf("Delete")||-1!=d.indexOf("Backspace"))&&CodeMirror.lookupKey(d,["vim-insert"],e)}function Vb(a,b,c,d){function h(){f?E.processAction(a,b,b.lastEditActionCommand):E.evalInput(a,b)}function i(c){e.lastInsertModeChanges.changes.length>0&&(c=b.lastEditActionCommand?c:1,Wb(a,c,e))}var e=y.macroModeState;e.inReplay=!0;var f=!!b.lastEditActionCommand,g=b.inputState;if(b.inputState=b.lastEditInputState,f&&b.lastEditActionCommand.interlaceInsertRepeat)for(var j=0;c>j;j++)h(),i(1);else d||h(),i(c);b.inputState=g,b.insertMode&&!d&&Lb(a),e.inReplay=!1}function Wb(a,b,c){function e(b){return"string"==typeof b?CodeMirror.commands[b](a):b(a),!0}for(var d=c.lastInsertModeChanges,f=0;b>f;f++)for(var g=0;g<d.changes.length;g++){var h=d.changes[g];if(h instanceof Tb)CodeMirror.lookupKey(h.keyName,["vim-insert"],e);else{var i=a.getCursor();a.replaceRange(h,i,i)}}}CodeMirror.defineOption("vimMode",!1,function(a,b){b?(a.setOption("keyMap","vim"),CodeMirror.signal(a,"vim-mode-change",{mode:"normal"}),a.on("beforeSelectionChange",c),x(a)):a.state.vim&&(a.setOption("keyMap","default"),a.off("beforeSelectionChange",c),a.state.vim=null)});var y,d=/[\d]/,e=[/\w/,/[^\w\s]/],f=[/\S/],h=g(65,26),i=g(97,26),j=g(48,10),k="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split(""),l=["Left","Right","Up","Down","Space","Backspace","Esc","Home","End","PageUp","PageDown","Enter"],m=[].concat(h,i,j,["<",">"]),n=[].concat(h,i,j,["-",'"']),v=function(){function f(f,g,h){function k(c){var d=++b%a,g=e[d];g&&g.clear(),e[d]=f.setBookmark(c)}var i=b%a,j=e[i];if(j){var l=j.find();l&&!P(l,g)&&k(g)}else k(g);k(h),c=b,d=b-a+1,0>d&&(d=0)}function g(f,g){b+=g,b>c?b=c:d>b&&(b=d);var h=e[(a+b)%a];if(h&&!h.find()){var j,i=g>0?1:-1,k=f.getCursor();do if(b+=i,h=e[(a+b)%a],h&&(j=h.find())&&!P(k,j))break;while(c>b&&b>d)}return h}var a=100,b=-1,c=0,d=0,e=new Array(a);return{cachedCursor:void 0,add:f,move:g}},w=function(){return{macroKeyBuffer:[],latestRegister:void 0,inReplay:!1,lastInsertModeChanges:{changes:[],expectCursorActivityForChange:!1},enteredMacroMode:void 0,isMacroPlaying:!1,toggle:function(a,b){this.enteredMacroMode?(this.enteredMacroMode(),this.enteredMacroMode=void 0):(this.latestRegister=b,this.enteredMacroMode=a.openDialog("(recording)["+b+"]",null,{bottom:!0}))}}},A={buildKeyMap:function(){},getRegisterController:function(){return y.registerController},resetVimGlobalState_:z,getVimGlobalState_:function(){return y},maybeInitVimState_:x,InsertModeKey:Tb,map:function(a,b){Ib.map(a,b)},defineEx:function(a,b,c){if(0!==a.indexOf(b))throw new Error('(Vim.defineEx) "'+b+'" is not a prefix of "'+a+'", command not registered');Hb[a]=c,Ib.commandMap_[b]={name:a,shortName:b,type:"api"}},handleKey:function(b,c){var d,e=x(b),f=y.macroModeState;if(f.enteredMacroMode&&"q"==c)return H.exitMacroRecordMode(),e.inputState=new B,void 0;if("<Esc>"==c)return e.inputState=new B,e.visualMode&&W(b),void 0;if(e.visualMode||P(b.getCursor("head"),b.getCursor("anchor"))||(e.visualMode=!0,e.visualLine=!1,CodeMirror.signal(b,"vim-mode-change",{mode:"visual"}),b.on("mousedown",W)),("0"!=c||"0"==c&&0===e.inputState.getRepeat())&&(d=E.matchCommand(c,a,e)),!d)return r(c)&&e.inputState.pushRepeatDigit(c),void 0;if("keyToKey"==d.type)for(var g=0;g<d.toKeys.length;g++)this.handleKey(b,d.toKeys[g]);else f.enteredMacroMode&&Qb(f,c),E.processCommand(b,e,d)}};B.prototype.pushRepeatDigit=function(a){this.operator?this.motionRepeat=this.motionRepeat.concat(a):this.prefixRepeat=this.prefixRepeat.concat(a)},B.prototype.getRepeat=function(){var a=0;return(this.prefixRepeat.length>0||this.motionRepeat.length>0)&&(a=1,this.prefixRepeat.length>0&&(a*=parseInt(this.prefixRepeat.join(""),10)),this.motionRepeat.length>0&&(a*=parseInt(this.motionRepeat.join(""),10))),a},C.prototype={set:function(a,b){this.text=a,this.linewise=!!b},append:function(a,b){b||this.linewise?(this.text+="\n"+a,this.linewise=!0):this.text+=a},clear:function(){this.text="",this.linewise=!1},toString:function(){return this.text}},D.prototype={pushText:function(a,b,c,d){d&&"\n"==c.charAt(0)&&(c=c.slice(1)+"\n");var e=this.isValidRegister(a)?this.getRegister(a):null;if(!e){switch(b){case"yank":this.registers["0"]=new C(c,d);break;case"delete":case"change":-1==c.indexOf("\n")?this.registers["-"]=new C(c,d):(this.shiftNumericRegisters_(),this.registers["1"]=new C(c,d))}return this.unamedRegister.set(c,d),void 0}var f=s(a);f?(e.append(c,d),this.unamedRegister.append(c,d)):(e.set(c,d),this.unamedRegister.set(c,d))},setRegisterText:function(a,b,c){this.getRegister(a).set(b,c)},getRegister:function(a){return this.isValidRegister(a)?(a=a.toLowerCase(),this.registers[a]||(this.registers[a]=new C),this.registers[a]):this.unamedRegister},isValidRegister:function(a){return a&&u(a,n)},shiftNumericRegisters_:function(){for(var a=9;a>=2;a--)this.registers[a]=this.getRegister(""+(a-1))}};var E={matchCommand:function(a,b,c){for(var d=c.inputState,e=d.keyBuffer.concat(a),f=0;f<b.length;f++){var g=b[f];if(M(e,g.keys)){if(e.length<g.keys.length)return d.keyBuffer.push(a),null;if(d.operator&&"action"==g.type)continue;if("character"==g.keys[e.length-1]&&(d.selectedCharacter=e[e.length-1],d.selectedCharacter.length>1))switch(d.selectedCharacter){case"<CR>":d.selectedCharacter="\n";break;case"<Space>":d.selectedCharacter=" ";break;default:continue}return d.keyBuffer=[],g}}return d.keyBuffer=[],null},processCommand:function(a,b,c){switch(b.inputState.repeatOverride=c.repeatOverride,c.type){case"motion":this.processMotion(a,b,c);break;case"operator":this.processOperator(a,b,c);break;case"operatorMotion":this.processOperatorMotion(a,b,c);break;case"action":this.processAction(a,b,c);break;case"search":this.processSearch(a,b,c);break;case"ex":case"keyToEx":this.processEx(a,b,c)}},processMotion:function(a,b,c){b.inputState.motion=c.motion,b.inputState.motionArgs=K(c.motionArgs),this.evalInput(a,b)},processOperator:function(a,b,c){var d=b.inputState;if(d.operator){if(d.operator==c.operator)return d.motion="expandToLine",d.motionArgs={linewise:!0},this.evalInput(a,b),void 0;b.inputState=new B}d.operator=c.operator,d.operatorArgs=K(c.operatorArgs),b.visualMode&&this.evalInput(a,b)},processOperatorMotion:function(a,b,c){var d=b.visualMode,e=K(c.operatorMotionArgs);e&&d&&e.visualLine&&(b.visualLine=!0),this.processOperator(a,b,c),d||this.processMotion(a,b,c)},processAction:function(a,b,c){var d=b.inputState,e=d.getRepeat(),f=!!e,g=K(c.actionArgs)||{};d.selectedCharacter&&(g.selectedCharacter=d.selectedCharacter),c.operator&&this.processOperator(a,b,c),c.motion&&this.processMotion(a,b,c),(c.motion||c.operator)&&this.evalInput(a,b),g.repeat=e||1,g.repeatIsExplicit=f,g.registerName=d.registerName,b.inputState=new B,b.lastMotion=null,c.isEdit&&this.recordLastEdit(b,d,c),H[c.action](a,g,b)},processSearch:function(a,b,c){function h(d,e,f){try{yb(a,d,e,f)}catch(g){return tb(a,"Invalid regex: "+d),void 0}E.processMotion(a,b,{type:"motion",motion:"findNext",motionArgs:{forward:!0,toJumplist:c.searchArgs.toJumplist}})}function i(b){a.scrollTo(g.left,g.top),h(b,!0,!0)}function j(b,c){var e;try{e=yb(a,c,!0,!0)}catch(f){}e?a.scrollIntoView(Bb(a,!d,e),30):(Cb(a),a.scrollTo(g.left,g.top))}function k(b,c,d){var e=CodeMirror.keyName(b);("Esc"==e||"Ctrl-C"==e||"Ctrl-["==e)&&(yb(a,f),Cb(a),a.scrollTo(g.left,g.top),CodeMirror.e_stop(b),d(),a.focus())}if(a.getSearchCursor){var d=c.searchArgs.forward;pb(a).setReversed(!d);var e=d?"/":"?",f=pb(a).getQuery(),g=a.getScrollInfo();switch(c.searchArgs.querySrc){case"prompt":wb(a,{onClose:i,prefix:e,desc:vb,onKeyUp:j,onKeyDown:k});break;case"wordUnderCursor":var l=$(a,!1,!0,!1,!0),m=!0;if(l||(l=$(a,!1,!0,!1,!1),m=!1),!l)return;var n=a.getLine(l.start.line).substring(l.start.ch,l.end.ch);n=m?"\\b"+n+"\\b":V(n),y.jumpList.cachedCursor=a.getCursor(),a.setCursor(l.start),h(n,!0,!1)}}},processEx:function(a,b,c){function d(b){Ib.processCommand(a,b)}function e(b,c,d){var e=CodeMirror.keyName(b);("Esc"==e||"Ctrl-C"==e||"Ctrl-["==e)&&(CodeMirror.e_stop(b),d(),a.focus())}"keyToEx"==c.type?Ib.processCommand(a,c.exArgs.input):b.visualMode?wb(a,{onClose:d,prefix:":",value:"'<,'>",onKeyDown:e}):wb(a,{onClose:d,prefix:":",onKeyDown:e})},evalInput:function(a,b){var m,n,c=b.inputState,d=c.motion,e=c.motionArgs||{},f=c.operator,g=c.operatorArgs||{},h=c.registerName,i=a.getCursor("head"),j=a.getCursor("anchor"),k=O(i),l=O(k);if(f&&this.recordLastEdit(b,c),n=void 0!==c.repeatOverride?c.repeatOverride:c.getRepeat(),n>0&&e.explicitRepeat?e.repeatIsExplicit=!0:(e.noRepeat||!e.explicitRepeat&&0===n)&&(n=1,e.repeatIsExplicit=!1),c.selectedCharacter&&(e.selectedCharacter=g.selectedCharacter=c.selectedCharacter),e.repeat=n,b.inputState=new B,d){var o=F[d](a,e,b);if(b.lastMotion=F[d],!o)return;if(e.toJumplist){var p=y.jumpList,q=p.cachedCursor;q?(_(a,q,o),delete p.cachedCursor):_(a,l,o)}if(o instanceof Array?(k=o[0],m=o[1]):m=o,m||(m={ch:k.ch,line:k.line}),b.visualMode){if(Q(j,i)&&(P(j,m)||Q(m,j))?j.ch+=1:Q(i,j)&&(P(j,m)||Q(j,m))&&(j.ch-=1),i=m,b.visualLine)if(Q(j,i)){j.ch=0;var r=a.lastLine();i.line>r&&(i.line=r),i.ch=S(a,i.line)}else i.ch=0,j.ch=S(a,j.line);a.setSelection(j,i),ib(a,b,"<",Q(j,i)?j:i),ib(a,b,">",Q(j,i)?i:j)}else f||(m=J(a,m),a.setCursor(m.line,m.ch))}if(f){var s=!1;if(b.lastMotion=null,g.repeat=n,b.visualMode&&(k=j,m=i,e.inclusive=!0),Q(m,k)){var t=k;k=m,m=t,s=!0}!e.inclusive||b.visualMode&&s||m.ch++;var u=e.linewise||b.visualMode&&b.visualLine;u?Y(a,k,m):e.forward&&X(a,k,m),g.registerName=h,g.linewise=u,G[f](a,g,b,k,m,l),b.visualMode&&W(a)}},recordLastEdit:function(a,b,c){var d=y.macroModeState;d.inReplay||(a.lastEditInputState=b,a.lastEditActionCommand=c,d.lastInsertModeChanges.changes=[],d.lastInsertModeChanges.expectCursorActivityForChange=!1)}},F={moveToTopLine:function(a,b){var c=Eb(a).top+b.repeat-1;return{line:c,ch:Z(a.getLine(c))}},moveToMiddleLine:function(a){var b=Eb(a),c=Math.floor(.5*(b.top+b.bottom));return{line:c,ch:Z(a.getLine(c))}},moveToBottomLine:function(a,b){var c=Eb(a).bottom-b.repeat+1;return{line:c,ch:Z(a.getLine(c))}},expandToLine:function(a,b){var c=a.getCursor();return{line:c.line+b.repeat-1,ch:1/0}},findNext:function(a,b){var c=pb(a),d=c.getQuery();if(d){var e=!b.forward;return e=c.isReversed()?!e:e,Ab(a,d),Bb(a,e,d,b.repeat)}},goToMark:function(a,b,c){var d=c.marks[b.selectedCharacter];return d?d.find():null},jumpToMark:function(a,b,c){for(var d=a.getCursor(),e=0;e<b.repeat;e++){var f=d;for(var g in c.marks)if(p(g)){var h=c.marks[g].find(),i=b.forward?Q(h,f):Q(f,h);if(!(i||b.linewise&&h.line==f.line)){var j=P(f,d),k=b.forward?R(f,h,d):R(d,h,f);(j||k)&&(d=h)}}}return b.linewise&&(d.ch=Z(a.getLine(d.line))),d},moveByCharacters:function(a,b){var c=a.getCursor(),d=b.repeat,e=b.forward?c.ch+d:c.ch-d;return{line:c.line,ch:e}},moveByLines:function(a,b,c){var d=a.getCursor(),e=d.ch;switch(c.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:e=c.lastHPos;break;default:c.lastHPos=e}var f=b.repeat+(b.repeatOffset||0),g=b.forward?d.line+f:d.line-f,h=a.firstLine(),i=a.lastLine();return h>g&&d.line==h||g>i&&d.line==i?void 0:(b.toFirstChar&&(e=Z(a.getLine(g)),c.lastHPos=e),c.lastHSPos=a.charCoords({line:g,ch:e},"div").left,{line:g,ch:e})},moveByDisplayLines:function(a,b,c){var d=a.getCursor();switch(c.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:c.lastHSPos=a.charCoords(d,"div").left}var e=b.repeat,f=a.findPosV(d,b.forward?e:-e,"line",c.lastHSPos);if(f.hitSide)if(b.forward)var g=a.charCoords(f,"div"),h={top:g.top+8,left:c.lastHSPos},f=a.coordsChar(h,"div");else{var i=a.charCoords({line:a.firstLine(),ch:0},"div");i.left=c.lastHSPos,f=a.coordsChar(i,"div")}return c.lastHPos=f.ch,f},moveByPage:function(a,b){var c=a.getCursor(),d=b.repeat;a.moveV(b.forward?d:-d,"page");var e=a.getCursor();return a.setCursor(c),e},moveByParagraph:function(a,b){for(var c=a.getCursor().line,d=b.repeat,e=b.forward?1:-1,f=0;d>f&&!(!b.forward&&c===a.firstLine()||b.forward&&c==a.lastLine());f++)for(c+=e;c!==a.firstLine()&&c!=a.lastLine()&&a.getLine(c);)c+=e;return{line:c,ch:0}},moveByScroll:function(a,b,c){var d=a.getScrollInfo(),e=null,f=b.repeat;f||(f=d.clientHeight/(2*a.defaultTextHeight()));var g=a.charCoords(a.getCursor(),"local");b.repeat=f;var e=F.moveByDisplayLines(a,b,c);if(!e)return null;var h=a.charCoords(e,"local");return a.scrollTo(null,d.top+h.top-g.top),e},moveByWords:function(a,b){return fb(a,b.repeat,!!b.forward,!!b.wordEnd,!!b.bigWord)},moveTillCharacter:function(a,b){var c=b.repeat,d=gb(a,c,b.forward,b.selectedCharacter),e=b.forward?-1:1;return ab(e,b),d?(d.ch+=e,d):a.getCursor()},moveToCharacter:function(a,b){var c=b.repeat;return ab(0,b),gb(a,c,b.forward,b.selectedCharacter)||a.getCursor()},moveToSymbol:function(a,b){var c=b.repeat;return db(a,c,b.forward,b.selectedCharacter)||a.getCursor()},moveToColumn:function(a,b,c){var d=b.repeat;return c.lastHPos=d-1,c.lastHSPos=a.charCoords(a.getCursor(),"div").left,hb(a,d)},moveToEol:function(a,b,c){var d=a.getCursor();c.lastHPos=1/0;var e={line:d.line+b.repeat-1,ch:1/0},f=a.clipPos(e);return f.ch--,c.lastHSPos=a.charCoords(f,"div").left,e},moveToFirstNonWhiteSpaceCharacter:function(a){var b=a.getCursor();return{line:b.line,ch:Z(a.getLine(b.line))}},moveToMatchedSymbol:function(a){var f,b=a.getCursor(),c=b.line,d=b.ch,e=a.getLine(c),g=a.getTokenAt(b).type,h=kb(g);do if(f=e.charAt(d++),f&&q(f)){var i=a.getTokenAt({line:c,ch:d}).type,j=kb(i);if(h>=j)break}while(f);return f?lb(a,{line:c,ch:d-1},f):b},moveToStartOfLine:function(a){var b=a.getCursor();return{line:b.line,ch:0}},moveToLineOrEdgeOfDocument:function(a,b){var c=b.forward?a.lastLine():a.firstLine();return b.repeatIsExplicit&&(c=b.repeat-a.getOption("firstLineNumber")),{line:c,ch:Z(a.getLine(c))}},textObjectManipulation:function(a,b){var c=b.selectedCharacter,d=!b.textObjectInner;if(!I[c])return null;var e=I[c](a,d),f=e.start,g=e.end;return[f,g]},repeatLastCharacterSearch:function(a,b){var c=y.lastChararacterSearch,d=b.repeat,e=b.forward===c.forward,f=(c.increment?1:0)*(e?-1:1);a.moveH(-f,"char"),b.inclusive=e?!0:!1;var g=gb(a,d,e,c.selectedCharacter);return g?(g.ch+=f,g):(a.moveH(f,"char"),a.getCursor())}},G={change:function(a,b,c,d,e){if(y.registerController.pushText(b.registerName,"change",a.getRange(d,e),b.linewise),b.linewise){var f=e.line>a.lastLine()?"":"\n";a.replaceRange(f,d,e),a.indentLine(d.line,"smart"),d.ch=null}else{var g=a.getRange(d,e);if(!t(g)){var h=/\s+$/.exec(g);h&&(e=L(e,0,-h[0].length))}a.replaceRange("",d,e)}H.enterInsertMode(a,{},a.state.vim),a.setCursor(d)},"delete":function(a,b,c,d,e){b.linewise&&e.line>a.lastLine()&&d.line>a.firstLine()&&(d.line--,d.ch=S(a,d.line)),y.registerController.pushText(b.registerName,"delete",a.getRange(d,e),b.linewise),a.replaceRange("",d,e),b.linewise?a.setCursor(F.moveToFirstNonWhiteSpaceCharacter(a)):a.setCursor(d)},indent:function(a,b,c,d,e){var f=d.line,g=e.line,h=c.visualMode?b.repeat:1;b.linewise&&g--;for(var i=f;g>=i;i++)for(var j=0;h>j;j++)a.indentLine(i,b.indentRight);a.setCursor(d),a.setCursor(F.moveToFirstNonWhiteSpaceCharacter(a))},swapcase:function(a,b,c,d,e,f){for(var g=a.getRange(d,e),h="",i=0;i<g.length;i++){var j=g.charAt(i);h+=s(j)?j.toLowerCase():j.toUpperCase()}a.replaceRange(h,d,e),b.shouldMoveCursor||a.setCursor(f)},yank:function(a,b,c,d,e,f){y.registerController.pushText(b.registerName,"yank",a.getRange(d,e),b.linewise),a.setCursor(f)}},H={jumpListWalk:function(a,b,c){if(!c.visualMode){var d=b.repeat,e=b.forward,f=y.jumpList,g=f.move(a,e?d:-d),h=g?g.find():void 0;h=h?h:a.getCursor(),a.setCursor(h)}},scrollToCursor:function(a,b){var c=a.getCursor().line,d=a.charCoords({line:c,ch:0},"local"),e=a.getScrollInfo().clientHeight,f=d.top,g=d.bottom-f;switch(b.position){case"center":f=f-e/2+g;break;case"bottom":f=f-e+1.4*g;break;case"top":f+=.4*g}a.scrollTo(null,f)},replayMacro:function(a,b){var c=b.selectedCharacter,d=b.repeat,e=y.macroModeState;"@"==c&&(c=e.latestRegister);for(var f=Mb(e,c);d--;)Pb(a,e,f)},exitMacroRecordMode:function(){var a=y.macroModeState;a.toggle(),Nb(a.latestRegister,a.macroKeyBuffer)},enterMacroRecordMode:function(a,b){var c=y.macroModeState,d=b.selectedCharacter;c.toggle(a,d),Ob(c)},enterInsertMode:function(a,b,c){if(!a.getOption("readOnly")){c.insertMode=!0,c.insertModeRepeat=b&&b.repeat||1;var d=b?b.insertAt:null;if("eol"==d){var e=a.getCursor();e={line:e.line,ch:S(a,e.line)},a.setCursor(e)}else"charAfter"==d?a.setCursor(L(a.getCursor(),0,1)):"firstNonBlank"==d&&a.setCursor(F.moveToFirstNonWhiteSpaceCharacter(a));a.setOption("keyMap","vim-insert"),b&&b.replace?(a.toggleOverwrite(!0),a.setOption("keyMap","vim-replace"),CodeMirror.signal(a,"vim-mode-change",{mode:"replace"})):(a.setOption("keyMap","vim-insert"),CodeMirror.signal(a,"vim-mode-change",{mode:"insert"})),y.macroModeState.inReplay||(a.on("change",Rb),a.on("cursorActivity",Sb),CodeMirror.on(a.getInputField(),"keydown",Ub))}},toggleVisualMode:function(a,b,c){var f,d=b.repeat,e=a.getCursor();c.visualMode?(e=a.getCursor("anchor"),f=a.getCursor("head"),!c.visualLine&&b.linewise?(c.visualLine=!0,e.ch=Q(e,f)?0:S(a,e.line),f.ch=Q(e,f)?S(a,f.line):0,a.setSelection(e,f),CodeMirror.signal(a,"vim-mode-change",{mode:"visual",subMode:"linewise"})):c.visualLine&&!b.linewise?(c.visualLine=!1,CodeMirror.signal(a,"vim-mode-change",{mode:"visual"})):W(a)):(a.on("mousedown",W),c.visualMode=!0,c.visualLine=!!b.linewise,c.visualLine?(e.ch=0,f=J(a,{line:e.line+d-1,ch:S(a,e.line)},!0)):f=J(a,{line:e.line,ch:e.ch+d},!0),b.repeatIsExplicit||c.visualLine?a.setSelection(e,f):(a.setCursor(f),a.setSelection(f,e)),CodeMirror.signal(a,"vim-mode-change",{mode:"visual",subMode:c.visualLine?"linewise":""})),ib(a,c,"<",Q(e,f)?e:f),ib(a,c,">",Q(e,f)?f:e)},joinLines:function(a,b,c){var d,e;if(c.visualMode)d=a.getCursor("anchor"),e=a.getCursor("head"),e.ch=S(a,e.line)-1;else{var f=Math.max(b.repeat,2);d=a.getCursor(),e=J(a,{line:d.line+f-1,ch:1/0})}var g=0;a.operation(function(){for(var b=d.line;b<e.line;b++){g=S(a,d.line);var c={line:d.line+1,ch:S(a,d.line+1)},f=a.getRange(d,c);f=f.replace(/\n\s*/g," "),a.replaceRange(f,d,c)}var h={line:d.line,ch:g};a.setCursor(h)})},newLineAndEnterInsertMode:function(a,b,c){c.insertMode=!0;var d=a.getCursor();if(d.line!==a.firstLine()||b.after){d.line=b.after?d.line:d.line-1,d.ch=S(a,d.line),a.setCursor(d);var e=CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent;e(a)}else a.replaceRange("\n",{line:a.firstLine(),ch:0}),a.setCursor(a.firstLine(),0);this.enterInsertMode(a,{repeat:b.repeat},c)},paste:function(a,b){var c=a.getCursor(),d=y.registerController.getRegister(b.registerName);if(d.text){for(var e="",f=0;f<b.repeat;f++)e+=d.text;var g=d.linewise;g?b.after?(e="\n"+e.slice(0,e.length-1),c.ch=S(a,c.line)):c.ch=0:c.ch+=b.after?1:0,a.replaceRange(e,c);var h,i;g&&b.after?h={line:c.line+1,ch:Z(a.getLine(c.line+1))}:g&&!b.after?h={line:c.line,ch:Z(a.getLine(c.line))}:!g&&b.after?(i=a.indexFromPos(c),h=a.posFromIndex(i+e.length-1)):(i=a.indexFromPos(c),h=a.posFromIndex(i+e.length)),a.setCursor(h)}},undo:function(a,b){a.operation(function(){N(a,CodeMirror.commands.undo,b.repeat)(),a.setCursor(a.getCursor("anchor"))})},redo:function(a,b){N(a,CodeMirror.commands.redo,b.repeat)()},setRegister:function(a,b,c){c.inputState.registerName=b.selectedCharacter},setMark:function(a,b,c){var d=b.selectedCharacter;ib(a,c,d,a.getCursor())},replace:function(a,b,c){var f,g,d=b.selectedCharacter,e=a.getCursor();if(c.visualMode)e=a.getCursor("start"),g=a.getCursor("end"),g=a.clipPos({line:g.line,ch:g.ch+1});else{var h=a.getLine(e.line);f=e.ch+b.repeat,f>h.length&&(f=h.length),g={line:e.line,ch:f}}if("\n"==d)c.visualMode||a.replaceRange("",e,g),(CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent)(a);else{var i=a.getRange(e,g);i=i.replace(/[^\n]/g,d),a.replaceRange(i,e,g),c.visualMode?(a.setCursor(e),W(a)):a.setCursor(L(g,0,-1))}},incrementNumberToken:function(a,b){for(var f,g,h,i,j,c=a.getCursor(),d=a.getLine(c.line),e=/-?\d+/g;null!==(f=e.exec(d))&&(j=f[0],g=f.index,h=g+j.length,!(c.ch<h)););if((b.backtrack||!(h<=c.ch))&&j){var k=b.increase?1:-1,l=parseInt(j)+k*b.repeat,m={ch:g,line:c.line},n={ch:h,line:c.line};i=l.toString(),a.replaceRange(i,m,n),a.setCursor({line:c.line,ch:g+i.length-1})}},repeatLastEdit:function(a,b,c){var d=c.lastEditInputState;if(d){var e=b.repeat;e&&b.repeatIsExplicit?c.lastEditInputState.repeatOverride=e:e=c.lastEditInputState.repeatOverride||e,Vb(a,c,e,!1)}}},I={w:function(a,b){return $(a,b,!0,!1)},W:function(a,b){return $(a,b,!0,!0)},"{":function(a,b){return mb(a,"}",b)},"(":function(a,b){return mb(a,")",b)},"[":function(a,b){return mb(a,"]",b)},"'":function(a,b){return nb(a,"'",b)},'"':function(a,b){return nb(a,'"',b)}},bb={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"},cb={bracket:{isComplete:function(a){if(a.nextCh===a.symb){if(a.depth++,a.depth>=1)return!0}else a.nextCh===a.reverseSymb&&a.depth--;return!1}},section:{init:function(a){a.curMoveThrough=!0,a.symb=(a.forward?"]":"[")===a.symb?"{":"}"},isComplete:function(a){return 0===a.index&&a.nextCh===a.symb}},comment:{isComplete:function(a){var b="*"===a.lastCh&&"/"===a.nextCh;return a.lastCh=a.nextCh,b}},method:{init:function(a){a.symb="m"===a.symb?"{":"}",a.reverseSymb="{"===a.symb?"}":"{"},isComplete:function(a){return a.nextCh===a.symb?!0:!1}},preprocess:{init:function(a){a.index=0},isComplete:function(a){if("#"===a.nextCh){var b=a.lineText.match(/#(\w+)/)[1];if("endif"===b){if(a.forward&&0===a.depth)return!0;a.depth++}else if("if"===b){if(!a.forward&&0===a.depth)return!0;a.depth--}if("else"===b&&0===a.depth)return!0}return!1}}};ob.prototype={getQuery:function(){return y.query},setQuery:function(a){y.query=a},getOverlay:function(){return this.searchOverlay},setOverlay:function(a){this.searchOverlay=a},isReversed:function(){return y.isReversed},setReversed:function(a){y.isReversed=a}};var vb="(Javascript regexp)",Fb=[{name:"map",type:"builtIn"},{name:"write",shortName:"w",type:"builtIn"},{name:"undo",shortName:"u",type:"builtIn"},{name:"redo",shortName:"red",type:"builtIn"},{name:"sort",shortName:"sor",type:"builtIn"},{name:"substitute",shortName:"s",type:"builtIn"},{name:"nohlsearch",shortName:"noh",type:"builtIn"},{name:"delmarks",shortName:"delm",type:"builtin"}];b.ExCommandDispatcher=function(){this.buildCommandMap_()},b.ExCommandDispatcher.prototype={processCommand:function(a,b){var c=a.state.vim;c.visualMode&&W(a);var d=new CodeMirror.StringStream(b),e={};e.input=b;try{this.parseInput_(a,d,e)}catch(f){return tb(a,f),void 0}var g;if(e.commandName){var h=this.matchCommand_(e.commandName);if(h){if(g=h.name,this.parseCommandArgs_(d,e,h),"exToKey"==h.type){for(var i=0;i<h.toKeys.length;i++)CodeMirror.Vim.handleKey(a,h.toKeys[i]);return}if("exToEx"==h.type)return this.processCommand(a,h.toInput),void 0}}else void 0!==e.line&&(g="move");if(!g)return tb(a,'Not an editor command ":'+b+'"'),void 0;try{Hb[g](a,e)}catch(f){tb(a,f)}},parseInput_:function(a,b,c){b.eatWhile(":"),b.eat("%")?(c.line=a.firstLine(),c.lineEnd=a.lastLine()):(c.line=this.parseLineSpec_(a,b),void 0!==c.line&&b.eat(",")&&(c.lineEnd=this.parseLineSpec_(a,b)));var d=b.match(/^(\w+)/);return c.commandName=d?d[1]:b.match(/.*/)[0],c},parseLineSpec_:function(a,b){var c=b.match(/^(\d+)/);if(c)return parseInt(c[1],10)-1;switch(b.next()){case".":return a.getCursor().line;case"$":return a.lastLine();case"'":var d=a.state.vim.marks[b.next()];if(d&&d.find())return d.find().line;throw new Error("Mark not set");default:return b.backUp(1),void 0}},parseCommandArgs_:function(a,b,c){if(!a.eol()){b.argString=a.match(/.*/)[0];var d=c.argDelimiter||/\s+/,e=U(b.argString).split(d);e.length&&e[0]&&(b.args=e)}},matchCommand_:function(a){for(var b=a.length;b>0;b--){var c=a.substring(0,b);if(this.commandMap_[c]){var d=this.commandMap_[c];if(0===d.name.indexOf(a))return d}}return null},buildCommandMap_:function(){this.commandMap_={};for(var a=0;a<Fb.length;a++){var b=Fb[a],c=b.shortName||b.name;this.commandMap_[c]=b}},map:function(b,c){if(":"!=b&&":"==b.charAt(0)){var d=b.substring(1);this.commandMap_[d]=":"!=c&&":"==c.charAt(0)?{name:d,type:"exToEx",toInput:c.substring(1)}:{name:d,type:"exToKey",toKeys:Gb(c)}}else":"!=c&&":"==c.charAt(0)?a.unshift({keys:Gb(b),type:"keyToEx",exArgs:{input:c.substring(1)}}):a.unshift({keys:Gb(b),type:"keyToKey",toKeys:Gb(c)})}};var Hb={map:function(a,b){var c=b.args;return!c||c.length<2?(a&&tb(a,"Invalid mapping: "+b.input),void 0):(Ib.map(c[0],c[1],a),void 0)},move:function(a,b){E.processCommand(a,a.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:!1,explicitRepeat:!0,linewise:!0},repeatOverride:b.line+1})},sort:function(a,b){function g(){if(b.argString){var a=new CodeMirror.StringStream(b.argString);if(a.eat("!")&&(c=!0),a.eol())return;if(!a.eatSpace())throw new Error("invalid arguments "+a.match(/.*/)[0]);var g=a.match(/[a-z]+/);if(g){g=g[0],d=-1!=g.indexOf("i"),e=-1!=g.indexOf("u");var h=-1!=g.indexOf("d")&&1,i=-1!=g.indexOf("x")&&1,j=-1!=g.indexOf("o")&&1;if(h+i+j>1)throw new Error("invalid arguments");f=h&&"decimal"||i&&"hex"||j&&"octal"}if(a.eatSpace()&&a.match(/\/.*\//))throw new Error("patterns not supported")}}function r(a,b){if(c){var e;e=a,a=b,b=e}d&&(a=a.toLowerCase(),b=b.toLowerCase());var g=f&&m.exec(a),h=f&&m.exec(b);
return g?(g=parseInt((g[1]+g[2]).toLowerCase(),n),h=parseInt((h[1]+h[2]).toLowerCase(),n),g-h):b>a?-1:1}var c,d,e,f;g();var h=b.line||a.firstLine(),i=b.lineEnd||b.line||a.lastLine();if(h!=i){var j={line:h,ch:0},k={line:i,ch:S(a,i)},l=a.getRange(j,k).split("\n"),m="decimal"==f?/(-?)([\d]+)/:"hex"==f?/(-?)(?:0x)?([0-9a-f]+)/i:"octal"==f?/([0-7]+)/:null,n="decimal"==f?10:"hex"==f?16:"octal"==f?8:null,o=[],p=[];if(f)for(var q=0;q<l.length;q++)m.exec(l[q])?o.push(l[q]):p.push(l[q]);else p=l;if(o.sort(r),p.sort(r),l=c?o.concat(p):p.concat(o),e){var t,s=l;l=[];for(var q=0;q<s.length;q++)s[q]!=t&&l.push(s[q]),t=s[q]}a.replaceRange(l.join("\n"),j,k)}},substitute:function(a,b){if(!a.getSearchCursor)throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.");var c=b.argString,d=rb(c);if(0!==d[0])return tb(a,"Substitutions should be of the form :s/pattern/replace/"),void 0;var g,h,e=c.substring(d[0]+1,d[1]),f="",i=!1;if(d[1]&&(f=c.substring(d[1]+1,d[2])),d[2]){var j=c.substring(d[2]+1).split(" ");g=j[0],h=parseInt(j[1])}if(g&&(-1!=g.indexOf("c")&&(i=!0,g.replace("c","")),e=e+"/"+g),e)try{yb(a,e,!0,!0)}catch(k){return tb(a,"Invalid regex: "+e),void 0}var l=pb(a),m=l.getQuery(),n=void 0!==b.line?b.line:a.getCursor().line,o=b.lineEnd||n;h&&(n=o,o=n+h-1);var p=J(a,{line:n,ch:0}),q=a.getSearchCursor(m,p);Jb(a,i,n,o,q,m,f)},redo:CodeMirror.commands.redo,undo:CodeMirror.commands.undo,write:function(a){CodeMirror.commands.save?CodeMirror.commands.save(a):a.save()},nohlsearch:function(a){Cb(a)},delmarks:function(a,b){if(!b.argString||!b.argString.trim())return tb(a,"Argument required"),void 0;for(var c=a.state.vim,d=new CodeMirror.StringStream(b.argString.trim());!d.eol();){d.eatSpace();var e=d.pos;if(!d.match(/[a-zA-Z]/,!1))return tb(a,"Invalid argument: "+b.argString.substring(e)),void 0;var f=d.next();if(d.match("-",!0)){if(!d.match(/[a-zA-Z]/,!1))return tb(a,"Invalid argument: "+b.argString.substring(e)),void 0;var g=f,h=d.next();if(!(p(g)&&p(h)||s(g)&&s(h)))return tb(a,"Invalid argument: "+g+"-"),void 0;var i=g.charCodeAt(0),j=h.charCodeAt(0);if(i>=j)return tb(a,"Invalid argument: "+b.argString.substring(e)),void 0;for(var k=0;j-i>=k;k++){var l=String.fromCharCode(i+k);delete c.marks[l]}}else delete c.marks[f]}}},Ib=new b.ExCommandDispatcher;return CodeMirror.keyMap.vim=Kb(),CodeMirror.keyMap["vim-insert"]={Esc:Lb,"Ctrl-[":Lb,"Ctrl-C":Lb,"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(a){var b=CodeMirror.commands.newlineAndIndentContinueComment||CodeMirror.commands.newlineAndIndent;b(a)},fallthrough:["default"]},CodeMirror.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]},z(),A};CodeMirror.Vim=b()}();