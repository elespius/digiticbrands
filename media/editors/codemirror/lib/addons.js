(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineOption("fullScreen",false,function(d,f,e){if(e==a.Init){e=false}if(!e==!f){return}if(f){b(d)}else{c(d)}});function b(d){var e=d.getWrapperElement();d.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:e.style.width,height:e.style.height};e.style.width="";e.style.height="auto";e.className+=" CodeMirror-fullscreen";document.documentElement.style.overflow="hidden";d.refresh()}function c(d){var e=d.getWrapperElement();e.className=e.className.replace(/\s*CodeMirror-fullscreen\b/,"");document.documentElement.style.overflow="";var f=d.state.fullScreenRestore;e.style.width=f.width;e.style.height=f.height;window.scrollTo(f.scrollLeft,f.scrollTop);d.refresh()}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var h="()[]{}''\"\"";var g="[]{}";var i=/\s/;var f=c.Pos;c.defineOption("autoCloseBrackets",false,function(j,o,k){if(k!=c.Init&&k){j.removeKeyMap("autoCloseBrackets")}if(!o){return}var m=h,l=g;if(typeof o=="string"){m=o}else{if(typeof o=="object"){if(o.pairs!=null){m=o.pairs}if(o.explode!=null){l=o.explode}}}var n=b(m);if(l){n.Enter=a(l)}j.addKeyMap(n)});function d(j,l){var k=j.getRange(f(l.line,l.ch-1),f(l.line,l.ch+1));return k.length==2?k:null}function e(j,p,n){var k=j.getLine(p.line);var m=j.getTokenAt(p);if(/\bstring2?\b/.test(m.type)){return false}var o=new c.StringStream(k.slice(0,p.ch)+n+k.slice(p.ch),4);o.pos=o.start=m.start;for(;;){var l=j.getMode().token(o,m.state);if(o.pos>=p.ch+1){return/\bstring2?\b/.test(l)}o.start=o.pos}}function b(l){var m={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput")){return c.Pass}var o=n.listSelections();for(var p=0;p<o.length;p++){if(!o[p].empty()){return c.Pass}var q=d(n,o[p].head);if(!q||l.indexOf(q)%2!=0){return c.Pass}}for(var p=o.length-1;p>=0;p--){var r=o[p].head;n.replaceRange("",f(r.line,r.ch-1),f(r.line,r.ch+1))}}};var k="";for(var j=0;j<l.length;j+=2){(function(o,n){if(o!=n){k+=n}m["'"+o+"'"]=function(p){if(p.getOption("disableInput")){return c.Pass}var q=p.listSelections(),v,u;for(var t=0;t<q.length;t++){var r=q[t],w=r.head,s;var u=p.getRange(w,f(w.line,w.ch+1));if(!r.empty()){s="surround"}else{if(o==n&&u==n){if(p.getRange(w,f(w.line,w.ch+3))==o+o+o){s="skipThree"}else{s="skip"}}else{if(o==n&&w.ch>1&&p.getRange(f(w.line,w.ch-2),w)==o+o&&(w.ch<=2||p.getRange(f(w.line,w.ch-3),f(w.line,w.ch-2))!=o)){s="addFour"}else{if(o=='"'||o=="'"){if(!c.isWordChar(u)&&e(p,w,o)){s="both"}else{return c.Pass}}else{if(p.getLine(w.line).length==w.ch||k.indexOf(u)>=0||i.test(u)){s="both"}else{return c.Pass}}}}}if(!v){v=s}else{if(v!=s){return c.Pass}}}p.operation(function(){if(v=="skip"){p.execCommand("goCharRight")}else{if(v=="skipThree"){for(var y=0;y<3;y++){p.execCommand("goCharRight")}}else{if(v=="surround"){var x=p.getSelections();for(var y=0;y<x.length;y++){x[y]=o+x[y]+n}p.replaceSelections(x,"around")}else{if(v=="both"){p.replaceSelection(o+n,null);p.execCommand("goCharLeft")}else{if(v=="addFour"){p.replaceSelection(o+o+o+o,"before");p.execCommand("goCharRight")}}}}}})};if(o!=n){m["'"+n+"'"]=function(p){var q=p.listSelections();for(var s=0;s<q.length;s++){var r=q[s];if(!r.empty()||p.getRange(r.head,f(r.head.line,r.head.ch+1))!=n){return c.Pass}}p.execCommand("goCharRight")}}})(l.charAt(j),l.charAt(j+1))}return m}function a(j){return function(k){if(k.getOption("disableInput")){return c.Pass}var l=k.listSelections();for(var m=0;m<l.length;m++){if(!l[m].empty()){return c.Pass}var n=d(k,l[m].head);if(!n||j.indexOf(n)%2!=0){return c.Pass}}k.operation(function(){k.replaceSelection("\n\n",null);k.execCommand("goCharLeft");l=k.listSelections();for(var p=0;p<l.length;p++){var o=l[p].head.line;k.indentLine(o,null,true);k.indentLine(o+1,null,true)}})}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(b){b.defineOption("autoCloseTags",false,function(h,k,i){if(i!=b.Init&&i){h.removeKeyMap("autoCloseTags")}if(!k){return}var j={name:"autoCloseTags"};if(typeof k!="object"||k.whenClosing){j["'/'"]=function(l){return e(l)}}if(typeof k!="object"||k.whenOpening){j["'>'"]=function(l){return a(l)}}h.addKeyMap(j)});var d=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var c=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];function a(w){if(w.getOption("disableInput")){return b.Pass}var j=w.listSelections(),q=[];for(var r=0;r<j.length;r++){if(!j[r].empty()){return b.Pass}var v=j[r].head,x=w.getTokenAt(v);var y=b.innerMode(w.getMode(),x.state),h=y.state;if(y.mode.name!="xml"||!h.tagName){return b.Pass}var k=w.getOption("autoCloseTags"),s=y.mode.configuration=="html";var m=(typeof k=="object"&&k.dontCloseTags)||(s&&d);var u=(typeof k=="object"&&k.indentTags)||(s&&c);var p=h.tagName;if(x.end>v.ch){p=p.slice(0,p.length-x.end+v.ch)}var t=p.toLowerCase();if(!p||x.type=="string"&&(x.end!=v.ch||!/[\"\']/.test(x.string.charAt(x.string.length-1))||x.string.length==1)||x.type=="tag"&&h.type=="closeTag"||x.string.indexOf("/")==(x.string.length-1)||m&&g(m,t)>-1||f(w,p,v,h,true)){return b.Pass}var o=u&&g(u,t)>-1;q[r]={indent:o,text:">"+(o?"\n\n":"")+"</"+p+">",newPos:o?b.Pos(v.line+1,0):b.Pos(v.line,v.ch+1)}}for(var r=j.length-1;r>=0;r--){var n=q[r];w.replaceRange(n.text,j[r].head,j[r].anchor,"+insert");var l=w.listSelections().slice(0);l[r]={head:n.newPos,anchor:n.newPos};w.setSelections(l);if(n.indent){w.indentLine(n.newPos.line,null,true);w.indentLine(n.newPos.line+1,null,true)}}}function e(h){if(h.getOption("disableInput")){return b.Pass}var j=h.listSelections(),n=[];for(var m=0;m<j.length;m++){if(!j[m].empty()){return b.Pass}var p=j[m].head,l=h.getTokenAt(p);var k=b.innerMode(h.getMode(),l.state),o=k.state;if(l.type=="string"||l.string.charAt(0)!="<"||l.start!=p.ch-1||k.mode.name!="xml"||!o.context||!o.context.tagName||f(h,o.context.tagName,p,o)){return b.Pass}n[m]="/"+o.context.tagName+">"}h.replaceSelections(n)}function g(l,h){if(l.indexOf){return l.indexOf(h)}for(var j=0,k=l.length;j<k;++j){if(l[j]==h){return j}}return -1}function f(q,j,p,h,s){if(!b.scanForClosingTag){return false}var k=Math.min(q.lastLine()+1,p.line+500);var r=b.scanForClosingTag(q,p,null,k);if(!r||r.tag!=j){return false}var l=h.context;for(var n=s?1:0;l&&l.tagName==j;l=l.prev){++n}p=r.to;for(var m=1;m<n;m++){var o=b.scanForClosingTag(q,p,null,k);if(!o||o.tag!=j){return false}p=o.to}return true}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var d=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var i=e.Pos;var a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function f(q,m,p,k){var s=q.getLineHandle(m.line),o=m.ch-1;var n=(o>=0&&a[s.text.charAt(o)])||a[s.text.charAt(++o)];if(!n){return null}var l=n.charAt(1)==">"?1:-1;if(p&&(l>0)!=(o==m.ch)){return null}var j=q.getTokenTypeAt(i(m.line,o+1));var r=g(q,i(m.line,o+(l>0?1:0)),l,j||null,k);if(r==null){return null}return{from:i(m.line,o),to:r&&r.pos,match:r&&r.ch==n.charAt(0),forward:l>0}}function g(w,r,n,k,m){var l=(m&&m.maxScanLineLength)||10000;var t=(m&&m.maxScanLines)||1000;var v=[];var x=m&&m.bracketRegex?m.bracketRegex:/[(){}[\]]/;var q=n>0?Math.min(r.line+t,w.lastLine()+1):Math.max(w.firstLine()-1,r.line-t);for(var o=r.line;o!=q;o+=n){var y=w.getLine(o);if(!y){continue}var u=n>0?0:y.length-1,p=n>0?y.length:-1;if(y.length>l){continue}if(o==r.line){u=r.ch-(n<0?1:0)}for(;u!=p;u+=n){var j=y.charAt(u);if(x.test(j)&&(k===undefined||w.getTokenTypeAt(i(o,u+1))==k)){var s=a[j];if((s.charAt(1)==">")==(n>0)){v.push(j)}else{if(!v.length){return{pos:i(o,u),ch:j}}else{v.pop()}}}}}return o-n==(n>0?w.lastLine():w.firstLine())?false:null}function b(s,n,m){var k=s.state.matchBrackets.maxHighlightLineLength||1000;var r=[],l=s.listSelections();for(var o=0;o<l.length;o++){var q=l[o].empty()&&f(s,l[o].head,false,m);if(q&&s.getLine(q.from.line).length<=k){var j=q.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";r.push(s.markText(q.from,i(q.from.line,q.from.ch+1),{className:j}));if(q.to&&s.getLine(q.to.line).length<=k){r.push(s.markText(q.to,i(q.to.line,q.to.ch+1),{className:j}))}}}if(r.length){if(d&&s.state.focused){s.display.input.focus()}var p=function(){s.operation(function(){for(var t=0;t<r.length;t++){r[t].clear()}})};if(n){setTimeout(p,800)}else{return p}}}var c=null;function h(j){j.operation(function(){if(c){c();c=null}c=b(j,false,j.state.matchBrackets)})}e.defineOption("matchBrackets",false,function(j,l,k){if(k&&k!=e.Init){j.off("cursorActivity",h)}if(l){j.state.matchBrackets=typeof l=="object"?l:{};j.on("cursorActivity",h)}});e.defineExtension("matchBrackets",function(){b(this,true)});e.defineExtension("findMatchingBracket",function(l,j,k){return f(this,l,j,k)});e.defineExtension("scanForBracket",function(m,k,l,j){return g(this,m,k,l,j)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(c){c.defineOption("matchTags",false,function(e,g,f){if(f&&f!=c.Init){e.off("cursorActivity",b);e.off("viewportChange",d);a(e)}if(g){e.state.matchBothTags=typeof g=="object"&&g.bothTags;e.on("cursorActivity",b);e.on("viewportChange",d);b(e)}});function a(e){if(e.state.tagHit){e.state.tagHit.clear()}if(e.state.tagOther){e.state.tagOther.clear()}e.state.tagHit=e.state.tagOther=null}function b(e){e.state.failedTagMatch=false;e.operation(function(){a(e);if(e.somethingSelected()){return}var j=e.getCursor(),g=e.getViewport();g.from=Math.min(g.from,j.line);g.to=Math.max(j.line+1,g.to);var h=c.findMatchingTag(e,j,g);if(!h){return}if(e.state.matchBothTags){var i=h.at=="open"?h.open:h.close;if(i){e.state.tagHit=e.markText(i.from,i.to,{className:"CodeMirror-matchingtag"})}}var f=h.at=="close"?h.open:h.close;if(f){e.state.tagOther=e.markText(f.from,f.to,{className:"CodeMirror-matchingtag"})}else{e.state.failedTagMatch=true}})}function d(e){if(e.state.failedTagMatch){b(e)}}c.commands.toMatchingTag=function(f){var g=c.findMatchingTag(f,f.getCursor());if(g){var e=g.at=="close"?g.open:g.close;if(e){f.extendSelection(e.to,e.from)}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("fold","brace",function(m,h){var o=h.line,g=m.getLine(o);var n,t;function d(u){for(var i=h.ch,v=0;;){var w=i<=0?-1:g.lastIndexOf(u,i-1);if(w==-1){if(v==1){break}v=1;i=g.length;continue}if(v==1&&w<h.ch){break}t=m.getTokenTypeAt(a.Pos(o,w+1));if(!/^(comment|string)/.test(t)){return w+1}i=w-1}}var j="{",e="}",n=d("{");if(n==null){j="[",e="]";n=d("[")}if(n==null){return}var l=1,c=m.lastLine(),f,q;outer:for(var s=o;s<=c;++s){var p=m.getLine(s),k=s==o?n:0;for(;;){var b=p.indexOf(j,k),r=p.indexOf(e,k);if(b<0){b=p.length}if(r<0){r=p.length}k=Math.min(b,r);if(k==p.length){break}if(m.getTokenTypeAt(a.Pos(s,k+1))==t){if(k==b){++l}else{if(!--l){f=s;q=k;break outer}}}++k}}if(f==null||o==f&&q==n){return}return{from:a.Pos(o,n),to:a.Pos(f,q)}});a.registerHelper("fold","import",function(b,h){function g(k){if(k<b.firstLine()||k>b.lastLine()){return null}var o=b.getTokenAt(a.Pos(k,1));if(!/\S/.test(o.string)){o=b.getTokenAt(a.Pos(k,o.end+1))}if(o.type!="keyword"||o.string!="import"){return null}for(var l=k,m=Math.min(b.lastLine(),k+10);l<=m;++l){var n=b.getLine(l),j=n.indexOf(";");if(j!=-1){return{startCh:o.end,end:a.Pos(l,j)}}}}var h=h.line,d=g(h),f;if(!d||g(h-1)||((f=g(h-2))&&f.end.line==h-1)){return null}for(var c=d.end;;){var e=g(c.line+1);if(e==null){break}c=e.end}return{from:b.clipPos(a.Pos(h,d.startCh+1)),to:c}});a.registerHelper("fold","include",function(b,g){function f(h){if(h<b.firstLine()||h>b.lastLine()){return null}var i=b.getTokenAt(a.Pos(h,1));if(!/\S/.test(i.string)){i=b.getTokenAt(a.Pos(h,i.end+1))}if(i.type=="meta"&&i.string.slice(0,8)=="#include"){return i.start+8}}var g=g.line,d=f(g);if(d==null||f(g-1)!=null){return null}for(var c=g;;){var e=f(c+1);if(e==null){break}++c}return{from:a.Pos(g,d+1),to:b.clipPos(a.Pos(c))}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function d(n,m,o,i){if(o&&o.call){var g=o;o=null}else{var g=c(n,o,"rangeFinder")}if(typeof m=="number"){m=b.Pos(m,0)}var h=c(n,o,"minFoldSize");function f(p){var q=g(n,m);if(!q||q.to.line-q.from.line<h){return null}var s=n.findMarksAt(q.from);for(var r=0;r<s.length;++r){if(s[r].__isFold&&i!=="fold"){if(!p){return null}q.cleared=true;s[r].clear()}}return q}var k=f(true);if(c(n,o,"scanUp")){while(!k&&m.line>n.firstLine()){m=b.Pos(m.line-1,0);k=f(false)}}if(!k||k.cleared||i==="unfold"){return}var l=e(n,o);b.on(l,"mousedown",function(p){j.clear();b.e_preventDefault(p)});var j=n.markText(k.from,k.to,{replacedWith:l,clearOnEnter:true,__isFold:true});j.on("clear",function(q,p){b.signal(n,"unfold",n,q,p)});b.signal(n,"fold",n,k.from,k.to)}function e(f,g){var h=c(f,g,"widget");if(typeof h=="string"){var i=document.createTextNode(h);h=document.createElement("span");h.appendChild(i);h.className="CodeMirror-foldmarker"}return h}b.newFoldFunction=function(g,f){return function(h,i){d(h,i,{rangeFinder:g,widget:f})}};b.defineExtension("foldCode",function(h,f,g){d(this,h,f,g)});b.defineExtension("isFolded",function(h){var g=this.findMarksAt(h);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});b.commands.toggleFold=function(f){f.foldCode(f.getCursor())};b.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};b.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};b.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"fold")}})};b.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"unfold")}})};b.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,k){for(var h=0;h<f.length;++h){var j=f[h](g,k);if(j){return j}}}});b.registerHelper("fold","auto",function(f,k){var h=f.getHelpers(k,"fold");for(var g=0;g<h.length;g++){var j=h[g](f,k);if(j){return j}}});var a={rangeFinder:b.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false};b.defineOption("foldOptions",null);function c(f,h,g){if(h&&h[g]!==undefined){return h[g]}var i=f.options.foldOptions;if(i&&i[g]!==undefined){return i[g]}return a[g]}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./foldcode"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./foldcode"],a)}else{a(CodeMirror)}}})(function(d){d.defineOption("foldGutter",false,function(m,o,n){if(n&&n!=d.Init){m.clearGutter(m.state.foldGutter.options.gutter);m.state.foldGutter=null;m.off("gutterClick",k);m.off("change",g);m.off("viewportChange",l);m.off("fold",e);m.off("unfold",e);m.off("swapDoc",b)}if(o){m.state.foldGutter=new j(i(o));b(m);m.on("gutterClick",k);m.on("change",g);m.on("viewportChange",l);m.on("fold",e);m.on("unfold",e);m.on("swapDoc",b)}});var h=d.Pos;function j(m){this.options=m;this.from=this.to=0}function i(m){if(m===true){m={}}if(m.gutter==null){m.gutter="CodeMirror-foldgutter"}if(m.indicatorOpen==null){m.indicatorOpen="CodeMirror-foldgutter-open"}if(m.indicatorFolded==null){m.indicatorFolded="CodeMirror-foldgutter-folded"}return m}function c(m,n){var p=m.findMarksAt(h(n));for(var o=0;o<p.length;++o){if(p[o].__isFold&&p[o].find().from.line==n){return true}}}function f(m){if(typeof m=="string"){var n=document.createElement("div");n.className=m+" CodeMirror-guttermarker-subtle";return n}else{return m.cloneNode(true)}}function a(m,q,p){var n=m.state.foldGutter.options,o=q;m.eachLine(q,p,function(r){var v=null;if(c(m,o)){v=f(n.indicatorFolded)}else{var u=h(o,0),t=n.rangeFinder||d.fold.auto;var s=t&&t(m,u);if(s&&s.from.line+1<s.to.line){v=f(n.indicatorOpen)}}m.setGutterMarker(r,n.gutter,v);++o})}function b(m){var n=m.getViewport(),o=m.state.foldGutter;if(!o){return}m.operation(function(){a(m,n.from,n.to)});o.from=n.from;o.to=n.to}function k(m,n,p){var o=m.state.foldGutter.options;if(p!=o.gutter){return}m.foldCode(h(n,0),o.rangeFinder)}function g(m){var o=m.state.foldGutter,n=m.state.foldGutter.options;o.from=o.to=0;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){b(m)},n.foldOnChangeTimeSpan||600)}function l(m){var o=m.state.foldGutter,n=m.state.foldGutter.options;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){var p=m.getViewport();if(o.from==o.to||p.from-o.to>20||o.from-p.to>20){b(m)}else{m.operation(function(){if(p.from<o.from){a(m,p.from,o.from);o.from=p.from}if(p.to>o.to){a(m,o.to,p.to);o.to=p.to}})}},n.updateViewportTimeSpan||400)}function e(m,p){var o=m.state.foldGutter,n=p.line;if(n>=o.from&&n<o.to){a(m,n,n+1)}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(i){var m=i.Pos;function l(r,q){return r.line-q.line||r.ch-q.ch}var j="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD";var o=j+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040";var d=new RegExp("<(/?)(["+j+"]["+o+"]*)","g");function b(q,r,t,s){this.line=r;this.ch=t;this.cm=q;this.text=q.getLine(r);this.min=s?s.from:q.firstLine();this.max=s?s.to-1:q.lastLine()}function h(q,s){var r=q.cm.getTokenTypeAt(m(q.line,s));return r&&/\btag\b/.test(r)}function a(q){if(q.line>=q.max){return}q.ch=0;q.text=q.cm.getLine(++q.line);return true}function n(q){if(q.line<=q.min){return}q.text=q.cm.getLine(--q.line);q.ch=q.text.length;return true}function g(s){for(;;){var r=s.text.indexOf(">",s.ch);if(r==-1){if(a(s)){continue}else{return}}if(!h(s,r+1)){s.ch=r+1;continue}var q=s.text.lastIndexOf("/",r);var t=q>-1&&!/\S/.test(s.text.slice(q+1,r));s.ch=r+1;return t?"selfClose":"regular"}}function k(r){for(;;){var q=r.ch?r.text.lastIndexOf("<",r.ch-1):-1;if(q==-1){if(n(r)){continue}else{return}}if(!h(r,q+1)){r.ch=q;continue}d.lastIndex=q;r.ch=q;var s=d.exec(r.text);if(s&&s.index==q){return s}}}function p(q){for(;;){d.lastIndex=q.ch;var r=d.exec(q.text);if(!r){if(a(q)){continue}else{return}}if(!h(q,r.index+1)){q.ch=r.index+1;continue}q.ch=r.index+r[0].length;return r}}function e(s){for(;;){var r=s.ch?s.text.lastIndexOf(">",s.ch-1):-1;if(r==-1){if(n(s)){continue}else{return}}if(!h(s,r+1)){s.ch=r;continue}var q=s.text.lastIndexOf("/",r);var t=q>-1&&!/\S/.test(s.text.slice(q+1,r));s.ch=r+1;return t?"selfClose":"regular"}}function f(t,r){var q=[];for(;;){var v=p(t),s,x=t.line,w=t.ch-(v?v[0].length:0);if(!v||!(s=g(t))){return}if(s=="selfClose"){continue}if(v[1]){for(var u=q.length-1;u>=0;--u){if(q[u]==v[2]){q.length=u;break}}if(u<0&&(!r||r==v[2])){return{tag:v[2],from:m(x,w),to:m(t.line,t.ch)}}}else{q.push(v[2])}}}function c(s,r){var q=[];for(;;){var w=e(s);if(!w){return}if(w=="selfClose"){k(s);continue}var v=s.line,u=s.ch;var x=k(s);if(!x){return}if(x[1]){q.push(x[2])}else{for(var t=q.length-1;t>=0;--t){if(q[t]==x[2]){q.length=t;break}}if(t<0&&(!r||r==x[2])){return{tag:x[2],from:m(s.line,s.ch),to:m(v,u)}}}}}i.registerHelper("fold","xml",function(q,v){var s=new b(q,v.line,0);for(;;){var t=p(s),r;if(!t||s.line!=v.line||!(r=g(s))){return}if(!t[1]&&r!="selfClose"){var v=m(s.line,s.ch);var u=f(s,t[2]);return u&&{from:v,to:u.from}}}});i.findMatchingTag=function(q,x,t){var s=new b(q,x.line,x.ch,t);if(s.text.indexOf(">")==-1&&s.text.indexOf("<")==-1){return}var r=g(s),w=r&&m(s.line,s.ch);var v=r&&k(s);if(!r||r=="selfClose"||!v||l(s,x)>0){return}var u={from:m(s.line,s.ch),to:w,tag:v[2]};if(v[1]){return{open:c(s,v[2]),close:u,at:"close"}}else{s=new b(q,w.line,w.ch,t);return{open:u,close:f(s,v[2]),at:"open"}}};i.findEnclosingTag=function(q,w,s){var r=new b(q,w.line,w.ch,s);for(;;){var u=c(r);if(!u){break}var t=new b(q,w.line,w.ch,s);var v=f(t,u.tag);if(v){return{open:u,close:v}}}};i.scanForClosingTag=function(q,u,t,s){var r=new b(q,u.line,u.ch,s?{from:0,to:s}:null);return f(r,t)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){if(!a.modeURL){a.modeURL="../mode/%N/%N.js"}var d={};function c(e,g){var f=g;return function(){if(--f==0){e()}}}function b(k,e){var j=a.modes[k].dependencies;if(!j){return e()}var h=[];for(var g=0;g<j.length;++g){if(!a.modes.hasOwnProperty(j[g])){h.push(j[g])}}if(!h.length){return e()}var f=c(e,h.length);for(var g=0;g<h.length;++g){a.requireMode(h[g],f)}}a.requireMode=function(k,e){if(typeof k!="string"){k=k.name}if(a.modes.hasOwnProperty(k)){return b(k,e)}if(d.hasOwnProperty(k)){return d[k].push(e)}var f=document.createElement("script");f.src=a.modeURL.replace(/%N/g,k);var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(f,g);var i=d[k]=[e];var h=0,j=setInterval(function(){if(++h>100){return clearInterval(j)}if(a.modes.hasOwnProperty(k)){clearInterval(j);d[k]=null;b(k,function(){for(var l=0;l<i.length;++l){i[l]()}})}},200)};a.autoLoadMode=function(e,f){if(!a.modes.hasOwnProperty(f)){a.requireMode(f,function(){e.setOption("mode",e.getOption("mode"))})}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.multiplexingMode=function(c){var e=Array.prototype.slice.call(arguments,1);var b=e.length;function d(g,h,i){if(typeof h=="string"){return g.indexOf(h,i)}var f=h.exec(i?g.slice(i):g);return f?f.index+i:-1}return{startState:function(){return{outer:a.startState(c),innerActive:null,inner:null}},copyState:function(f){return{outer:a.copyState(c,f.outer),innerActive:f.innerActive,inner:f.innerActive&&a.copyState(f.innerActive.mode,f.inner)}},token:function(o,f){if(!f.innerActive){var h=Infinity,m=o.string;for(var j=0;j<b;++j){var l=e[j];var p=d(m,l.open,o.pos);if(p==o.pos){o.match(l.open);f.innerActive=l;f.inner=a.startState(l.mode,c.indent?c.indent(f.outer,""):0);return l.delimStyle}else{if(p!=-1&&p<h){h=p}}}if(h!=Infinity){o.string=m.slice(0,h)}var g=c.token(o,f.outer);if(h!=Infinity){o.string=m}return g}else{var k=f.innerActive,m=o.string;if(!k.close&&o.sol()){f.innerActive=f.inner=null;return this.token(o,f)}var p=k.close?d(m,k.close,o.pos):-1;if(p==o.pos){o.match(k.close);f.innerActive=f.inner=null;return k.delimStyle}if(p>-1){o.string=m.slice(0,p)}var n=k.mode.token(o,f.inner);if(p>-1){o.string=m}if(k.innerStyle){if(n){n=n+" "+k.innerStyle}else{n=k.innerStyle}}return n}},indent:function(g,f){var h=g.innerActive?g.innerActive.mode:c;if(!h.indent){return a.Pass}return h.indent(g.innerActive?g.inner:g.outer,f)},blankLine:function(h){var j=h.innerActive?h.innerActive.mode:c;if(j.blankLine){j.blankLine(h.innerActive?h.inner:h.outer)}if(!h.innerActive){for(var g=0;g<b;++g){var f=e[g];if(f.open==="\n"){h.innerActive=f;h.inner=a.startState(f.mode,j.indent?j.indent(h.outer,""):0)}}}else{if(h.innerActive.close==="\n"){h.innerActive=h.inner=null}}},electricChars:c.electricChars,innerMode:function(f){return f.inner?{state:f.inner,mode:f.innerActive.mode}:{state:f.outer,mode:c}}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var g="CodeMirror-activeline";var f="CodeMirror-activeline-background";c.defineOption("styleActiveLine",false,function(h,k,i){var j=i&&i!=c.Init;if(k&&!j){h.state.activeLines=[];e(h,h.listSelections());h.on("beforeSelectionChange",b)}else{if(!k&&j){h.off("beforeSelectionChange",b);d(h);delete h.state.activeLines}}});function d(h){for(var j=0;j<h.state.activeLines.length;j++){h.removeLineClass(h.state.activeLines[j],"wrap",g);h.removeLineClass(h.state.activeLines[j],"background",f)}}function a(j,h){if(j.length!=h.length){return false}for(var k=0;k<j.length;k++){if(j[k]!=h[k]){return false}}return true}function e(h,k){var n=[];for(var m=0;m<k.length;m++){var l=k[m];if(!l.empty()){continue}var j=h.getLineHandleVisualStart(l.head.line);if(n[n.length-1]!=j){n.push(j)}}if(a(h.state.activeLines,n)){return}h.operation(function(){d(h);for(var o=0;o<n.length;o++){h.addLineClass(n[o],"wrap",g);h.addLineClass(n[o],"background",f)}h.state.activeLines=n})}function b(h,i){e(h,i.ranges)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],a)}else{a(CodeMirror)}}})(function(b){var a=[{keys:["<Left>"],type:"keyToKey",toKeys:["h"]},{keys:["<Right>"],type:"keyToKey",toKeys:["l"]},{keys:["<Up>"],type:"keyToKey",toKeys:["k"]},{keys:["<Down>"],type:"keyToKey",toKeys:["j"]},{keys:["<Space>"],type:"keyToKey",toKeys:["l"]},{keys:["<BS>"],type:"keyToKey",toKeys:["h"]},{keys:["<C-Space>"],type:"keyToKey",toKeys:["W"]},{keys:["<C-BS>"],type:"keyToKey",toKeys:["B"]},{keys:["<S-Space>"],type:"keyToKey",toKeys:["w"]},{keys:["<S-BS>"],type:"keyToKey",toKeys:["b"]},{keys:["<C-n>"],type:"keyToKey",toKeys:["j"]},{keys:["<C-p>"],type:"keyToKey",toKeys:["k"]},{keys:["<C-[>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["<C-c>"],type:"keyToKey",toKeys:["<Esc>"]},{keys:["s"],type:"keyToKey",toKeys:["c","l"],context:"normal"},{keys:["s"],type:"keyToKey",toKeys:["x","i"],context:"visual"},{keys:["S"],type:"keyToKey",toKeys:["c","c"],context:"normal"},{keys:["S"],type:"keyToKey",toKeys:["d","c","c"],context:"visual"},{keys:["<Home>"],type:"keyToKey",toKeys:["0"]},{keys:["<End>"],type:"keyToKey",toKeys:["$"]},{keys:["<PageUp>"],type:"keyToKey",toKeys:["<C-b>"]},{keys:["<PageDown>"],type:"keyToKey",toKeys:["<C-f>"]},{keys:["<CR>"],type:"keyToKey",toKeys:["j","^"],context:"normal"},{keys:["H"],type:"motion",motion:"moveToTopLine",motionArgs:{linewise:true,toJumplist:true}},{keys:["M"],type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:true,toJumplist:true}},{keys:["L"],type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:true,toJumplist:true}},{keys:["h"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:false}},{keys:["l"],type:"motion",motion:"moveByCharacters",motionArgs:{forward:true}},{keys:["j"],type:"motion",motion:"moveByLines",motionArgs:{forward:true,linewise:true}},{keys:["k"],type:"motion",motion:"moveByLines",motionArgs:{forward:false,linewise:true}},{keys:["g","j"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:true}},{keys:["g","k"],type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:false}},{keys:["w"],type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false}},{keys:["W"],type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false,bigWord:true}},{keys:["e"],type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,inclusive:true}},{keys:["E"],type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,bigWord:true,inclusive:true}},{keys:["b"],type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false}},{keys:["B"],type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false,bigWord:true}},{keys:["g","e"],type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,inclusive:true}},{keys:["g","E"],type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,bigWord:true,inclusive:true}},{keys:["{"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:false,toJumplist:true}},{keys:["}"],type:"motion",motion:"moveByParagraph",motionArgs:{forward:true,toJumplist:true}},{keys:["<C-f>"],type:"motion",motion:"moveByPage",motionArgs:{forward:true}},{keys:["<C-b>"],type:"motion",motion:"moveByPage",motionArgs:{forward:false}},{keys:["<C-d>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:true,explicitRepeat:true}},{keys:["<C-u>"],type:"motion",motion:"moveByScroll",motionArgs:{forward:false,explicitRepeat:true}},{keys:["g","g"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:["G"],type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:true,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:["0"],type:"motion",motion:"moveToStartOfLine"},{keys:["^"],type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["+"],type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true}},{keys:["-"],type:"motion",motion:"moveByLines",motionArgs:{forward:false,toFirstChar:true}},{keys:["_"],type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true,repeatOffset:-1}},{keys:["$"],type:"motion",motion:"moveToEol",motionArgs:{inclusive:true}},{keys:["%"],type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:true,toJumplist:true}},{keys:["f","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:true,inclusive:true}},{keys:["F","character"],type:"motion",motion:"moveToCharacter",motionArgs:{forward:false}},{keys:["t","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:true,inclusive:true}},{keys:["T","character"],type:"motion",motion:"moveTillCharacter",motionArgs:{forward:false}},{keys:[";"],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:true}},{keys:[","],type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:false}},{keys:["'","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:true,linewise:true}},{keys:["`","character"],type:"motion",motion:"goToMark",motionArgs:{toJumplist:true}},{keys:["]","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:true}},{keys:["[","`"],type:"motion",motion:"jumpToMark",motionArgs:{forward:false}},{keys:["]","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:true,linewise:true}},{keys:["[","'"],type:"motion",motion:"jumpToMark",motionArgs:{forward:false,linewise:true}},{keys:["]","p"],type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true,matchIndent:true}},{keys:["[","p"],type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true,matchIndent:true}},{keys:["]","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:true,toJumplist:true}},{keys:["[","character"],type:"motion",motion:"moveToSymbol",motionArgs:{forward:false,toJumplist:true}},{keys:["|"],type:"motion",motion:"moveToColumn",motionArgs:{}},{keys:["o"],type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{},context:"visual"},{keys:["O"],type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:true},context:"visual"},{keys:["d"],type:"operator",operator:"delete"},{keys:["y"],type:"operator",operator:"yank"},{keys:["c"],type:"operator",operator:"change"},{keys:[">"],type:"operator",operator:"indent",operatorArgs:{indentRight:true}},{keys:["<"],type:"operator",operator:"indent",operatorArgs:{indentRight:false}},{keys:["g","~"],type:"operator",operator:"swapcase"},{keys:["n"],type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:true}},{keys:["N"],type:"motion",motion:"findNext",motionArgs:{forward:false,toJumplist:true}},{keys:["x"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:true},operatorMotionArgs:{visualLine:false}},{keys:["X"],type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:false},operatorMotionArgs:{visualLine:true}},{keys:["D"],type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:true},operatorMotionArgs:{visualLine:true}},{keys:["Y"],type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:true},operatorMotionArgs:{visualLine:true}},{keys:["C"],type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:true},operatorMotionArgs:{visualLine:true}},{keys:["~"],type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:true},motion:"moveByCharacters",motionArgs:{forward:true}},{keys:["<C-i>"],type:"action",action:"jumpListWalk",actionArgs:{forward:true}},{keys:["<C-o>"],type:"action",action:"jumpListWalk",actionArgs:{forward:false}},{keys:["<C-e>"],type:"action",action:"scroll",actionArgs:{forward:true,linewise:true}},{keys:["<C-y>"],type:"action",action:"scroll",actionArgs:{forward:false,linewise:true}},{keys:["a"],type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"charAfter"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"eol"}},{keys:["A"],type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:["i"],type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"inplace"}},{keys:["I"],type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"firstNonBlank"}},{keys:["o"],type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:true}},{keys:["O"],type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:false}},{keys:["v"],type:"action",action:"toggleVisualMode"},{keys:["V"],type:"action",action:"toggleVisualMode",actionArgs:{linewise:true}},{keys:["<C-v>"],type:"action",action:"toggleVisualMode",actionArgs:{blockwise:true}},{keys:["g","v"],type:"action",action:"reselectLastSelection"},{keys:["J"],type:"action",action:"joinLines",isEdit:true},{keys:["p"],type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true}},{keys:["P"],type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true}},{keys:["r","character"],type:"action",action:"replace",isEdit:true},{keys:["@","character"],type:"action",action:"replayMacro"},{keys:["q","character"],type:"action",action:"enterMacroRecordMode"},{keys:["R"],type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{replace:true}},{keys:["u"],type:"action",action:"undo"},{keys:["u"],type:"action",action:"changeCase",actionArgs:{toLower:true},context:"visual",isEdit:true},{keys:["U"],type:"action",action:"changeCase",actionArgs:{toLower:false},context:"visual",isEdit:true},{keys:["<C-r>"],type:"action",action:"redo"},{keys:["m","character"],type:"action",action:"setMark"},{keys:['"',"character"],type:"action",action:"setRegister"},{keys:["z","z"],type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:["z","."],type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","t"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:["z","<CR>"],type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["z","-"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:["z","b"],type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:["."],type:"action",action:"repeatLastEdit"},{keys:["<C-a>"],type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:true,backtrack:false}},{keys:["<C-x>"],type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:false,backtrack:false}},{keys:["a","character"],type:"motion",motion:"textObjectManipulation"},{keys:["i","character"],type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:true}},{keys:["/"],type:"search",searchArgs:{forward:true,querySrc:"prompt",toJumplist:true}},{keys:["?"],type:"search",searchArgs:{forward:false,querySrc:"prompt",toJumplist:true}},{keys:["*"],type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:["#"],type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:["g","*"],type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",toJumplist:true}},{keys:["g","#"],type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",toJumplist:true}},{keys:[":"],type:"ex"}];var c=b.Pos;var d=function(){b.defineOption("vimMode",false,function(bd,be){if(be){bd.setOption("keyMap","vim");bd.setOption("disableInput",true);bd.setOption("showCursorWhenSelecting",false);b.signal(bd,"vim-mode-change",{mode:"normal"});bd.on("cursorActivity",Q);B(bd);b.on(bd.getInputField(),"paste",L(bd))}else{if(bd.state.vim){bd.setOption("keyMap","default");bd.setOption("disableInput",false);bd.off("cursorActivity",Q);b.off(bd.getInputField(),"paste",L(bd));bd.state.vim=null}}});function L(bd){var be=bd.state.vim;if(!be.onPasteFn){be.onPasteFn=function(){if(!be.insertMode){bd.setCursor(y(bd.getCursor(),0,1));o.enterInsertMode(bd,{},be)}}}return be.onPasteFn}var aI=/[\d]/;var ag=[(/\w/),(/[^\w\s]/)],a3=[(/\S/)];function af(bg,be){var bf=[];for(var bd=bg;bd<bg+be;bd++){bf.push(String.fromCharCode(bd))}return bf}var W=af(65,26);var ac=af(97,26);var M=af(48,10);var h="~`!@#$%^&*()_-+=[{}]\\|/?.,<>:;\"'".split("");var aG=["Left","Right","Up","Down","Space","Backspace","Esc","Home","End","PageUp","PageDown","Enter"];var ar=[].concat(W,ac,M,["<",">"]);var k=[].concat(W,ac,M,["-",'"',".",":","/"]);function e(bd,be){return be>=bd.firstLine()&&be<=bd.lastLine()}function z(bd){return(/^[a-z]$/).test(bd)}function G(bd){return"()[]{}".indexOf(bd)!=-1}function V(bd){return aI.test(bd)}function v(bd){return(/^[A-Z]$/).test(bd)}function J(bd){return(/^\s*$/).test(bd)}function E(bf,bd){for(var be=0;be<bd.length;be++){if(bd[be]==bf){return true}}return false}var ai={};function ax(be,bd,bf){if(bd===undefined){throw Error("defaultValue is required")}if(!bf){bf="string"}ai[be]={type:bf,defaultValue:bd};av(be,bd)}function av(bd,bf){var be=ai[bd];if(!be){throw Error("Unknown option: "+bd)}if(be.type=="boolean"){if(bf&&bf!==true){throw Error("Invalid argument: "+bd+"="+bf)}else{if(bf!==false){bf=true}}}be.value=be.type=="boolean"?!!bf:bf}function n(bd){var be=ai[bd];if(!be){throw Error("Unknown option: "+bd)}return be.value}var ae=function(){var bh=100;var bj=-1;var bg=0;var bf=0;var be=new Array(bh);function bi(bk,bm,bn){var bo=bj%bh;var bp=be[bo];function bl(bs){var br=++bj%bh;var bt=be[br];if(bt){bt.clear()}be[br]=bk.setBookmark(bs)}if(bp){var bq=bp.find();if(bq&&!bb(bq,bm)){bl(bm)}}else{bl(bm)}bl(bn);bg=bj;bf=bj-bh+1;if(bf<0){bf=0}}function bd(bk,bo){bj+=bo;if(bj>bg){bj=bg}else{if(bj<bf){bj=bf}}var bp=be[(bh+bj)%bh];if(bp&&!bp.find()){var bn=bo>0?1:-1;var bm;var bl=bk.getCursor();do{bj+=bn;bp=be[(bh+bj)%bh];if(bp&&(bm=bp.find())&&!bb(bl,bm)){break}}while(bj<bg&&bj>bf)}return bp}return{cachedCursor:undefined,add:bi,move:bd}};var g=function(bd){if(bd){return{changes:bd.changes,expectCursorActivityForChange:bd.expectCursorActivityForChange}}return{changes:[],expectCursorActivityForChange:false}};function ak(){this.latestRegister=undefined;this.isPlaying=false;this.isRecording=false;this.replaySearchQueries=[];this.onRecordingDone=undefined;this.lastInsertModeChanges=g()}ak.prototype={exitMacroRecordMode:function(){var bd=p.macroModeState;if(bd.onRecordingDone){bd.onRecordingDone()}bd.onRecordingDone=undefined;bd.isRecording=false},enterMacroRecordMode:function(bd,bf){var be=p.registerController.getRegister(bf);if(be){be.clear();this.latestRegister=bf;if(bd.openDialog){this.onRecordingDone=bd.openDialog("(recording)["+bf+"]",null,{bottom:true})}this.isRecording=true}}};function B(bd){if(!bd.state.vim){bd.state.vim={inputState:new am(),lastEditInputState:undefined,lastEditActionCommand:undefined,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:false,insertModeRepeat:undefined,visualMode:false,visualLine:false,visualBlock:false,lastSelection:null,lastPastedText:null}}return bd.state.vim}var p;function u(){p={searchQuery:null,searchIsReversed:false,lastSubstituteReplacePart:undefined,jumpList:ae(),macroModeState:new ak,lastChararacterSearch:{increment:0,forward:true,selectedCharacter:""},registerController:new X({}),searchHistoryController:new aN({}),exCommandHistoryController:new aN({})};for(var bd in ai){var be=ai[bd];be.value=be.defaultValue}}var aB={buildKeyMap:function(){},getRegisterController:function(){return p.registerController},resetVimGlobalState_:u,getVimGlobalState_:function(){return p},maybeInitVimState_:B,InsertModeKey:a0,map:function(be,bf,bd){l.map(be,bf,bd)},setOption:av,getOption:n,defineOption:ax,defineEx:function(bd,bf,be){if(bd.indexOf(bf)!==0){throw new Error('(Vim.defineEx) "'+bf+'" is not a prefix of "'+bd+'", command not registered')}aO[bd]=be;l.commandMap_[bf]={name:bd,shortName:bf,type:"api"}},handleKey:function(bd,bg){var bi;var be=B(bd);var bh=p.macroModeState;if(bh.isRecording){if(bg=="q"){bh.exitMacroRecordMode();i(bd);return}}if(bg=="<Esc>"){i(bd);if(be.visualMode){aE(bd)}return}if(!be.visualMode&&!bb(bd.getCursor("head"),bd.getCursor("anchor"))){be.visualMode=true;be.visualLine=false;b.signal(bd,"vim-mode-change",{mode:"visual"});bd.on("mousedown",aE)}if(bg!="0"||(bg=="0"&&be.inputState.getRepeat()===0)){bi=aT.matchCommand(bg,a,be)}if(!bi){if(V(bg)){be.inputState.pushRepeatDigit(bg)}if(bh.isRecording){D(bh,bg)}return}if(bi.type=="keyToKey"){for(var bf=0;bf<bi.toKeys.length;bf++){this.handleKey(bd,bi.toKeys[bf])}}else{if(bh.isRecording){D(bh,bg)}aT.processCommand(bd,be,bi)}},handleEx:function(bd,be){l.processCommand(bd,be)}};function am(){this.prefixRepeat=[];this.motionRepeat=[];this.operator=null;this.operatorArgs=null;this.motion=null;this.motionArgs=null;this.keyBuffer=[];this.registerName=null}am.prototype.pushRepeatDigit=function(bd){if(!this.operator){this.prefixRepeat=this.prefixRepeat.concat(bd)}else{this.motionRepeat=this.motionRepeat.concat(bd)}};am.prototype.getRepeat=function(){var bd=0;if(this.prefixRepeat.length>0||this.motionRepeat.length>0){bd=1;if(this.prefixRepeat.length>0){bd*=parseInt(this.prefixRepeat.join(""),10)}if(this.motionRepeat.length>0){bd*=parseInt(this.motionRepeat.join(""),10)}}return bd};function i(bd,be){bd.state.vim.inputState=new am();b.signal(bd,"vim-command-done",be)}function a4(be,bd){this.clear();this.keyBuffer=[be||""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!bd}a4.prototype={setText:function(be,bd){this.keyBuffer=[be||""];this.linewise=!!bd},pushText:function(be,bd){if(bd){if(!this.linewise){this.keyBuffer.push("\n")}this.linewise=true}this.keyBuffer.push(be)},pushInsertModeChanges:function(bd){this.insertModeChanges.push(g(bd))},pushSearchQuery:function(bd){this.searchQueries.push(bd)},clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=false},toString:function(){return this.keyBuffer.join("")}};function X(bd){this.registers=bd;this.unnamedRegister=bd['"']=new a4();bd["."]=new a4();bd[":"]=new a4();bd["/"]=new a4()}X.prototype={pushText:function(bg,be,bi,bh){if(bh&&bi.charAt(0)=="\n"){bi=bi.slice(1)+"\n"}if(bh&&bi.charAt(bi.length-1)!=="\n"){bi+="\n"}var bf=this.isValidRegister(bg)?this.getRegister(bg):null;if(!bf){switch(be){case"yank":this.registers["0"]=new a4(bi,bh);break;case"delete":case"change":if(bi.indexOf("\n")==-1){this.registers["-"]=new a4(bi,bh)}else{this.shiftNumericRegisters_();this.registers["1"]=new a4(bi,bh)}break}this.unnamedRegister.setText(bi,bh);return}var bd=v(bg);if(bd){bf.pushText(bi,bh)}else{bf.setText(bi,bh)}this.unnamedRegister.setText(bf.toString(),bh)},getRegister:function(bd){if(!this.isValidRegister(bd)){return this.unnamedRegister}bd=bd.toLowerCase();if(!this.registers[bd]){this.registers[bd]=new a4()}return this.registers[bd]},isValidRegister:function(bd){return bd&&E(bd,k)},shiftNumericRegisters_:function(){for(var bd=9;bd>=2;bd--){this.registers[bd]=this.getRegister(""+(bd-1))}}};function aN(){this.historyBuffer=[];this.iterator;this.initialPrefix=null}aN.prototype={nextMatch:function(be,bd){var bj=this.historyBuffer;var bg=bd?-1:1;if(this.initialPrefix===null){this.initialPrefix=be}for(var bi=this.iterator+bg;bd?bi>=0:bi<bj.length;bi+=bg){var bh=bj[bi];for(var bf=0;bf<=bh.length;bf++){if(this.initialPrefix==bh.substring(0,bf)){this.iterator=bi;return bh}}}if(bi>=bj.length){this.iterator=bj.length;return this.initialPrefix}if(bi<0){return be}},pushInput:function(bd){var be=this.historyBuffer.indexOf(bd);if(be>-1){this.historyBuffer.splice(be,1)}if(bd.length){this.historyBuffer.push(bd)}},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var aT={matchCommand:function(bo,bn,bg){var bk=bg.inputState;var bp=bk.keyBuffer.concat(bo);var bj=[];var bd;for(var bh=0;bh<bn.length;bh++){var bf=bn[bh];if(a2(bp,bf.keys)){if(bk.operator&&bf.type=="action"){continue}if(bf.keys[bp.length-1]=="character"){bd=bp[bp.length-1];if(bd.length>1){switch(bd){case"<CR>":bd="\n";break;case"<Space>":bd=" ";break;default:continue}}}bj.push(bf)}}function bm(bq){if(bp.length<bq.keys.length){bk.keyBuffer.push(bo);return null}else{if(bq.keys[bp.length-1]=="character"){bk.selectedCharacter=bd}bk.keyBuffer=[];return bq}}if(!bj.length){bk.keyBuffer=[];return null}else{if(bj.length==1){return bm(bj[0])}else{var be=bg.visualMode?"visual":"normal";var bi;for(var bh=0;bh<bj.length;bh++){var bl=bj[bh];if(bl.context==be){bi=bl;break}else{if(!bi&&!bl.context){bi=bl}}}return bm(bi)}}},processCommand:function(bd,be,bf){be.inputState.repeatOverride=bf.repeatOverride;switch(bf.type){case"motion":this.processMotion(bd,be,bf);break;case"operator":this.processOperator(bd,be,bf);break;case"operatorMotion":this.processOperatorMotion(bd,be,bf);break;case"action":this.processAction(bd,be,bf);break;case"search":this.processSearch(bd,be,bf);break;case"ex":case"keyToEx":this.processEx(bd,be,bf);break;default:break}},processMotion:function(bd,be,bf){be.inputState.motion=bf.motion;be.inputState.motionArgs=aZ(bf.motionArgs);this.evalInput(bd,be)},processOperator:function(be,bf,bg){var bd=bf.inputState;if(bd.operator){if(bd.operator==bg.operator){bd.motion="expandToLine";bd.motionArgs={linewise:true};this.evalInput(be,bf);return}else{i(be)}}bd.operator=bg.operator;bd.operatorArgs=aZ(bg.operatorArgs);if(bf.visualMode){this.evalInput(be,bf)}},processOperatorMotion:function(bd,bg,bh){var bf=bg.visualMode;var be=aZ(bh.operatorMotionArgs);if(be){if(bf&&be.visualLine){bg.visualLine=true}}this.processOperator(bd,bg,bh);if(!bf){this.processMotion(bd,bg,bh)}},processAction:function(be,bg,bj){var bd=bg.inputState;var bi=bd.getRepeat();var bh=!!bi;var bf=aZ(bj.actionArgs)||{};if(bd.selectedCharacter){bf.selectedCharacter=bd.selectedCharacter}if(bj.operator){this.processOperator(be,bg,bj)}if(bj.motion){this.processMotion(be,bg,bj)}if(bj.motion||bj.operator){this.evalInput(be,bg)}bf.repeat=bi||1;bf.repeatIsExplicit=bh;bf.registerName=bd.registerName;i(be);bg.lastMotion=null;if(bj.isEdit){this.recordLastEdit(bg,bd,bj)}o[bj.action](be,bf,bg)},processSearch:function(bs,bl,bk){if(!bs.getSearchCursor){return}var bn=bk.searchArgs.forward;var bi=bk.searchArgs.wholeWordOnly;au(bs).setReversed(!bn);var bo=(bn)?"/":"?";var bq=au(bs).getQuery();var bf=bs.getScrollInfo();function bj(bv,bt,bu){p.searchHistoryController.pushInput(bv);p.searchHistoryController.reset();try{ba(bs,bv,bt,bu)}catch(bw){a1(bs,"Invalid regex: "+bv);return}aT.processMotion(bs,bl,{type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:bk.searchArgs.toJumplist}})}function br(bt){bs.scrollTo(bf.left,bf.top);bj(bt,true,true);var bu=p.macroModeState;if(bu.isRecording){H(bu,bt)}}function bh(bx,bw,by){var bv=b.keyName(bx),bt;if(bv=="Up"||bv=="Down"){bt=bv=="Up"?true:false;bw=p.searchHistoryController.nextMatch(bw,bt)||"";by(bw)}else{if(bv!="Left"&&bv!="Right"&&bv!="Ctrl"&&bv!="Alt"&&bv!="Shift"){p.searchHistoryController.reset()}}var bu;try{bu=ba(bs,bw,true,true)}catch(bx){}if(bu){bs.scrollIntoView(bc(bs,!bn,bu),30)}else{ay(bs);bs.scrollTo(bf.left,bf.top)}}function be(bv,bu,bw){var bt=b.keyName(bv);if(bt=="Esc"||bt=="Ctrl-C"||bt=="Ctrl-["){p.searchHistoryController.pushInput(bu);p.searchHistoryController.reset();ba(bs,bq);ay(bs);bs.scrollTo(bf.left,bf.top);b.e_stop(bv);bw();bs.focus()}}switch(bk.searchArgs.querySrc){case"prompt":var bm=p.macroModeState;if(bm.isPlaying){var bp=bm.replaySearchQueries.shift();bj(bp,true,false)}else{aL(bs,{onClose:br,prefix:bo,desc:I,onKeyUp:bh,onKeyDown:be})}break;case"wordUnderCursor":var bg=aq(bs,false,true,false,true);var bd=true;if(!bg){bg=aq(bs,false,true,false,false);bd=false}if(!bg){return}var bp=bs.getLine(bg.start.line).substring(bg.start.ch,bg.end.ch);if(bd&&bi){bp="\\b"+bp+"\\b"}else{bp=f(bp)}p.jumpList.cachedCursor=bs.getCursor();bs.setCursor(bg.start);bj(bp,true,false);break}},processEx:function(bd,be,bh){function bg(bi){p.exCommandHistoryController.pushInput(bi);p.exCommandHistoryController.reset();l.processCommand(bd,bi)}function bf(bl,bj,bm){var bk=b.keyName(bl),bi;if(bk=="Esc"||bk=="Ctrl-C"||bk=="Ctrl-["){p.exCommandHistoryController.pushInput(bj);p.exCommandHistoryController.reset();b.e_stop(bl);bm();bd.focus()}if(bk=="Up"||bk=="Down"){bi=bk=="Up"?true:false;bj=p.exCommandHistoryController.nextMatch(bj,bi)||"";bm(bj)}else{if(bk!="Left"&&bk!="Right"&&bk!="Ctrl"&&bk!="Alt"&&bk!="Shift"){p.exCommandHistoryController.reset()}}}if(bh.type=="keyToEx"){l.processCommand(bd,bh.exArgs.input)}else{if(be.visualMode){aL(bd,{onClose:bg,prefix:":",value:"'<,'>",onKeyDown:bf})}else{aL(bd,{onClose:bg,prefix:":",onKeyDown:bf})}}},evalInput:function(bm,bD){var bs=bD.inputState;var bA=bs.motion;var bt=bs.motionArgs||{};var bn=bs.operator;var bJ=bs.operatorArgs||{};var bu=bs.registerName;var be=x(bm.getCursor("head"));var bB=x(bm.getCursor("anchor"));var bk=x(be);var br=x(bk);var bE;var bo;if(bn){this.recordLastEdit(bD,bs)}if(bs.repeatOverride!==undefined){bo=bs.repeatOverride}else{bo=bs.getRepeat()}if(bo>0&&bt.explicitRepeat){bt.repeatIsExplicit=true}else{if(bt.noRepeat||(!bt.explicitRepeat&&bo===0)){bo=1;bt.repeatIsExplicit=false}}if(bs.selectedCharacter){bt.selectedCharacter=bJ.selectedCharacter=bs.selectedCharacter}bt.repeat=bo;i(bm);if(bA){var bC=aM[bA](bm,bt,bD);bD.lastMotion=aM[bA];if(!bC){return}if(bt.toJumplist){var bI=p.jumpList;var bp=bI.cachedCursor;if(bp){aX(bm,bp,bC);delete bI.cachedCursor}else{aX(bm,br,bC)}}if(bC instanceof Array){bk=bC[0];bE=bC[1]}else{bE=bC}if(!bE){bE=c(bk.line,bk.ch)}if(bD.visualMode){var bi=0;if(aA(bB,be)&&(bb(bB,bE)||aA(bE,bB))){bB.ch+=1;bi=-1}else{if(aA(be,bB)&&(bb(bB,bE)||aA(bB,bE))){bB.ch-=1;bi=1}}if(!bD.visualBlock&&!(bC instanceof Array)){bE.ch+=bi}if(bD.lastHPos!=Infinity){bD.lastHPos=bE.ch}be=bE;bB=(bC instanceof Array)?bk:bB;if(bD.visualLine){if(aA(bB,be)){bB.ch=0;var bd=bm.lastLine();if(be.line>bd){be.line=bd}be.ch=aH(bm,be.line)}else{be.ch=0;bB.ch=aH(bm,bB.line)}}else{if(bD.visualBlock){bB=A(bm,be)}}if(!bD.visualBlock){bm.setSelection(bB,be)}aD(bm,bD,"<",aA(bB,be)?bB:be);aD(bm,bD,">",aA(bB,be)?be:bB)}else{if(!bn){bE=P(bm,bE);bm.setCursor(bE.line,bE.ch)}}}if(bn){var bx=false;bD.lastMotion=null;var bq=bD.lastSelection;bJ.repeat=bo;if(bD.visualMode){bk=bB;bE=be;bt.inclusive=true;bJ.shouldMoveCursor=false}if(bE&&aA(bE,bk)){var bH=bk;bk=bE;bE=bH;bx=true}else{if(!bE){bE=x(bk)}}if(bt.inclusive&&!bD.visualMode){bE.ch++}if(bJ.selOffset){bE.line=bk.line+bJ.selOffset.line;if(bJ.selOffset.line){bE.ch=bJ.selOffset.ch}else{bE.ch=bk.ch+bJ.selOffset.ch}if(bq&&bq.visualBlock){var bl=bq.visualBlock;var bz=bl.width;var by=bl.height;bE=c(bk.line+by,bk.ch+bz);var bf=[];for(var bF=bk.line;bF<bE.line;bF++){var bj=c(bF,bk.ch);var bg=c(bF,bE.ch);var bw={anchor:bj,head:bg};bf.push(bw)}bm.setSelections(bf);var bG=true}}else{if(bD.visualMode){var bv=c();bv.line=bE.line-bk.line;if(bv.line){bv.ch=bE.ch}else{bv.ch=bE.ch-bk.ch}bJ.selOffset=bv}}var bh=bt.linewise||(bD.visualMode&&bD.visualLine)||bJ.linewise;if(bh){aV(bm,bk,bE)}else{if(bt.forward){ab(bm,bk,bE)}}bJ.registerName=bu;bJ.linewise=bh;if(!bD.visualBlock&&!bG){bm.setSelection(bk,bE)}F[bn](bm,bJ,bD,bk,bE,br);if(bD.visualMode){aE(bm)}}},recordLastEdit:function(be,bd,bf){var bg=p.macroModeState;if(bg.isPlaying){return}be.lastEditInputState=bd;be.lastEditActionCommand=bf;bg.lastInsertModeChanges.changes=[];bg.lastInsertModeChanges.expectCursorActivityForChange=false}};var aM={moveToTopLine:function(bd,bf){var be=aU(bd).top+bf.repeat-1;return c(be,aK(bd.getLine(be)))},moveToMiddleLine:function(bd){var bf=aU(bd);var be=Math.floor((bf.top+bf.bottom)*0.5);return c(be,aK(bd.getLine(be)))},moveToBottomLine:function(bd,bf){var be=aU(bd).bottom-bf.repeat+1;return c(be,aK(bd.getLine(be)))},expandToLine:function(bd,be){var bf=bd.getCursor();return c(bf.line+be.repeat-1,Infinity)},findNext:function(bd,be){var bh=au(bd);var bg=bh.getQuery();if(!bg){return}var bf=!be.forward;bf=(bh.isReversed())?!bf:bf;aw(bd,bg);return bc(bd,bf,bg,be.repeat)},goToMark:function(bd,bf,be){var bh=be.marks[bf.selectedCharacter];if(bh){var bg=bh.find();return bf.linewise?{line:bg.line,ch:aK(bd.getLine(bg.line))}:bg}return null},moveToOtherHighlightedEnd:function(be,bh,bg){var bf=be.listSelections();var bj=be.getCursor("head");var bd=bf[0].anchor;var bi=bb(bf[0].head,bj)?bf.length-1:0;if(bh.sameLine&&bg.visualBlock){bd=c(bj.line,bf[bi].anchor.ch);bj=c(bf[bi].head.line,bj.ch)}else{bd=bf[bi].anchor}be.setCursor(bj);return([bj,bd])},jumpToMark:function(bk,bg,bh){var bf=bk.getCursor();for(var bi=0;bi<bg.repeat;bi++){var bm=bf;for(var bl in bh.marks){if(!z(bl)){continue}var be=bh.marks[bl].find();var bd=(bg.forward)?aA(be,bm):aA(bm,be);if(bd){continue}if(bg.linewise&&(be.line==bm.line)){continue}var bj=bb(bm,bf);var bn=(bg.forward)?aF(bm,be,bf):aF(bf,be,bm);if(bj||bn){bf=be}}}if(bg.linewise){bf=c(bf.line,aK(bk.getLine(bf.line)))}return bf},moveByCharacters:function(bd,be){var bh=bd.getCursor();var bg=be.repeat;var bf=be.forward?bh.ch+bg:bh.ch-bg;return c(bh.line,bf)},moveByLines:function(bi,be,bf){var bk=bi.getCursor();var bg=bk.ch;switch(bf.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:bg=bf.lastHPos;break;default:bf.lastHPos=bg}var bd=be.repeat+(be.repeatOffset||0);var bl=be.forward?bk.line+bd:bk.line-bd;var bh=bi.firstLine();var bj=bi.lastLine();if((bl<bh&&bk.line==bh)||(bl>bj&&bk.line==bj)){return}if(be.toFirstChar){bg=aK(bi.getLine(bl));bf.lastHPos=bg}bf.lastHSPos=bi.charCoords(c(bl,bg),"div").left;return c(bl,bg)},moveByDisplayLines:function(bk,bf,bg){var bl=bk.getCursor();switch(bg.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:bg.lastHSPos=bk.charCoords(bl,"div").left}var bd=bf.repeat;var bj=bk.findPosV(bl,(bf.forward?bd:-bd),"line",bg.lastHSPos);if(bj.hitSide){if(bf.forward){var be=bk.charCoords(bj,"div");var bh={top:be.top+8,left:bg.lastHSPos};var bj=bk.coordsChar(bh,"div")}else{var bi=bk.charCoords(c(bk.firstLine(),0),"div");bi.left=bg.lastHSPos;bj=bk.coordsChar(bi,"div")}}bg.lastHPos=bj.ch;return bj},moveByPage:function(be,bf){var bd=be.getCursor();var bg=bf.repeat;return be.findPosV(bd,(bf.forward?bg:-bg),"page")},moveByParagraph:function(bd,bf){var be=bd.getCursor().line;var bh=bf.repeat;var bi=bf.forward?1:-1;for(var bg=0;bg<bh;bg++){if((!bf.forward&&be===bd.firstLine())||(bf.forward&&be==bd.lastLine())){break}be+=bi;while(be!==bd.firstLine()&&be!=bd.lastLine()&&bd.getLine(be)){be+=bi}}return c(be,0)},moveByScroll:function(bd,bg,be){var bk=bd.getScrollInfo();var bi=null;var bh=bg.repeat;if(!bh){bh=bk.clientHeight/(2*bd.defaultTextHeight())}var bj=bd.charCoords(bd.getCursor(),"local");bg.repeat=bh;var bi=aM.moveByDisplayLines(bd,bg,be);if(!bi){return null}var bf=bd.charCoords(bi,"local");bd.scrollTo(null,bk.top+bf.top-bj.top);return bi},moveByWords:function(bd,be){return an(bd,be.repeat,!!be.forward,!!be.wordEnd,!!be.bigWord)},moveTillCharacter:function(be,bf){var bh=bf.repeat;var bg=a6(be,bh,bf.forward,bf.selectedCharacter);var bd=bf.forward?-1:1;ao(bd,bf);if(!bg){return null}bg.ch+=bd;return bg},moveToCharacter:function(bd,be){var bf=be.repeat;ao(0,be);return a6(bd,bf,be.forward,be.selectedCharacter)||bd.getCursor()},moveToSymbol:function(bd,be){var bf=be.repeat;return a7(bd,bf,be.forward,be.selectedCharacter)||bd.getCursor()},moveToColumn:function(bd,bf,be){var bg=bf.repeat;be.lastHPos=bg-1;be.lastHSPos=bd.charCoords(bd.getCursor(),"div").left;return Z(bd,bg)},moveToEol:function(bd,bh,bg){var bi=bd.getCursor();bg.lastHPos=Infinity;var bf=c(bi.line+bh.repeat-1,Infinity);var be=bd.clipPos(bf);be.ch--;bg.lastHSPos=bd.charCoords(be,"div").left;return bf},moveToFirstNonWhiteSpaceCharacter:function(bd){var be=bd.getCursor();return c(be.line,aK(bd.getLine(be.line)))},moveToMatchedSymbol:function(be){var bk=be.getCursor();var bg=bk.line;var bi=bk.ch;var bf=be.getLine(bg);var bj;do{bj=bf.charAt(bi++);if(bj&&G(bj)){var bh=be.getTokenTypeAt(c(bg,bi));if(bh!=="string"&&bh!=="comment"){break}}}while(bj);if(bj){var bd=be.findMatchingBracket(c(bg,bi));return bd.to}else{return bk}},moveToStartOfLine:function(bd){var be=bd.getCursor();return c(be.line,0)},moveToLineOrEdgeOfDocument:function(bd,be){var bf=be.forward?bd.lastLine():bd.firstLine();if(be.repeatIsExplicit){bf=be.repeat-bd.getOption("firstLineNumber")}return c(bf,aK(bd.getLine(bf)))},textObjectManipulation:function(be,bg){var bf={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["};var bj={"'":true,'"':true};var bi=bg.selectedCharacter;if(bi=="b"){bi="("}else{if(bi=="B"){bi="{"}}var bd=!bg.textObjectInner;var bh;if(bf[bi]){bh=m(be,bi,bd)}else{if(bj[bi]){bh=aC(be,bi,bd)}else{if(bi==="W"){bh=aq(be,bd,true,true)}else{if(bi==="w"){bh=aq(be,bd,true,false)}else{return null}}}}return[bh.start,bh.end]},repeatLastCharacterSearch:function(bf,bh){var be=p.lastChararacterSearch;var bj=bh.repeat;var bg=bh.forward===be.forward;var bd=(be.increment?1:0)*(bg?-1:1);bf.moveH(-bd,"char");bh.inclusive=bg?true:false;var bi=a6(bf,bj,bg,be.selectedCharacter);if(!bi){bf.moveH(bd,"char");return bf.getCursor()}bi.ch+=bd;return bi}};var F={change:function(bo,bg,bi){var be=bo.listSelections();var bd=be[0],bh=be[be.length-1];var bm=aA(bd.anchor,bd.head)?bd.anchor:bd.head;var bp=aA(bh.anchor,bh.head)?bh.head:bh.anchor;var bs=bo.getSelection();var bf=new Array(be.length).join("1").split("1");var br=bi.marks[">"]?bi.marks[">"].find():bo.getCursor("head");p.registerController.pushText(bg.registerName,"change",bs,bg.linewise);if(bg.linewise){if(bi.visualBlock){var bq=bm.line;while(bq<=bp.line){var bk=aH(bo,bq);var bn=c(bq,bk);var bj=c(bq,bm.ch);bq++;bo.replaceRange("",bj,bn)}}else{bf="\n";if(bp.line==bm.line&&bp.line==bo.lastLine()){bf=""}bo.replaceRange(bf,bm,bp);bo.indentLine(bm.line,"smart");bm.ch=null;bo.setCursor(bm)}}else{var bs=bo.getRange(bm,bp);if(!J(bs)){var bl=(/\s+$/).exec(bs);if(bl){bp=y(bp,0,-bl[0].length)}}if(bi.visualBlock){bo.replaceSelections(bf)}else{bo.setCursor(bm);bo.replaceRange("",bm,bp)}}bi.marks[">"]=bo.setBookmark(br);o.enterInsertMode(bo,{},bo.state.vim)},"delete":function(bo,bi,bk){var bg=bo.listSelections();var bf=bg[0],bj=bg[bg.length-1];var bm=aA(bf.anchor,bf.head)?bf.anchor:bf.head;var bp=aA(bj.anchor,bj.head)?bj.head:bj.anchor;var br,bn;if(bk.visualMode){br=bk.marks[">"].find();bn=bk.marks["<"].find()}else{if(bk.lastSelection){br=bk.lastSelection.curStartMark.find();bn=bk.lastSelection.curEndMark.find()}}var bq=bo.getSelection();p.registerController.pushText(bi.registerName,"delete",bq,bi.linewise);var bh=new Array(bg.length).join("1").split("1");if(bi.linewise&&bp.line==bo.lastLine()&&bm.line==bp.line){var bl=x(bp);bm.line--;bm.ch=aH(bo,bm.line);bp=bl;bo.replaceRange("",bm,bp)}else{bo.replaceSelections(bh)}if(br){var be=bo.setBookmark(bn);var bd=bo.setBookmark(br);if(bk.visualMode){bk.marks["<"]=be;bk.marks[">"]=bd}else{bk.lastSelection.curStartMark=be;bk.lastSelection.curEndMark=bd}}if(bi.linewise){bo.setCursor(aM.moveToFirstNonWhiteSpaceCharacter(bo))}else{bo.setCursor(bm)}},indent:function(bk,bf,bh,bj,bl){var bm=bj.line;var be=bl.line;var bd=(bh.visualMode)?bf.repeat:1;if(bf.linewise){be--}for(var bi=bm;bi<=be;bi++){for(var bg=0;bg<bd;bg++){bk.indentLine(bi,bf.indentRight)}}bk.setCursor(bj);bk.setCursor(aM.moveToFirstNonWhiteSpaceCharacter(bk))},swapcase:function(bq,bg,bn,bp,bh,bk){var be=bq.getSelections();var bd=bq.listSelections();var bf=[];for(var bi=0;bi<be.length;bi++){var bl=be[bi];var bs="";for(var bj=0;bj<bl.length;bj++){var bm=bl.charAt(bj);bs+=v(bm)?bm.toLowerCase():bm.toUpperCase()}bf.push(bs)}bq.replaceSelections(bf);var bo=bd[0].anchor;var br=bd[0].head;if(!bg.shouldMoveCursor){bq.setCursor(aA(bo,br)?bo:br)}},yank:function(be,bi,bh,bg,bd,bf){var bj=be.getSelection();p.registerController.pushText(bi.registerName,"yank",bj,bi.linewise);be.setCursor(bf)}};var o={jumpListWalk:function(bd,bf,bg){if(bg.visualMode){return}var bi=bf.repeat;var bh=bf.forward;var be=p.jumpList;var bk=be.move(bd,bh?bi:-bi);var bj=bk?bk.find():undefined;bj=bj?bj:bd.getCursor();bd.setCursor(bj)},scroll:function(bl,bf,bh){if(bh.visualMode){return}var bd=bf.repeat||1;var bk=bl.defaultTextHeight();var bj=bl.getScrollInfo().top;var bm=bk*bd;var bi=bf.forward?bj+bm:bj-bm;var bn=x(bl.getCursor());var bg=bl.charCoords(bn,"local");if(bf.forward){if(bi>bg.top){bn.line+=(bi-bg.top)/bk;bn.line=Math.ceil(bn.line);bl.setCursor(bn);bg=bl.charCoords(bn,"local");bl.scrollTo(null,bg.top)}else{bl.scrollTo(null,bi)}}else{var be=bi+bl.getScrollInfo().clientHeight;if(be<bg.bottom){bn.line-=(bg.bottom-be)/bk;bn.line=Math.floor(bn.line);bl.setCursor(bn);bg=bl.charCoords(bn,"local");bl.scrollTo(null,bg.bottom-bl.getScrollInfo().clientHeight)}else{bl.scrollTo(null,bi)}}},scrollToCursor:function(be,bf){var bi=be.getCursor().line;var bg=be.charCoords(c(bi,0),"local");var bd=be.getScrollInfo().clientHeight;var bj=bg.top;var bh=bg.bottom-bj;switch(bf.position){case"center":bj=bj-(bd/2)+bh;break;case"bottom":bj=bj-bd+bh*1.4;break;case"top":bj=bj+bh*0.4;break}be.scrollTo(null,bj)},replayMacro:function(bd,be,bf){var bg=be.selectedCharacter;var bh=be.repeat;var bi=p.macroModeState;if(bg=="@"){bg=bi.latestRegister}while(bh--){C(bd,bf,bi,bg)}},enterMacroRecordMode:function(bd,be){var bg=p.macroModeState;var bf=be.selectedCharacter;bg.enterMacroRecordMode(bd,bf)},enterInsertMode:function(bd,be,bf){if(bd.getOption("readOnly")){return}bf.insertMode=true;bf.insertModeRepeat=be&&be.repeat||1;var bg=(be)?be.insertAt:null;if(bg=="eol"){var bj=bd.getCursor();bj=c(bj.line,aH(bd,bj.line));bd.setCursor(bj)}else{if(bg=="charAfter"){bd.setCursor(y(bd.getCursor(),0,1))}else{if(bg=="firstNonBlank"){bd.setCursor(aM.moveToFirstNonWhiteSpaceCharacter(bd))}else{if(bg=="endOfSelectedArea"){var bi=bd.getCursor("head");var bh=bd.getCursor("anchor");if(bi.line<bh.line){bi=c(bh.line,0)}bd.setCursor(bi);aE(bd)}}}}bd.setOption("keyMap","vim-insert");bd.setOption("disableInput",false);if(be&&be.replace){bd.toggleOverwrite(true);bd.setOption("keyMap","vim-replace");b.signal(bd,"vim-mode-change",{mode:"replace"})}else{bd.setOption("keyMap","vim-insert");b.signal(bd,"vim-mode-change",{mode:"insert"})}if(!p.macroModeState.isPlaying){bd.on("change",aY);b.on(bd.getInputField(),"keydown",N)}},toggleVisualMode:function(be,bf,bg){var bj=bf.repeat;var bd=be.getCursor();var bi;var bh=be.listSelections();if(!bg.visualMode){be.on("mousedown",aE);bg.visualMode=true;bg.visualLine=!!bf.linewise;bg.visualBlock=!!bf.blockwise;if(bg.visualLine){bd.ch=0;bi=P(be,c(bd.line+bj-1,aH(be,bd.line)),true)}else{bi=P(be,c(bd.line,bd.ch+bj),true)}be.setSelection(bd,bi);b.signal(be,"vim-mode-change",{mode:"visual",subMode:bg.visualLine?"linewise":""})}else{bd=be.getCursor("anchor");bi=be.getCursor("head");if(bg.visualLine){if(bf.blockwise){bg.visualBlock=true;A(be,bi);b.signal(be,"vim-mode-change",{mode:"visual",subMode:"blockwise"})}else{if(!bf.linewise){b.signal(be,"vim-mode-change",{mode:"visual"})}else{aE(be)}}bg.visualLine=false}else{if(bg.visualBlock){if(bf.linewise){bg.visualLine=true;bd=c(bh[0].anchor.line,0);bi=c(bh[bh.length-1].anchor.line,aH(be,bh[bh.length-1].anchor.line));be.setSelection(bd,bi);b.signal(be,"vim-mode-change",{mode:"visual",subMode:"linewise"})}else{if(!bf.blockwise){if(bi!=bh[0].head){bd=bh[0].anchor}else{bd=bh[bh.length-1].anchor}be.setSelection(bd,bi);b.signal(be,"vim-mode-change",{mode:"visual"})}else{aE(be)}}bg.visualBlock=false}else{if(bf.linewise){bg.visualLine=true;bd.ch=aA(bd,bi)?0:aH(be,bd.line);bi.ch=aA(bd,bi)?aH(be,bi.line):0;be.setSelection(bd,bi);b.signal(be,"vim-mode-change",{mode:"visual",subMode:"linewise"})}else{if(bf.blockwise){bg.visualBlock=true;A(be,bi);b.signal(be,"vim-mode-change",{mode:"visual",subMode:"blockwise"})}else{aE(be)}}}}}aD(be,bg,"<",aA(bd,bi)?bd:bi);aD(be,bg,">",aA(bd,bi)?bi:bd)},reselectLastSelection:function(bj,bf,be){var bg=be.marks["<"].find();var bk=be.marks[">"].find();var bd=be.lastSelection;if(bd){var bi=bd.curStartMark.find();var bl=bd.curEndMark.find();var bh=bd.visualBlock;aW(bj,be,bg,bk);if(bh){bj.setCursor(bi);bi=A(bj,bl)}else{bj.setSelection(bi,bl);bi=bj.getCursor("anchor");bl=bj.getCursor("head")}if(be.visualMode){aD(bj,be,"<",aA(bi,bl)?bi:bl);aD(bj,be,">",aA(bi,bl)?bl:bi)}be.visualMode=true;if(bd.visualLine){be.visualLine=true;be.visualBlock=false}else{if(bd.visualBlock){be.visualLine=false;be.visualBlock=true}else{be.visualBlock=be.visualLine=false}}b.signal(bj,"vim-mode-change",{mode:"visual",subMode:be.visualLine?"linewise":""})}},joinLines:function(be,bf,bg){var bd,bi;if(bg.visualMode){bd=be.getCursor("anchor");bi=be.getCursor("head");bi.ch=aH(be,bi.line)-1}else{var bh=Math.max(bf.repeat,2);bd=be.getCursor();bi=P(be,c(bd.line+bh-1,Infinity))}var bj=0;be.operation(function(){for(var bm=bd.line;bm<bi.line;bm++){bj=aH(be,bd.line);var bl=c(bd.line+1,aH(be,bd.line+1));var bn=be.getRange(bd,bl);bn=bn.replace(/\n\s*/g," ");be.replaceRange(bn,bd,bl)}var bk=c(bd.line,bj);be.setCursor(bk)})},newLineAndEnterInsertMode:function(bd,be,bf){bf.insertMode=true;var bg=x(bd.getCursor());if(bg.line===bd.firstLine()&&!be.after){bd.replaceRange("\n",c(bd.firstLine(),0));bd.setCursor(bd.firstLine(),0)}else{bg.line=(be.after)?bg.line:bg.line-1;bg.ch=aH(bd,bg.line);bd.setCursor(bg);var bh=b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent;bh(bd)}this.enterInsertMode(bd,{repeat:be.repeat},bf)},paste:function(bo,bn,bt){var bj=x(bo.getCursor());var be=p.registerController.getRegister(bn.registerName);var bq=be.toString();if(!bq){return}if(bn.matchIndent){var bk=function(by){var bx=(by.split("\t").length-1);var bw=(by.split(" ").length-1);return bx*bo.options.tabSize+bw*1};var bu=bo.getLine(bo.getCursor().line);var bp=bk(bu.match(/^\s*/)[0]);var bd=bq.replace(/\n$/,"");var bi=bq!==bd;var bm=bk(bq.match(/^\s*/)[0]);var bq=bd.replace(/^\s*/gm,function(bw){var bx=bp+(bk(bw)-bm);if(bx<0){return""}else{if(bo.options.indentWithTabs){var by=Math.floor(bx/bo.options.tabSize);return Array(by+1).join("\t")}else{return Array(bx+1).join(" ")}}});bq+=bi?"\n":""}if(bn.repeat>1){var bq=Array(bn.repeat+1).join(bq)}var bl=be.linewise;if(bl){if(bt.visualMode){bq=bt.visualLine?bq.slice(0,-1):"\n"+bq.slice(0,bq.length-1)+"\n"}else{if(bn.after){bq="\n"+bq.slice(0,bq.length-1);bj.ch=aH(bo,bj.line)}else{bj.ch=0}}}else{bj.ch+=bn.after?1:0}var bh;var br;if(bt.visualMode){bt.lastPastedText=bq;var bg;var bv=aP(bo,bt);var bs=bv[0];var bf=bv[1];if(bt.lastSelection){bg=bt.lastSelection.curEndMark.find()}p.registerController.unnamedRegister.setText(bo.getRange(bs,bf));bo.replaceRange(bq,bs,bf);if(bg){bt.lastSelection.curEndMark=bo.setBookmark(bg)}bh=bo.posFromIndex(bo.indexFromPos(bs)+bq.length-1);if(bl){bh.ch=0}}else{bo.replaceRange(bq,bj);if(bl&&bn.after){bh=c(bj.line+1,aK(bo.getLine(bj.line+1)))}else{if(bl&&!bn.after){bh=c(bj.line,aK(bo.getLine(bj.line)))}else{if(!bl&&bn.after){br=bo.indexFromPos(bj);bh=bo.posFromIndex(br+bq.length-1)}else{br=bo.indexFromPos(bj);bh=bo.posFromIndex(br+bq.length)}}}}bo.setCursor(bh);if(bt.visualMode){aE(bo)}},undo:function(bd,be){bd.operation(function(){aj(bd,b.commands.undo,be.repeat)();bd.setCursor(bd.getCursor("anchor"))})},redo:function(bd,be){aj(bd,b.commands.redo,be.repeat)()},setRegister:function(bf,bd,be){be.inputState.registerName=bd.selectedCharacter},setMark:function(bd,be,bf){var bg=be.selectedCharacter;aD(bd,bf,bg,bd.getCursor())},replace:function(bl,bf,bh){var bg=bf.selectedCharacter;var bk=bl.getCursor();var bj;var bm;var be=bl.listSelections();if(bh.visualMode){bk=bl.getCursor("start");bm=bl.getCursor("end")}else{var bn=bl.getLine(bk.line);bj=bk.ch+bf.repeat;if(bj>bn.length){bj=bn.length}bm=c(bk.line,bj)}if(bg=="\n"){if(!bh.visualMode){bl.replaceRange("",bk,bm)}(b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent)(bl)}else{var bd=bl.getRange(bk,bm);bd=bd.replace(/[^\n]/g,bg);if(bh.visualBlock){var bi=new Array(bl.options.tabSize+1).join(" ");bd=bl.getSelection();bd=bd.replace(/\t/g,bi).replace(/[^\n]/g,bg).split("\n");bl.replaceSelections(bd)}else{bl.replaceRange(bd,bk,bm)}if(bh.visualMode){bk=aA(be[0].anchor,be[0].head)?be[0].anchor:be[0].head;bl.setCursor(bk);aE(bl)}else{bl.setCursor(y(bm,0,-1))}}},incrementNumberToken:function(bn,be){var bo=bn.getCursor();var bj=bn.getLine(bo.line);var bq=/-?\d+/g;var bi;var bd;var bh;var bp;var bf;while((bi=bq.exec(bj))!==null){bf=bi[0];bd=bi.index;bh=bd+bf.length;if(bo.ch<bh){break}}if(!be.backtrack&&(bh<=bo.ch)){return}if(bf){var bm=be.increase?1:-1;var bg=parseInt(bf)+(bm*be.repeat);var bl=c(bo.line,bd);var bk=c(bo.line,bh);bp=bg.toString();bn.replaceRange(bp,bl,bk)}else{return}bn.setCursor(c(bo.line,bd+bp.length-1))},repeatLastEdit:function(be,bf,bg){var bd=bg.lastEditInputState;if(!bd){return}var bh=bf.repeat;if(bh&&bf.repeatIsExplicit){bg.lastEditInputState.repeatOverride=bh}else{bh=bg.lastEditInputState.repeatOverride||bh}t(be,bg,bh,false)},changeCase:function(bd,bf,bg){var bh=aP(bd,bg)[0];var bk=bd.getSelection();var be;var bj;if(bg.lastSelection){be=bg.lastSelection.curEndMark.find();bj=bg.lastSelection.visualBlock}var bi=bf.toLower;bk=bi?bk.toLowerCase():bk.toUpperCase();bd.replaceSelections(bg.visualBlock||bj?bk.split("\n"):[bk]);if(be){bg.lastSelection.curEndMark=bd.setBookmark(be)}bd.setCursor(bh);if(bg.visualMode){aE(bd)}}};function P(be,bi,bg){var bf=Math.min(Math.max(be.firstLine(),bi.line),be.lastLine());var bd=aH(be,bf)-1;bd=(bg)?bd+1:bd;var bh=Math.min(Math.max(0,bi.ch),bd);return c(bf,bh)}function aZ(be){var bd={};for(var bf in be){if(be.hasOwnProperty(bf)){bd[bf]=be[bf]}}return bd}function y(be,bd,bf){return c(be.line+bd,be.ch+bf)}function a2(bf,bd){for(var be=0;be<bf.length;be++){if(bf[be]!=bd[be]&&bd[be]!="character"){return false}}return true}function aj(bd,be,bf){return function(){for(var bg=0;bg<bf;bg++){be(bd)}}}function x(bd){return c(bd.line,bd.ch)}function bb(be,bd){return be.ch==bd.ch&&be.line==bd.line}function aA(be,bd){if(be.line<bd.line){return true}if(be.line==bd.line&&be.ch<bd.ch){return true}return false}function aF(bg,bf,be){var bh=aA(bg,bf);var bd=aA(bf,be);return bh&&bd}function aH(bd,be){return bd.getLine(be).length}function j(bd){return bd.split("").reverse().join("")}function aR(bd){if(bd.trim){return bd.trim()}return bd.replace(/^\s+|\s+$/g,"")}function f(bd){return bd.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function A(bq,bs){var bf=[],bd=bq.listSelections();var bt=bd[0].anchor,bk=bd[bd.length-1].anchor;var be,bh,bp;var br=bq.getCursor("head");var bo=q(bd,br);var bg=q(bd,bs)<0?false:true;bs=bq.clipPos(bs);var bm=Math.abs(bt.line-bs.line)-Math.abs(bk.line-bs.line);if(bm>0){bh=bs.line;be=bt.line;if(bk.line==bs.line&&bg){be=bh}}else{if(bm<0){be=bs.line;bh=bk.line;if(bt.line==bs.line&&bg){bh=be}}else{if(bo==0){be=bs.line;bh=bk.line}else{be=bt.line;bh=bs.line}}}if(be>bh){var bj=be;be=bh;bh=bj}bp=(bm>0)?bt:bk;while(be<=bh){var bi={line:be,ch:bp.ch};var bn={line:be,ch:bs.ch};if((bi.ch<br.ch)&&((bn.ch==bi.ch)||(bi.ch-bn.ch==1))){bi.ch++;bn.ch--}else{if((bi.ch>br.ch)&&((bn.ch==bi.ch)||(bi.ch-bn.ch==-1))){bi.ch--;bn.ch++}}var bl={anchor:bi,head:bn};bf.push(bl);if(bb(bn,bs)){bo=bf.indexOf(bl)}be++}bs.ch=bf[0].head.ch;bp.ch=bf[0].anchor.ch;bq.setSelections(bf,bo);return bp}function q(bd,bf){for(var be=0;be<bd.length;be++){if(bb(bd[be].head,bf)){return be}}return -1}function aP(be,bg){var bf=bg.lastSelection;var bd=function(){var bj=be.listSelections();var bm=bj[0];var bi=bj[bj.length-1];var bk=aA(bm.anchor,bm.head)?bm.anchor:bm.head;var bl=aA(bi.anchor,bi.head)?bi.head:bi.anchor;return[bk,bl]};var bh=function(){var bs=be.getCursor();var bt=be.getCursor();var bn=bf.visualBlock;if(bn){var bk=bn.width;var bu=bn.height;bt=c(bs.line+bu,bs.ch+bk);var bl=[];for(var bo=bs.line;bo<bt.line;bo++){var bp=c(bo,bs.ch);var br=c(bo,bt.ch);var bq={anchor:bp,head:br};bl.push(bq)}be.setSelections(bl)}else{var bj=bf.curStartMark.find();var bm=bf.curEndMark.find();var bv=bm.line-bj.line;var bi=bm.ch-bj.ch;bt={line:bt.line+bv,ch:bv?bt.ch:bi+bt.ch};if(bf.visualLine){bs=c(bs.line,0);bt=c(bt.line,aH(be,bt.line))}be.setSelection(bs,bt)}return[bs,bt]};if(!bg.visualMode){return bh()}else{return bd()}}function aW(bj,bh,bi,bk){if(!bi||!bk){bi=bh.marks["<"].find()||bj.getCursor("anchor");bk=bh.marks[">"].find()||bj.getCursor("head")}if(bh.lastPastedText){bk=bj.posFromIndex(bj.indexFromPos(bi)+bh.lastPastedText.length);bh.lastPastedText=null}var bd=bj.listSelections();var bf=q(bd,bi)>-1;if(bh.visualBlock){var bl=Math.abs(bi.line-bk.line)+1;var be=Math.abs(bi.ch-bk.ch);var bg={height:bl,width:be}}bh.lastSelection={curStartMark:bj.setBookmark(bf?bk:bi),curEndMark:bj.setBookmark(bf?bi:bk),visualMode:bh.visualMode,visualLine:bh.visualLine,visualBlock:bg}}function aE(bd){bd.off("mousedown",aE);var be=bd.state.vim;var bf=bd.getCursor("anchor");var bg=bd.getCursor("head");aW(bd,be);be.visualMode=false;be.visualLine=false;be.visualBlock=false;if(!bb(bf,bg)){bd.setCursor(P(bd,bg))}b.signal(bd,"vim-mode-change",{mode:"normal"});if(be.fakeCursor){be.fakeCursor.clear()}}function ab(be,bd,bi){var bh=be.getRange(bd,bi);if(/\n\s*$/.test(bh)){var bg=bh.split("\n");bg.pop();var bf;for(var bf=bg.pop();bg.length>0&&bf&&J(bf);bf=bg.pop()){bi.line--;bi.ch=0}if(bf){bi.line--;bi.ch=aH(be,bi.line)}else{bi.ch=0}}}function aV(be,bd,bf){bd.ch=0;bf.ch=0;bf.line++}function aK(be){if(!be){return 0}var bd=be.search(/\S/);return bd==-1?be.length:bd}function aq(bm,bi,bw,be,bx){var bg=bm.getCursor();var bp=bm.getLine(bg.line);var bs=bg.ch;var br=bp.substring(bs);var bt;if(bx){bt=br.search(/\w/)}else{bt=br.search(/\S/)}if(bt==-1){return null}bs+=bt;br=bp.substring(bs);var bv=bp.substring(0,bs);var by;if(be){by=/^\S+/}else{if((/\w/).test(bp.charAt(bs))){by=/^\w+/}else{by=/^[^\w\s]+/}}var bj=by.exec(br);var bq=bs;var bf=bs+bj[0].length;var bh=j(bv);var bn=by.exec(bh);if(bn){bq-=bn[0].length}if(bi){var bo=bp.substring(bf);var bd=bo.match(/^\s*/)[0].length;if(bd>0){bf+=bd}else{var bl=bh.length-bq;var bk=bh.substring(bl);var bu=bk.match(/^\s*/)[0].length;bq-=bu}}return{start:c(bg.line,bq),end:c(bg.line,bf)}}function aX(bd,be,bf){if(!bb(be,bf)){p.jumpList.add(bd,be,bf)}}function ao(bd,be){p.lastChararacterSearch.increment=bd;p.lastChararacterSearch.forward=be.forward;p.lastChararacterSearch.selectedCharacter=be.selectedCharacter}var K={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"};var aJ={bracket:{isComplete:function(bd){if(bd.nextCh===bd.symb){bd.depth++;if(bd.depth>=1){return true}}else{if(bd.nextCh===bd.reverseSymb){bd.depth--}}return false}},section:{init:function(bd){bd.curMoveThrough=true;bd.symb=(bd.forward?"]":"[")===bd.symb?"{":"}"},isComplete:function(bd){return bd.index===0&&bd.nextCh===bd.symb}},comment:{isComplete:function(be){var bd=be.lastCh==="*"&&be.nextCh==="/";be.lastCh=be.nextCh;return bd}},method:{init:function(bd){bd.symb=(bd.symb==="m"?"{":"}");bd.reverseSymb=bd.symb==="{"?"}":"{"},isComplete:function(bd){if(bd.nextCh===bd.symb){return true}return false}},preprocess:{init:function(bd){bd.index=0},isComplete:function(be){if(be.nextCh==="#"){var bd=be.lineText.match(/#(\w+)/)[1];if(bd==="endif"){if(be.forward&&be.depth===0){return true}be.depth++}else{if(bd==="if"){if(!be.forward&&be.depth===0){return true}be.depth--}}if(bd==="else"&&be.depth===0){return true}}return false}}};function a7(bm,be,bh,bf){var bp=x(bm.getCursor());var bn=bh?1:-1;var bg=bh?bm.lineCount():-1;var bl=bp.ch;var br=bp.line;var bk=bm.getLine(br);var bd={lineText:bk,nextCh:bk.charAt(bl),lastCh:null,index:bl,symb:bf,reverseSymb:(bh?{")":"(","}":"{"}:{"(":")","{":"}"})[bf],forward:bh,depth:0,curMoveThrough:false};var bi=K[bf];if(!bi){return bp}var bq=aJ[bi].init;var bo=aJ[bi].isComplete;if(bq){bq(bd)}while(br!==bg&&be){bd.index+=bn;bd.nextCh=bd.lineText.charAt(bd.index);if(!bd.nextCh){br+=bn;bd.lineText=bm.getLine(br)||"";if(bn>0){bd.index=0}else{var bj=bd.lineText.length;bd.index=(bj>0)?(bj-1):0}bd.nextCh=bd.lineText.charAt(bd.index)}if(bo(bd)){bp.line=br;bp.ch=bd.index;be--}}if(bd.nextCh||bd.curMoveThrough){return c(br,bd.index)}return bp}function a9(bn,bo,bg,bl,bm){var bh=bo.line;var bk=bo.ch;var br=bn.getLine(bh);var be=bg?1:-1;var bi=bl?a3:ag;if(bm&&br==""){bh+=be;br=bn.getLine(bh);if(!e(bn,bh)){return null}bk=(bg)?0:br.length}while(true){if(bm&&br==""){return{from:0,to:0,line:bh}}var bj=(be>0)?br.length:-1;var bq=bj,bp=bj;while(bk!=bj){var bd=false;for(var bf=0;bf<bi.length&&!bd;++bf){if(bi[bf].test(br.charAt(bk))){bq=bk;while(bk!=bj&&bi[bf].test(br.charAt(bk))){bk+=be}bp=bk;bd=bq!=bp;if(bq==bo.ch&&bh==bo.line&&bp==bq+be){continue}else{return{from:Math.min(bq,bp+1),to:Math.max(bq,bp),line:bh}}}}if(!bd){bk+=be}}bh+=be;if(!e(bn,bh)){return null}br=bn.getLine(bh);bk=(be>0)?0:br.length}throw new Error("The impossible happened.")}function an(bn,be,bi,br,bl){var bp=bn.getCursor();var bj=x(bp);var bk=[];if(bi&&!br||!bi&&br){be++}var bm=!(bi&&br);for(var bg=0;bg<be;bg++){var bd=a9(bn,bp,bi,bl,bm);if(!bd){var bf=aH(bn,bn.lastLine());bk.push(bi?{line:bn.lastLine(),from:bf,to:bf}:{line:0,from:0,to:0});break}bk.push(bd);bp=c(bd.line,bi?(bd.to-1):bd.from)}var bh=bk.length!=be;var bo=bk[0];var bq=bk.pop();if(bi&&!br){if(!bh&&(bo.from!=bj.ch||bo.line!=bj.line)){bq=bk.pop()}return c(bq.line,bq.from)}else{if(bi&&br){return c(bq.line,bq.to-1)}else{if(!bi&&br){if(!bh&&(bo.to!=bj.ch||bo.line!=bj.line)){bq=bk.pop()}return c(bq.line,bq.to)}else{return c(bq.line,bq.from)}}}}function a6(bi,be,bg,bh){var bk=bi.getCursor();var bd=bk.ch;var bj;for(var bf=0;bf<be;bf++){var bl=bi.getLine(bk.line);bj=aS(bd,bl,bh,bg,true);if(bj==-1){return null}bd=bj}return c(bi.getCursor().line,bj)}function Z(bd,bf){var be=bd.getCursor().line;return P(bd,c(be,bf-1))}function aD(bd,be,bf,bg){if(!E(bf,ar)){return}if(be.marks[bf]){be.marks[bf].clear()}be.marks[bf]=bd.setBookmark(bg)}function aS(bi,be,bh,bf,bg){var bd;if(bf){bd=be.indexOf(bh,bi+1);if(bd!=-1&&!bg){bd-=1}}else{bd=be.lastIndexOf(bh,bi-1);if(bd!=-1&&!bg){bd+=1}}return bd}function m(bm,bf,bl){var bn=bm.getCursor(),be,bh;var bk=({"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/})[bf];var bg=({"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"})[bf];var bd=bm.getLine(bn.line).charAt(bn.ch);var bi=bd===bg?1:0;be=bm.scanForBracket(c(bn.line,bn.ch+bi),-1,null,{bracketRegex:bk});bh=bm.scanForBracket(c(bn.line,bn.ch+bi),1,null,{bracketRegex:bk});if(!be||!bh){return{start:bn,end:bn}}be=be.pos;bh=bh.pos;if((be.line==bh.line&&be.ch>bh.ch)||(be.line>bh.line)){var bj=be;be=bh;bh=bj}if(bl){bh.ch+=1}else{be.ch+=1}return{start:be,end:bh}}function aC(bl,bf,bk){var bm=x(bl.getCursor());var bn=bl.getLine(bm.line);var bj=bn.split("");var be,bg,bh,bi;var bd=bj.indexOf(bf);if(bm.ch<bd){bm.ch=bd}else{if(bd<bm.ch&&bj[bm.ch]==bf){bg=bm.ch;--bm.ch}}if(bj[bm.ch]==bf&&!bg){be=bm.ch+1}else{for(bh=bm.ch;bh>-1&&!be;bh--){if(bj[bh]==bf){be=bh+1}}}if(be&&!bg){for(bh=be,bi=bj.length;bh<bi&&!bg;bh++){if(bj[bh]==bf){bg=bh}}}if(!be||!bg){return{start:bm,end:bm}}if(bk){--be;++bg}return{start:c(bm.line,be),end:c(bm.line,bg)}}ax("pcre",true,"boolean");function S(){}S.prototype={getQuery:function(){return p.query},setQuery:function(bd){p.query=bd},getOverlay:function(){return this.searchOverlay},setOverlay:function(bd){this.searchOverlay=bd},isReversed:function(){return p.isReversed},setReversed:function(bd){p.isReversed=bd}};function au(bd){var be=bd.state.vim;return be.searchState_||(be.searchState_=new S())}function R(bd,bg,bh,be,bf){if(bd.openDialog){bd.openDialog(bg,be,{bottom:true,value:bf.value,onKeyDown:bf.onKeyDown,onKeyUp:bf.onKeyUp})}else{be(prompt(bh,""))}}function s(bf){var be=aa(bf)||[];if(!be.length){return[]}var bg=[];if(be[0]!==0){return}for(var bd=0;bd<be.length;bd++){if(typeof be[bd]=="number"){bg.push(bf.substring(be[bd]+1,be[bd+1]))}}return bg}function aa(bg){var be=false;var bf=[];for(var bd=0;bd<bg.length;bd++){var bh=bg.charAt(bd);if(!be&&bh=="/"){bf.push(bd)}be=!be&&(bh=="\\")}return bf}function a5(bk){var bl="|(){";var bh="}";var bi=false;var be=[];for(var bf=-1;bf<bk.length;bf++){var bj=bk.charAt(bf)||"";var bd=bk.charAt(bf+1)||"";var bg=(bd&&bl.indexOf(bd)!=-1);if(bi){if(bj!=="\\"||!bg){be.push(bj)}bi=false}else{if(bj==="\\"){bi=true;if(bd&&bh.indexOf(bd)!=-1){bg=true}if(!bg||bd==="\\"){be.push(bj)}}else{be.push(bj);if(bg&&bd!=="\\"){be.push("\\")}}}}return be.join("")}function a8(bg){var bf=false;var bd=[];for(var be=-1;be<bg.length;be++){var bi=bg.charAt(be)||"";var bh=bg.charAt(be+1)||"";if(bf){bd.push(bi);bf=false}else{if(bi==="\\"){bf=true;if((V(bh)||bh==="$")){bd.push("$")}else{if(bh!=="/"&&bh!=="\\"){bd.push("\\")}}}else{if(bi==="$"){bd.push("$")}bd.push(bi);if(bh==="/"){bd.push("\\")}}}}return bd.join("")}function U(bf){var be=new b.StringStream(bf);var bd=[];while(!be.eol()){while(be.peek()&&be.peek()!="\\"){bd.push(be.next())}if(be.match("\\/",true)){bd.push("/")}else{if(be.match("\\\\",true)){bd.push("\\")}else{bd.push(be.next())}}}return bd.join("")}function al(bh,bf,bk){var bj=p.registerController.getRegister("/");bj.setText(bh);if(bh instanceof RegExp){return bh}var bi=aa(bh);var bl;var be;if(!bi.length){bl=bh}else{bl=bh.substring(0,bi[0]);var bd=bh.substring(bi[0]);be=(bd.indexOf("i")!=-1)}if(!bl){return null}if(!n("pcre")){bl=a5(bl)}if(bk){bf=(/^[^A-Z]*$/).test(bl)}var bg=new RegExp(bl,(bf||be)?"i":undefined);return bg}function a1(bd,be){if(bd.openNotification){bd.openNotification('<span style="color: red">'+be+"</span>",{bottom:true,duration:5000})}else{alert(be)}}function at(be,bf){var bd="";if(be){bd+='<span style="font-family: monospace">'+be+"</span>"}bd+='<input type="text"/> <span style="color: #888">';if(bf){bd+='<span style="color: #888">';bd+=bf;bd+="</span>"}return bd}var I="(Javascript regexp)";function aL(be,bf){var bg=(bf.prefix||"")+" "+(bf.desc||"");var bd=at(bf.prefix,bf.desc);R(be,bd,bg,bf.onClose,bf)}function O(be,bd){if(be instanceof RegExp&&bd instanceof RegExp){var bg=["global","multiline","ignoreCase","source"];for(var bf=0;bf<bg.length;bf++){var bh=bg[bf];if(be[bh]!==bd[bh]){return false}}return true}return false}function ba(bd,bi,be,bf){if(!bi){return}var bh=au(bd);var bg=al(bi,!!be,!!bf);if(!bg){return}aw(bd,bg);if(O(bg,bh.getQuery())){return bg}bh.setQuery(bg);return bg}function az(be){if(be.source.charAt(0)=="^"){var bd=true}return{token:function(bg){if(bd&&!bg.sol()){bg.skipToEnd();return}var bf=bg.match(be,false);if(bf){if(bf[0].length==0){bg.next();return"searching"}if(!bg.sol()){bg.backUp(1);if(!be.exec(bg.next()+bf[0])){bg.next();return null}}bg.match(be);return"searching"}while(!bg.eol()){bg.next();if(bg.match(be,false)){break}}},query:be}}function aw(bd,bf){var be=au(bd).getOverlay();if(!be||bf!=be.query){if(be){bd.removeOverlay(be)}be=az(bf);bd.addOverlay(be);au(bd).setOverlay(be)}}function bc(bd,be,bg,bf){if(bf===undefined){bf=1}return bd.operation(function(){var bk=bd.getCursor();var bj=bd.getSearchCursor(bg,bk);for(var bh=0;bh<bf;bh++){var bi=bj.find(be);if(bh==0&&bi&&bb(bj.from(),bk)){bi=bj.find(be)}if(!bi){bj=bd.getSearchCursor(bg,(be)?c(bd.lastLine()):c(bd.firstLine(),0));if(!bj.find(be)){return}}}return bj.from()})}function ay(bd){bd.removeOverlay(au(bd).getOverlay());au(bd).setOverlay(null)}function T(bf,be,bd){if(typeof bf!="number"){bf=bf.line}if(be instanceof Array){return E(bf,be)}else{if(bd){return(bf>=be&&bf<=bd)}else{return bf==be}}}function aU(bd){var bg=bd.getScrollInfo();var bf=6;var bj=10;var bi=bd.coordsChar({left:0,top:bf+bg.top},"local");var be=bg.clientHeight-bj+bg.top;var bh=bd.coordsChar({left:0,top:be},"local");return{top:bi.line,bottom:bh.line}}var w=[{name:"map"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"set"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:true},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:true},{name:"global",shortName:"g"}];d.ExCommandDispatcher=function(){this.buildCommandMap_()};d.ExCommandDispatcher.prototype={processCommand:function(bo,bn,be){var bi=bo.state.vim;var bf=p.registerController.getRegister(":");var bl=bf.toString();if(bi.visualMode){aE(bo)}var bd=new b.StringStream(bn);bf.setText(bn);var bh=be||{};bh.input=bn;try{this.parseInput_(bo,bd,bh)}catch(bm){a1(bo,bm);throw bm}var bg;var bk;if(!bh.commandName){if(bh.line!==undefined){bk="move"}}else{bg=this.matchCommand_(bh.commandName);if(bg){bk=bg.name;if(bg.excludeFromCommandHistory){bf.setText(bl)}this.parseCommandArgs_(bd,bh,bg);if(bg.type=="exToKey"){for(var bj=0;bj<bg.toKeys.length;bj++){b.Vim.handleKey(bo,bg.toKeys[bj])}return}else{if(bg.type=="exToEx"){this.processCommand(bo,bg.toInput);return}}}}if(!bk){a1(bo,'Not an editor command ":'+bn+'"');return}try{aO[bk](bo,bh);if((!bg||!bg.possiblyAsync)&&bh.callback){bh.callback()}}catch(bm){a1(bo,bm);throw bm}},parseInput_:function(be,bf,bd){bf.eatWhile(":");if(bf.eat("%")){bd.line=be.firstLine();bd.lineEnd=be.lastLine()}else{bd.line=this.parseLineSpec_(be,bf);if(bd.line!==undefined&&bf.eat(",")){bd.lineEnd=this.parseLineSpec_(be,bf)}}var bg=bf.match(/^(\w+)/);if(bg){bd.commandName=bg[1]}else{bd.commandName=bf.match(/.*/)[0]}return bd},parseLineSpec_:function(bd,be){var bf=be.match(/^(\d+)/);if(bf){return parseInt(bf[1],10)-1}switch(be.next()){case".":return bd.getCursor().line;case"$":return bd.lastLine();case"'":var bg=bd.state.vim.marks[be.next()];if(bg&&bg.find()){return bg.find().line}throw new Error("Mark not set");default:be.backUp(1);return undefined}},parseCommandArgs_:function(be,bh,bg){if(be.eol()){return}bh.argString=be.match(/.*/)[0];var bf=bg.argDelimiter||/\s+/;var bd=aR(bh.argString).split(bf);if(bd.length&&bd[0]){bh.args=bd}},matchCommand_:function(be){for(var bd=be.length;bd>0;bd--){var bf=be.substring(0,bd);if(this.commandMap_[bf]){var bg=this.commandMap_[bf];if(bg.name.indexOf(be)===0){return bg}}}return null},buildCommandMap_:function(){this.commandMap_={};for(var be=0;be<w.length;be++){var bf=w[be];var bd=bf.shortName||bf.name;this.commandMap_[bd]=bf}},map:function(be,bh,bd){if(be!=":"&&be.charAt(0)==":"){if(bd){throw Error("Mode not supported for ex mappings")}var bg=be.substring(1);if(bh!=":"&&bh.charAt(0)==":"){this.commandMap_[bg]={name:bg,type:"exToEx",toInput:bh.substring(1),user:true}}else{this.commandMap_[bg]={name:bg,type:"exToKey",toKeys:Y(bh),user:true}}}else{if(bh!=":"&&bh.charAt(0)==":"){var bf={keys:Y(be),type:"keyToEx",exArgs:{input:bh.substring(1)},user:true};if(bd){bf.context=bd}a.unshift(bf)}else{var bf={keys:Y(be),type:"keyToKey",toKeys:Y(bh),user:true};if(bd){bf.context=bd}a.unshift(bf)}}},unmap:function(be,bd){var bi=function(bk,bj){if(bk===bj){return true}if(bk==null||bj==null){return true}if(bk.length!=bj.length){return false}for(var bl=0;bl<bk.length;bl++){if(bk[bl]!==bj[bl]){return false}}return true};if(be!=":"&&be.charAt(0)==":"){if(bd){throw Error("Mode not supported for ex mappings")}var bg=be.substring(1);if(this.commandMap_[bg]&&this.commandMap_[bg].user){delete this.commandMap_[bg];return}}else{var bh=Y(be);for(var bf=0;bf<a.length;bf++){if(bi(bh,a[bf].keys)&&a[bf].context===bd&&a[bf].user){a.splice(bf,1);return}}}throw Error("No such mapping.")}};function Y(bg){var be,bd;var bf=[];while(bg){bd=(/<\w+-.+?>|<\w+>|./).exec(bg);if(bd===null){break}be=bd[0];bg=bg.substring(bd.index+be.length);bf.push(be)}return bf}var aO={map:function(bd,bg,be){var bf=bg.args;if(!bf||bf.length<2){if(bd){a1(bd,"Invalid mapping: "+bg.input)}return}l.map(bf[0],bf[1],be)},nmap:function(bd,be){this.map(bd,be,"normal")},vmap:function(bd,be){this.map(bd,be,"visual")},unmap:function(bd,bg,be){var bf=bg.args;if(!bf||bf.length<1){if(bd){a1(bd,"No such mapping: "+bg.input)}return}l.unmap(bf[0],be)},move:function(bd,be){aT.processCommand(bd,bd.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true},repeatOverride:be.line+1})},set:function(bl,bi){var bf=bi.args;if(!bf||bf.length<1){if(bl){a1(bl,"Invalid mapping: "+bi.input)}return}var bj=bf[0].split("=");var be=bj[0];var bk=bj[1];var bh=false;if(be.charAt(be.length-1)=="?"){if(bk){throw Error("Trailing characters: "+bi.argString)}be=be.substring(0,be.length-1);bh=true}if(bk===undefined&&be.substring(0,2)=="no"){be=be.substring(2);bk=false}var bg=ai[be]&&ai[be].type=="boolean";if(bg&&bk==undefined){bk=true}if(!bg&&!bk||bh){var bd=n(be);if(bd===true||bd===false){a1(bl," "+(bd?"":"no")+be)}else{a1(bl,"  "+be+"="+bd)}}else{av(be,bk)}},registers:function(bi,be){var bk=be.args;var bh=p.registerController.registers;var bf="----------Registers----------<br><br>";if(!bk){for(var bd in bh){var bl=bh[bd].toString();if(bl.length){bf+='"'+bd+"    "+bl+"<br>"}}}else{var bd;bk=bk.join("");for(var bg=0;bg<bk.length;bg++){bd=bk.charAt(bg);if(!p.registerController.isValidRegister(bd)){continue}var bj=bh[bd]||new a4();bf+='"'+bd+"    "+bj.toString()+"<br>"}}a1(bi,bf)},sort:function(bm,bw){var bn,bg,be,bf;function bh(){if(bw.argString){var bA=new b.StringStream(bw.argString);if(bA.eat("!")){bn=true}if(bA.eol()){return}if(!bA.eatSpace()){return"Invalid arguments"}var bC=bA.match(/[a-z]+/);if(bC){bC=bC[0];bg=bC.indexOf("i")!=-1;be=bC.indexOf("u")!=-1;var bz=bC.indexOf("d")!=-1&&1;var bB=bC.indexOf("x")!=-1&&1;var by=bC.indexOf("o")!=-1&&1;if(bz+bB+by>1){return"Invalid arguments"}bf=bz&&"decimal"||bB&&"hex"||by&&"octal"}if(bA.eatSpace()&&bA.match(/\/.*\//)){"patterns not supported"}}}var bi=bh();if(bi){a1(bm,bi+": "+bw.argString);return}var br=bw.line||bm.firstLine();var bv=bw.lineEnd||bw.line||bm.lastLine();if(br==bv){return}var bl=c(br,0);var bt=c(bv,aH(bm,bv));var bq=bm.getRange(bl,bt).split("\n");var bj=(bf=="decimal")?/(-?)([\d]+)/:(bf=="hex")?/(-?)(?:0x)?([0-9a-f]+)/i:(bf=="octal")?/([0-7]+)/:null;var bk=(bf=="decimal")?10:(bf=="hex")?16:(bf=="octal")?8:null;var bo=[],bs=[];if(bf){for(var bu=0;bu<bq.length;bu++){if(bj.exec(bq[bu])){bo.push(bq[bu])}else{bs.push(bq[bu])}}}else{bs=bq}function bx(bz,by){if(bn){var bA;bA=bz;bz=by;by=bA}if(bg){bz=bz.toLowerCase();by=by.toLowerCase()}var bC=bf&&bj.exec(bz);var bB=bf&&bj.exec(by);if(!bC){return bz<by?-1:1}bC=parseInt((bC[1]+bC[2]).toLowerCase(),bk);bB=parseInt((bB[1]+bB[2]).toLowerCase(),bk);return bC-bB}bo.sort(bx);bs.sort(bx);bq=(!bn)?bs.concat(bo):bo.concat(bs);if(be){var bp=bq;var bd;bq=[];for(var bu=0;bu<bp.length;bu++){if(bp[bu]!=bd){bq.push(bp[bu])}bd=bp[bu]}}bm.replaceRange(bq.join("\n"),bl,bt)},global:function(bq,bh){var be=bh.argString;if(!be){a1(bq,"Regular Expression missing from global");return}var bk=(bh.line!==undefined)?bh.line:bq.firstLine();var bi=bh.lineEnd||bh.line||bq.lastLine();var bp=s(be);var bs=be,bg;if(bp.length){bs=bp[0];bg=bp.slice(1,bp.length).join("/")}if(bs){try{ba(bq,bs,true,true)}catch(bn){a1(bq,"Invalid regex: "+bs);return}}var bo=au(bq).getQuery();var bd=[],bm="";for(var bj=bk;bj<=bi;bj++){var bf=bo.test(bq.getLine(bj));if(bf){bd.push(bj+1);bm+=bq.getLine(bj)+"<br>"}}if(!bg){a1(bq,bm);return}var bl=0;var br=function(){if(bl<bd.length){var bt=bd[bl]+bg;l.processCommand(bq,bt,{callback:br})}bl++};br()},substitute:function(bk,bs){if(!bk.getSearchCursor){throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.")}var bt=bs.argString;var bn=bt?s(bt):[];var bl,bm="",bd,be,bi;var bj=false;var bp=false;if(bn.length){bl=bn[0];bm=bn[1];if(bm!==undefined){if(n("pcre")){bm=U(bm)}else{bm=a8(bm)}p.lastSubstituteReplacePart=bm}bd=bn[2]?bn[2].split(" "):[]}else{if(bt&&bt.length){a1(bk,"Substitutions should be of the form :s/pattern/replace/");return}}if(bd){be=bd[0];bi=parseInt(bd[1]);if(be){if(be.indexOf("c")!=-1){bj=true;be.replace("c","")}if(be.indexOf("g")!=-1){bp=true;be.replace("g","")}bl=bl+"/"+be}}if(bl){try{ba(bk,bl,true,true)}catch(br){a1(bk,"Invalid regex: "+bl);return}}bm=bm||p.lastSubstituteReplacePart;if(bm===undefined){a1(bk,"No previous substitute regular expression");return}var bg=au(bk);var bh=bg.getQuery();var bo=(bs.line!==undefined)?bs.line:bk.getCursor().line;var bq=bs.lineEnd||bo;if(bi){bo=bq;bq=bo+bi-1}var bu=P(bk,c(bo,0));var bf=bk.getSearchCursor(bh,bu);aQ(bk,bj,bp,bo,bq,bf,bh,bm,bs.callback)},redo:b.commands.redo,undo:b.commands.undo,write:function(bd){if(b.commands.save){b.commands.save(bd)}else{bd.save()}},nohlsearch:function(bd){ay(bd)},delmarks:function(bn,bi){if(!bi.argString||!aR(bi.argString)){a1(bn,"Argument required");return}var bd=bn.state.vim;var bo=new b.StringStream(aR(bi.argString));while(!bo.eol()){bo.eatSpace();var bl=bo.pos;if(!bo.match(/[a-zA-Z]/,false)){a1(bn,"Invalid argument: "+bi.argString.substring(bl));return}var bf=bo.next();if(bo.match("-",true)){if(!bo.match(/[a-zA-Z]/,false)){a1(bn,"Invalid argument: "+bi.argString.substring(bl));return}var bg=bf;var bk=bo.next();if(z(bg)&&z(bk)||v(bg)&&v(bk)){var be=bg.charCodeAt(0);var bm=bk.charCodeAt(0);if(be>=bm){a1(bn,"Invalid argument: "+bi.argString.substring(bl));return}for(var bj=0;bj<=bm-be;bj++){var bh=String.fromCharCode(be+bj);delete bd.marks[bh]}}else{a1(bn,"Invalid argument: "+bg+"-");return}}else{delete bd.marks[bf]}}}};var l=new d.ExCommandDispatcher();function aQ(br,be,bg,bm,bk,bf,bo,bi,bs){br.state.vim.exMode=true;var bj=false;var bq=bf.from();function bn(){br.operation(function(){while(!bj){bh();bl()}bp()})}function bh(){var bu=br.getRange(bf.from(),bf.to());var bt=bu.replace(bo,bi);bf.replace(bt)}function bl(){var bt;while(bt=bf.findNext()&&T(bf.from(),bm,bk)){if(!bg&&bq&&bf.from().line==bq.line){continue}br.scrollIntoView(bf.from(),30);br.setSelection(bf.from(),bf.to());bq=bf.from();bj=false;return}bj=true}function bp(bu){if(bu){bu()}br.focus();if(bq){br.setCursor(bq);var bt=br.state.vim;bt.exMode=false;bt.lastHPos=bt.lastHSPos=bq.ch}if(bs){bs()}}function bd(bw,bt,bx){b.e_stop(bw);var bu=b.keyName(bw);switch(bu){case"Y":bh();bl();break;case"N":bl();break;case"A":var bv=bs;bs=undefined;br.operation(bn);bs=bv;break;case"L":bh();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":bp(bx);break}if(bj){bp(bx)}}bl();if(bj){a1(br,"No matches for "+bo.source);return}if(!be){bn();if(bs){bs()}return}aL(br,{prefix:"replace with <strong>"+bi+"</strong> (y/n/a/q/l)",onKeyDown:bd})}function ap(){function bf(bj,bi){var bh=bj;if(v(bh)&&bi=="Ctrl"){bh=bh.toLowerCase()}if(bi){bh=bi.charAt(0)+"-"+bh}var bk=({Enter:"CR",Backspace:"BS",Delete:"Del"})[bh];bh=bk?bk:bh;bh=bh.length>1?"<"+bh+">":bh;return bh}function be(bh){return function(bi){b.signal(bi,"vim-keypress",bh);b.Vim.handleKey(bi,bh)}}var bd={nofallthrough:true,style:"fat-cursor"};function bg(bm,bi){for(var bl=0;bl<bm.length;bl++){var bk=bm[bl];if(!bi&&bk.length==1){bk="'"+bk+"'"}var bh=bf(bm[bl],bi);var bj=bi?bi+"-"+bk:bk;bd[bj]=be(bh)}}bg(W);bg(ac);bg(W,"Ctrl");bg(h);bg(h,"Ctrl");bg(M);bg(M,"Ctrl");bg(aG);bg(aG,"Ctrl");return bd}b.keyMap.vim=ap();function r(bd){var bf=bd.state.vim;var bh=p.macroModeState;var be=p.registerController.getRegister(".");var bg=bh.isPlaying;if(!bg){bd.off("change",aY);b.off(bd.getInputField(),"keydown",N)}if(!bg&&bf.insertModeRepeat>1){t(bd,bf,bf.insertModeRepeat-1,true);bf.lastEditInputState.repeatOverride=bf.insertModeRepeat}delete bf.insertModeRepeat;bf.insertMode=false;bd.setCursor(bd.getCursor().line,bd.getCursor().ch-1);bd.setOption("keyMap","vim");bd.setOption("disableInput",true);bd.toggleOverwrite(false);be.setText(bh.lastInsertModeChanges.changes.join(""));b.signal(bd,"vim-mode-change",{mode:"normal"});if(bh.isRecording){ad(bh)}}b.keyMap["vim-insert"]={Esc:r,"Ctrl-[":r,"Ctrl-C":r,"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(bd){var be=b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent;be(bd)},fallthrough:["default"]};b.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]};function C(bl,bf,bg,bd){var bn=p.registerController.getRegister(bd);var be=bn.keyBuffer;var bj=0;bg.isPlaying=true;bg.replaySearchQueries=bn.searchQueries.slice(0);for(var bh=0;bh<be.length;bh++){var bo=be[bh];var bi,bm;while(bo){bi=(/<\w+-.+?>|<\w+>|./).exec(bo);bm=bi[0];bo=bo.substring(bi.index+bm.length);b.Vim.handleKey(bl,bm);if(bf.insertMode){var bk=bn.insertModeChanges[bj++].changes;p.macroModeState.lastInsertModeChanges.changes=bk;ah(bl,bk,1);r(bl)}}}bg.isPlaying=false}function D(bg,bd){if(bg.isPlaying){return}var bf=bg.latestRegister;var be=p.registerController.getRegister(bf);if(be){be.pushText(bd)}}function ad(bf){if(bf.isPlaying){return}var be=bf.latestRegister;var bd=p.registerController.getRegister(be);if(bd){bd.pushInsertModeChanges(bf.lastInsertModeChanges)}}function H(bg,bf){if(bg.isPlaying){return}var be=bg.latestRegister;var bd=p.registerController.getRegister(be);if(bd){bd.pushSearchQuery(bf)}}function aY(be,bd){var bg=p.macroModeState;var bf=bg.lastInsertModeChanges;if(!bg.isPlaying){while(bd){bf.expectCursorActivityForChange=true;if(bd.origin=="+input"||bd.origin=="paste"||bd.origin===undefined){var bh=bd.text.join("\n");bf.changes.push(bh)}bd=bd.next}}}function Q(bk){var bd=bk.state.vim;if(bd.insertMode){var be=p.macroModeState;if(be.isPlaying){return}var bf=be.lastInsertModeChanges;if(bf.expectCursorActivityForChange){bf.expectCursorActivityForChange=false}else{bf.changes=[]}}else{if(bk.doc.history.lastSelOrigin=="*mouse"){bd.lastHPos=bk.doc.getCursor().ch;if(bk.somethingSelected()){bd.visualMode=true}}}if(bd.visualMode){var bi,bh;bi=bh=bk.getCursor("head");var bg=bk.getCursor("anchor");var bj=c(bh.line,bi.ch+(aA(bg,bh)?-1:1));if(aA(bj,bi)){var bl=bi;bi=bj;bj=bl}if(bd.fakeCursor){bd.fakeCursor.clear()}bd.fakeCursor=bk.markText(bi,bj,{className:"cm-animate-fat-cursor"})}}function a0(bd){this.keyName=bd}function N(bh){var bg=p.macroModeState;var bf=bg.lastInsertModeChanges;var be=b.keyName(bh);function bd(){bf.changes.push(new a0(be));return true}if(be.indexOf("Delete")!=-1||be.indexOf("Backspace")!=-1){b.lookupKey(be,["vim-insert"],bd)}}function t(bl,bg,be,bd){var bi=p.macroModeState;bi.isPlaying=true;var bm=!!bg.lastEditActionCommand;var bj=bg.inputState;function bf(){if(bm){aT.processAction(bl,bg,bg.lastEditActionCommand)}else{aT.evalInput(bl,bg)}}function bk(bo){if(bi.lastInsertModeChanges.changes.length>0){bo=!bg.lastEditActionCommand?1:bo;var bn=bi.lastInsertModeChanges;bi.lastInsertModeChanges={};ah(bl,bn.changes,bo);bi.lastInsertModeChanges=bn}}bg.inputState=bg.lastEditInputState;if(bm&&bg.lastEditActionCommand.interlaceInsertRepeat){for(var bh=0;bh<be;bh++){bf();bk(1)}}else{if(!bd){bf()}bk(be)}bg.inputState=bj;if(bg.insertMode&&!bd){r(bl)}bi.isPlaying=false}function ah(bd,bg,bh){function bi(bl){if(typeof bl=="string"){b.commands[bl](bd)}else{bl(bd)}return true}for(var bf=0;bf<bh;bf++){for(var be=0;be<bg.length;be++){var bk=bg[be];if(bk instanceof a0){b.lookupKey(bk.keyName,["vim-insert"],bi)}else{var bj=bd.getCursor();bd.replaceRange(bk,bj,bj)}}}}u();return aB};b.Vim=d()});