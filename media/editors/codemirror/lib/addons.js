(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.defineOption("fullScreen",false,function(d,f,e){if(e==a.Init){e=false}if(!e==!f){return}if(f){b(d)}else{c(d)}});function b(d){var e=d.getWrapperElement();d.state.fullScreenRestore={scrollTop:window.pageYOffset,scrollLeft:window.pageXOffset,width:e.style.width,height:e.style.height};e.style.width="";e.style.height="auto";e.className+=" CodeMirror-fullscreen";document.documentElement.style.overflow="hidden";d.refresh()}function c(d){var e=d.getWrapperElement();e.className=e.className.replace(/\s*CodeMirror-fullscreen\b/,"");document.documentElement.style.overflow="";var f=d.state.fullScreenRestore;e.style.width=f.width;e.style.height=f.height;window.scrollTo(f.scrollLeft,f.scrollTop);d.refresh()}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var h="()[]{}''\"\"";var g="[]{}";var i=/\s/;var f=c.Pos;c.defineOption("autoCloseBrackets",false,function(j,o,k){if(k!=c.Init&&k){j.removeKeyMap("autoCloseBrackets")}if(!o){return}var m=h,l=g;if(typeof o=="string"){m=o}else{if(typeof o=="object"){if(o.pairs!=null){m=o.pairs}if(o.explode!=null){l=o.explode}}}var n=b(m);if(l){n.Enter=a(l)}j.addKeyMap(n)});function d(j,l){var k=j.getRange(f(l.line,l.ch-1),f(l.line,l.ch+1));return k.length==2?k:null}function e(j,p,n){var k=j.getLine(p.line);var m=j.getTokenAt(p);if(/\bstring2?\b/.test(m.type)){return false}var o=new c.StringStream(k.slice(0,p.ch)+n+k.slice(p.ch),4);o.pos=o.start=m.start;for(;;){var l=j.getMode().token(o,m.state);if(o.pos>=p.ch+1){return/\bstring2?\b/.test(l)}o.start=o.pos}}function b(l){var m={name:"autoCloseBrackets",Backspace:function(n){if(n.getOption("disableInput")){return c.Pass}var o=n.listSelections();for(var p=0;p<o.length;p++){if(!o[p].empty()){return c.Pass}var q=d(n,o[p].head);if(!q||l.indexOf(q)%2!=0){return c.Pass}}for(var p=o.length-1;p>=0;p--){var r=o[p].head;n.replaceRange("",f(r.line,r.ch-1),f(r.line,r.ch+1))}}};var k="";for(var j=0;j<l.length;j+=2){(function(o,n){if(o!=n){k+=n}m["'"+o+"'"]=function(p){if(p.getOption("disableInput")){return c.Pass}var q=p.listSelections(),v,u;for(var t=0;t<q.length;t++){var r=q[t],w=r.head,s;var u=p.getRange(w,f(w.line,w.ch+1));if(!r.empty()){s="surround"}else{if(o==n&&u==n){if(p.getRange(w,f(w.line,w.ch+3))==o+o+o){s="skipThree"}else{s="skip"}}else{if(o==n&&w.ch>1&&p.getRange(f(w.line,w.ch-2),w)==o+o&&(w.ch<=2||p.getRange(f(w.line,w.ch-3),f(w.line,w.ch-2))!=o)){s="addFour"}else{if(o=='"'||o=="'"){if(!c.isWordChar(u)&&e(p,w,o)){s="both"}else{return c.Pass}}else{if(p.getLine(w.line).length==w.ch||k.indexOf(u)>=0||i.test(u)){s="both"}else{return c.Pass}}}}}if(!v){v=s}else{if(v!=s){return c.Pass}}}p.operation(function(){if(v=="skip"){p.execCommand("goCharRight")}else{if(v=="skipThree"){for(var y=0;y<3;y++){p.execCommand("goCharRight")}}else{if(v=="surround"){var x=p.getSelections();for(var y=0;y<x.length;y++){x[y]=o+x[y]+n}p.replaceSelections(x,"around")}else{if(v=="both"){p.replaceSelection(o+n,null);p.execCommand("goCharLeft")}else{if(v=="addFour"){p.replaceSelection(o+o+o+o,"before");p.execCommand("goCharRight")}}}}}})};if(o!=n){m["'"+n+"'"]=function(p){var q=p.listSelections();for(var s=0;s<q.length;s++){var r=q[s];if(!r.empty()||p.getRange(r.head,f(r.head.line,r.head.ch+1))!=n){return c.Pass}}p.execCommand("goCharRight")}}})(l.charAt(j),l.charAt(j+1))}return m}function a(j){return function(k){if(k.getOption("disableInput")){return c.Pass}var l=k.listSelections();for(var m=0;m<l.length;m++){if(!l[m].empty()){return c.Pass}var n=d(k,l[m].head);if(!n||j.indexOf(n)%2!=0){return c.Pass}}k.operation(function(){k.replaceSelection("\n\n",null);k.execCommand("goCharLeft");l=k.listSelections();for(var p=0;p<l.length;p++){var o=l[p].head.line;k.indentLine(o,null,true);k.indentLine(o+1,null,true)}})}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(b){b.defineOption("autoCloseTags",false,function(h,k,i){if(i!=b.Init&&i){h.removeKeyMap("autoCloseTags")}if(!k){return}var j={name:"autoCloseTags"};if(typeof k!="object"||k.whenClosing){j["'/'"]=function(l){return e(l)}}if(typeof k!="object"||k.whenOpening){j["'>'"]=function(l){return a(l)}}h.addKeyMap(j)});var d=["area","base","br","col","command","embed","hr","img","input","keygen","link","meta","param","source","track","wbr"];var c=["applet","blockquote","body","button","div","dl","fieldset","form","frameset","h1","h2","h3","h4","h5","h6","head","html","iframe","layer","legend","object","ol","p","select","table","ul"];function a(w){if(w.getOption("disableInput")){return b.Pass}var j=w.listSelections(),q=[];for(var r=0;r<j.length;r++){if(!j[r].empty()){return b.Pass}var v=j[r].head,x=w.getTokenAt(v);var y=b.innerMode(w.getMode(),x.state),h=y.state;if(y.mode.name!="xml"||!h.tagName){return b.Pass}var k=w.getOption("autoCloseTags"),s=y.mode.configuration=="html";var m=(typeof k=="object"&&k.dontCloseTags)||(s&&d);var u=(typeof k=="object"&&k.indentTags)||(s&&c);var p=h.tagName;if(x.end>v.ch){p=p.slice(0,p.length-x.end+v.ch)}var t=p.toLowerCase();if(!p||x.type=="string"&&(x.end!=v.ch||!/[\"\']/.test(x.string.charAt(x.string.length-1))||x.string.length==1)||x.type=="tag"&&h.type=="closeTag"||x.string.indexOf("/")==(x.string.length-1)||m&&g(m,t)>-1||f(w,p,v,h,true)){return b.Pass}var o=u&&g(u,t)>-1;q[r]={indent:o,text:">"+(o?"\n\n":"")+"</"+p+">",newPos:o?b.Pos(v.line+1,0):b.Pos(v.line,v.ch+1)}}for(var r=j.length-1;r>=0;r--){var n=q[r];w.replaceRange(n.text,j[r].head,j[r].anchor,"+insert");var l=w.listSelections().slice(0);l[r]={head:n.newPos,anchor:n.newPos};w.setSelections(l);if(n.indent){w.indentLine(n.newPos.line,null,true);w.indentLine(n.newPos.line+1,null,true)}}}function e(h){if(h.getOption("disableInput")){return b.Pass}var j=h.listSelections(),n=[];for(var m=0;m<j.length;m++){if(!j[m].empty()){return b.Pass}var p=j[m].head,l=h.getTokenAt(p);var k=b.innerMode(h.getMode(),l.state),o=k.state;if(l.type=="string"||l.string.charAt(0)!="<"||l.start!=p.ch-1){return b.Pass}if(k.mode.name!="xml"){if(h.getMode().name=="htmlmixed"&&k.mode.name=="javascript"){n[m]="/script>"}else{if(h.getMode().name=="htmlmixed"&&k.mode.name=="css"){n[m]="/style>"}else{return b.Pass}}}else{if(!o.context||!o.context.tagName||f(h,o.context.tagName,p,o)){return b.Pass}n[m]="/"+o.context.tagName+">"}}h.replaceSelections(n);j=h.listSelections();for(var m=0;m<j.length;m++){if(m==j.length-1||j[m].head.line<j[m+1].head.line){h.indentLine(j[m].head.line)}}}function g(l,h){if(l.indexOf){return l.indexOf(h)}for(var j=0,k=l.length;j<k;++j){if(l[j]==h){return j}}return -1}function f(q,j,p,h,s){if(!b.scanForClosingTag){return false}var k=Math.min(q.lastLine()+1,p.line+500);var r=b.scanForClosingTag(q,p,null,k);if(!r||r.tag!=j){return false}var l=h.context;for(var n=s?1:0;l&&l.tagName==j;l=l.prev){++n}p=r.to;for(var m=1;m<n;m++){var o=b.scanForClosingTag(q,p,null,k);if(!o||o.tag!=j){return false}p=o.to}return true}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(e){var d=/MSIE \d/.test(navigator.userAgent)&&(document.documentMode==null||document.documentMode<8);var i=e.Pos;var a={"(":")>",")":"(<","[":"]>","]":"[<","{":"}>","}":"{<"};function f(q,m,p,k){var s=q.getLineHandle(m.line),o=m.ch-1;var n=(o>=0&&a[s.text.charAt(o)])||a[s.text.charAt(++o)];if(!n){return null}var l=n.charAt(1)==">"?1:-1;if(p&&(l>0)!=(o==m.ch)){return null}var j=q.getTokenTypeAt(i(m.line,o+1));var r=g(q,i(m.line,o+(l>0?1:0)),l,j||null,k);if(r==null){return null}return{from:i(m.line,o),to:r&&r.pos,match:r&&r.ch==n.charAt(0),forward:l>0}}function g(w,r,n,k,m){var l=(m&&m.maxScanLineLength)||10000;var t=(m&&m.maxScanLines)||1000;var v=[];var x=m&&m.bracketRegex?m.bracketRegex:/[(){}[\]]/;var q=n>0?Math.min(r.line+t,w.lastLine()+1):Math.max(w.firstLine()-1,r.line-t);for(var o=r.line;o!=q;o+=n){var y=w.getLine(o);if(!y){continue}var u=n>0?0:y.length-1,p=n>0?y.length:-1;if(y.length>l){continue}if(o==r.line){u=r.ch-(n<0?1:0)}for(;u!=p;u+=n){var j=y.charAt(u);if(x.test(j)&&(k===undefined||w.getTokenTypeAt(i(o,u+1))==k)){var s=a[j];if((s.charAt(1)==">")==(n>0)){v.push(j)}else{if(!v.length){return{pos:i(o,u),ch:j}}else{v.pop()}}}}}return o-n==(n>0?w.lastLine():w.firstLine())?false:null}function b(s,n,m){var k=s.state.matchBrackets.maxHighlightLineLength||1000;var r=[],l=s.listSelections();for(var o=0;o<l.length;o++){var q=l[o].empty()&&f(s,l[o].head,false,m);if(q&&s.getLine(q.from.line).length<=k){var j=q.match?"CodeMirror-matchingbracket":"CodeMirror-nonmatchingbracket";r.push(s.markText(q.from,i(q.from.line,q.from.ch+1),{className:j}));if(q.to&&s.getLine(q.to.line).length<=k){r.push(s.markText(q.to,i(q.to.line,q.to.ch+1),{className:j}))}}}if(r.length){if(d&&s.state.focused){s.display.input.focus()}var p=function(){s.operation(function(){for(var t=0;t<r.length;t++){r[t].clear()}})};if(n){setTimeout(p,800)}else{return p}}}var c=null;function h(j){j.operation(function(){if(c){c();c=null}c=b(j,false,j.state.matchBrackets)})}e.defineOption("matchBrackets",false,function(j,l,k){if(k&&k!=e.Init){j.off("cursorActivity",h)}if(l){j.state.matchBrackets=typeof l=="object"?l:{};j.on("cursorActivity",h)}});e.defineExtension("matchBrackets",function(){b(this,true)});e.defineExtension("findMatchingBracket",function(l,j,k){return f(this,l,j,k)});e.defineExtension("scanForBracket",function(m,k,l,j){return g(this,m,k,l,j)})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("../fold/xml-fold"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","../fold/xml-fold"],a)}else{a(CodeMirror)}}})(function(c){c.defineOption("matchTags",false,function(e,g,f){if(f&&f!=c.Init){e.off("cursorActivity",b);e.off("viewportChange",d);a(e)}if(g){e.state.matchBothTags=typeof g=="object"&&g.bothTags;e.on("cursorActivity",b);e.on("viewportChange",d);b(e)}});function a(e){if(e.state.tagHit){e.state.tagHit.clear()}if(e.state.tagOther){e.state.tagOther.clear()}e.state.tagHit=e.state.tagOther=null}function b(e){e.state.failedTagMatch=false;e.operation(function(){a(e);if(e.somethingSelected()){return}var j=e.getCursor(),g=e.getViewport();g.from=Math.min(g.from,j.line);g.to=Math.max(j.line+1,g.to);var h=c.findMatchingTag(e,j,g);if(!h){return}if(e.state.matchBothTags){var i=h.at=="open"?h.open:h.close;if(i){e.state.tagHit=e.markText(i.from,i.to,{className:"CodeMirror-matchingtag"})}}var f=h.at=="close"?h.open:h.close;if(f){e.state.tagOther=e.markText(f.from,f.to,{className:"CodeMirror-matchingtag"})}else{e.state.failedTagMatch=true}})}function d(e){if(e.state.failedTagMatch){b(e)}}c.commands.toMatchingTag=function(f){var g=c.findMatchingTag(f,f.getCursor());if(g){var e=g.at=="close"?g.open:g.close;if(e){f.extendSelection(e.to,e.from)}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.registerHelper("fold","brace",function(m,h){var o=h.line,g=m.getLine(o);var n,t;function d(u){for(var i=h.ch,v=0;;){var w=i<=0?-1:g.lastIndexOf(u,i-1);if(w==-1){if(v==1){break}v=1;i=g.length;continue}if(v==1&&w<h.ch){break}t=m.getTokenTypeAt(a.Pos(o,w+1));if(!/^(comment|string)/.test(t)){return w+1}i=w-1}}var j="{",e="}",n=d("{");if(n==null){j="[",e="]";n=d("[")}if(n==null){return}var l=1,c=m.lastLine(),f,q;outer:for(var s=o;s<=c;++s){var p=m.getLine(s),k=s==o?n:0;for(;;){var b=p.indexOf(j,k),r=p.indexOf(e,k);if(b<0){b=p.length}if(r<0){r=p.length}k=Math.min(b,r);if(k==p.length){break}if(m.getTokenTypeAt(a.Pos(s,k+1))==t){if(k==b){++l}else{if(!--l){f=s;q=k;break outer}}}++k}}if(f==null||o==f&&q==n){return}return{from:a.Pos(o,n),to:a.Pos(f,q)}});a.registerHelper("fold","import",function(b,h){function g(k){if(k<b.firstLine()||k>b.lastLine()){return null}var o=b.getTokenAt(a.Pos(k,1));if(!/\S/.test(o.string)){o=b.getTokenAt(a.Pos(k,o.end+1))}if(o.type!="keyword"||o.string!="import"){return null}for(var l=k,m=Math.min(b.lastLine(),k+10);l<=m;++l){var n=b.getLine(l),j=n.indexOf(";");if(j!=-1){return{startCh:o.end,end:a.Pos(l,j)}}}}var h=h.line,d=g(h),f;if(!d||g(h-1)||((f=g(h-2))&&f.end.line==h-1)){return null}for(var c=d.end;;){var e=g(c.line+1);if(e==null){break}c=e.end}return{from:b.clipPos(a.Pos(h,d.startCh+1)),to:c}});a.registerHelper("fold","include",function(b,g){function f(h){if(h<b.firstLine()||h>b.lastLine()){return null}var i=b.getTokenAt(a.Pos(h,1));if(!/\S/.test(i.string)){i=b.getTokenAt(a.Pos(h,i.end+1))}if(i.type=="meta"&&i.string.slice(0,8)=="#include"){return i.start+8}}var g=g.line,d=f(g);if(d==null||f(g-1)!=null){return null}for(var c=g;;){var e=f(c+1);if(e==null){break}++c}return{from:a.Pos(g,d+1),to:b.clipPos(a.Pos(c))}})});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(b){function d(n,m,o,i){if(o&&o.call){var g=o;o=null}else{var g=c(n,o,"rangeFinder")}if(typeof m=="number"){m=b.Pos(m,0)}var h=c(n,o,"minFoldSize");function f(p){var q=g(n,m);if(!q||q.to.line-q.from.line<h){return null}var s=n.findMarksAt(q.from);for(var r=0;r<s.length;++r){if(s[r].__isFold&&i!=="fold"){if(!p){return null}q.cleared=true;s[r].clear()}}return q}var k=f(true);if(c(n,o,"scanUp")){while(!k&&m.line>n.firstLine()){m=b.Pos(m.line-1,0);k=f(false)}}if(!k||k.cleared||i==="unfold"){return}var l=e(n,o);b.on(l,"mousedown",function(p){j.clear();b.e_preventDefault(p)});var j=n.markText(k.from,k.to,{replacedWith:l,clearOnEnter:true,__isFold:true});j.on("clear",function(q,p){b.signal(n,"unfold",n,q,p)});b.signal(n,"fold",n,k.from,k.to)}function e(f,g){var h=c(f,g,"widget");if(typeof h=="string"){var i=document.createTextNode(h);h=document.createElement("span");h.appendChild(i);h.className="CodeMirror-foldmarker"}return h}b.newFoldFunction=function(g,f){return function(h,i){d(h,i,{rangeFinder:g,widget:f})}};b.defineExtension("foldCode",function(h,f,g){d(this,h,f,g)});b.defineExtension("isFolded",function(h){var g=this.findMarksAt(h);for(var f=0;f<g.length;++f){if(g[f].__isFold){return true}}});b.commands.toggleFold=function(f){f.foldCode(f.getCursor())};b.commands.fold=function(f){f.foldCode(f.getCursor(),null,"fold")};b.commands.unfold=function(f){f.foldCode(f.getCursor(),null,"unfold")};b.commands.foldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"fold")}})};b.commands.unfoldAll=function(f){f.operation(function(){for(var g=f.firstLine(),h=f.lastLine();g<=h;g++){f.foldCode(b.Pos(g,0),null,"unfold")}})};b.registerHelper("fold","combine",function(){var f=Array.prototype.slice.call(arguments,0);return function(g,k){for(var h=0;h<f.length;++h){var j=f[h](g,k);if(j){return j}}}});b.registerHelper("fold","auto",function(f,k){var h=f.getHelpers(k,"fold");for(var g=0;g<h.length;g++){var j=h[g](f,k);if(j){return j}}});var a={rangeFinder:b.fold.auto,widget:"\u2194",minFoldSize:0,scanUp:false};b.defineOption("foldOptions",null);function c(f,h,g){if(h&&h[g]!==undefined){return h[g]}var i=f.options.foldOptions;if(i&&i[g]!==undefined){return i[g]}return a[g]}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"),require("./foldcode"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror","./foldcode"],a)}else{a(CodeMirror)}}})(function(d){d.defineOption("foldGutter",false,function(m,o,n){if(n&&n!=d.Init){m.clearGutter(m.state.foldGutter.options.gutter);m.state.foldGutter=null;m.off("gutterClick",k);m.off("change",g);m.off("viewportChange",l);m.off("fold",e);m.off("unfold",e);m.off("swapDoc",b)}if(o){m.state.foldGutter=new j(i(o));b(m);m.on("gutterClick",k);m.on("change",g);m.on("viewportChange",l);m.on("fold",e);m.on("unfold",e);m.on("swapDoc",b)}});var h=d.Pos;function j(m){this.options=m;this.from=this.to=0}function i(m){if(m===true){m={}}if(m.gutter==null){m.gutter="CodeMirror-foldgutter"}if(m.indicatorOpen==null){m.indicatorOpen="CodeMirror-foldgutter-open"}if(m.indicatorFolded==null){m.indicatorFolded="CodeMirror-foldgutter-folded"}return m}function c(m,n){var p=m.findMarksAt(h(n));for(var o=0;o<p.length;++o){if(p[o].__isFold&&p[o].find().from.line==n){return true}}}function f(m){if(typeof m=="string"){var n=document.createElement("div");n.className=m+" CodeMirror-guttermarker-subtle";return n}else{return m.cloneNode(true)}}function a(m,q,p){var n=m.state.foldGutter.options,o=q;m.eachLine(q,p,function(r){var v=null;if(c(m,o)){v=f(n.indicatorFolded)}else{var u=h(o,0),t=n.rangeFinder||d.fold.auto;var s=t&&t(m,u);if(s&&s.from.line+1<s.to.line){v=f(n.indicatorOpen)}}m.setGutterMarker(r,n.gutter,v);++o})}function b(m){var n=m.getViewport(),o=m.state.foldGutter;if(!o){return}m.operation(function(){a(m,n.from,n.to)});o.from=n.from;o.to=n.to}function k(m,n,p){var o=m.state.foldGutter.options;if(p!=o.gutter){return}m.foldCode(h(n,0),o.rangeFinder)}function g(m){var o=m.state.foldGutter,n=m.state.foldGutter.options;o.from=o.to=0;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){b(m)},n.foldOnChangeTimeSpan||600)}function l(m){var o=m.state.foldGutter,n=m.state.foldGutter.options;clearTimeout(o.changeUpdate);o.changeUpdate=setTimeout(function(){var p=m.getViewport();if(o.from==o.to||p.from-o.to>20||o.from-p.to>20){b(m)}else{m.operation(function(){if(p.from<o.from){a(m,p.from,o.from);o.from=p.from}if(p.to>o.to){a(m,o.to,p.to);o.to=p.to}})}},n.updateViewportTimeSpan||400)}function e(m,p){var o=m.state.foldGutter,n=p.line;if(n>=o.from&&n<o.to){a(m,n,n+1)}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(i){var m=i.Pos;function l(r,q){return r.line-q.line||r.ch-q.ch}var j="A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD";var o=j+"-:.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040";var d=new RegExp("<(/?)(["+j+"]["+o+"]*)","g");function b(q,r,t,s){this.line=r;this.ch=t;this.cm=q;this.text=q.getLine(r);this.min=s?s.from:q.firstLine();this.max=s?s.to-1:q.lastLine()}function h(q,s){var r=q.cm.getTokenTypeAt(m(q.line,s));return r&&/\btag\b/.test(r)}function a(q){if(q.line>=q.max){return}q.ch=0;q.text=q.cm.getLine(++q.line);return true}function n(q){if(q.line<=q.min){return}q.text=q.cm.getLine(--q.line);q.ch=q.text.length;return true}function g(s){for(;;){var r=s.text.indexOf(">",s.ch);if(r==-1){if(a(s)){continue}else{return}}if(!h(s,r+1)){s.ch=r+1;continue}var q=s.text.lastIndexOf("/",r);var t=q>-1&&!/\S/.test(s.text.slice(q+1,r));s.ch=r+1;return t?"selfClose":"regular"}}function k(r){for(;;){var q=r.ch?r.text.lastIndexOf("<",r.ch-1):-1;if(q==-1){if(n(r)){continue}else{return}}if(!h(r,q+1)){r.ch=q;continue}d.lastIndex=q;r.ch=q;var s=d.exec(r.text);if(s&&s.index==q){return s}}}function p(q){for(;;){d.lastIndex=q.ch;var r=d.exec(q.text);if(!r){if(a(q)){continue}else{return}}if(!h(q,r.index+1)){q.ch=r.index+1;continue}q.ch=r.index+r[0].length;return r}}function e(s){for(;;){var r=s.ch?s.text.lastIndexOf(">",s.ch-1):-1;if(r==-1){if(n(s)){continue}else{return}}if(!h(s,r+1)){s.ch=r;continue}var q=s.text.lastIndexOf("/",r);var t=q>-1&&!/\S/.test(s.text.slice(q+1,r));s.ch=r+1;return t?"selfClose":"regular"}}function f(t,r){var q=[];for(;;){var v=p(t),s,x=t.line,w=t.ch-(v?v[0].length:0);if(!v||!(s=g(t))){return}if(s=="selfClose"){continue}if(v[1]){for(var u=q.length-1;u>=0;--u){if(q[u]==v[2]){q.length=u;break}}if(u<0&&(!r||r==v[2])){return{tag:v[2],from:m(x,w),to:m(t.line,t.ch)}}}else{q.push(v[2])}}}function c(s,r){var q=[];for(;;){var w=e(s);if(!w){return}if(w=="selfClose"){k(s);continue}var v=s.line,u=s.ch;var x=k(s);if(!x){return}if(x[1]){q.push(x[2])}else{for(var t=q.length-1;t>=0;--t){if(q[t]==x[2]){q.length=t;break}}if(t<0&&(!r||r==x[2])){return{tag:x[2],from:m(s.line,s.ch),to:m(v,u)}}}}}i.registerHelper("fold","xml",function(q,v){var s=new b(q,v.line,0);for(;;){var t=p(s),r;if(!t||s.line!=v.line||!(r=g(s))){return}if(!t[1]&&r!="selfClose"){var v=m(s.line,s.ch);var u=f(s,t[2]);return u&&{from:v,to:u.from}}}});i.findMatchingTag=function(q,x,t){var s=new b(q,x.line,x.ch,t);if(s.text.indexOf(">")==-1&&s.text.indexOf("<")==-1){return}var r=g(s),w=r&&m(s.line,s.ch);var v=r&&k(s);if(!r||!v||l(s,x)>0){return}var u={from:m(s.line,s.ch),to:w,tag:v[2]};if(r=="selfClose"){return{open:u,close:null,at:"open"}}if(v[1]){return{open:c(s,v[2]),close:u,at:"close"}}else{s=new b(q,w.line,w.ch,t);return{open:u,close:f(s,v[2]),at:"open"}}};i.findEnclosingTag=function(q,w,s){var r=new b(q,w.line,w.ch,s);for(;;){var u=c(r);if(!u){break}var t=new b(q,w.line,w.ch,s);var v=f(t,u.tag);if(v){return{open:u,close:v}}}};i.scanForClosingTag=function(q,u,t,s){var r=new b(q,u.line,u.ch,s?{from:0,to:s}:null);return f(r,t)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){if(!a.modeURL){a.modeURL="../mode/%N/%N.js"}var d={};function c(e,g){var f=g;return function(){if(--f==0){e()}}}function b(k,e){var j=a.modes[k].dependencies;if(!j){return e()}var h=[];for(var g=0;g<j.length;++g){if(!a.modes.hasOwnProperty(j[g])){h.push(j[g])}}if(!h.length){return e()}var f=c(e,h.length);for(var g=0;g<h.length;++g){a.requireMode(h[g],f)}}a.requireMode=function(k,e){if(typeof k!="string"){k=k.name}if(a.modes.hasOwnProperty(k)){return b(k,e)}if(d.hasOwnProperty(k)){return d[k].push(e)}var f=document.createElement("script");f.src=a.modeURL.replace(/%N/g,k);var g=document.getElementsByTagName("script")[0];g.parentNode.insertBefore(f,g);var i=d[k]=[e];var h=0,j=setInterval(function(){if(++h>100){return clearInterval(j)}if(a.modes.hasOwnProperty(k)){clearInterval(j);d[k]=null;b(k,function(){for(var l=0;l<i.length;++l){i[l]()}})}},200)};a.autoLoadMode=function(e,f){if(!a.modes.hasOwnProperty(f)){a.requireMode(f,function(){e.setOption("mode",e.getOption("mode"))})}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(a){a.multiplexingMode=function(c){var e=Array.prototype.slice.call(arguments,1);var b=e.length;function d(g,h,i){if(typeof h=="string"){return g.indexOf(h,i)}var f=h.exec(i?g.slice(i):g);return f?f.index+i:-1}return{startState:function(){return{outer:a.startState(c),innerActive:null,inner:null}},copyState:function(f){return{outer:a.copyState(c,f.outer),innerActive:f.innerActive,inner:f.innerActive&&a.copyState(f.innerActive.mode,f.inner)}},token:function(o,f){if(!f.innerActive){var h=Infinity,m=o.string;for(var j=0;j<b;++j){var l=e[j];var p=d(m,l.open,o.pos);if(p==o.pos){o.match(l.open);f.innerActive=l;f.inner=a.startState(l.mode,c.indent?c.indent(f.outer,""):0);return l.delimStyle}else{if(p!=-1&&p<h){h=p}}}if(h!=Infinity){o.string=m.slice(0,h)}var g=c.token(o,f.outer);if(h!=Infinity){o.string=m}return g}else{var k=f.innerActive,m=o.string;if(!k.close&&o.sol()){f.innerActive=f.inner=null;return this.token(o,f)}var p=k.close?d(m,k.close,o.pos):-1;if(p==o.pos){o.match(k.close);f.innerActive=f.inner=null;return k.delimStyle}if(p>-1){o.string=m.slice(0,p)}var n=k.mode.token(o,f.inner);if(p>-1){o.string=m}if(k.innerStyle){if(n){n=n+" "+k.innerStyle}else{n=k.innerStyle}}return n}},indent:function(g,f){var h=g.innerActive?g.innerActive.mode:c;if(!h.indent){return a.Pass}return h.indent(g.innerActive?g.inner:g.outer,f)},blankLine:function(h){var j=h.innerActive?h.innerActive.mode:c;if(j.blankLine){j.blankLine(h.innerActive?h.inner:h.outer)}if(!h.innerActive){for(var g=0;g<b;++g){var f=e[g];if(f.open==="\n"){h.innerActive=f;h.inner=a.startState(f.mode,j.indent?j.indent(h.outer,""):0)}}}else{if(h.innerActive.close==="\n"){h.innerActive=h.inner=null}}},electricChars:c.electricChars,innerMode:function(f){return f.inner?{state:f.inner,mode:f.innerActive.mode}:{state:f.outer,mode:c}}}}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../../lib/codemirror"))}else{if(typeof define=="function"&&define.amd){define(["../../lib/codemirror"],a)}else{a(CodeMirror)}}})(function(c){var g="CodeMirror-activeline";var f="CodeMirror-activeline-background";c.defineOption("styleActiveLine",false,function(h,k,i){var j=i&&i!=c.Init;if(k&&!j){h.state.activeLines=[];e(h,h.listSelections());h.on("beforeSelectionChange",b)}else{if(!k&&j){h.off("beforeSelectionChange",b);d(h);delete h.state.activeLines}}});function d(h){for(var j=0;j<h.state.activeLines.length;j++){h.removeLineClass(h.state.activeLines[j],"wrap",g);h.removeLineClass(h.state.activeLines[j],"background",f)}}function a(j,h){if(j.length!=h.length){return false}for(var k=0;k<j.length;k++){if(j[k]!=h[k]){return false}}return true}function e(h,k){var n=[];for(var m=0;m<k.length;m++){var l=k[m];if(!l.empty()){continue}var j=h.getLineHandleVisualStart(l.head.line);if(n[n.length-1]!=j){n.push(j)}}if(a(h.state.activeLines,n)){return}h.operation(function(){d(h);for(var o=0;o<n.length;o++){h.addLineClass(n[o],"wrap",g);h.addLineClass(n[o],"background",f)}h.state.activeLines=n})}function b(h,i){e(h,i.ranges)}});(function(a){if(typeof exports=="object"&&typeof module=="object"){a(require("../lib/codemirror"),require("../addon/search/searchcursor"),require("../addon/dialog/dialog"),require("../addon/edit/matchbrackets.js"))}else{if(typeof define=="function"&&define.amd){define(["../lib/codemirror","../addon/search/searchcursor","../addon/dialog/dialog","../addon/edit/matchbrackets"],a)}else{a(CodeMirror)}}})(function(b){var a=[{keys:"<Left>",type:"keyToKey",toKeys:"h"},{keys:"<Right>",type:"keyToKey",toKeys:"l"},{keys:"<Up>",type:"keyToKey",toKeys:"k"},{keys:"<Down>",type:"keyToKey",toKeys:"j"},{keys:"<Space>",type:"keyToKey",toKeys:"l"},{keys:"<BS>",type:"keyToKey",toKeys:"h"},{keys:"<C-Space>",type:"keyToKey",toKeys:"W"},{keys:"<C-BS>",type:"keyToKey",toKeys:"B"},{keys:"<S-Space>",type:"keyToKey",toKeys:"w"},{keys:"<S-BS>",type:"keyToKey",toKeys:"b"},{keys:"<C-n>",type:"keyToKey",toKeys:"j"},{keys:"<C-p>",type:"keyToKey",toKeys:"k"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>"},{keys:"<C-[>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"<C-c>",type:"keyToKey",toKeys:"<Esc>",context:"insert"},{keys:"s",type:"keyToKey",toKeys:"cl",context:"normal"},{keys:"s",type:"keyToKey",toKeys:"xi",context:"visual"},{keys:"S",type:"keyToKey",toKeys:"cc",context:"normal"},{keys:"S",type:"keyToKey",toKeys:"dcc",context:"visual"},{keys:"<Home>",type:"keyToKey",toKeys:"0"},{keys:"<End>",type:"keyToKey",toKeys:"$"},{keys:"<PageUp>",type:"keyToKey",toKeys:"<C-b>"},{keys:"<PageDown>",type:"keyToKey",toKeys:"<C-f>"},{keys:"<CR>",type:"keyToKey",toKeys:"j^",context:"normal"},{keys:"H",type:"motion",motion:"moveToTopLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"M",type:"motion",motion:"moveToMiddleLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"L",type:"motion",motion:"moveToBottomLine",motionArgs:{linewise:true,toJumplist:true}},{keys:"h",type:"motion",motion:"moveByCharacters",motionArgs:{forward:false}},{keys:"l",type:"motion",motion:"moveByCharacters",motionArgs:{forward:true}},{keys:"j",type:"motion",motion:"moveByLines",motionArgs:{forward:true,linewise:true}},{keys:"k",type:"motion",motion:"moveByLines",motionArgs:{forward:false,linewise:true}},{keys:"gj",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:true}},{keys:"gk",type:"motion",motion:"moveByDisplayLines",motionArgs:{forward:false}},{keys:"w",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false}},{keys:"W",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:false,bigWord:true}},{keys:"e",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,inclusive:true}},{keys:"E",type:"motion",motion:"moveByWords",motionArgs:{forward:true,wordEnd:true,bigWord:true,inclusive:true}},{keys:"b",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false}},{keys:"B",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false,bigWord:true}},{keys:"ge",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,inclusive:true}},{keys:"gE",type:"motion",motion:"moveByWords",motionArgs:{forward:false,wordEnd:true,bigWord:true,inclusive:true}},{keys:"{",type:"motion",motion:"moveByParagraph",motionArgs:{forward:false,toJumplist:true}},{keys:"}",type:"motion",motion:"moveByParagraph",motionArgs:{forward:true,toJumplist:true}},{keys:"<C-f>",type:"motion",motion:"moveByPage",motionArgs:{forward:true}},{keys:"<C-b>",type:"motion",motion:"moveByPage",motionArgs:{forward:false}},{keys:"<C-d>",type:"motion",motion:"moveByScroll",motionArgs:{forward:true,explicitRepeat:true}},{keys:"<C-u>",type:"motion",motion:"moveByScroll",motionArgs:{forward:false,explicitRepeat:true}},{keys:"gg",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:"G",type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:true,explicitRepeat:true,linewise:true,toJumplist:true}},{keys:"0",type:"motion",motion:"moveToStartOfLine"},{keys:"^",type:"motion",motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"+",type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true}},{keys:"-",type:"motion",motion:"moveByLines",motionArgs:{forward:false,toFirstChar:true}},{keys:"_",type:"motion",motion:"moveByLines",motionArgs:{forward:true,toFirstChar:true,repeatOffset:-1}},{keys:"$",type:"motion",motion:"moveToEol",motionArgs:{inclusive:true}},{keys:"%",type:"motion",motion:"moveToMatchedSymbol",motionArgs:{inclusive:true,toJumplist:true}},{keys:"f<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:true,inclusive:true}},{keys:"F<character>",type:"motion",motion:"moveToCharacter",motionArgs:{forward:false}},{keys:"t<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:true,inclusive:true}},{keys:"T<character>",type:"motion",motion:"moveTillCharacter",motionArgs:{forward:false}},{keys:";",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:true}},{keys:",",type:"motion",motion:"repeatLastCharacterSearch",motionArgs:{forward:false}},{keys:"'<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:true,linewise:true}},{keys:"`<character>",type:"motion",motion:"goToMark",motionArgs:{toJumplist:true}},{keys:"]`",type:"motion",motion:"jumpToMark",motionArgs:{forward:true}},{keys:"[`",type:"motion",motion:"jumpToMark",motionArgs:{forward:false}},{keys:"]'",type:"motion",motion:"jumpToMark",motionArgs:{forward:true,linewise:true}},{keys:"['",type:"motion",motion:"jumpToMark",motionArgs:{forward:false,linewise:true}},{keys:"]p",type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true,matchIndent:true}},{keys:"[p",type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true,matchIndent:true}},{keys:"]<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:true,toJumplist:true}},{keys:"[<character>",type:"motion",motion:"moveToSymbol",motionArgs:{forward:false,toJumplist:true}},{keys:"|",type:"motion",motion:"moveToColumn"},{keys:"o",type:"motion",motion:"moveToOtherHighlightedEnd",context:"visual"},{keys:"O",type:"motion",motion:"moveToOtherHighlightedEnd",motionArgs:{sameLine:true},context:"visual"},{keys:"d",type:"operator",operator:"delete"},{keys:"y",type:"operator",operator:"yank"},{keys:"c",type:"operator",operator:"change"},{keys:">",type:"operator",operator:"indent",operatorArgs:{indentRight:true}},{keys:"<",type:"operator",operator:"indent",operatorArgs:{indentRight:false}},{keys:"g~",type:"operator",operator:"swapcase"},{keys:"n",type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:true}},{keys:"N",type:"motion",motion:"findNext",motionArgs:{forward:false,toJumplist:true}},{keys:"x",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:true},operatorMotionArgs:{visualLine:false}},{keys:"X",type:"operatorMotion",operator:"delete",motion:"moveByCharacters",motionArgs:{forward:false},operatorMotionArgs:{visualLine:true}},{keys:"D",type:"operatorMotion",operator:"delete",motion:"moveToEol",motionArgs:{inclusive:true},operatorMotionArgs:{visualLine:true}},{keys:"Y",type:"operatorMotion",operator:"yank",motion:"moveToEol",motionArgs:{inclusive:true},operatorMotionArgs:{visualLine:true}},{keys:"C",type:"operatorMotion",operator:"change",motion:"moveToEol",motionArgs:{inclusive:true},operatorMotionArgs:{visualLine:true}},{keys:"~",type:"operatorMotion",operator:"swapcase",operatorArgs:{shouldMoveCursor:true},motion:"moveByCharacters",motionArgs:{forward:true}},{keys:"<C-w>",type:"operatorMotion",operator:"delete",motion:"moveByWords",motionArgs:{forward:false,wordEnd:false},context:"insert"},{keys:"<C-i>",type:"action",action:"jumpListWalk",actionArgs:{forward:true}},{keys:"<C-o>",type:"action",action:"jumpListWalk",actionArgs:{forward:false}},{keys:"<C-e>",type:"action",action:"scroll",actionArgs:{forward:true,linewise:true}},{keys:"<C-y>",type:"action",action:"scroll",actionArgs:{forward:false,linewise:true}},{keys:"a",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"charAfter"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"eol"},context:"normal"},{keys:"A",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"endOfSelectedArea"},context:"visual"},{keys:"i",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"inplace"},context:"normal"},{keys:"I",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{insertAt:"firstNonBlank"}},{keys:"o",type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:true},context:"normal"},{keys:"O",type:"action",action:"newLineAndEnterInsertMode",isEdit:true,interlaceInsertRepeat:true,actionArgs:{after:false},context:"normal"},{keys:"v",type:"action",action:"toggleVisualMode"},{keys:"V",type:"action",action:"toggleVisualMode",actionArgs:{linewise:true}},{keys:"<C-v>",type:"action",action:"toggleVisualMode",actionArgs:{blockwise:true}},{keys:"gv",type:"action",action:"reselectLastSelection"},{keys:"J",type:"action",action:"joinLines",isEdit:true},{keys:"p",type:"action",action:"paste",isEdit:true,actionArgs:{after:true,isEdit:true}},{keys:"P",type:"action",action:"paste",isEdit:true,actionArgs:{after:false,isEdit:true}},{keys:"r<character>",type:"action",action:"replace",isEdit:true},{keys:"@<character>",type:"action",action:"replayMacro"},{keys:"q<character>",type:"action",action:"enterMacroRecordMode"},{keys:"R",type:"action",action:"enterInsertMode",isEdit:true,actionArgs:{replace:true}},{keys:"u",type:"action",action:"undo",context:"normal"},{keys:"u",type:"action",action:"changeCase",actionArgs:{toLower:true},context:"visual",isEdit:true},{keys:"U",type:"action",action:"changeCase",actionArgs:{toLower:false},context:"visual",isEdit:true},{keys:"<C-r>",type:"action",action:"redo"},{keys:"m<character>",type:"action",action:"setMark"},{keys:'"<character>',type:"action",action:"setRegister"},{keys:"zz",type:"action",action:"scrollToCursor",actionArgs:{position:"center"}},{keys:"z.",type:"action",action:"scrollToCursor",actionArgs:{position:"center"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"zt",type:"action",action:"scrollToCursor",actionArgs:{position:"top"}},{keys:"z<CR>",type:"action",action:"scrollToCursor",actionArgs:{position:"top"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:"z-",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"}},{keys:"zb",type:"action",action:"scrollToCursor",actionArgs:{position:"bottom"},motion:"moveToFirstNonWhiteSpaceCharacter"},{keys:".",type:"action",action:"repeatLastEdit"},{keys:"<C-a>",type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:true,backtrack:false}},{keys:"<C-x>",type:"action",action:"incrementNumberToken",isEdit:true,actionArgs:{increase:false,backtrack:false}},{keys:"a<character>",type:"motion",motion:"textObjectManipulation"},{keys:"i<character>",type:"motion",motion:"textObjectManipulation",motionArgs:{textObjectInner:true}},{keys:"/",type:"search",searchArgs:{forward:true,querySrc:"prompt",toJumplist:true}},{keys:"?",type:"search",searchArgs:{forward:false,querySrc:"prompt",toJumplist:true}},{keys:"*",type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:"#",type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",wholeWordOnly:true,toJumplist:true}},{keys:"g*",type:"search",searchArgs:{forward:true,querySrc:"wordUnderCursor",toJumplist:true}},{keys:"g#",type:"search",searchArgs:{forward:false,querySrc:"wordUnderCursor",toJumplist:true}},{keys:":",type:"ex"}];var c=b.Pos;var g=[16,17,18,91];var d={Enter:"CR",Backspace:"BS",Delete:"Del"};var f=/Mac/.test(navigator.platform);var e=function(){b.defineOption("vimMode",false,function(bl,bp){function bn(bu){var bt=bu.keyCode;if(g.indexOf(bt)!=-1){return}var bs=bu.ctrlKey||bu.metaKey;var br=b.keyNames[bt];br=d[br]||br;var bq="";if(bu.ctrlKey){bq+="C-"}if(bu.altKey){bq+="A-"}if(f&&bu.metaKey||(!bs&&bu.shiftKey)&&br.length<2){return}else{if(bu.shiftKey&&!/^[A-Za-z]$/.test(br)){bq+="S-"}}if(br.length==1){br=br.toLowerCase()}bq+=br;if(bq.length>1){bq="<"+bq+">"}return bq}function bm(bq,bs){var br=bn(bs);if(!br){return}b.signal(bq,"vim-keypress",br);if(b.Vim.handleKey(bq,br,"user")){b.e_stop(bs)}}function bo(bq,bt){var bs=bt.charCode||bt.keyCode;if(bt.ctrlKey||bt.metaKey||bt.altKey||bt.shiftKey&&bs<32){return}var br=String.fromCharCode(bs);b.signal(bq,"vim-keypress",br);if(b.Vim.handleKey(bq,br,"user")){b.e_stop(bt)}}if(bp){bl.setOption("keyMap","vim");bl.setOption("disableInput",true);bl.setOption("showCursorWhenSelecting",false);b.signal(bl,"vim-mode-change",{mode:"normal"});bl.on("cursorActivity",X);G(bl);b.on(bl.getInputField(),"paste",S(bl));bl.on("keypress",bo);bl.on("keydown",bm)}else{if(bl.state.vim){bl.setOption("keyMap","default");bl.setOption("disableInput",false);bl.off("cursorActivity",X);b.off(bl.getInputField(),"paste",S(bl));bl.state.vim=null;bl.off("keypress",bo);bl.off("keydown",bm)}}});function S(bl){var bm=bl.state.vim;if(!bm.onPasteFn){bm.onPasteFn=function(){if(!bm.insertMode){bl.setCursor(D(bl.getCursor(),0,1));r.enterInsertMode(bl,{},bm)}}}return bm.onPasteFn}var aO=/[\d]/;var am=[(/\w/),(/[^\w\s]/)],ba=[(/\S/)];function al(bo,bm){var bn=[];for(var bl=bo;bl<bo+bm;bl++){bn.push(String.fromCharCode(bl))}return bn}var ad=al(65,26);var ai=al(97,26);var T=al(48,10);var az=[].concat(ad,ai,T,["<",">"]);var n=[].concat(ad,ai,T,["-",'"',".",":","/"]);function h(bl,bm){return bm>=bl.firstLine()&&bm<=bl.lastLine()}function E(bl){return(/^[a-z]$/).test(bl)}function L(bl){return"()[]{}".indexOf(bl)!=-1}function ac(bl){return aO.test(bl)}function A(bl){return(/^[A-Z]$/).test(bl)}function Q(bl){return(/^\s*$/).test(bl)}function J(bn,bl){for(var bm=0;bm<bl.length;bm++){if(bl[bm]==bn){return true}}return false}var ao={};function aE(bm,bl,bn){if(bl===undefined){throw Error("defaultValue is required")}if(!bn){bn="string"}ao[bm]={type:bn,defaultValue:bl};aC(bm,bl)}function aC(bl,bn){var bm=ao[bl];if(!bm){throw Error("Unknown option: "+bl)}if(bm.type=="boolean"){if(bn&&bn!==true){throw Error("Invalid argument: "+bl+"="+bn)}else{if(bn!==false){bn=true}}}bm.value=bm.type=="boolean"?!!bn:bn}function q(bl){var bm=ao[bl];if(!bm){throw Error("Unknown option: "+bl)}return bm.value}var ak=function(){var bp=100;var br=-1;var bo=0;var bn=0;var bm=new Array(bp);function bq(bs,bu,bv){var bw=br%bp;var bx=bm[bw];function bt(bA){var bz=++br%bp;var bB=bm[bz];if(bB){bB.clear()}bm[bz]=bs.setBookmark(bA)}if(bx){var by=bx.find();if(by&&!bj(by,bu)){bt(bu)}}else{bt(bu)}bt(bv);bo=br;bn=br-bp+1;if(bn<0){bn=0}}function bl(bs,bw){br+=bw;if(br>bo){br=bo}else{if(br<bn){br=bn}}var bx=bm[(bp+br)%bp];if(bx&&!bx.find()){var bv=bw>0?1:-1;var bu;var bt=bs.getCursor();do{br+=bv;bx=bm[(bp+br)%bp];if(bx&&(bu=bx.find())&&!bj(bt,bu)){break}}while(br<bo&&br>bn)}return bx}return{cachedCursor:undefined,add:bq,move:bl}};var k=function(bl){if(bl){return{changes:bl.changes,expectCursorActivityForChange:bl.expectCursorActivityForChange}}return{changes:[],expectCursorActivityForChange:false}};function at(){this.latestRegister=undefined;this.isPlaying=false;this.isRecording=false;this.replaySearchQueries=[];this.onRecordingDone=undefined;this.lastInsertModeChanges=k()}at.prototype={exitMacroRecordMode:function(){var bl=s.macroModeState;if(bl.onRecordingDone){bl.onRecordingDone()}bl.onRecordingDone=undefined;bl.isRecording=false},enterMacroRecordMode:function(bl,bn){var bm=s.registerController.getRegister(bn);if(bm){bm.clear();this.latestRegister=bn;if(bl.openDialog){this.onRecordingDone=bl.openDialog("(recording)["+bn+"]",null,{bottom:true})}this.isRecording=true}}};function G(bl){if(!bl.state.vim){bl.state.vim={inputState:new av(),lastEditInputState:undefined,lastEditActionCommand:undefined,lastHPos:-1,lastHSPos:-1,lastMotion:null,marks:{},fakeCursor:null,insertMode:false,insertModeRepeat:undefined,visualMode:false,visualLine:false,visualBlock:false,lastSelection:null,lastPastedText:null,awaitingEscapeSecondCharacter:false}}return bl.state.vim}var s;function z(){s={searchQuery:null,searchIsReversed:false,lastSubstituteReplacePart:undefined,jumpList:ak(),macroModeState:new at,lastChararacterSearch:{increment:0,forward:true,selectedCharacter:""},registerController:new ae({}),searchHistoryController:new aT({}),exCommandHistoryController:new aT({})};for(var bl in ao){var bm=ao[bl];bm.value=bm.defaultValue}}var bh;var aI={buildKeyMap:function(){},getRegisterController:function(){return s.registerController},resetVimGlobalState_:z,getVimGlobalState_:function(){return s},maybeInitVimState_:G,InsertModeKey:a7,map:function(bm,bn,bl){o.map(bm,bn,bl)},setOption:aC,getOption:q,defineOption:aE,defineEx:function(bl,bn,bm){if(bl.indexOf(bn)!==0){throw new Error('(Vim.defineEx) "'+bn+'" is not a prefix of "'+bl+'", command not registered')}aU[bl]=bm;o.commandMap_[bn]={name:bl,shortName:bn,type:"api"}},handleKey:function(bq,br,bp){var bn=G(bq);function bs(){var bu=s.macroModeState;if(bu.isRecording){if(br=="q"){bu.exitMacroRecordMode();l(bq);return true}if(bp!="mapping"){I(bu,br)}}}function bt(){if(br=="<Esc>"){l(bq);if(bn.visualMode){aL(bq)}else{if(bn.insertMode){w(bq)}}return true}}function bl(bv){var bu;while(bv){bu=(/<\w+-.+?>|<\w+>|./).exec(bv);br=bu[0];bv=bv.substring(bu.index+br.length);b.Vim.handleKey(bq,br,"mapping")}}function bo(){if(bt()){return true}var bw=bn.inputState.keyBuffer=bn.inputState.keyBuffer+br;var bx=br.length==1;var bu=a0.matchCommand(bw,a,bn.inputState,"insert");while(bw.length>1&&bu.type!="full"){var bw=bn.inputState.keyBuffer=bw.slice(1);var by=a0.matchCommand(bw,a,bn.inputState,"insert");if(by.type!="none"){bu=by}}if(bu.type=="none"){l(bq);return false}else{if(bu.type=="partial"){if(bh){window.clearTimeout(bh)}bh=window.setTimeout(function(){if(bn.insertMode&&bn.inputState.keyBuffer){l(bq)}},q("insertModeEscKeysTimeout"));return !bx}}if(bh){window.clearTimeout(bh)}if(bx){var bv=bq.getCursor();bq.replaceRange("",D(bv,0,-(bw.length-1)),bv,"+input")}l(bq);var bz=bu.command;if(bz.type=="keyToKey"){bl(bz.toKeys)}else{a0.processCommand(bq,bn,bz)}return !bx}function bm(){if(bs()||bt()){return true}var bw=bn.inputState.keyBuffer=bn.inputState.keyBuffer+br;if(/^[1-9]\d*$/.test(bw)){return true}var by=/^(\d*)(.*)$/.exec(bw);if(!by){l(bq);return false}var bv=bn.visualMode?"visual":"normal";var bu=a0.matchCommand(by[2]||by[1],a,bn.inputState,bv);if(bu.type=="none"){l(bq);return false}else{if(bu.type=="partial"){return true}}bn.inputState.keyBuffer="";var bx=bu.command;var by=/^(\d*)(.*)$/.exec(bw);if(by[1]&&by[1]!="0"){bn.inputState.pushRepeatDigit(by[1])}if(bx.type=="keyToKey"){bl(bx.toKeys)}else{a0.processCommand(bq,bn,bx)}return true}if(bn.insertMode){return bo()}else{return bm()}},handleEx:function(bl,bm){o.processCommand(bl,bm)}};function av(){this.prefixRepeat=[];this.motionRepeat=[];this.operator=null;this.operatorArgs=null;this.motion=null;this.motionArgs=null;this.keyBuffer=[];this.registerName=null}av.prototype.pushRepeatDigit=function(bl){if(!this.operator){this.prefixRepeat=this.prefixRepeat.concat(bl)}else{this.motionRepeat=this.motionRepeat.concat(bl)}};av.prototype.getRepeat=function(){var bl=0;if(this.prefixRepeat.length>0||this.motionRepeat.length>0){bl=1;if(this.prefixRepeat.length>0){bl*=parseInt(this.prefixRepeat.join(""),10)}if(this.motionRepeat.length>0){bl*=parseInt(this.motionRepeat.join(""),10)}}return bl};function l(bl,bm){bl.state.vim.inputState=new av();b.signal(bl,"vim-command-done",bm)}function bb(bn,bm,bl){this.clear();this.keyBuffer=[bn||""];this.insertModeChanges=[];this.searchQueries=[];this.linewise=!!bm;this.blockwise=!!bl}bb.prototype={setText:function(bn,bm,bl){this.keyBuffer=[bn||""];this.linewise=!!bm;this.blockwise=!!bl},pushText:function(bm,bl){if(bl){if(!this.linewise){this.keyBuffer.push("\n")}this.linewise=true}this.keyBuffer.push(bm)},pushInsertModeChanges:function(bl){this.insertModeChanges.push(k(bl))},pushSearchQuery:function(bl){this.searchQueries.push(bl)},clear:function(){this.keyBuffer=[];this.insertModeChanges=[];this.searchQueries=[];this.linewise=false},toString:function(){return this.keyBuffer.join("")}};function ae(bl){this.registers=bl;this.unnamedRegister=bl['"']=new bb();bl["."]=new bb();bl[":"]=new bb();bl["/"]=new bb()}ae.prototype={pushText:function(bp,bm,br,bq,bn){if(bq&&br.charAt(0)=="\n"){br=br.slice(1)+"\n"}if(bq&&br.charAt(br.length-1)!=="\n"){br+="\n"}var bo=this.isValidRegister(bp)?this.getRegister(bp):null;if(!bo){switch(bm){case"yank":this.registers["0"]=new bb(br,bq,bn);break;case"delete":case"change":if(br.indexOf("\n")==-1){this.registers["-"]=new bb(br,bq)}else{this.shiftNumericRegisters_();this.registers["1"]=new bb(br,bq)}break}this.unnamedRegister.setText(br,bq,bn);return}var bl=A(bp);if(bl){bo.pushText(br,bq)}else{bo.setText(br,bq,bn)}this.unnamedRegister.setText(bo.toString(),bq)},getRegister:function(bl){if(!this.isValidRegister(bl)){return this.unnamedRegister}bl=bl.toLowerCase();if(!this.registers[bl]){this.registers[bl]=new bb()}return this.registers[bl]},isValidRegister:function(bl){return bl&&J(bl,n)},shiftNumericRegisters_:function(){for(var bl=9;bl>=2;bl--){this.registers[bl]=this.getRegister(""+(bl-1))}}};function aT(){this.historyBuffer=[];this.iterator;this.initialPrefix=null}aT.prototype={nextMatch:function(bm,bl){var br=this.historyBuffer;var bo=bl?-1:1;if(this.initialPrefix===null){this.initialPrefix=bm}for(var bq=this.iterator+bo;bl?bq>=0:bq<br.length;bq+=bo){var bp=br[bq];for(var bn=0;bn<=bp.length;bn++){if(this.initialPrefix==bp.substring(0,bn)){this.iterator=bq;return bp}}}if(bq>=br.length){this.iterator=br.length;return this.initialPrefix}if(bq<0){return bm}},pushInput:function(bl){var bm=this.historyBuffer.indexOf(bl);if(bm>-1){this.historyBuffer.splice(bm,1)}if(bl.length){this.historyBuffer.push(bl)}},reset:function(){this.initialPrefix=null;this.iterator=this.historyBuffer.length}};var a0={matchCommand:function(bq,bs,bl,bo){var br=a8(bq,bs,bo,bl);if(!br.full&&!br.partial){return{type:"none"}}else{if(!br.full&&br.partial){return{type:"partial"}}}var bp;for(var bn=0;bn<br.full.length;bn++){var bm=br.full[bn];if(!bp){bp=bm}}if(bp.keys.slice(-11)=="<character>"){bl.selectedCharacter=O(bq)}return{type:"full",command:bp}},processCommand:function(bl,bm,bn){bm.inputState.repeatOverride=bn.repeatOverride;switch(bn.type){case"motion":this.processMotion(bl,bm,bn);break;case"operator":this.processOperator(bl,bm,bn);break;case"operatorMotion":this.processOperatorMotion(bl,bm,bn);break;case"action":this.processAction(bl,bm,bn);break;case"search":this.processSearch(bl,bm,bn);break;case"ex":case"keyToEx":this.processEx(bl,bm,bn);break;default:break}},processMotion:function(bl,bm,bn){bm.inputState.motion=bn.motion;bm.inputState.motionArgs=a6(bn.motionArgs);this.evalInput(bl,bm)},processOperator:function(bm,bn,bo){var bl=bn.inputState;if(bl.operator){if(bl.operator==bo.operator){bl.motion="expandToLine";bl.motionArgs={linewise:true};this.evalInput(bm,bn);return}else{l(bm)}}bl.operator=bo.operator;bl.operatorArgs=a6(bo.operatorArgs);if(bn.visualMode){this.evalInput(bm,bn)}},processOperatorMotion:function(bl,bo,bp){var bn=bo.visualMode;var bm=a6(bp.operatorMotionArgs);if(bm){if(bn&&bm.visualLine){bo.visualLine=true}}this.processOperator(bl,bo,bp);if(!bn){this.processMotion(bl,bo,bp)}},processAction:function(bm,bo,br){var bl=bo.inputState;var bq=bl.getRepeat();var bp=!!bq;var bn=a6(br.actionArgs)||{};if(bl.selectedCharacter){bn.selectedCharacter=bl.selectedCharacter}if(br.operator){this.processOperator(bm,bo,br)}if(br.motion){this.processMotion(bm,bo,br)}if(br.motion||br.operator){this.evalInput(bm,bo)}bn.repeat=bq||1;bn.repeatIsExplicit=bp;bn.registerName=bl.registerName;l(bm);bo.lastMotion=null;if(br.isEdit){this.recordLastEdit(bo,bl,br)}r[br.action](bm,bn,bo)},processSearch:function(bA,bt,bs){if(!bA.getSearchCursor){return}var bv=bs.searchArgs.forward;var bq=bs.searchArgs.wholeWordOnly;aB(bA).setReversed(!bv);var bw=(bv)?"/":"?";var by=aB(bA).getQuery();var bn=bA.getScrollInfo();function br(bD,bB,bC){s.searchHistoryController.pushInput(bD);s.searchHistoryController.reset();try{bi(bA,bD,bB,bC)}catch(bE){a9(bA,"Invalid regex: "+bD);return}a0.processMotion(bA,bt,{type:"motion",motion:"findNext",motionArgs:{forward:true,toJumplist:bs.searchArgs.toJumplist}})}function bz(bB){bA.scrollTo(bn.left,bn.top);br(bB,true,true);var bC=s.macroModeState;if(bC.isRecording){M(bC,bB)}}function bp(bF,bE,bG){var bD=b.keyName(bF),bB;if(bD=="Up"||bD=="Down"){bB=bD=="Up"?true:false;bE=s.searchHistoryController.nextMatch(bE,bB)||"";bG(bE)}else{if(bD!="Left"&&bD!="Right"&&bD!="Ctrl"&&bD!="Alt"&&bD!="Shift"){s.searchHistoryController.reset()}}var bC;try{bC=bi(bA,bE,true,true)}catch(bF){}if(bC){bA.scrollIntoView(bk(bA,!bv,bC),30)}else{aF(bA);bA.scrollTo(bn.left,bn.top)}}function bm(bD,bC,bE){var bB=b.keyName(bD);if(bB=="Esc"||bB=="Ctrl-C"||bB=="Ctrl-["){s.searchHistoryController.pushInput(bC);s.searchHistoryController.reset();bi(bA,by);aF(bA);bA.scrollTo(bn.left,bn.top);b.e_stop(bD);bE();bA.focus()}}switch(bs.searchArgs.querySrc){case"prompt":var bu=s.macroModeState;if(bu.isPlaying){var bx=bu.replaySearchQueries.shift();br(bx,true,false)}else{aR(bA,{onClose:bz,prefix:bw,desc:N,onKeyUp:bp,onKeyDown:bm})}break;case"wordUnderCursor":var bo=ay(bA,false,true,false,true);var bl=true;if(!bo){bo=ay(bA,false,true,false,false);bl=false}if(!bo){return}var bx=bA.getLine(bo.start.line).substring(bo.start.ch,bo.end.ch);if(bl&&bq){bx="\\b"+bx+"\\b"}else{bx=j(bx)}s.jumpList.cachedCursor=bA.getCursor();bA.setCursor(bo.start);br(bx,true,false);break}},processEx:function(bl,bm,bp){function bo(bq){s.exCommandHistoryController.pushInput(bq);s.exCommandHistoryController.reset();o.processCommand(bl,bq)}function bn(bt,br,bu){var bs=b.keyName(bt),bq;if(bs=="Esc"||bs=="Ctrl-C"||bs=="Ctrl-["){s.exCommandHistoryController.pushInput(br);s.exCommandHistoryController.reset();b.e_stop(bt);bu();bl.focus()}if(bs=="Up"||bs=="Down"){bq=bs=="Up"?true:false;br=s.exCommandHistoryController.nextMatch(br,bq)||"";bu(br)}else{if(bs!="Left"&&bs!="Right"&&bs!="Ctrl"&&bs!="Alt"&&bs!="Shift"){s.exCommandHistoryController.reset()}}}if(bp.type=="keyToEx"){o.processCommand(bl,bp.exArgs.input)}else{if(bm.visualMode){aR(bl,{onClose:bo,prefix:":",value:"'<,'>",onKeyDown:bn})}else{aR(bl,{onClose:bo,prefix:":",onKeyDown:bn})}}},evalInput:function(bu,bL){var bA=bL.inputState;var bI=bA.motion;var bB=bA.motionArgs||{};var bv=bA.operator;var bR=bA.operatorArgs||{};var bC=bA.registerName;var bm=C(bu.getCursor("head"));var bJ=C(bu.getCursor("anchor"));var bs=C(bm);var bz=C(bs);var bM;var bw;if(bv){this.recordLastEdit(bL,bA)}if(bA.repeatOverride!==undefined){bw=bA.repeatOverride}else{bw=bA.getRepeat()}if(bw>0&&bB.explicitRepeat){bB.repeatIsExplicit=true}else{if(bB.noRepeat||(!bB.explicitRepeat&&bw===0)){bw=1;bB.repeatIsExplicit=false}}if(bA.selectedCharacter){bB.selectedCharacter=bR.selectedCharacter=bA.selectedCharacter}bB.repeat=bw;l(bu);if(bI){var bK=aS[bI](bu,bB,bL);bL.lastMotion=aS[bI];if(!bK){return}if(bB.toJumplist){var bQ=s.jumpList;var bx=bQ.cachedCursor;if(bx){a4(bu,bx,bK);delete bQ.cachedCursor}else{a4(bu,bz,bK)}}if(bK instanceof Array){bs=bK[0];bM=bK[1]}else{bM=bK}if(!bM){bM=c(bs.line,bs.ch)}if(bL.visualMode){var bq=0;if(aH(bJ,bm)&&(bj(bJ,bM)||aH(bM,bJ))){bJ.ch+=1;bq=-1}else{if(aH(bm,bJ)&&(bj(bJ,bM)||aH(bJ,bM))){bJ.ch-=1;bq=1}}if(!bL.visualBlock&&!(bK instanceof Array)){bM.ch+=bq}if(bL.lastHPos!=Infinity){bL.lastHPos=bM.ch}bm=bM;bJ=(bK instanceof Array)?bs:bJ;if(bL.visualLine){if(aH(bJ,bm)){bJ.ch=0;var bl=bu.lastLine();if(bm.line>bl){bm.line=bl}bm.ch=aM(bu,bm.line)}else{bm.ch=0;bJ.ch=aM(bu,bJ.line)}}else{if(bL.visualBlock){bJ=F(bu,bm)}}if(!bL.visualBlock){bu.setSelection(bJ,bm)}aK(bu,bL,"<",aH(bJ,bm)?bJ:bm);aK(bu,bL,">",aH(bJ,bm)?bm:bJ)}else{if(!bv){bM=W(bu,bM);bu.setCursor(bM.line,bM.ch)}}}if(bv){var bF=false;bL.lastMotion=null;var by=bL.lastSelection;bR.repeat=bw;if(bL.visualMode){bs=bJ;bM=bm;bB.inclusive=true;bR.shouldMoveCursor=false}if(bM&&aH(bM,bs)){var bP=bs;bs=bM;bM=bP;bF=true}else{if(!bM){bM=C(bs)}}if(bB.inclusive&&!bL.visualMode){bM.ch++}if(bR.selOffset){bM.line=bs.line+bR.selOffset.line;if(bR.selOffset.line){bM.ch=bR.selOffset.ch}else{bM.ch=bs.ch+bR.selOffset.ch}if(by&&by.visualBlock){var bt=by.visualBlock;var bH=bt.width;var bG=bt.height;bM=c(bs.line+bG,bs.ch+bH);var bn=[];for(var bN=bs.line;bN<bM.line;bN++){var br=c(bN,bs.ch);var bo=c(bN,bM.ch);var bE={anchor:br,head:bo};bn.push(bE)}bu.setSelections(bn);var bO=true}}else{if(bL.visualMode){var bD=c();bD.line=bM.line-bs.line;if(bD.line){bD.ch=bM.ch}else{bD.ch=bM.ch-bs.ch}bR.selOffset=bD}}var bp=bB.linewise||(bL.visualMode&&bL.visualLine)||bR.linewise;if(bp){a2(bu,bs,bM)}else{if(bB.forward){ah(bu,bs,bM)}}bR.registerName=bC;bR.linewise=bp;if(!bL.visualBlock&&!bO){bu.setSelection(bs,bM)}K[bv](bu,bR,bL,bs,bM,bz);if(bL.visualMode){aL(bu)}}},recordLastEdit:function(bm,bl,bn){var bo=s.macroModeState;if(bo.isPlaying){return}bm.lastEditInputState=bl;bm.lastEditActionCommand=bn;bo.lastInsertModeChanges.changes=[];bo.lastInsertModeChanges.expectCursorActivityForChange=false}};var aS={moveToTopLine:function(bl,bn){var bm=a1(bl).top+bn.repeat-1;return c(bm,aQ(bl.getLine(bm)))},moveToMiddleLine:function(bl){var bn=a1(bl);var bm=Math.floor((bn.top+bn.bottom)*0.5);return c(bm,aQ(bl.getLine(bm)))},moveToBottomLine:function(bl,bn){var bm=a1(bl).bottom-bn.repeat+1;return c(bm,aQ(bl.getLine(bm)))},expandToLine:function(bl,bm){var bn=bl.getCursor();return c(bn.line+bm.repeat-1,Infinity)},findNext:function(bl,bm){var bp=aB(bl);var bo=bp.getQuery();if(!bo){return}var bn=!bm.forward;bn=(bp.isReversed())?!bn:bn;aD(bl,bo);return bk(bl,bn,bo,bm.repeat)},goToMark:function(bl,bn,bm){var bp=bm.marks[bn.selectedCharacter];if(bp){var bo=bp.find();return bn.linewise?{line:bo.line,ch:aQ(bl.getLine(bo.line))}:bo}return null},moveToOtherHighlightedEnd:function(bm,bp,bo){var bn=bm.listSelections();var br=bm.getCursor("head");var bl=bn[0].anchor;var bq=bj(bn[0].head,br)?bn.length-1:0;if(bp.sameLine&&bo.visualBlock){bl=c(br.line,bn[bq].anchor.ch);br=c(bn[bq].head.line,br.ch)}else{bl=bn[bq].anchor}bm.setCursor(br);return([br,bl])},jumpToMark:function(bs,bo,bp){var bn=bs.getCursor();for(var bq=0;bq<bo.repeat;bq++){var bu=bn;for(var bt in bp.marks){if(!E(bt)){continue}var bm=bp.marks[bt].find();var bl=(bo.forward)?aH(bm,bu):aH(bu,bm);if(bl){continue}if(bo.linewise&&(bm.line==bu.line)){continue}var br=bj(bu,bn);var bv=(bo.forward)?ap(bu,bm,bn):ap(bn,bm,bu);if(br||bv){bn=bm}}}if(bo.linewise){bn=c(bn.line,aQ(bs.getLine(bn.line)))}return bn},moveByCharacters:function(bl,bm){var bp=bl.getCursor();var bo=bm.repeat;var bn=bm.forward?bp.ch+bo:bp.ch-bo;return c(bp.line,bn)},moveByLines:function(bq,bm,bn){var bs=bq.getCursor();var bo=bs.ch;switch(bn.lastMotion){case this.moveByLines:case this.moveByDisplayLines:case this.moveByScroll:case this.moveToColumn:case this.moveToEol:bo=bn.lastHPos;break;default:bn.lastHPos=bo}var bl=bm.repeat+(bm.repeatOffset||0);var bt=bm.forward?bs.line+bl:bs.line-bl;var bp=bq.firstLine();var br=bq.lastLine();if((bt<bp&&bs.line==bp)||(bt>br&&bs.line==br)){return}if(bm.toFirstChar){bo=aQ(bq.getLine(bt));bn.lastHPos=bo}bn.lastHSPos=bq.charCoords(c(bt,bo),"div").left;return c(bt,bo)},moveByDisplayLines:function(bs,bn,bo){var bt=bs.getCursor();switch(bo.lastMotion){case this.moveByDisplayLines:case this.moveByScroll:case this.moveByLines:case this.moveToColumn:case this.moveToEol:break;default:bo.lastHSPos=bs.charCoords(bt,"div").left}var bl=bn.repeat;var br=bs.findPosV(bt,(bn.forward?bl:-bl),"line",bo.lastHSPos);if(br.hitSide){if(bn.forward){var bm=bs.charCoords(br,"div");var bp={top:bm.top+8,left:bo.lastHSPos};var br=bs.coordsChar(bp,"div")}else{var bq=bs.charCoords(c(bs.firstLine(),0),"div");bq.left=bo.lastHSPos;br=bs.coordsChar(bq,"div")}}bo.lastHPos=br.ch;return br},moveByPage:function(bm,bn){var bl=bm.getCursor();var bo=bn.repeat;return bm.findPosV(bl,(bn.forward?bo:-bo),"page")},moveByParagraph:function(bl,bn){var bm=bl.getCursor().line;var bp=bn.repeat;var bq=bn.forward?1:-1;for(var bo=0;bo<bp;bo++){if((!bn.forward&&bm===bl.firstLine())||(bn.forward&&bm==bl.lastLine())){break}bm+=bq;while(bm!==bl.firstLine()&&bm!=bl.lastLine()&&bl.getLine(bm)){bm+=bq}}return c(bm,0)},moveByScroll:function(bl,bo,bm){var bs=bl.getScrollInfo();var bq=null;var bp=bo.repeat;if(!bp){bp=bs.clientHeight/(2*bl.defaultTextHeight())}var br=bl.charCoords(bl.getCursor(),"local");bo.repeat=bp;var bq=aS.moveByDisplayLines(bl,bo,bm);if(!bq){return null}var bn=bl.charCoords(bq,"local");bl.scrollTo(null,bs.top+bn.top-br.top);return bq},moveByWords:function(bl,bm){return aw(bl,bm.repeat,!!bm.forward,!!bm.wordEnd,!!bm.bigWord)},moveTillCharacter:function(bm,bn){var bp=bn.repeat;var bo=bd(bm,bp,bn.forward,bn.selectedCharacter);var bl=bn.forward?-1:1;ax(bl,bn);if(!bo){return null}bo.ch+=bl;return bo},moveToCharacter:function(bl,bm){var bn=bm.repeat;ax(0,bm);return bd(bl,bn,bm.forward,bm.selectedCharacter)||bl.getCursor()},moveToSymbol:function(bl,bm){var bn=bm.repeat;return be(bl,bn,bm.forward,bm.selectedCharacter)||bl.getCursor()},moveToColumn:function(bl,bn,bm){var bo=bn.repeat;bm.lastHPos=bo-1;bm.lastHSPos=bl.charCoords(bl.getCursor(),"div").left;return af(bl,bo)},moveToEol:function(bl,bp,bo){var bq=bl.getCursor();bo.lastHPos=Infinity;var bn=c(bq.line+bp.repeat-1,Infinity);var bm=bl.clipPos(bn);bm.ch--;bo.lastHSPos=bl.charCoords(bm,"div").left;return bn},moveToFirstNonWhiteSpaceCharacter:function(bl){var bm=bl.getCursor();return c(bm.line,aQ(bl.getLine(bm.line)))},moveToMatchedSymbol:function(bm){var bs=bm.getCursor();var bo=bs.line;var bq=bs.ch;var bn=bm.getLine(bo);var br;do{br=bn.charAt(bq++);if(br&&L(br)){var bp=bm.getTokenTypeAt(c(bo,bq));if(bp!=="string"&&bp!=="comment"){break}}}while(br);if(br){var bl=bm.findMatchingBracket(c(bo,bq));return bl.to}else{return bs}},moveToStartOfLine:function(bl){var bm=bl.getCursor();return c(bm.line,0)},moveToLineOrEdgeOfDocument:function(bl,bm){var bn=bm.forward?bl.lastLine():bl.firstLine();if(bm.repeatIsExplicit){bn=bm.repeat-bl.getOption("firstLineNumber")}return c(bn,aQ(bl.getLine(bn)))},textObjectManipulation:function(bm,bo){var bn={"(":")",")":"(","{":"}","}":"{","[":"]","]":"["};var br={"'":true,'"':true};var bq=bo.selectedCharacter;if(bq=="b"){bq="("}else{if(bq=="B"){bq="{"}}var bl=!bo.textObjectInner;var bp;if(bn[bq]){bp=p(bm,bq,bl)}else{if(br[bq]){bp=aJ(bm,bq,bl)}else{if(bq==="W"){bp=ay(bm,bl,true,true)}else{if(bq==="w"){bp=ay(bm,bl,true,false)}else{return null}}}}if(!bm.state.vim.visualMode){return[bp.start,bp.end]}else{return v(bm,bp.start,bp.end)}},repeatLastCharacterSearch:function(bn,bp){var bm=s.lastChararacterSearch;var br=bp.repeat;var bo=bp.forward===bm.forward;var bl=(bm.increment?1:0)*(bo?-1:1);bn.moveH(-bl,"char");bp.inclusive=bo?true:false;var bq=bd(bn,br,bo,bm.selectedCharacter);if(!bq){bn.moveH(bl,"char");return bn.getCursor()}bq.ch+=bl;return bq}};var K={change:function(bu,bC,by){var bo=bu.listSelections();var bp=bo[0],bm=bo[bo.length-1];var bt=aH(bp.anchor,bp.head)?bp.anchor:bp.head;var bA=aH(bm.anchor,bm.head)?bm.head:bm.anchor;var bv=bu.getSelection();var bB=by.visualBlock;if(by.lastSelection&&!by.visualMode){bB=by.lastSelection.visualBlock?true:bB}var bn=s.macroModeState.lastInsertModeChanges;bn.inVisualBlock=bB;var bx=new Array(bo.length).join("1").split("1");var bl=by.marks[">"]?by.marks[">"].find():bu.getCursor("head");s.registerController.pushText(bC.registerName,"change",bv,bC.linewise);if(bC.linewise){if(bB){var bz=bt.line;while(bz<=bA.line){var bw=aM(bu,bz);var bq=c(bz,bw);var br=c(bz,bt.ch);bz++;bu.replaceRange("",br,bq)}}else{bx="\n";if(bA.line==bt.line&&bA.line==bu.lastLine()){bx=""}bu.replaceRange(bx,bt,bA);bu.indentLine(bt.line,"smart");bt.ch=null;bu.setCursor(bt)}}else{var bv=bu.getRange(bt,bA);if(!Q(bv)){var bs=(/\s+$/).exec(bv);if(bs){bA=D(bA,0,-bs[0].length)}}if(bB){bu.replaceSelections(bx)}else{bu.setCursor(bt);bu.replaceRange("",bt,bA)}}by.marks[">"]=bu.setBookmark(bl);r.enterInsertMode(bu,{},bu.state.vim)},"delete":function(bx,bq,bs){var bo=bx.listSelections();var bn=bo[0],br=bo[bo.length-1];var bu=aH(bn.anchor,bn.head)?bn.anchor:bn.head;var by=aH(br.anchor,br.head)?br.head:br.anchor;var bA,bw;var bv=bs.visualBlock;if(bs.visualMode){bA=bs.marks[">"].find();bw=bs.marks["<"].find()}else{if(bs.lastSelection){bA=bs.lastSelection.curStartMark.find();bw=bs.lastSelection.curEndMark.find();bv=bs.lastSelection.visualBlock}}var bz=bx.getSelection();s.registerController.pushText(bq.registerName,"delete",bz,bq.linewise,bv);var bp=new Array(bo.length).join("1").split("1");if(bq.linewise&&by.line==bx.lastLine()&&bu.line==by.line){if(by.line==0){bu.ch=0}else{var bt=C(by);bu.line--;bu.ch=aM(bx,bu.line);by=bt}bx.replaceRange("",bu,by)}else{bx.replaceSelections(bp)}if(bA){var bm=bx.setBookmark(bw);var bl=bx.setBookmark(bA);if(bs.visualMode){bs.marks["<"]=bm;bs.marks[">"]=bl}else{bs.lastSelection.curStartMark=bm;bs.lastSelection.curEndMark=bl}}if(bq.linewise){bx.setCursor(aS.moveToFirstNonWhiteSpaceCharacter(bx))}else{bx.setCursor(bu)}},indent:function(bs,bn,bp,br,bt){var bu=br.line;var bm=bt.line;var bl=(bp.visualMode)?bn.repeat:1;if(bn.linewise){bm--}for(var bq=bu;bq<=bm;bq++){for(var bo=0;bo<bl;bo++){bs.indentLine(bq,bn.indentRight)}}bs.setCursor(br);bs.setCursor(aS.moveToFirstNonWhiteSpaceCharacter(bs))},swapcase:function(by,bo,bv,bx,bp,bs){var bm=by.getSelections();var bl=by.listSelections();var bn=[];for(var bq=0;bq<bm.length;bq++){var bt=bm[bq];var bA="";for(var br=0;br<bt.length;br++){var bu=bt.charAt(br);bA+=A(bu)?bu.toLowerCase():bu.toUpperCase()}bn.push(bA)}by.replaceSelections(bn);var bw=bl[0].anchor;var bz=bl[0].head;if(!bo.shouldMoveCursor){by.setCursor(aH(bw,bz)?bw:bz)}},yank:function(bm,bq,bp,bo,bl,bn){var br=bm.getSelection();s.registerController.pushText(bq.registerName,"yank",br,bq.linewise,bp.visualBlock);bm.setCursor(bn)}};var r={jumpListWalk:function(bl,bn,bo){if(bo.visualMode){return}var bq=bn.repeat;var bp=bn.forward;var bm=s.jumpList;var bs=bm.move(bl,bp?bq:-bq);var br=bs?bs.find():undefined;br=br?br:bl.getCursor();bl.setCursor(br)},scroll:function(bt,bn,bp){if(bp.visualMode){return}var bl=bn.repeat||1;var bs=bt.defaultTextHeight();var br=bt.getScrollInfo().top;var bu=bs*bl;var bq=bn.forward?br+bu:br-bu;var bv=C(bt.getCursor());var bo=bt.charCoords(bv,"local");if(bn.forward){if(bq>bo.top){bv.line+=(bq-bo.top)/bs;bv.line=Math.ceil(bv.line);bt.setCursor(bv);bo=bt.charCoords(bv,"local");bt.scrollTo(null,bo.top)}else{bt.scrollTo(null,bq)}}else{var bm=bq+bt.getScrollInfo().clientHeight;if(bm<bo.bottom){bv.line-=(bo.bottom-bm)/bs;bv.line=Math.floor(bv.line);bt.setCursor(bv);bo=bt.charCoords(bv,"local");bt.scrollTo(null,bo.bottom-bt.getScrollInfo().clientHeight)}else{bt.scrollTo(null,bq)}}},scrollToCursor:function(bm,bn){var bq=bm.getCursor().line;var bo=bm.charCoords(c(bq,0),"local");var bl=bm.getScrollInfo().clientHeight;var br=bo.top;var bp=bo.bottom-br;switch(bn.position){case"center":br=br-(bl/2)+bp;break;case"bottom":br=br-bl+bp*1.4;break;case"top":br=br+bp*0.4;break}bm.scrollTo(null,br)},replayMacro:function(bl,bm,bn){var bo=bm.selectedCharacter;var bp=bm.repeat;var bq=s.macroModeState;if(bo=="@"){bo=bq.latestRegister}while(bp--){H(bl,bn,bq,bo)}},enterMacroRecordMode:function(bl,bm){var bo=s.macroModeState;var bn=bm.selectedCharacter;bo.enterMacroRecordMode(bl,bn)},enterInsertMode:function(bl,bm,bn){if(bl.getOption("readOnly")){return}bn.insertMode=true;bn.insertModeRepeat=bm&&bm.repeat||1;var bp=(bm)?bm.insertAt:null;if(bn.visualMode){var bo=aV(bl,bn);var bq=bo[0];var br=bo[1]}if(bp=="eol"){var bs=bl.getCursor();bs=c(bs.line,aM(bl,bs.line));bl.setCursor(bs)}else{if(bp=="charAfter"){bl.setCursor(D(bl.getCursor(),0,1))}else{if(bp=="firstNonBlank"){if(bn.visualMode&&!bn.visualBlock){if(br.line<bq.line){bl.setCursor(br)}else{bq=c(bq.line,0);bl.setCursor(bq)}bl.setCursor(aS.moveToFirstNonWhiteSpaceCharacter(bl))}else{if(bn.visualBlock){br=c(br.line,bq.ch);bl.setCursor(bq);F(bl,br)}else{bl.setCursor(aS.moveToFirstNonWhiteSpaceCharacter(bl))}}}else{if(bp=="endOfSelectedArea"){if(bn.visualBlock){bq=c(bq.line,br.ch);bl.setCursor(bq);F(bl,br)}else{if(br.line<bq.line){br=c(bq.line,0);bl.setCursor(br)}}}else{if(bp=="inplace"){if(bn.visualMode){return}}}}}}bl.setOption("keyMap","vim-insert");bl.setOption("disableInput",false);if(bm&&bm.replace){bl.toggleOverwrite(true);bl.setOption("keyMap","vim-replace");b.signal(bl,"vim-mode-change",{mode:"replace"})}else{bl.setOption("keyMap","vim-insert");b.signal(bl,"vim-mode-change",{mode:"insert"})}if(!s.macroModeState.isPlaying){bl.on("change",a5);b.on(bl.getInputField(),"keydown",U)}if(bn.visualMode){aL(bl)}},toggleVisualMode:function(bm,bn,bo){var br=bn.repeat;var bl=bm.getCursor();var bq;var bp=bm.listSelections();if(!bo.visualMode){bm.on("mousedown",aL);bo.visualMode=true;bo.visualLine=!!bn.linewise;bo.visualBlock=!!bn.blockwise;if(bo.visualLine){bl.ch=0;bq=W(bm,c(bl.line+br-1,aM(bm,bl.line)),true)}else{bq=W(bm,c(bl.line,bl.ch+br),true)}bm.setSelection(bl,bq);b.signal(bm,"vim-mode-change",{mode:"visual",subMode:bo.visualLine?"linewise":""})}else{bl=bm.getCursor("anchor");bq=bm.getCursor("head");if(bo.visualLine){if(bn.blockwise){bo.visualBlock=true;F(bm,bq);b.signal(bm,"vim-mode-change",{mode:"visual",subMode:"blockwise"})}else{if(!bn.linewise){b.signal(bm,"vim-mode-change",{mode:"visual"})}else{aL(bm)}}bo.visualLine=false}else{if(bo.visualBlock){if(bn.linewise){bo.visualLine=true;bl=c(bp[0].anchor.line,0);bq=c(bp[bp.length-1].anchor.line,aM(bm,bp[bp.length-1].anchor.line));bm.setSelection(bl,bq);b.signal(bm,"vim-mode-change",{mode:"visual",subMode:"linewise"})}else{if(!bn.blockwise){if(bq!=bp[0].head){bl=bp[0].anchor}else{bl=bp[bp.length-1].anchor}bm.setSelection(bl,bq);b.signal(bm,"vim-mode-change",{mode:"visual"})}else{aL(bm)}}bo.visualBlock=false}else{if(bn.linewise){bo.visualLine=true;bl.ch=aH(bl,bq)?0:aM(bm,bl.line);bq.ch=aH(bl,bq)?aM(bm,bq.line):0;bm.setSelection(bl,bq);b.signal(bm,"vim-mode-change",{mode:"visual",subMode:"linewise"})}else{if(bn.blockwise){bo.visualBlock=true;F(bm,bq);b.signal(bm,"vim-mode-change",{mode:"visual",subMode:"blockwise"})}else{aL(bm)}}}}}aK(bm,bo,"<",aH(bl,bq)?bl:bq);aK(bm,bo,">",aH(bl,bq)?bq:bl)},reselectLastSelection:function(br,bn,bm){var bo=bm.marks["<"].find();var bs=bm.marks[">"].find();var bl=bm.lastSelection;if(bl){var bq=bl.curStartMark.find();var bt=bl.curEndMark.find();var bp=bl.visualBlock;a3(br,bm,bo,bs);if(bp){br.setCursor(bq);bq=F(br,bt)}else{br.setSelection(bq,bt);bq=br.getCursor("anchor");bt=br.getCursor("head")}if(bm.visualMode){aK(br,bm,"<",aH(bq,bt)?bq:bt);aK(br,bm,">",aH(bq,bt)?bt:bq)}bm.visualMode=true;if(bl.visualLine){bm.visualLine=true;bm.visualBlock=false}else{if(bl.visualBlock){bm.visualLine=false;bm.visualBlock=true}else{bm.visualBlock=bm.visualLine=false}}b.signal(br,"vim-mode-change",{mode:"visual",subMode:bm.visualLine?"linewise":""})}},joinLines:function(bm,bn,bo){var bl,bq;if(bo.visualMode){bl=bm.getCursor("anchor");bq=bm.getCursor("head");bq.ch=aM(bm,bq.line)-1}else{var bp=Math.max(bn.repeat,2);bl=bm.getCursor();bq=W(bm,c(bl.line+bp-1,Infinity))}var br=0;bm.operation(function(){for(var bu=bl.line;bu<bq.line;bu++){br=aM(bm,bl.line);var bt=c(bl.line+1,aM(bm,bl.line+1));var bv=bm.getRange(bl,bt);bv=bv.replace(/\n\s*/g," ");bm.replaceRange(bv,bl,bt)}var bs=c(bl.line,br);bm.setCursor(bs)})},newLineAndEnterInsertMode:function(bl,bm,bn){bn.insertMode=true;var bo=C(bl.getCursor());if(bo.line===bl.firstLine()&&!bm.after){bl.replaceRange("\n",c(bl.firstLine(),0));bl.setCursor(bl.firstLine(),0)}else{bo.line=(bm.after)?bo.line:bo.line-1;bo.ch=aM(bl,bo.line);bl.setCursor(bo);var bp=b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent;bp(bl)}this.enterInsertMode(bl,{repeat:bm.repeat},bn)},paste:function(bz,by,bG){var bs=C(bz.getCursor());var bm=s.registerController.getRegister(by.registerName);var bC=bm.toString();if(!bC){return}if(by.matchIndent){var bt=function(bN){var bM=(bN.split("\t").length-1);var bL=(bN.split(" ").length-1);return bM*bz.options.tabSize+bL*1};var bI=bz.getLine(bz.getCursor().line);var bB=bt(bI.match(/^\s*/)[0]);var bl=bC.replace(/\n$/,"");var bq=bC!==bl;var bw=bt(bC.match(/^\s*/)[0]);var bC=bl.replace(/^\s*/gm,function(bL){var bM=bB+(bt(bL)-bw);if(bM<0){return""}else{if(bz.options.indentWithTabs){var bN=Math.floor(bM/bz.options.tabSize);return Array(bN+1).join("\t")}else{return Array(bM+1).join(" ")}}});bC+=bq?"\n":""}if(by.repeat>1){var bC=Array(by.repeat+1).join(bC)}var bv=bm.linewise;var bx=bm.blockwise;if(bv){if(bG.visualMode){bC=bG.visualLine?bC.slice(0,-1):"\n"+bC.slice(0,bC.length-1)+"\n"}else{if(by.after){bC="\n"+bC.slice(0,bC.length-1);bs.ch=aM(bz,bs.line)}else{bs.ch=0}}}else{if(bx){bC=bC.split("\n");for(var bH=0;bH<bC.length;bH++){bC[bH]=(bC[bH]=="")?" ":bC[bH]}}bs.ch+=by.after?1:0}var bp;var bD;if(bG.visualMode){bG.lastPastedText=bC;var bo;var bK=aV(bz,bG);var bE=bK[0];var bn=bK[1];var bF=bz.getSelection();var bu=bz.listSelections();var br=new Array(bu.length).join("1").split("1");if(bG.lastSelection){bo=bG.lastSelection.curEndMark.find()}s.registerController.unnamedRegister.setText(bF);if(bx){bz.replaceSelections(br);bn=c(bE.line+bC.length-1,bE.ch);bz.setCursor(bE);F(bz,bn);bz.replaceSelections(bC);bp=bE}else{if(bG.visualBlock){bz.replaceSelections(br);bz.setCursor(bE);bz.replaceRange(bC,bE,bE);bp=bE}else{bz.replaceRange(bC,bE,bn);bp=bz.posFromIndex(bz.indexFromPos(bE)+bC.length-1)}}if(bo){bG.lastSelection.curEndMark=bz.setBookmark(bo)}if(bv){bp.ch=0}}else{if(bx){bz.setCursor(bs);for(var bH=0;bH<bC.length;bH++){var bA=bs.line+bH;if(bA>bz.lastLine()){bz.replaceRange("\n",c(bA,0))}var bJ=aM(bz,bA);if(bJ<bs.ch){aN(bz,bA,bs.ch)}}bz.setCursor(bs);F(bz,c(bs.line+bC.length-1,bs.ch));bz.replaceSelections(bC);bp=bs}else{bz.replaceRange(bC,bs);if(bv&&by.after){bp=c(bs.line+1,aQ(bz.getLine(bs.line+1)))}else{if(bv&&!by.after){bp=c(bs.line,aQ(bz.getLine(bs.line)))}else{if(!bv&&by.after){bD=bz.indexFromPos(bs);bp=bz.posFromIndex(bD+bC.length-1)}else{bD=bz.indexFromPos(bs);bp=bz.posFromIndex(bD+bC.length)}}}}}bz.setCursor(bp);if(bG.visualMode){aL(bz)}},undo:function(bl,bm){bl.operation(function(){ar(bl,b.commands.undo,bm.repeat)();bl.setCursor(bl.getCursor("anchor"))})},redo:function(bl,bm){ar(bl,b.commands.redo,bm.repeat)()},setRegister:function(bn,bl,bm){bm.inputState.registerName=bl.selectedCharacter},setMark:function(bl,bm,bn){var bo=bm.selectedCharacter;aK(bl,bn,bo,bl.getCursor())},replace:function(bt,bn,bp){var bo=bn.selectedCharacter;var bs=bt.getCursor();var br;var bu;var bm=bt.listSelections();if(bp.visualMode){bs=bt.getCursor("start");bu=bt.getCursor("end")}else{var bv=bt.getLine(bs.line);br=bs.ch+bn.repeat;if(br>bv.length){br=bv.length}bu=c(bs.line,br)}if(bo=="\n"){if(!bp.visualMode){bt.replaceRange("",bs,bu)}(b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent)(bt)}else{var bl=bt.getRange(bs,bu);bl=bl.replace(/[^\n]/g,bo);if(bp.visualBlock){var bq=new Array(bt.options.tabSize+1).join(" ");bl=bt.getSelection();bl=bl.replace(/\t/g,bq).replace(/[^\n]/g,bo).split("\n");bt.replaceSelections(bl)}else{bt.replaceRange(bl,bs,bu)}if(bp.visualMode){bs=aH(bm[0].anchor,bm[0].head)?bm[0].anchor:bm[0].head;bt.setCursor(bs);aL(bt)}else{bt.setCursor(D(bu,0,-1))}}},incrementNumberToken:function(bv,bm){var bw=bv.getCursor();var br=bv.getLine(bw.line);var by=/-?\d+/g;var bq;var bl;var bp;var bx;var bn;while((bq=by.exec(br))!==null){bn=bq[0];bl=bq.index;bp=bl+bn.length;if(bw.ch<bp){break}}if(!bm.backtrack&&(bp<=bw.ch)){return}if(bn){var bu=bm.increase?1:-1;var bo=parseInt(bn)+(bu*bm.repeat);var bt=c(bw.line,bl);var bs=c(bw.line,bp);bx=bo.toString();bv.replaceRange(bx,bt,bs)}else{return}bv.setCursor(c(bw.line,bl+bx.length-1))},repeatLastEdit:function(bm,bn,bo){var bl=bo.lastEditInputState;if(!bl){return}var bp=bn.repeat;if(bp&&bn.repeatIsExplicit){bo.lastEditInputState.repeatOverride=bp}else{bp=bo.lastEditInputState.repeatOverride||bp}y(bm,bo,bp,false)},changeCase:function(bl,bn,bo){var bp=aV(bl,bo)[0];var bs=bl.getSelection();var bm;var br;if(bo.lastSelection){bm=bo.lastSelection.curEndMark.find();br=bo.lastSelection.visualBlock}var bq=bn.toLower;bs=bq?bs.toLowerCase():bs.toUpperCase();bl.replaceSelections(bo.visualBlock||br?bs.split("\n"):[bs]);if(bm){bo.lastSelection.curEndMark=bl.setBookmark(bm)}bl.setCursor(bp);if(bo.visualMode){aL(bl)}},exitInsertMode:w};function W(bm,bq,bo){var bn=Math.min(Math.max(bm.firstLine(),bq.line),bm.lastLine());var bl=aM(bm,bn)-1;bl=(bo)?bl+1:bl;var bp=Math.min(Math.max(0,bq.ch),bl);return c(bn,bp)}function a6(bm){var bl={};for(var bn in bm){if(bm.hasOwnProperty(bn)){bl[bn]=bm[bn]}}return bl}function D(bm,bl,bn){return c(bm.line+bl,bm.ch+bn)}function a8(bt,br,bl,bp){var bo,bs=[],bq=[];for(var bn=0;bn<br.length;bn++){var bm=br[bn];if(bl=="insert"&&bm.context!="insert"||bm.context&&bm.context!=bl||bp.operator&&bm.type=="action"||!(bo=P(bt,bm.keys))){continue}if(bo=="partial"){bs.push(bm)}if(bo=="full"){bq.push(bm)}}return{partial:bs.length&&bs,full:bq.length&&bq}}function P(bo,bl){if(bl.slice(-11)=="<character>"){var bm=bl.length-11;var bp=bo.slice(0,bm);var bn=bl.slice(0,bm);return bp==bn&&bo.length>bm?"full":bn.indexOf(bp)==0?"partial":false}else{return bo==bl?"full":bl.indexOf(bo)==0?"partial":false}}function O(bn){var bm=/^.*(<[\w\-]+>)$/.exec(bn);var bl=bm?bm[1]:bn.slice(-1);if(bl.length>1){switch(bl){case"<CR>":bl="\n";break;case"<Space>":bl=" ";break;default:break}}return bl}function ar(bl,bm,bn){return function(){for(var bo=0;bo<bn;bo++){bm(bl)}}}function C(bl){return c(bl.line,bl.ch)}function bj(bm,bl){return bm.ch==bl.ch&&bm.line==bl.line}function aH(bm,bl){if(bm.line<bl.line){return true}if(bm.line==bl.line&&bm.ch<bl.ch){return true}return false}function aq(bm,bl){return aH(bm,bl)?bm:bl}function aY(bm,bl){return aH(bm,bl)?bl:bm}function ap(bo,bn,bm){var bp=aH(bo,bn);var bl=aH(bn,bm);return bp&&bl}function aM(bl,bm){return bl.getLine(bm).length}function m(bl){return bl.split("").reverse().join("")}function aX(bl){if(bl.trim){return bl.trim()}return bl.replace(/^\s+|\s+$/g,"")}function j(bl){return bl.replace(/([.?*+$\[\]\/\\(){}|\-])/g,"\\$1")}function aN(bl,bp,bo){var bn=aM(bl,bp);var bm=new Array(bo-bn+1).join(" ");bl.setCursor(c(bp,bn));bl.replaceRange(bm,bl.getCursor())}function F(bw,bm){var bq=[],bn=bw.listSelections();var bu=bn[0].anchor,bl=bn[bn.length-1].anchor;var br,bp,bB,bz;var bA=bw.getCursor("head");var bt=C(bm);br=bu.line;bp=bl.line;if(bm.line<bA.line){bB="up"}else{if(bm.line>bA.line){bB="down"}else{if(bm.ch!=bA.ch){bB=bm.ch>bA.ch?"right":"left"}bz=bw.getCursor("anchor")}}var bC=u(bn,bA);bm=bw.clipPos(bm);var bx=u(bn,bm)<0?false:true;var bD=!bj(bt,bm);var bo=function(){if(bD){if(bA.ch>=bz.ch){bz.ch++}}else{if(bA.ch==aM(bw,bA.line)){if(bj(bn[bC].anchor,bn[bC].head)&&bn.length>1){if(bB=="up"){if(bx||bC>0){br=bu.line;bp=bm.line;bz=bn[bC-1].anchor}}else{if(bx||bC==0){bp=bl.line;br=bm.line;bz=bn[bC+1].anchor}}if(bm.ch>=bz.ch){bz.ch--}}}}};switch(bB){case"up":br=bx?bu.line:bm.line;bp=bx?bm.line:bl.line;bz=bl;bo();break;case"down":br=bx?bm.line:bu.line;bp=bx?bl.line:bm.line;bz=bu;bo();break;case"left":if((bm.ch<=bz.ch)&&(bA.ch>bz.ch)){bz.ch++;bm.ch--}break;case"right":if((bz.ch<=bm.ch)&&(bA.ch<bz.ch)){bz.ch--;bm.ch++}break;default:br=bz.line;bp=bm.line}while(br<=bp){var bv={line:br,ch:bz.ch};var bs={line:br,ch:bm.ch};var by={anchor:bv,head:bs};bq.push(by);if(bj(bs,bm)){bC=bq.indexOf(by)}br++}bm.ch=bq[0].head.ch;bz.ch=bq[0].anchor.ch;if(bj(bm,bq[0].head)){bz.line=bq[bq.length-1].anchor.line}else{bz.line=bq[0].anchor.line}bw.setSelections(bq,bC);return bz}function u(bm,bq,bl){var br=-1;for(var bn=0;bn<bm.length;bn++){var bo=bj(bm[bn].anchor,bq);var bp=bj(bm[bn].head,bq);if(bl=="head"){br=bp?bn:br}else{if(bl=="anchor"){br=bo?bn:br}else{br=(bo||bp)?bn:br}}}return br}function aV(bm,bo){var bn=bo.lastSelection;var bl=function(){var br=bm.listSelections();var bu=br[0];var bq=br[br.length-1];var bs=aH(bu.anchor,bu.head)?bu.anchor:bu.head;var bt=aH(bq.anchor,bq.head)?bq.head:bq.anchor;return[bs,bt]};var bp=function(){var bA=bm.getCursor();var bB=bm.getCursor();var bv=bn.visualBlock;if(bv){var bs=bv.width;var bC=bv.height;bB=c(bA.line+bC,bA.ch+bs);var bt=[];for(var bw=bA.line;bw<bB.line;bw++){var bx=c(bw,bA.ch);var bz=c(bw,bB.ch);var by={anchor:bx,head:bz};bt.push(by)}bm.setSelections(bt)}else{var br=bn.curStartMark.find();var bu=bn.curEndMark.find();var bD=bu.line-br.line;var bq=bu.ch-br.ch;bB={line:bB.line+bD,ch:bD?bB.ch:bq+bB.ch};if(bn.visualLine){bA=c(bA.line,0);bB=c(bB.line,aM(bm,bB.line))}bm.setSelection(bA,bB)}return[bA,bB]};if(!bo.visualMode){return bp()}else{return bl()}}function a3(br,bp,bq,bs){if(!bq||!bs){bq=bp.marks["<"].find()||br.getCursor("anchor");bs=bp.marks[">"].find()||br.getCursor("head")}if(bp.lastPastedText){bs=br.posFromIndex(br.indexFromPos(bq)+bp.lastPastedText.length);bp.lastPastedText=null}var bl=br.listSelections();var bn=u(bl,bq,"head")>-1;if(bp.visualBlock){var bt=Math.abs(bq.line-bs.line)+1;var bm=Math.abs(bq.ch-bs.ch);var bo={height:bt,width:bm}}bp.lastSelection={curStartMark:br.setBookmark(bn?bs:bq),curEndMark:br.setBookmark(bn?bq:bs),visualMode:bp.visualMode,visualLine:bp.visualLine,visualBlock:bo}}function v(bl,bq,bm){var bp=bl.getCursor("head");var bn=bl.getCursor("anchor");var bo;if(aH(bm,bq)){bo=bm;bm=bq;bq=bo}if(aH(bp,bn)){bp=aq(bq,bp);bn=aY(bn,bm)}else{bn=aq(bq,bn);bp=aY(bp,bm)}return[bn,bp]}function i(bl){var bm=bl.getCursor("head");if(bl.getSelection().length==1){bm=aq(bm,bl.getCursor("anchor"))}return bm}function aL(bl){bl.off("mousedown",aL);var bm=bl.state.vim;var bn=bl.getCursor("anchor");var bo=bl.getCursor("head");if(bm.visualBlock&&(aH(bn,bo))){bo.ch--}a3(bl,bm);bm.visualMode=false;bm.visualLine=false;bm.visualBlock=false;if(!bj(bn,bo)){bl.setCursor(W(bl,bo))}b.signal(bl,"vim-mode-change",{mode:"normal"});if(bm.fakeCursor){bm.fakeCursor.clear()}}function ah(bm,bl,bq){var bp=bm.getRange(bl,bq);if(/\n\s*$/.test(bp)){var bo=bp.split("\n");bo.pop();var bn;for(var bn=bo.pop();bo.length>0&&bn&&Q(bn);bn=bo.pop()){bq.line--;bq.ch=0}if(bn){bq.line--;bq.ch=aM(bm,bq.line)}else{bq.ch=0}}}function a2(bm,bl,bn){bl.ch=0;bn.ch=0;bn.line++}function aQ(bm){if(!bm){return 0}var bl=bm.search(/\S/);return bl==-1?bm.length:bl}function ay(bu,bq,bE,bm,bF){var bo=i(bu);var bx=bu.getLine(bo.line);var bA=bo.ch;var bz=bx.substring(bA);var bB;if(bF){bB=bz.search(/\w/)}else{bB=bz.search(/\S/)}if(bB==-1){return null}bA+=bB;bz=bx.substring(bA);var bD=bx.substring(0,bA);var bG;if(bm){bG=/^\S+/}else{if((/\w/).test(bx.charAt(bA))){bG=/^\w+/}else{bG=/^[^\w\s]+/}}var br=bG.exec(bz);var by=bA;var bn=bA+br[0].length;var bp=m(bD);var bv=bG.exec(bp);if(bv){by-=bv[0].length}if(bq){var bw=bx.substring(bn);var bl=bw.match(/^\s*/)[0].length;if(bl>0){bn+=bl}else{var bt=bp.length-by;var bs=bp.substring(bt);var bC=bs.match(/^\s*/)[0].length;by-=bC}}return{start:c(bo.line,by),end:c(bo.line,bn)}}function a4(bl,bm,bn){if(!bj(bm,bn)){s.jumpList.add(bl,bm,bn)}}function ax(bl,bm){s.lastChararacterSearch.increment=bl;s.lastChararacterSearch.forward=bm.forward;s.lastChararacterSearch.selectedCharacter=bm.selectedCharacter}var R={"(":"bracket",")":"bracket","{":"bracket","}":"bracket","[":"section","]":"section","*":"comment","/":"comment",m:"method",M:"method","#":"preprocess"};var aP={bracket:{isComplete:function(bl){if(bl.nextCh===bl.symb){bl.depth++;if(bl.depth>=1){return true}}else{if(bl.nextCh===bl.reverseSymb){bl.depth--}}return false}},section:{init:function(bl){bl.curMoveThrough=true;bl.symb=(bl.forward?"]":"[")===bl.symb?"{":"}"},isComplete:function(bl){return bl.index===0&&bl.nextCh===bl.symb}},comment:{isComplete:function(bm){var bl=bm.lastCh==="*"&&bm.nextCh==="/";bm.lastCh=bm.nextCh;return bl}},method:{init:function(bl){bl.symb=(bl.symb==="m"?"{":"}");bl.reverseSymb=bl.symb==="{"?"}":"{"},isComplete:function(bl){if(bl.nextCh===bl.symb){return true}return false}},preprocess:{init:function(bl){bl.index=0},isComplete:function(bm){if(bm.nextCh==="#"){var bl=bm.lineText.match(/#(\w+)/)[1];if(bl==="endif"){if(bm.forward&&bm.depth===0){return true}bm.depth++}else{if(bl==="if"){if(!bm.forward&&bm.depth===0){return true}bm.depth--}}if(bl==="else"&&bm.depth===0){return true}}return false}}};function be(bu,bm,bp,bn){var bx=C(bu.getCursor());var bv=bp?1:-1;var bo=bp?bu.lineCount():-1;var bt=bx.ch;var bz=bx.line;var bs=bu.getLine(bz);var bl={lineText:bs,nextCh:bs.charAt(bt),lastCh:null,index:bt,symb:bn,reverseSymb:(bp?{")":"(","}":"{"}:{"(":")","{":"}"})[bn],forward:bp,depth:0,curMoveThrough:false};var bq=R[bn];if(!bq){return bx}var by=aP[bq].init;var bw=aP[bq].isComplete;if(by){by(bl)}while(bz!==bo&&bm){bl.index+=bv;bl.nextCh=bl.lineText.charAt(bl.index);if(!bl.nextCh){bz+=bv;bl.lineText=bu.getLine(bz)||"";if(bv>0){bl.index=0}else{var br=bl.lineText.length;bl.index=(br>0)?(br-1):0}bl.nextCh=bl.lineText.charAt(bl.index)}if(bw(bl)){bx.line=bz;bx.ch=bl.index;bm--}}if(bl.nextCh||bl.curMoveThrough){return c(bz,bl.index)}return bx}function bg(bv,bw,bo,bt,bu){var bp=bw.line;var bs=bw.ch;var bz=bv.getLine(bp);var bm=bo?1:-1;var bq=bt?ba:am;if(bu&&bz==""){bp+=bm;bz=bv.getLine(bp);if(!h(bv,bp)){return null}bs=(bo)?0:bz.length}while(true){if(bu&&bz==""){return{from:0,to:0,line:bp}}var br=(bm>0)?bz.length:-1;var by=br,bx=br;while(bs!=br){var bl=false;for(var bn=0;bn<bq.length&&!bl;++bn){if(bq[bn].test(bz.charAt(bs))){by=bs;while(bs!=br&&bq[bn].test(bz.charAt(bs))){bs+=bm}bx=bs;bl=by!=bx;if(by==bw.ch&&bp==bw.line&&bx==by+bm){continue}else{return{from:Math.min(by,bx+1),to:Math.max(by,bx),line:bp}}}}if(!bl){bs+=bm}}bp+=bm;if(!h(bv,bp)){return null}bz=bv.getLine(bp);bs=(bm>0)?0:bz.length}throw new Error("The impossible happened.")}function aw(bv,bm,bq,bz,bt){var bx=bv.getCursor();var br=C(bx);var bs=[];if(bq&&!bz||!bq&&bz){bm++}var bu=!(bq&&bz);for(var bo=0;bo<bm;bo++){var bl=bg(bv,bx,bq,bt,bu);if(!bl){var bn=aM(bv,bv.lastLine());bs.push(bq?{line:bv.lastLine(),from:bn,to:bn}:{line:0,from:0,to:0});break}bs.push(bl);bx=c(bl.line,bq?(bl.to-1):bl.from)}var bp=bs.length!=bm;var bw=bs[0];var by=bs.pop();if(bq&&!bz){if(!bp&&(bw.from!=br.ch||bw.line!=br.line)){by=bs.pop()}return c(by.line,by.from)}else{if(bq&&bz){return c(by.line,by.to-1)}else{if(!bq&&bz){if(!bp&&(bw.to!=br.ch||bw.line!=br.line)){by=bs.pop()}return c(by.line,by.to)}else{return c(by.line,by.from)}}}}function bd(bq,bm,bo,bp){var bs=bq.getCursor();var bl=bs.ch;var br;for(var bn=0;bn<bm;bn++){var bt=bq.getLine(bs.line);br=aZ(bl,bt,bp,bo,true);if(br==-1){return null}bl=br}return c(bq.getCursor().line,br)}function af(bl,bn){var bm=bl.getCursor().line;return W(bl,c(bm,bn-1))}function aK(bl,bm,bn,bo){if(!J(bn,az)){return}if(bm.marks[bn]){bm.marks[bn].clear()}bm.marks[bn]=bl.setBookmark(bo)}function aZ(bq,bm,bp,bn,bo){var bl;if(bn){bl=bm.indexOf(bp,bq+1);if(bl!=-1&&!bo){bl-=1}}else{bl=bm.lastIndexOf(bp,bq-1);if(bl!=-1&&!bo){bl+=1}}return bl}function p(bu,bn,bt){var bv=i(bu),bm,bp;var bs=({"(":/[()]/,")":/[()]/,"[":/[[\]]/,"]":/[[\]]/,"{":/[{}]/,"}":/[{}]/})[bn];var bo=({"(":"(",")":"(","[":"[","]":"[","{":"{","}":"{"})[bn];var bl=bu.getLine(bv.line).charAt(bv.ch);var bq=bl===bo?1:0;bm=bu.scanForBracket(c(bv.line,bv.ch+bq),-1,null,{bracketRegex:bs});bp=bu.scanForBracket(c(bv.line,bv.ch+bq),1,null,{bracketRegex:bs});if(!bm||!bp){return{start:bv,end:bv}}bm=bm.pos;bp=bp.pos;if((bm.line==bp.line&&bm.ch>bp.ch)||(bm.line>bp.line)){var br=bm;bm=bp;bp=br}if(bt){bp.ch+=1}else{bm.ch+=1}return{start:bm,end:bp}}function aJ(bt,bn,bs){var bu=C(i(bt));var bv=bt.getLine(bu.line);var br=bv.split("");var bm,bo,bp,bq;var bl=br.indexOf(bn);if(bu.ch<bl){bu.ch=bl}else{if(bl<bu.ch&&br[bu.ch]==bn){bo=bu.ch;--bu.ch}}if(br[bu.ch]==bn&&!bo){bm=bu.ch+1}else{for(bp=bu.ch;bp>-1&&!bm;bp--){if(br[bp]==bn){bm=bp+1}}}if(bm&&!bo){for(bp=bm,bq=br.length;bp<bq&&!bo;bp++){if(br[bp]==bn){bo=bp}}}if(!bm||!bo){return{start:bu,end:bu}}if(bs){--bm;++bo}return{start:c(bu.line,bm),end:c(bu.line,bo)}}aE("pcre",true,"boolean");function Z(){}Z.prototype={getQuery:function(){return s.query},setQuery:function(bl){s.query=bl},getOverlay:function(){return this.searchOverlay},setOverlay:function(bl){this.searchOverlay=bl},isReversed:function(){return s.isReversed},setReversed:function(bl){s.isReversed=bl}};function aB(bl){var bm=bl.state.vim;return bm.searchState_||(bm.searchState_=new Z())}function Y(bl,bo,bp,bm,bn){if(bl.openDialog){bl.openDialog(bo,bm,{bottom:true,value:bn.value,onKeyDown:bn.onKeyDown,onKeyUp:bn.onKeyUp})}else{bm(prompt(bp,""))}}function x(bn){var bm=ag(bn)||[];if(!bm.length){return[]}var bo=[];if(bm[0]!==0){return}for(var bl=0;bl<bm.length;bl++){if(typeof bm[bl]=="number"){bo.push(bn.substring(bm[bl]+1,bm[bl+1]))}}return bo}function ag(bo){var bm=false;var bn=[];for(var bl=0;bl<bo.length;bl++){var bp=bo.charAt(bl);if(!bm&&bp=="/"){bn.push(bl)}bm=!bm&&(bp=="\\")}return bn}function bc(bs){var bt="|(){";var bp="}";var bq=false;var bm=[];for(var bn=-1;bn<bs.length;bn++){var br=bs.charAt(bn)||"";var bl=bs.charAt(bn+1)||"";var bo=(bl&&bt.indexOf(bl)!=-1);if(bq){if(br!=="\\"||!bo){bm.push(br)}bq=false}else{if(br==="\\"){bq=true;if(bl&&bp.indexOf(bl)!=-1){bo=true}if(!bo||bl==="\\"){bm.push(br)}}else{bm.push(br);if(bo&&bl!=="\\"){bm.push("\\")}}}}return bm.join("")}function bf(bo){var bn=false;var bl=[];for(var bm=-1;bm<bo.length;bm++){var bq=bo.charAt(bm)||"";var bp=bo.charAt(bm+1)||"";if(bn){bl.push(bq);bn=false}else{if(bq==="\\"){bn=true;if((ac(bp)||bp==="$")){bl.push("$")}else{if(bp!=="/"&&bp!=="\\"){bl.push("\\")}}}else{if(bq==="$"){bl.push("$")}bl.push(bq);if(bp==="/"){bl.push("\\")}}}}return bl.join("")}function ab(bn){var bm=new b.StringStream(bn);var bl=[];while(!bm.eol()){while(bm.peek()&&bm.peek()!="\\"){bl.push(bm.next())}if(bm.match("\\/",true)){bl.push("/")}else{if(bm.match("\\\\",true)){bl.push("\\")}else{bl.push(bm.next())}}}return bl.join("")}function au(bp,bn,bs){var br=s.registerController.getRegister("/");br.setText(bp);if(bp instanceof RegExp){return bp}var bq=ag(bp);var bt;var bm;if(!bq.length){bt=bp}else{bt=bp.substring(0,bq[0]);var bl=bp.substring(bq[0]);bm=(bl.indexOf("i")!=-1)}if(!bt){return null}if(!q("pcre")){bt=bc(bt)}if(bs){bn=(/^[^A-Z]*$/).test(bt)}var bo=new RegExp(bt,(bn||bm)?"i":undefined);return bo}function a9(bl,bm){if(bl.openNotification){bl.openNotification('<span style="color: red">'+bm+"</span>",{bottom:true,duration:5000})}else{alert(bm)}}function aA(bm,bn){var bl="";if(bm){bl+='<span style="font-family: monospace">'+bm+"</span>"}bl+='<input type="text"/> <span style="color: #888">';if(bn){bl+='<span style="color: #888">';bl+=bn;bl+="</span>"}return bl}var N="(Javascript regexp)";function aR(bm,bn){var bo=(bn.prefix||"")+" "+(bn.desc||"");var bl=aA(bn.prefix,bn.desc);Y(bm,bl,bo,bn.onClose,bn)}function V(bm,bl){if(bm instanceof RegExp&&bl instanceof RegExp){var bo=["global","multiline","ignoreCase","source"];for(var bn=0;bn<bo.length;bn++){var bp=bo[bn];if(bm[bp]!==bl[bp]){return false}}return true}return false}function bi(bl,bq,bm,bn){if(!bq){return}var bp=aB(bl);var bo=au(bq,!!bm,!!bn);if(!bo){return}aD(bl,bo);if(V(bo,bp.getQuery())){return bo}bp.setQuery(bo);return bo}function aG(bm){if(bm.source.charAt(0)=="^"){var bl=true}return{token:function(bo){if(bl&&!bo.sol()){bo.skipToEnd();return}var bn=bo.match(bm,false);if(bn){if(bn[0].length==0){bo.next();return"searching"}if(!bo.sol()){bo.backUp(1);if(!bm.exec(bo.next()+bn[0])){bo.next();return null}}bo.match(bm);return"searching"}while(!bo.eol()){bo.next();if(bo.match(bm,false)){break}}},query:bm}}function aD(bl,bn){var bm=aB(bl).getOverlay();if(!bm||bn!=bm.query){if(bm){bl.removeOverlay(bm)}bm=aG(bn);bl.addOverlay(bm);aB(bl).setOverlay(bm)}}function bk(bl,bm,bo,bn){if(bn===undefined){bn=1}return bl.operation(function(){var bs=bl.getCursor();var br=bl.getSearchCursor(bo,bs);for(var bp=0;bp<bn;bp++){var bq=br.find(bm);if(bp==0&&bq&&bj(br.from(),bs)){bq=br.find(bm)}if(!bq){br=bl.getSearchCursor(bo,(bm)?c(bl.lastLine()):c(bl.firstLine(),0));if(!br.find(bm)){return}}}return br.from()})}function aF(bl){bl.removeOverlay(aB(bl).getOverlay());aB(bl).setOverlay(null)}function aa(bn,bm,bl){if(typeof bn!="number"){bn=bn.line}if(bm instanceof Array){return J(bn,bm)}else{if(bl){return(bn>=bm&&bn<=bl)}else{return bn==bm}}}function a1(bl){var bo=bl.getScrollInfo();var bn=6;var br=10;var bq=bl.coordsChar({left:0,top:bn+bo.top},"local");var bm=bo.clientHeight-br+bo.top;var bp=bl.coordsChar({left:0,top:bm},"local");return{top:bq.line,bottom:bp.line}}var B=[{name:"map"},{name:"imap",shortName:"im"},{name:"nmap",shortName:"nm"},{name:"vmap",shortName:"vm"},{name:"unmap"},{name:"write",shortName:"w"},{name:"undo",shortName:"u"},{name:"redo",shortName:"red"},{name:"set",shortName:"set"},{name:"sort",shortName:"sor"},{name:"substitute",shortName:"s",possiblyAsync:true},{name:"nohlsearch",shortName:"noh"},{name:"delmarks",shortName:"delm"},{name:"registers",shortName:"reg",excludeFromCommandHistory:true},{name:"global",shortName:"g"}];e.ExCommandDispatcher=function(){this.buildCommandMap_()};e.ExCommandDispatcher.prototype={processCommand:function(bw,bv,bm){var bq=bw.state.vim;var bn=s.registerController.getRegister(":");var bt=bn.toString();if(bq.visualMode){aL(bw)}var bl=new b.StringStream(bv);bn.setText(bv);var bp=bm||{};bp.input=bv;try{this.parseInput_(bw,bl,bp)}catch(bu){a9(bw,bu);throw bu}var bo;var bs;if(!bp.commandName){if(bp.line!==undefined){bs="move"}}else{bo=this.matchCommand_(bp.commandName);if(bo){bs=bo.name;if(bo.excludeFromCommandHistory){bn.setText(bt)}this.parseCommandArgs_(bl,bp,bo);if(bo.type=="exToKey"){for(var br=0;br<bo.toKeys.length;br++){b.Vim.handleKey(bw,bo.toKeys[br],"mapping")}return}else{if(bo.type=="exToEx"){this.processCommand(bw,bo.toInput);return}}}}if(!bs){a9(bw,'Not an editor command ":'+bv+'"');return}try{aU[bs](bw,bp);if((!bo||!bo.possiblyAsync)&&bp.callback){bp.callback()}}catch(bu){a9(bw,bu);throw bu}},parseInput_:function(bm,bn,bl){bn.eatWhile(":");if(bn.eat("%")){bl.line=bm.firstLine();bl.lineEnd=bm.lastLine()}else{bl.line=this.parseLineSpec_(bm,bn);if(bl.line!==undefined&&bn.eat(",")){bl.lineEnd=this.parseLineSpec_(bm,bn)}}var bo=bn.match(/^(\w+)/);if(bo){bl.commandName=bo[1]}else{bl.commandName=bn.match(/.*/)[0]}return bl},parseLineSpec_:function(bl,bm){var bn=bm.match(/^(\d+)/);if(bn){return parseInt(bn[1],10)-1}switch(bm.next()){case".":return bl.getCursor().line;case"$":return bl.lastLine();case"'":var bo=bl.state.vim.marks[bm.next()];if(bo&&bo.find()){return bo.find().line}throw new Error("Mark not set");default:bm.backUp(1);return undefined}},parseCommandArgs_:function(bm,bp,bo){if(bm.eol()){return}bp.argString=bm.match(/.*/)[0];var bn=bo.argDelimiter||/\s+/;var bl=aX(bp.argString).split(bn);if(bl.length&&bl[0]){bp.args=bl}},matchCommand_:function(bm){for(var bl=bm.length;bl>0;bl--){var bn=bm.substring(0,bl);if(this.commandMap_[bn]){var bo=this.commandMap_[bn];if(bo.name.indexOf(bm)===0){return bo}}}return null},buildCommandMap_:function(){this.commandMap_={};for(var bm=0;bm<B.length;bm++){var bn=B[bm];var bl=bn.shortName||bn.name;this.commandMap_[bl]=bn}},map:function(bm,bp,bl){if(bm!=":"&&bm.charAt(0)==":"){if(bl){throw Error("Mode not supported for ex mappings")}var bo=bm.substring(1);if(bp!=":"&&bp.charAt(0)==":"){this.commandMap_[bo]={name:bo,type:"exToEx",toInput:bp.substring(1),user:true}}else{this.commandMap_[bo]={name:bo,type:"exToKey",toKeys:bp,user:true}}}else{if(bp!=":"&&bp.charAt(0)==":"){var bn={keys:bm,type:"keyToEx",exArgs:{input:bp.substring(1)},user:true};if(bl){bn.context=bl}a.unshift(bn)}else{var bn={keys:bm,type:"keyToKey",toKeys:bp,user:true};if(bl){bn.context=bl}a.unshift(bn)}}},unmap:function(bm,bl){if(bm!=":"&&bm.charAt(0)==":"){if(bl){throw Error("Mode not supported for ex mappings")}var bo=bm.substring(1);if(this.commandMap_[bo]&&this.commandMap_[bo].user){delete this.commandMap_[bo];return}}else{var bp=bm;for(var bn=0;bn<a.length;bn++){if(bp==a[bn].keys&&a[bn].context===bl&&a[bn].user){a.splice(bn,1);return}}}throw Error("No such mapping.")}};var aU={map:function(bl,bo,bm){var bn=bo.args;if(!bn||bn.length<2){if(bl){a9(bl,"Invalid mapping: "+bo.input)}return}o.map(bn[0],bn[1],bm)},imap:function(bl,bm){this.map(bl,bm,"insert")},nmap:function(bl,bm){this.map(bl,bm,"normal")},vmap:function(bl,bm){this.map(bl,bm,"visual")},unmap:function(bl,bo,bm){var bn=bo.args;if(!bn||bn.length<1){if(bl){a9(bl,"No such mapping: "+bo.input)}return}o.unmap(bn[0],bm)},move:function(bl,bm){a0.processCommand(bl,bl.state.vim,{type:"motion",motion:"moveToLineOrEdgeOfDocument",motionArgs:{forward:false,explicitRepeat:true,linewise:true},repeatOverride:bm.line+1})},set:function(bt,bq){var bn=bq.args;if(!bn||bn.length<1){if(bt){a9(bt,"Invalid mapping: "+bq.input)}return}var br=bn[0].split("=");var bm=br[0];var bs=br[1];var bp=false;if(bm.charAt(bm.length-1)=="?"){if(bs){throw Error("Trailing characters: "+bq.argString)}bm=bm.substring(0,bm.length-1);bp=true}if(bs===undefined&&bm.substring(0,2)=="no"){bm=bm.substring(2);bs=false}var bo=ao[bm]&&ao[bm].type=="boolean";if(bo&&bs==undefined){bs=true}if(!bo&&!bs||bp){var bl=q(bm);if(bl===true||bl===false){a9(bt," "+(bl?"":"no")+bm)}else{a9(bt,"  "+bm+"="+bl)}}else{aC(bm,bs)}},registers:function(bq,bm){var bs=bm.args;var bp=s.registerController.registers;var bn="----------Registers----------<br><br>";if(!bs){for(var bl in bp){var bt=bp[bl].toString();if(bt.length){bn+='"'+bl+"    "+bt+"<br>"}}}else{var bl;bs=bs.join("");for(var bo=0;bo<bs.length;bo++){bl=bs.charAt(bo);if(!s.registerController.isValidRegister(bl)){continue}var br=bp[bl]||new bb();bn+='"'+bl+"    "+br.toString()+"<br>"}}a9(bq,bn)},sort:function(bu,bE){var bv,bo,bm,bn;function bp(){if(bE.argString){var bI=new b.StringStream(bE.argString);if(bI.eat("!")){bv=true}if(bI.eol()){return}if(!bI.eatSpace()){return"Invalid arguments"}var bK=bI.match(/[a-z]+/);if(bK){bK=bK[0];bo=bK.indexOf("i")!=-1;bm=bK.indexOf("u")!=-1;var bH=bK.indexOf("d")!=-1&&1;var bJ=bK.indexOf("x")!=-1&&1;var bG=bK.indexOf("o")!=-1&&1;if(bH+bJ+bG>1){return"Invalid arguments"}bn=bH&&"decimal"||bJ&&"hex"||bG&&"octal"}if(bI.eatSpace()&&bI.match(/\/.*\//)){"patterns not supported"}}}var bq=bp();if(bq){a9(bu,bq+": "+bE.argString);return}var bz=bE.line||bu.firstLine();var bD=bE.lineEnd||bE.line||bu.lastLine();if(bz==bD){return}var bt=c(bz,0);var bB=c(bD,aM(bu,bD));var by=bu.getRange(bt,bB).split("\n");var br=(bn=="decimal")?/(-?)([\d]+)/:(bn=="hex")?/(-?)(?:0x)?([0-9a-f]+)/i:(bn=="octal")?/([0-7]+)/:null;var bs=(bn=="decimal")?10:(bn=="hex")?16:(bn=="octal")?8:null;var bw=[],bA=[];if(bn){for(var bC=0;bC<by.length;bC++){if(br.exec(by[bC])){bw.push(by[bC])}else{bA.push(by[bC])}}}else{bA=by}function bF(bH,bG){if(bv){var bI;bI=bH;bH=bG;bG=bI}if(bo){bH=bH.toLowerCase();bG=bG.toLowerCase()}var bK=bn&&br.exec(bH);var bJ=bn&&br.exec(bG);if(!bK){return bH<bG?-1:1}bK=parseInt((bK[1]+bK[2]).toLowerCase(),bs);bJ=parseInt((bJ[1]+bJ[2]).toLowerCase(),bs);return bK-bJ}bw.sort(bF);bA.sort(bF);by=(!bv)?bA.concat(bw):bw.concat(bA);if(bm){var bx=by;var bl;by=[];for(var bC=0;bC<bx.length;bC++){if(bx[bC]!=bl){by.push(bx[bC])}bl=bx[bC]}}bu.replaceRange(by.join("\n"),bt,bB)},global:function(by,bp){var bm=bp.argString;if(!bm){a9(by,"Regular Expression missing from global");return}var bs=(bp.line!==undefined)?bp.line:by.firstLine();var bq=bp.lineEnd||bp.line||by.lastLine();var bx=x(bm);var bA=bm,bo;if(bx.length){bA=bx[0];bo=bx.slice(1,bx.length).join("/")}if(bA){try{bi(by,bA,true,true)}catch(bv){a9(by,"Invalid regex: "+bA);return}}var bw=aB(by).getQuery();var bl=[],bu="";for(var br=bs;br<=bq;br++){var bn=bw.test(by.getLine(br));if(bn){bl.push(br+1);bu+=by.getLine(br)+"<br>"}}if(!bo){a9(by,bu);return}var bt=0;var bz=function(){if(bt<bl.length){var bB=bl[bt]+bo;o.processCommand(by,bB,{callback:bz})}bt++};bz()},substitute:function(bs,bA){if(!bs.getSearchCursor){throw new Error("Search feature not available. Requires searchcursor.js or any other getSearchCursor implementation.")}var bB=bA.argString;var bv=bB?x(bB):[];var bt,bu="",bl,bm,bq;var br=false;var bx=false;if(bv.length){bt=bv[0];bu=bv[1];if(bu!==undefined){if(q("pcre")){bu=ab(bu)}else{bu=bf(bu)}s.lastSubstituteReplacePart=bu}bl=bv[2]?bv[2].split(" "):[]}else{if(bB&&bB.length){a9(bs,"Substitutions should be of the form :s/pattern/replace/");return}}if(bl){bm=bl[0];bq=parseInt(bl[1]);if(bm){if(bm.indexOf("c")!=-1){br=true;bm.replace("c","")}if(bm.indexOf("g")!=-1){bx=true;bm.replace("g","")}bt=bt+"/"+bm}}if(bt){try{bi(bs,bt,true,true)}catch(bz){a9(bs,"Invalid regex: "+bt);return}}bu=bu||s.lastSubstituteReplacePart;if(bu===undefined){a9(bs,"No previous substitute regular expression");return}var bo=aB(bs);var bp=bo.getQuery();var bw=(bA.line!==undefined)?bA.line:bs.getCursor().line;var by=bA.lineEnd||bw;if(bq){bw=by;by=bw+bq-1}var bC=W(bs,c(bw,0));var bn=bs.getSearchCursor(bp,bC);aW(bs,br,bx,bw,by,bn,bp,bu,bA.callback)},redo:b.commands.redo,undo:b.commands.undo,write:function(bl){if(b.commands.save){b.commands.save(bl)}else{bl.save()}},nohlsearch:function(bl){aF(bl)},delmarks:function(bv,bq){if(!bq.argString||!aX(bq.argString)){a9(bv,"Argument required");return}var bl=bv.state.vim;var bw=new b.StringStream(aX(bq.argString));while(!bw.eol()){bw.eatSpace();var bt=bw.pos;if(!bw.match(/[a-zA-Z]/,false)){a9(bv,"Invalid argument: "+bq.argString.substring(bt));return}var bn=bw.next();if(bw.match("-",true)){if(!bw.match(/[a-zA-Z]/,false)){a9(bv,"Invalid argument: "+bq.argString.substring(bt));return}var bo=bn;var bs=bw.next();if(E(bo)&&E(bs)||A(bo)&&A(bs)){var bm=bo.charCodeAt(0);var bu=bs.charCodeAt(0);if(bm>=bu){a9(bv,"Invalid argument: "+bq.argString.substring(bt));return}for(var br=0;br<=bu-bm;br++){var bp=String.fromCharCode(bm+br);delete bl.marks[bp]}}else{a9(bv,"Invalid argument: "+bo+"-");return}}else{delete bl.marks[bn]}}}};var o=new e.ExCommandDispatcher();function aW(bz,bm,bo,bu,bs,bn,bw,bq,bA){bz.state.vim.exMode=true;var br=false;var by=bn.from();function bv(){bz.operation(function(){while(!br){bp();bt()}bx()})}function bp(){var bC=bz.getRange(bn.from(),bn.to());var bB=bC.replace(bw,bq);bn.replace(bB)}function bt(){var bB;while(bB=bn.findNext()&&aa(bn.from(),bu,bs)){if(!bo&&by&&bn.from().line==by.line){continue}bz.scrollIntoView(bn.from(),30);bz.setSelection(bn.from(),bn.to());by=bn.from();br=false;return}br=true}function bx(bC){if(bC){bC()}bz.focus();if(by){bz.setCursor(by);var bB=bz.state.vim;bB.exMode=false;bB.lastHPos=bB.lastHSPos=by.ch}if(bA){bA()}}function bl(bE,bB,bF){b.e_stop(bE);var bC=b.keyName(bE);switch(bC){case"Y":bp();bt();break;case"N":bt();break;case"A":var bD=bA;bA=undefined;bz.operation(bv);bA=bD;break;case"L":bp();case"Q":case"Esc":case"Ctrl-C":case"Ctrl-[":bx(bF);break}if(br){bx(bF)}}bt();if(br){a9(bz,"No matches for "+bw.source);return}if(!bm){bv();if(bA){bA()}return}aR(bz,{prefix:"replace with <strong>"+bq+"</strong> (y/n/a/q/l)",onKeyDown:bl})}b.keyMap.vim={nofallthrough:true,style:"fat-cursor"};function w(bt){var bm=bt.state.vim;var bo=s.macroModeState;var br=s.registerController.getRegister(".");var bl=bo.isPlaying;var bp=bo.lastInsertModeChanges;var bu=[];if(!bl){var bq=bp.inVisualBlock?bm.lastSelection.visualBlock.height:1;var bs=bp.changes;var bu=[];var bn=0;while(bn<bs.length){bu.push(bs[bn]);if(bs[bn] instanceof a7){bn++}else{bn+=bq}}bp.changes=bu;bt.off("change",a5);b.off(bt.getInputField(),"keydown",U)}if(!bl&&bm.insertModeRepeat>1){y(bt,bm,bm.insertModeRepeat-1,true);bm.lastEditInputState.repeatOverride=bm.insertModeRepeat}delete bm.insertModeRepeat;bm.insertMode=false;bt.setCursor(bt.getCursor().line,bt.getCursor().ch-1);bt.setOption("keyMap","vim");bt.setOption("disableInput",true);bt.toggleOverwrite(false);br.setText(bp.changes.join(""));b.signal(bt,"vim-mode-change",{mode:"normal"});if(bo.isRecording){aj(bo)}}aE("insertModeEscKeysTimeout",200,"number");b.keyMap["vim-insert"]={"Ctrl-N":"autocomplete","Ctrl-P":"autocomplete",Enter:function(bl){var bm=b.commands.newlineAndIndentContinueComment||b.commands.newlineAndIndent;bm(bl)},fallthrough:["default"]};b.keyMap["await-second"]={fallthrough:["vim-insert"]};b.keyMap["vim-replace"]={Backspace:"goCharLeft",fallthrough:["vim-insert"]};function H(bt,bn,bo,bl){var bv=s.registerController.getRegister(bl);var bm=bv.keyBuffer;var br=0;bo.isPlaying=true;bo.replaySearchQueries=bv.searchQueries.slice(0);for(var bp=0;bp<bm.length;bp++){var bw=bm[bp];var bq,bu;while(bw){bq=(/<\w+-.+?>|<\w+>|./).exec(bw);bu=bq[0];bw=bw.substring(bq.index+bu.length);b.Vim.handleKey(bt,bu,"macro");if(bn.insertMode){var bs=bv.insertModeChanges[br++].changes;s.macroModeState.lastInsertModeChanges.changes=bs;an(bt,bs,1);w(bt)}}}bo.isPlaying=false}function I(bo,bl){if(bo.isPlaying){return}var bn=bo.latestRegister;var bm=s.registerController.getRegister(bn);if(bm){bm.pushText(bl)}}function aj(bn){if(bn.isPlaying){return}var bm=bn.latestRegister;var bl=s.registerController.getRegister(bm);if(bl){bl.pushInsertModeChanges(bn.lastInsertModeChanges)}}function M(bo,bn){if(bo.isPlaying){return}var bm=bo.latestRegister;var bl=s.registerController.getRegister(bm);if(bl){bl.pushSearchQuery(bn)}}function a5(bm,bl){var bo=s.macroModeState;var bn=bo.lastInsertModeChanges;if(!bo.isPlaying){while(bl){bn.expectCursorActivityForChange=true;if(bl.origin=="+input"||bl.origin=="paste"||bl.origin===undefined){var bp=bl.text.join("\n");bn.changes.push(bp)}bl=bl.next}}}function X(bs){var bl=bs.state.vim;if(bl.insertMode){var bm=s.macroModeState;if(bm.isPlaying){return}var bn=bm.lastInsertModeChanges;if(bn.expectCursorActivityForChange){bn.expectCursorActivityForChange=false}else{bn.changes=[]}}else{if(bs.doc.history.lastSelOrigin=="*mouse"){bl.lastHPos=bs.doc.getCursor().ch;t(bs,bl)}}if(bl.visualMode){var bq,bp;bq=bp=bs.getCursor("head");var bo=bs.getCursor("anchor");var br=c(bp.line,bq.ch+(aH(bo,bp)?-1:1));if(aH(br,bq)){var bt=bq;bq=br;br=bt}if(bl.fakeCursor){bl.fakeCursor.clear()}bl.fakeCursor=bs.markText(bq,br,{className:"cm-animate-fat-cursor"})}}function t(bl,bm){var bn=bl.getCursor("anchor");var bo=bl.getCursor("head");if(!bm.visualMode&&!bm.insertMode&&bl.somethingSelected()){bm.visualMode=true;bm.visualLine=false;b.signal(bl,"vim-mode-change",{mode:"visual"});bl.on("mousedown",aL)}if(bm.visualMode){aK(bl,bm,"<",aq(bo,bn));aK(bl,bm,">",aY(bo,bn))}}function a7(bl){this.keyName=bl}function U(bp){var bo=s.macroModeState;var bn=bo.lastInsertModeChanges;var bm=b.keyName(bp);function bl(){bn.changes.push(new a7(bm));return true}if(bm.indexOf("Delete")!=-1||bm.indexOf("Backspace")!=-1){b.lookupKey(bm,["vim-insert"],bl)}}function y(bt,bo,bm,bl){var bq=s.macroModeState;bq.isPlaying=true;var bu=!!bo.lastEditActionCommand;var br=bo.inputState;function bn(){if(bu){a0.processAction(bt,bo,bo.lastEditActionCommand)}else{a0.evalInput(bt,bo)}}function bs(bw){if(bq.lastInsertModeChanges.changes.length>0){bw=!bo.lastEditActionCommand?1:bw;var bv=bq.lastInsertModeChanges;an(bt,bv.changes,bw)}}bo.inputState=bo.lastEditInputState;if(bu&&bo.lastEditActionCommand.interlaceInsertRepeat){for(var bp=0;bp<bm;bp++){bn();bs(1)}}else{if(!bl){bn()}bs(bm)}bo.inputState=br;if(bo.insertMode&&!bl){w(bt)}bq.isPlaying=false}function an(bv,bu,bm){function br(by){if(typeof by=="string"){b.commands[by](bv)}else{by(bv)}return true}var bs=bv.getCursor();var bl=s.macroModeState.lastInsertModeChanges.inVisualBlock;if(bl){var bp=bv.state.vim;var bn=bp.lastSelection.visualBlock;var bx=c(bs.line+bn.height-1,bs.ch);bv.setCursor(bs);F(bv,bx);bm=bv.listSelections().length;bv.setCursor(bs)}for(var bq=0;bq<bm;bq++){for(var bo=0;bo<bu.length;bo++){var bt=bu[bo];if(bt instanceof a7){b.lookupKey(bt.keyName,["vim-insert"],br)}else{var bw=bv.getCursor();bv.replaceRange(bt,bw,bw)}}if(bl){bs.line++;bv.setCursor(bs)}}}z();return aI};b.Vim=e()});