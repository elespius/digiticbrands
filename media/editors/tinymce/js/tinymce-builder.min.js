!function(t){"use strict";window.tinymce={langCode:"en",langStrings:{},addI18n:function(t,e){this.langCode=t,this.langStrings=e||{}},translate:function(t){return this.langStrings[t]?this.langStrings[t]:t}};var e=function(e,n){this.$container=t(e),this.options=n,this.$sourceMenu=this.$container.find(".timymce-builder-menu.source"),this.$sourceToolbar=this.$container.find(".timymce-builder-toolbar.source"),this.$targetMenu=this.$container.find(".timymce-builder-menu.target"),this.$targetToolbar=this.$container.find(".timymce-builder-toolbar.target"),this.$sourceMenu.each(function(t,e){this.renderBar(e,"menu")}.bind(this)),this.$sourceToolbar.each(function(t,e){this.renderBar(e,"toolbar")}.bind(this)),this.$targetMenu.each(function(t,e){this.renderBar(e,"menu",null,!0)}.bind(this)),this.$targetToolbar.each(function(t,e){this.renderBar(e,"toolbar",null,!0)}.bind(this));var a=null,i=!1,r=this;this.$sourceMenu.sortable({connectWith:this.$targetMenu,items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",start:function(t,e){r.$targetMenu.addClass("drop-area-highlight")},helper:function(t,e){return a=e.clone().insertAfter(e),e},stop:function(){a&&a.remove(),r.$targetMenu.removeClass("drop-area-highlight")}}),this.$sourceToolbar.sortable({connectWith:this.$targetToolbar,items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",start:function(t,e){r.$targetToolbar.addClass("drop-area-highlight")},helper:function(t,e){return a=e.clone().insertAfter(e),e},stop:function(){a&&a.remove(),r.$targetToolbar.removeClass("drop-area-highlight")}}),t().add(this.$targetMenu).add(this.$targetToolbar).sortable({items:".mce-btn",cancel:"",placeholder:"mce-btn ui-state-highlight",receive:function(e,n){a=null;var i=n.item,o=t(this);r.appendInput(i,o.data("group"),o.data("set"))},over:function(t,e){i=!1},out:function(t,e){i=!0},beforeStop:function(t,e){i&&e.item.remove()}}),this.$container.on("click",".button-action",function(e){var n=t(e.target),a=n.data("action"),i=n.data();if(!this[a])throw new Error("Unsupported action "+a);this[a].call(this,i)}.bind(this))};e.prototype.renderBar=function(e,n,a,i){for(var r,o,s,l=t(e),c=l.data("group"),u=l.data("set"),h="menu"===n?this.options.menus:this.options.buttons,d=0,p=(a=a||(l.data("value")||[])).length;d<p;d++)(r=h[o=a[d]])&&(s=this.createButton(o,r,n),l.append(s),s.tooltip&&s.tooltip({trigger:"hover"}),i&&this.appendInput(s,c,u))},e.prototype.createButton=function(e,n,a){var i=t("<div />",{class:"mce-btn","data-name":e,"data-toggle":"tooltip",title:tinymce.translate(n.label)}),r=t("<button/>",{type:"button"});return i.append(r),"menu"===a?r.html('<span class="mce-txt">'+tinymce.translate(n.label)+'</span> <i class="mce-caret"></i>'):(i.addClass("mce-btn-small"),r.html(n.text?tinymce.translate(n.text):'<span class="mce-ico mce-i-'+e+'"></span>')),i},e.prototype.appendInput=function(e,n,a){var i=t(e),r=this.options.formControl+"["+a+"]["+n+"][]",o=t("<input/>",{type:"hidden",name:r,value:i.data("name")});i.append(o)},e.prototype.setPreset=function(t){var e=t.set,n=this.options.toolbarPreset[t.preset]||null;if(!n)throw new Error('Unknown Preset "'+t.preset+'"');var a,i;for(var r in n)n.hasOwnProperty(r)&&("menu"===r?(i="menu",a=this.$targetMenu.filter('[data-group="'+r+'"][data-set="'+e+'"]')):(i="toolbar",a=this.$targetToolbar.filter('[data-group="'+r+'"][data-set="'+e+'"]')),a.empty(),this.renderBar(a,i,n[r],!0))},e.prototype.clearPane=function(t){var e=t.set;this.$targetMenu.filter('[data-set="'+e+'"]').empty(),this.$targetToolbar.filter('[data-set="'+e+'"]').empty()},t(document).ready(function(){function n(){i.find("option[disabled]").removeAttr("disabled"),i.each(function(){for(var e=t(this).val()||[],n=[],a=i.not(this).find("option"),r=0,o=e.length;r<o;r++)e[r]&&n.push('[value="'+e[r]+'"]');n.length&&a.filter(n.join(",")).attr("disabled","disabled")}),i.trigger("liszt:updated")}var a=Joomla.getOptions?Joomla.getOptions("plg_editors_tinymce_builder",{}):Joomla.optionsStorage.plg_editors_tinymce_builder||{};new e(t("#joomla-tinymce-builder"),a),t("#set-tabs a").on("click",function(e){e.preventDefault(),t(this).tab("show")});var i=t("#joomla-tinymce-builder").find(".access-select");n(),i.on("change",function(){n()})})}(jQuery);