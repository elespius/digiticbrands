!function(){var n={},r=function(r,e,t){if("string"!=typeof r)throw"module id must be a string";if(void 0===e)throw"no dependencies for "+r;if(void 0===t)throw"no definition function for "+r;n[r]={deps:e,defn:t,instance:void 0}},e=function(r){var t=n[r];if(void 0===t)throw"module ["+r+"] was undefined";return void 0===t.instance&&function(r){for(var t=n[r],o=t.deps,i=t.defn,u=o.length,a=new Array(u),c=0;c<u;++c)a[c]=e(o[c]);var l=i.apply(null,a);if(void 0===l)throw"module ["+r+"] returned undefined";t.instance=l}(r),t.instance},t=r,o=function(n,r){t(n,[],function(){return r})};t("ephox.katamari.api.Cell",[],function(){var n=function(r){var e=r,t=function(){return e};return{get:t,set:function(n){e=n},clone:function(){return n(t())}}};return n}),o("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve),t("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(n){return n("tinymce.PluginManager")}),t("tinymce.plugins.visualchars.api.Api",[],function(){return{get:function(n){return{isEnabled:function(){return n.get()}}}}}),t("tinymce.plugins.visualchars.api.Events",[],function(){return{fireVisualChars:function(n,r){return n.fire("VisualChars",{state:r})}}}),t("tinymce.plugins.visualchars.core.Data",[],function(){var n={" ":"nbsp","­":"shy"},r=function(n,r){var e,t="";for(e in n)t+=e;return new RegExp("["+t+"]",r?"g":"")},e=function(n){var r,e="";for(r in n)e&&(e+=","),e+="span.mce-"+n[r];return e};return{charMap:n,regExp:r(n),regExpGlobal:r(n,!0),selector:e(n),charMapToRegExp:r,charMapToSelector:e}}),o("global!Array",Array),o("global!Error",Error),t("ephox.katamari.api.Fun",["global!Array","global!Error"],function(n,r){var e=function(n){return function(){return n}};return{noop:function(){},noarg:function(n){return function(){return n()}},compose:function(n,r){return function(){return n(r.apply(null,arguments))}},constant:e,identity:function(n){return n},tripleEquals:function(n,r){return n===r},curry:function(r){for(var e=new n(arguments.length-1),t=1;t<arguments.length;t++)e[t-1]=arguments[t];return function(){for(var t=new n(arguments.length),o=0;o<t.length;o++)t[o]=arguments[o];var i=e.concat(t);return r.apply(null,i)}},not:function(n){return function(){return!n.apply(null,arguments)}},die:function(n){return function(){throw new r(n)}},apply:function(n){return n()},call:function(n){n()},never:e(!1),always:e(!0)}}),o("global!Object",Object),t("ephox.katamari.api.Option",["ephox.katamari.api.Fun","global!Object"],function(n,r){var e,t,o,i,u=n.never,a=n.always,c=function(){return l},l=(i={fold:function(n,r){return n()},is:u,isSome:u,isNone:a,getOr:o=function(n){return n},getOrThunk:t=function(n){return n()},getOrDie:function(n){throw new Error(n||"error: getOrDie called on none.")},or:o,orThunk:t,map:c,ap:c,each:function(){},bind:c,flatten:c,exists:u,forall:a,filter:c,equals:e=function(n){return n.isNone()},equals_:e,toArray:function(){return[]},toString:n.constant("none()")},r.freeze&&r.freeze(i),i),s=function(n){var r=function(){return n},e=function(){return o},t=function(r){return r(n)},o={fold:function(r,e){return e(n)},is:function(r){return n===r},isSome:a,isNone:u,getOr:r,getOrThunk:r,getOrDie:r,or:e,orThunk:e,map:function(r){return s(r(n))},ap:function(r){return r.fold(c,function(r){return s(r(n))})},each:function(r){r(n)},bind:t,flatten:r,exists:t,forall:t,filter:function(r){return r(n)?o:l},equals:function(r){return r.is(n)},equals_:function(r,e){return r.fold(u,function(r){return e(n,r)})},toArray:function(){return[n]},toString:function(){return"some("+n+")"}};return o};return{some:s,none:c,from:function(n){return null===n||void 0===n?l:s(n)}}}),o("global!String",String),t("ephox.katamari.api.Arr",["ephox.katamari.api.Option","global!Array","global!Error","global!String"],function(n,r,e,t){var o,i=void 0===(o=r.prototype.indexOf)?function(n,r){return p(n,r)}:function(n,r){return o.call(n,r)},u=function(n,r){return i(n,r)>-1},a=function(n,e){for(var t=n.length,o=new r(t),i=0;i<t;i++){var u=n[i];o[i]=e(u,i,n)}return o},c=function(n,r){for(var e=0,t=n.length;e<t;e++){r(n[e],e,n)}},l=function(n,r){for(var e=n.length-1;e>=0;e--){r(n[e],e,n)}},s=function(n,r){for(var e=[],t=0,o=n.length;t<o;t++){var i=n[t];r(i,t,n)&&e.push(i)}return e},f=function(r,e){for(var t=0,o=r.length;t<o;t++){if(e(r[t],t,r))return n.some(t)}return n.none()},p=function(n,r){for(var e=0,t=n.length;e<t;++e)if(n[e]===r)return e;return-1},h=r.prototype.push,g=function(n){for(var t=[],o=0,i=n.length;o<i;++o){if(!r.prototype.isPrototypeOf(n[o]))throw new e("Arr.flatten item "+o+" was not an array, input: "+n);h.apply(t,n[o])}return t},m=function(n,r){for(var e=0,t=n.length;e<t;++e){if(!0!==r(n[e],e,n))return!1}return!0},d=r.prototype.slice;return{map:a,each:c,eachr:l,partition:function(n,r){for(var e=[],t=[],o=0,i=n.length;o<i;o++){var u=n[o];(r(u,o,n)?e:t).push(u)}return{pass:e,fail:t}},filter:s,groupBy:function(n,r){if(0===n.length)return[];for(var e=r(n[0]),t=[],o=[],i=0,u=n.length;i<u;i++){var a=n[i],c=r(a);c!==e&&(t.push(o),o=[]),e=c,o.push(a)}return 0!==o.length&&t.push(o),t},indexOf:function(r,e){var t=i(r,e);return-1===t?n.none():n.some(t)},foldr:function(n,r,e){return l(n,function(n){e=r(e,n)}),e},foldl:function(n,r,e){return c(n,function(n){e=r(e,n)}),e},find:function(r,e){for(var t=0,o=r.length;t<o;t++){var i=r[t];if(e(i,t,r))return n.some(i)}return n.none()},findIndex:f,flatten:g,bind:function(n,r){var e=a(n,r);return g(e)},forall:m,exists:function(n,r){return f(n,r).isSome()},contains:u,equal:function(n,r){return n.length===r.length&&m(n,function(n,e){return n===r[e]})},reverse:function(n){var r=d.call(n,0);return r.reverse(),r},chunk:function(n,r){for(var e=[],t=0;t<n.length;t+=r){var o=n.slice(t,t+r);e.push(o)}return e},difference:function(n,r){return s(n,function(n){return!u(r,n)})},mapToObject:function(n,r){for(var e={},o=0,i=n.length;o<i;o++){var u=n[o];e[t(u)]=r(u,o)}return e},pure:function(n){return[n]},sort:function(n,r){var e=d.call(n,0);return e.sort(r),e},range:function(n,r){for(var e=[],t=0;t<n;t++)e.push(r(t));return e},head:function(r){return 0===r.length?n.none():n.some(r[0])},last:function(r){return 0===r.length?n.none():n.some(r[r.length-1])}}}),t("global!console",[],function(){return"undefined"==typeof console&&(console={log:function(){}}),console}),o("global!document",document),t("ephox.sugar.api.node.Element",["ephox.katamari.api.Fun","ephox.katamari.api.Option","global!Error","global!console","global!document"],function(n,r,e,t,o){var i=function(r){if(null===r||void 0===r)throw new e("Node cannot be null or undefined");return{dom:n.constant(r)}};return{fromHtml:function(n,r){var e=(r||o).createElement("div");if(e.innerHTML=n,!e.hasChildNodes()||e.childNodes.length>1)throw t.error("HTML does not have a single root node",n),"HTML must have a single root node";return i(e.childNodes[0])},fromTag:function(n,r){var e=(r||o).createElement(n);return i(e)},fromText:function(n,r){var e=(r||o).createTextNode(n);return i(e)},fromDom:i,fromPoint:function(n,e,t){return r.from(n.dom().elementFromPoint(e,t)).map(i)}}}),t("ephox.sugar.api.node.NodeTypes",[],function(){return{ATTRIBUTE:2,CDATA_SECTION:4,COMMENT:8,DOCUMENT:9,DOCUMENT_TYPE:10,DOCUMENT_FRAGMENT:11,ELEMENT:1,TEXT:3,PROCESSING_INSTRUCTION:7,ENTITY_REFERENCE:5,ENTITY:6,NOTATION:12}}),t("ephox.sugar.api.node.Node",["ephox.sugar.api.node.NodeTypes"],function(n){var r=function(n){return n.dom().nodeName.toLowerCase()},e=function(n){return n.dom().nodeType},t=function(n){return function(r){return e(r)===n}},o=t(n.ELEMENT),i=t(n.TEXT),u=t(n.DOCUMENT);return{name:r,type:e,value:function(n){return n.dom().nodeValue},isElement:o,isText:i,isDocument:u,isComment:function(t){return e(t)===n.COMMENT||"#comment"===r(t)}}}),t("tinymce.plugins.visualchars.core.Html",["tinymce.plugins.visualchars.core.Data"],function(n){return{wrapCharWithSpan:function(r){return'<span data-mce-bogus="1" class="mce-'+n.charMap[r]+'">'+r+"</span>"}}}),t("tinymce.plugins.visualchars.core.Nodes",["ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node","tinymce.plugins.visualchars.core.Data","tinymce.plugins.visualchars.core.Html"],function(n,r,e,t,o){var i=function(e,t){var o=[],u=e.dom(),a=n.map(u.childNodes,r.fromDom);return n.each(a,function(n){t(n)&&(o=o.concat([n])),o=o.concat(i(n,t))}),o};return{isMatch:function(n){return e.isText(n)&&void 0!==e.value(n)&&t.regExp.test(e.value(n))},filterDescendants:i,findParentElm:function(n,r){for(;n.parentNode;){if(n.parentNode===r)return n;n=n.parentNode}},replaceWithSpans:function(n){return n.replace(t.regExpGlobal,o.wrapCharWithSpan)}}}),t("tinymce.plugins.visualchars.core.VisualChars",["tinymce.plugins.visualchars.core.Data","tinymce.plugins.visualchars.core.Nodes","ephox.katamari.api.Arr","ephox.sugar.api.node.Element","ephox.sugar.api.node.Node"],function(n,r,e,t,o){var i=function(n,i){var u,a,c=r.filterDescendants(t.fromDom(i),r.isMatch);e.each(c,function(e){var t=r.replaceWithSpans(o.value(e));for(a=n.dom.create("div",null,t);u=a.lastChild;)n.dom.insertAfter(u,e.dom());n.dom.remove(e.dom())})},u=function(r,t){var o=r.dom.select(n.selector,t);e.each(o,function(n){r.dom.remove(n,1)})};return{show:i,hide:u,toggle:function(n){var e=n.getBody(),t=n.selection.getBookmark(),o=r.findParentElm(n.selection.getNode(),e);u(n,o=void 0!==o?o:e),i(n,o),n.selection.moveToBookmark(t)}}}),t("tinymce.plugins.visualchars.core.Actions",["tinymce.plugins.visualchars.api.Events","tinymce.plugins.visualchars.core.VisualChars"],function(n,r){return{toggleVisualChars:function(e,t){var o,i=e.getBody(),u=e.selection;t.set(!t.get()),n.fireVisualChars(e,t.get()),o=u.getBookmark(),!0===t.get()?r.show(e,i):r.hide(e,i),u.moveToBookmark(o)}}}),t("tinymce.plugins.visualchars.api.Commands",["tinymce.plugins.visualchars.core.Actions"],function(n){return{register:function(r,e){r.addCommand("mceVisualChars",function(){n.toggleVisualChars(r,e)})}}}),t("tinymce.core.util.Delay",["global!tinymce.util.Tools.resolve"],function(n){return n("tinymce.util.Delay")}),t("tinymce.plugins.visualchars.core.Keyboard",["tinymce.core.util.Delay","tinymce.plugins.visualchars.core.VisualChars"],function(n,r){return{setup:function(e,t){var o=n.debounce(function(){r.toggle(e)},300);!1!==e.settings.forced_root_block&&e.on("keydown",function(n){!0===t.get()&&(13===n.keyCode?r.toggle(e):o())})}}}),t("tinymce.plugins.visualchars.ui.Buttons",[],function(){var n=function(n){return function(r){var e=r.control;n.on("VisualChars",function(n){e.active(n.state)})}};return{register:function(r){r.addButton("visualchars",{active:!1,title:"Show invisible characters",cmd:"mceVisualChars",onPostRender:n(r)}),r.addMenuItem("visualchars",{text:"Show invisible characters",cmd:"mceVisualChars",onPostRender:n(r),selectable:!0,context:"view",prependToContext:!0})}}}),t("tinymce.plugins.visualchars.Plugin",["ephox.katamari.api.Cell","tinymce.core.PluginManager","tinymce.plugins.visualchars.api.Api","tinymce.plugins.visualchars.api.Commands","tinymce.plugins.visualchars.core.Keyboard","tinymce.plugins.visualchars.ui.Buttons"],function(n,r,e,t,o,i){return r.add("visualchars",function(r){var u=n(!1);return t.register(r,u),i.register(r),o.setup(r,u),e.get(u)}),function(){}}),e("tinymce.plugins.visualchars.Plugin")()}();