!function(){var e={},t=function(t){for(var n=e[t],i=n.deps,l=n.defn,r=i.length,o=new Array(r),c=0;c<r;++c)o[c]=a(i[c]);var u=l.apply(null,o);if(void 0===u)throw"module ["+t+"] returned undefined";n.instance=u},n=function(t,n,a){if("string"!=typeof t)throw"module id must be a string";if(void 0===n)throw"no dependencies for "+t;if(void 0===a)throw"no definition function for "+t;e[t]={deps:n,defn:a,instance:void 0}},a=function(n){var a=e[n];if(void 0===a)throw"module ["+n+"] was undefined";return void 0===a.instance&&t(n),a.instance},i=function(e,t){for(var n=e.length,i=new Array(n),l=0;l<n;++l)i[l]=a(e[l]);t.apply(null,i)};({}).bolt={module:{api:{define:n,require:i,demand:a}}};var l=n,r=function(e,t){l(e,[],function(){return t})};r("global!tinymce.util.Tools.resolve",tinymce.util.Tools.resolve),l("tinymce.core.PluginManager",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.PluginManager")}),r("global!Array",Array),r("global!Error",Error),l("ephox.katamari.api.Fun",["global!Array","global!Error"],function(e,t){var n=function(e){return function(){return e}};return{noop:function(){},compose:function(e,t){return function(){return e(t.apply(null,arguments))}},constant:n,identity:function(e){return e},tripleEquals:function(e,t){return e===t},curry:function(t){for(var n=new e(arguments.length-1),a=1;a<arguments.length;a++)n[a-1]=arguments[a];return function(){for(var a=new e(arguments.length),i=0;i<a.length;i++)a[i]=arguments[i];var l=n.concat(a);return t.apply(null,l)}},not:function(e){return function(){return!e.apply(null,arguments)}},die:function(e){return function(){throw new t(e)}},apply:function(e){return e()},call:function(e){e()},never:n(!1),always:n(!0)}}),l("tinymce.core.util.Tools",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.Tools")}),l("tinymce.core.util.XHR",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.util.XHR")}),l("tinymce.core.dom.DOMUtils",["global!tinymce.util.Tools.resolve"],function(e){return e("tinymce.dom.DOMUtils")}),l("tinymce.plugins.template.api.Settings",["tinymce.core.dom.DOMUtils"],function(e){return{getCreationDateClasses:function(e){return e.getParam("template_cdate_classes","cdate")},getModificationDateClasses:function(e){return e.getParam("template_mdate_classes","mdate")},getSelectedContentClasses:function(e){return e.getParam("template_selected_content_classes","selcontent")},getPreviewReplaceValues:function(e){return e.getParam("template_preview_replace_values")},getTemplateReplaceValues:function(e){return e.getParam("template_replace_values")},getTemplates:function(e){return e.templates},getCdateFormat:function(e){return e.getParam("template_cdate_format",e.getLang("template.cdate_format"))},getMdateFormat:function(e){return e.getParam("template_mdate_format",e.getLang("template.mdate_format"))},getDialogWidth:function(e){return e.getParam("template_popup_width",600)},getDialogHeight:function(t){return Math.min(e.DOM.getViewPort().h,t.getParam("template_popup_height",500))}}}),l("tinymce.plugins.template.core.DateTimeHelper",[],function(){var e=function(e,t){if((e=""+e).length<t)for(var n=0;n<t-e.length;n++)e="0"+e;return e};return{getDateTime:function(t,n,a){var i="Sun Mon Tue Wed Thu Fri Sat Sun".split(" "),l="Sunday Monday Tuesday Wednesday Thursday Friday Saturday Sunday".split(" "),r="Jan Feb Mar Apr May Jun Jul Aug Sep Oct Nov Dec".split(" "),o="January February March April May June July August September October November December".split(" ");return a=a||new Date,n=n.replace("%D","%m/%d/%Y"),n=n.replace("%r","%I:%M:%S %p"),n=n.replace("%Y",""+a.getFullYear()),n=n.replace("%y",""+a.getYear()),n=n.replace("%m",e(a.getMonth()+1,2)),n=n.replace("%d",e(a.getDate(),2)),n=n.replace("%H",""+e(a.getHours(),2)),n=n.replace("%M",""+e(a.getMinutes(),2)),n=n.replace("%S",""+e(a.getSeconds(),2)),n=n.replace("%I",""+((a.getHours()+11)%12+1)),n=n.replace("%p",a.getHours()<12?"AM":"PM"),n=n.replace("%B",""+t.translate(o[a.getMonth()])),n=n.replace("%b",""+t.translate(r[a.getMonth()])),n=n.replace("%A",""+t.translate(l[a.getDay()])),n=n.replace("%a",""+t.translate(i[a.getDay()])),n=n.replace("%%","%")}}}),l("tinymce.plugins.template.core.Templates",["tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.DateTimeHelper"],function(e,t,n,a){var i=function(t,n,a){return e.each(a,function(e,t){"function"==typeof e&&(e=e(t)),n=n.replace(new RegExp("\\{\\$"+t+"\\}","g"),e)}),n},l=function(t,a){var i=t.dom,l=n.getTemplateReplaceValues(t);e.each(i.select("*",a),function(t){e.each(l,function(e,n){i.hasClass(t,n)&&"function"==typeof l[n]&&l[n](t)})})},r=function(e,t){return new RegExp("\\b"+t+"\\b","g").test(e.className)};return{createTemplateList:function(e,a){return function(){var i=n.getTemplates(e);"function"!=typeof i?"string"==typeof i?t.send({url:i,success:function(e){a(JSON.parse(e))}}):a(i):i(a)}},replaceTemplateValues:i,replaceVals:l,insertTemplate:function(t,o,c){var u,s,p=t.dom,m=t.selection.getContent();c=i(0,c,n.getTemplateReplaceValues(t)),u=p.create("div",null,c),(s=p.select(".mceTmpl",u))&&s.length>0&&(u=p.create("div",null)).appendChild(s[0].cloneNode(!0)),e.each(p.select("*",u),function(e){r(e,n.getCreationDateClasses(t).replace(/\s+/g,"|"))&&(e.innerHTML=a.getDateTime(t,n.getCdateFormat(t))),r(e,n.getModificationDateClasses(t).replace(/\s+/g,"|"))&&(e.innerHTML=a.getDateTime(t,n.getMdateFormat(t))),r(e,n.getSelectedContentClasses(t).replace(/\s+/g,"|"))&&(e.innerHTML=m)}),l(t,u),t.execCommand("mceInsertContent",!1,u.innerHTML),t.addVisual()}}}),l("tinymce.plugins.template.api.Commands",["ephox.katamari.api.Fun","tinymce.plugins.template.core.Templates"],function(e,t){return{register:function(n){n.addCommand("mceInsertTemplate",e.curry(t.insertTemplate,n))}}}),l("tinymce.plugins.template.core.FilterContent",["tinymce.core.util.Tools","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.DateTimeHelper","tinymce.plugins.template.core.Templates"],function(e,t,n,a){return{setup:function(i){i.on("PreProcess",function(l){var r=i.dom,o=t.getMdateFormat(i);e.each(r.select("div",l.node),function(t){r.hasClass(t,"mceTmpl")&&(e.each(r.select("*",t),function(e){r.hasClass(e,i.getParam("template_mdate_classes","mdate").replace(/\s+/g,"|"))&&(e.innerHTML=n.getDateTime(i,o))}),a.replaceVals(i,t))})})}}}),l("tinymce.plugins.template.ui.Dialog",["tinymce.core.dom.DOMUtils","tinymce.core.util.Tools","tinymce.core.util.XHR","tinymce.plugins.template.api.Settings","tinymce.plugins.template.core.Templates"],function(e,t,n,a,i){var l=function(e,n,l){if(-1===l.indexOf("<html>")){var r="";t.each(e.contentCSS,function(t){r+='<link type="text/css" rel="stylesheet" href="'+e.documentBaseURI.toAbsolute(t)+'">'});var o=e.settings.body_class||"";-1!==o.indexOf("=")&&(o=(o=e.getParam("body_class","","hash"))[e.id]||""),l="<!DOCTYPE html><html><head>"+r+'</head><body class="'+o+'">'+l+"</body></html>"}l=i.replaceTemplateValues(e,l,a.getPreviewReplaceValues(e));var c=n.find("iframe")[0].getEl().contentWindow.document;c.open(),c.write(l),c.close()};return{open:function(e,r){var o,c,u=[];if(r&&0!==r.length)t.each(r,function(e){u.push({selected:!u.length,text:e.title,value:{url:e.url,content:e.content,description:e.description}})}),(o=e.windowManager.open({title:"Insert template",layout:"flex",direction:"column",align:"stretch",padding:15,spacing:10,items:[{type:"form",flex:0,padding:0,items:[{type:"container",label:"Templates",items:{type:"listbox",label:"Templates",name:"template",values:u,onselect:function(t){var a=t.control.value();a.url?n.send({url:a.url,success:function(t){l(e,o,c=t)}}):(c=a.content,l(e,o,c)),o.find("#description")[0].text(t.control.value().description)}}}]},{type:"label",name:"description",label:"Description",text:"Â "},{type:"iframe",flex:1,border:1}],onsubmit:function(){i.insertTemplate(e,!1,c)},minWidth:a.getDialogWidth(e),minHeight:a.getDialogHeight(e)})).find("listbox")[0].fire("select");else{var s=e.translate("No templates defined.");e.notificationManager.open({text:s,type:"info"})}}}}),l("tinymce.plugins.template.ui.Buttons",["tinymce.plugins.template.core.Templates","tinymce.plugins.template.ui.Dialog"],function(e,t){var n=function(e){return function(n){t.open(e,n)}};return{register:function(t){t.addButton("template",{title:"Insert template",onclick:e.createTemplateList(t.settings,n(t))}),t.addMenuItem("template",{text:"Template",onclick:e.createTemplateList(t.settings,n(t)),icon:"template",context:"insert"})}}}),l("tinymce.plugins.template.Plugin",["tinymce.core.PluginManager","tinymce.plugins.template.api.Commands","tinymce.plugins.template.core.FilterContent","tinymce.plugins.template.ui.Buttons"],function(e,t,n,a){return e.add("template",function(e){a.register(e),t.register(e),n.setup(e)}),function(){}}),a("tinymce.plugins.template.Plugin")()}();