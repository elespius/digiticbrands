!function(){"use strict";var t,e,n,r,o,i,u=tinymce.util.Tools.resolve("tinymce.PluginManager"),a=function(t){return function(){return t}},c={noop:function(){},noarg:function(t){return function(){return t()}},compose:function(t,e){return function(){return t(e.apply(null,arguments))}},constant:a,identity:function(t){return t},tripleEquals:function(t,e){return t===e},curry:function(t){for(var e=new Array(arguments.length-1),n=1;n<arguments.length;n++)e[n-1]=arguments[n];return function(){for(var n=new Array(arguments.length),r=0;r<n.length;r++)n[r]=arguments[r];var o=e.concat(n);return t.apply(null,o)}},not:function(t){return function(){return!t.apply(null,arguments)}},die:function(t){return function(){throw new Error(t)}},apply:function(t){return t()},call:function(t){t()},never:a(!1),always:a(!0)},l=c.never,s=c.always,f=function(){return d},d=(r={fold:function(t,e){return t()},is:l,isSome:l,isNone:s,getOr:n=function(t){return t},getOrThunk:e=function(t){return t()},getOrDie:function(t){throw new Error(t||"error: getOrDie called on none.")},or:n,orThunk:e,map:f,ap:f,each:function(){},bind:f,flatten:f,exists:l,forall:s,filter:f,equals:t=function(t){return t.isNone()},equals_:t,toArray:function(){return[]},toString:c.constant("none()")},Object.freeze&&Object.freeze(r),r),m=function(t){var e=function(){return t},n=function(){return o},r=function(e){return e(t)},o={fold:function(e,n){return n(t)},is:function(e){return t===e},isSome:s,isNone:l,getOr:e,getOrThunk:e,getOrDie:e,or:n,orThunk:n,map:function(e){return m(e(t))},ap:function(e){return e.fold(f,function(e){return m(e(t))})},each:function(e){e(t)},bind:r,flatten:e,exists:r,forall:r,filter:function(e){return e(t)?o:d},equals:function(e){return e.is(t)},equals_:function(e,n){return e.fold(l,function(e){return n(t,e)})},toArray:function(){return[t]},toString:function(){return"some("+t+")"}};return o},g={some:m,none:f,from:function(t){return null===t||void 0===t?d:m(t)}},p=void 0===(o=Array.prototype.indexOf)?function(t,e){return S(t,e)}:function(t,e){return o.call(t,e)},h=function(t,e){return p(t,e)>-1},v=function(t,e){for(var n=t.length,r=new Array(n),o=0;o<n;o++){var i=t[o];r[o]=e(i,o,t)}return r},b=function(t,e){for(var n=0,r=t.length;n<r;n++)e(t[n],n,t)},w=function(t,e){for(var n=t.length-1;n>=0;n--)e(t[n],n,t)},y=function(t,e){for(var n=[],r=0,o=t.length;r<o;r++){var i=t[r];e(i,r,t)&&n.push(i)}return n},x=function(t,e){for(var n=0,r=t.length;n<r;n++)if(e(t[n],n,t))return g.some(n);return g.none()},S=function(t,e){for(var n=0,r=t.length;n<r;++n)if(t[n]===e)return n;return-1},C=Array.prototype.push,R=function(t){for(var e=[],n=0,r=t.length;n<r;++n){if(!Array.prototype.isPrototypeOf(t[n]))throw new Error("Arr.flatten item "+n+" was not an array, input: "+t);C.apply(e,t[n])}return e},T=function(t,e){for(var n=0,r=t.length;n<r;++n)if(!0!==e(t[n],n,t))return!1;return!0},D=Array.prototype.slice,A={map:v,each:b,eachr:w,partition:function(t,e){for(var n=[],r=[],o=0,i=t.length;o<i;o++){var u=t[o];(e(u,o,t)?n:r).push(u)}return{pass:n,fail:r}},filter:y,groupBy:function(t,e){if(0===t.length)return[];for(var n=e(t[0]),r=[],o=[],i=0,u=t.length;i<u;i++){var a=t[i],c=e(a);c!==n&&(r.push(o),o=[]),n=c,o.push(a)}return 0!==o.length&&r.push(o),r},indexOf:function(t,e){var n=p(t,e);return-1===n?g.none():g.some(n)},foldr:function(t,e,n){return w(t,function(t){n=e(n,t)}),n},foldl:function(t,e,n){return b(t,function(t){n=e(n,t)}),n},find:function(t,e){for(var n=0,r=t.length;n<r;n++){var o=t[n];if(e(o,n,t))return g.some(o)}return g.none()},findIndex:x,flatten:R,bind:function(t,e){var n=v(t,e);return R(n)},forall:T,exists:function(t,e){return x(t,e).isSome()},contains:h,equal:function(t,e){return t.length===e.length&&T(t,function(t,n){return t===e[n]})},reverse:function(t){var e=D.call(t,0);return e.reverse(),e},chunk:function(t,e){for(var n=[],r=0;r<t.length;r+=e){var o=t.slice(r,r+e);n.push(o)}return n},difference:function(t,e){return y(t,function(t){return!h(e,t)})},mapToObject:function(t,e){for(var n={},r=0,o=t.length;r<o;r++){var i=t[r];n[String(i)]=e(i,r)}return n},pure:function(t){return[t]},sort:function(t,e){var n=D.call(t,0);return n.sort(e),n},range:function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},head:function(t){return 0===t.length?g.none():g.some(t[0])},last:function(t){return 0===t.length?g.none():g.some(t[t.length-1])}},k=void 0===(i=Object.keys)?function(t){var e=[];for(var n in t)t.hasOwnProperty(n)&&e.push(n);return e}:i,N=function(t,e){for(var n=k(t),r=0,o=n.length;r<o;r++){var i=n[r];e(t[i],i,t)}},O=function(t,e){var n={};return N(t,function(r,o){var i=e(r,o,t);n[i.k]=i.v}),n},E=function(t,e){var n=[];return N(t,function(t,r){n.push(e(t,r))}),n},B=function(t){return E(t,function(t){return t})},I={bifilter:function(t,e){var n={},r={};return N(t,function(t,o){(e(t,o)?n:r)[o]=t}),{t:n,f:r}},each:N,map:function(t,e){return O(t,function(t,n,r){return{k:n,v:e(t,n,r)}})},mapToArray:E,tupleMap:O,find:function(t,e){for(var n=k(t),r=0,o=n.length;r<o;r++){var i=n[r],u=t[i];if(e(u,i,t))return g.some(u)}return g.none()},keys:k,values:B,size:function(t){return B(t).length}},P=function(t){return function(e){return function(t){if(null===t)return"null";var e=typeof t;return"object"===e&&Array.prototype.isPrototypeOf(t)?"array":"object"===e&&String.prototype.isPrototypeOf(t)?"string":e}(e)===t}},W={isString:P("string"),isObject:P("object"),isArray:P("array"),isNull:P("null"),isBoolean:P("boolean"),isUndefined:P("undefined"),isFunction:P("function"),isNumber:P("number")},_=function(t){return t.slice(0).sort()},M={sort:_,reqMessage:function(t,e){throw new Error("All required keys ("+_(t).join(", ")+") were not specified. Specified keys were: "+_(e).join(", ")+".")},unsuppMessage:function(t){throw new Error("Unsupported keys for object: "+_(t).join(", "))},validateStrArr:function(t,e){if(!W.isArray(e))throw new Error("The "+t+" fields must be an array. Was: "+e+".");A.each(e,function(e){if(!W.isString(e))throw new Error("The value "+e+" in the "+t+" fields was not a string.")})},invalidTypeMessage:function(t,e){throw new Error("All values need to be of type: "+e+". Keys ("+_(t).join(", ")+") were not.")},checkDupes:function(t){var e=_(t);A.find(e,function(t,n){return n<e.length-1&&t===e[n+1]}).each(function(t){throw new Error("The field: "+t+" occurs more than once in the combined fields: ["+e.join(", ")+"].")})}},L={immutable:function(){var t=arguments;return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(t.length!==e.length)throw new Error('Wrong number of arguments to struct. Expected "['+t.length+']", got '+e.length+" arguments");var r={};return A.each(t,function(t,n){r[t]=c.constant(e[n])}),r}},immutableBag:function(t,e){var n=t.concat(e);if(0===n.length)throw new Error("You must specify at least one required or optional field.");return M.validateStrArr("required",t),M.validateStrArr("optional",e),M.checkDupes(n),function(r){var o=I.keys(r);A.forall(t,function(t){return A.contains(o,t)})||M.reqMessage(t,o);var i=A.filter(o,function(t){return!A.contains(n,t)});i.length>0&&M.unsuppMessage(i);var u={};return A.each(t,function(t){u[t]=c.constant(r[t])}),A.each(e,function(t){u[t]=c.constant(Object.prototype.hasOwnProperty.call(r,t)?g.some(r[t]):g.none())}),u}}},q=L.immutable("width","height"),z=L.immutable("rows","columns"),F=L.immutable("row","column"),j=L.immutable("x","y"),H=L.immutable("element","rowspan","colspan"),V=L.immutable("element","rowspan","colspan","isNew"),U={dimensions:q,grid:z,address:F,coords:j,extended:L.immutable("element","rowspan","colspan","row","column"),detail:H,detailnew:V,rowdata:L.immutable("element","cells","section"),elementnew:L.immutable("element","isNew"),rowdatanew:L.immutable("element","cells","section","isNew"),rowcells:L.immutable("cells","section"),rowdetails:L.immutable("details","section"),bounds:L.immutable("startRow","startCol","finishRow","finishCol")},G=function(t){if(null===t||void 0===t)throw new Error("Node cannot be null or undefined");return{dom:c.constant(t)}},X={fromHtml:function(t,e){var n=(e||document).createElement("div");if(n.innerHTML=t,!n.hasChildNodes()||n.childNodes.length>1)throw console.error("HTML does not have a single root node",t),"HTML must have a single root node";return G(n.childNodes[0])},fromTag:function(t,e){var n=(e||document).createElement(t);return G(n)},fromText:function(t,e){var n=(e||document).createTextNode(t);return G(n)},fromDom:G,fromPoint:function(t,e,n){return g.from(t.dom().elementFromPoint(e,n)).map(G)}},Y=8,$=9,K=1,J=3,Q=K,Z=$,tt=function(t){return t.nodeType!==Q&&t.nodeType!==Z||0===t.childElementCount},et={all:function(t,e){var n=void 0===e?document:e.dom();return tt(n)?[]:A.map(n.querySelectorAll(t),X.fromDom)},is:function(t,e){var n=t.dom();if(n.nodeType!==Q)return!1;if(void 0!==n.matches)return n.matches(e);if(void 0!==n.msMatchesSelector)return n.msMatchesSelector(e);if(void 0!==n.webkitMatchesSelector)return n.webkitMatchesSelector(e);if(void 0!==n.mozMatchesSelector)return n.mozMatchesSelector(e);throw new Error("Browser lacks native selectors")},one:function(t,e){var n=void 0===e?document:e.dom();return tt(n)?g.none():g.from(n.querySelector(t)).map(X.fromDom)}},nt=function(t,e){var n=[],r=function(t){return n.push(t),e(t)},o=e(t);do{o=o.bind(r)}while(o.isSome());return n},rt="undefined"!=typeof window?window:Function("return this;")(),ot=function(t,e){for(var n=void 0!==e&&null!==e?e:rt,r=0;r<t.length&&void 0!==n&&null!==n;++r)n=n[t[r]];return n},it=function(t,e){var n=t.split(".");return ot(n,e)},ut=function(t,e){var n=it(t,e);if(void 0===n||null===n)throw t+" not available on this browser";return n},at=function(){return ut("Node")},ct=function(t,e,n){return 0!=(t.compareDocumentPosition(e)&n)},lt=function(t,e){return ct(t,e,at().DOCUMENT_POSITION_CONTAINED_BY)},st=function(t){var e,n=!1;return function(){return n||(n=!0,e=t.apply(null,arguments)),e}},ft=function(){return dt(0,0)},dt=function(t,e){return{major:t,minor:e}},mt={nu:dt,detect:function(t,e){var n=String(e).toLowerCase();return 0===t.length?ft():function(t,e){var n=function(t,e){for(var n=0;n<t.length;n++){var r=t[n];if(r.test(e))return r}}(t,e);if(!n)return{major:0,minor:0};var r=function(t){return Number(e.replace(n,"$"+t))};return dt(r(1),r(2))}(t,n)},unknown:ft},gt="Firefox",pt=function(t,e){return function(){return e===t}},ht=function(t){var e=t.current;return{current:e,version:t.version,isEdge:pt("Edge",e),isChrome:pt("Chrome",e),isIE:pt("IE",e),isOpera:pt("Opera",e),isFirefox:pt(gt,e),isSafari:pt("Safari",e)}},vt={unknown:function(){return ht({current:void 0,version:mt.unknown()})},nu:ht,edge:c.constant("Edge"),chrome:c.constant("Chrome"),ie:c.constant("IE"),opera:c.constant("Opera"),firefox:c.constant(gt),safari:c.constant("Safari")},bt="Windows",wt="Android",yt="Solaris",xt="FreeBSD",St=function(t,e){return function(){return e===t}},Ct=function(t){var e=t.current;return{current:e,version:t.version,isWindows:St(bt,e),isiOS:St("iOS",e),isAndroid:St(wt,e),isOSX:St("OSX",e),isLinux:St("Linux",e),isSolaris:St(yt,e),isFreeBSD:St(xt,e)}},Rt={unknown:function(){return Ct({current:void 0,version:mt.unknown()})},nu:Ct,windows:c.constant(bt),ios:c.constant("iOS"),android:c.constant(wt),linux:c.constant("Linux"),osx:c.constant("OSX"),solaris:c.constant(yt),freebsd:c.constant(xt)},Tt=function(t,e){var n=String(e).toLowerCase();return A.find(t,function(t){return t.search(n)})},Dt=function(t,e){return Tt(t,e).map(function(t){var n=mt.detect(t.versionRegexes,e);return{current:t.name,version:n}})},At=function(t,e){return Tt(t,e).map(function(t){var n=mt.detect(t.versionRegexes,e);return{current:t.name,version:n}})},kt=function(t,e){return e+t},Nt=function(t,e){return t+e},Ot=function(t,e){return t.substring(e)},Et=function(t,e){return t.substring(0,t.length-e)},Bt=function(t){return""===t?g.none():g.some(t.substr(0,1))},It=function(t){return""===t?g.none():g.some(t.substring(1))},Pt=function(t,e,n){return""===e||!(t.length<e.length)&&t.substr(n,n+e.length)===e},Wt=function(t,e){return Pt(t,e,0)},_t=function(t,e){return Pt(t,e,t.length-e.length)},Mt={supplant:function(t,e){return t.replace(/\${([^{}]*)}/g,function(t,n){var r,o=e[n];return"string"==(r=typeof o)||"number"===r?o:t})},startsWith:Wt,removeLeading:function(t,e){return Wt(t,e)?Ot(t,e.length):t},removeTrailing:function(t,e){return _t(t,e)?Et(t,e.length):t},ensureLeading:function(t,e){return Wt(t,e)?t:kt(t,e)},ensureTrailing:function(t,e){return _t(t,e)?t:Nt(t,e)},endsWith:_t,contains:function(t,e){return-1!==t.indexOf(e)},trim:function(t){return t.replace(/^\s+|\s+$/g,"")},lTrim:function(t){return t.replace(/^\s+/g,"")},rTrim:function(t){return t.replace(/\s+$/g,"")},capitalize:function(t){return Bt(t).bind(function(e){return It(t).map(function(t){return e.toUpperCase()+t})}).getOr(t)}},Lt=/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,qt=function(t){return function(e){return Mt.contains(e,t)}},zt=[{name:"Edge",versionRegexes:[/.*?edge\/ ?([0-9]+)\.([0-9]+)$/],search:function(t){return Mt.contains(t,"edge/")&&Mt.contains(t,"chrome")&&Mt.contains(t,"safari")&&Mt.contains(t,"applewebkit")}},{name:"Chrome",versionRegexes:[/.*?chrome\/([0-9]+)\.([0-9]+).*/,Lt],search:function(t){return Mt.contains(t,"chrome")&&!Mt.contains(t,"chromeframe")}},{name:"IE",versionRegexes:[/.*?msie\ ?([0-9]+)\.([0-9]+).*/,/.*?rv:([0-9]+)\.([0-9]+).*/],search:function(t){return Mt.contains(t,"msie")||Mt.contains(t,"trident")}},{name:"Opera",versionRegexes:[Lt,/.*?opera\/([0-9]+)\.([0-9]+).*/],search:qt("opera")},{name:"Firefox",versionRegexes:[/.*?firefox\/\ ?([0-9]+)\.([0-9]+).*/],search:qt("firefox")},{name:"Safari",versionRegexes:[Lt,/.*?cpu os ([0-9]+)_([0-9]+).*/],search:function(t){return(Mt.contains(t,"safari")||Mt.contains(t,"mobile/"))&&Mt.contains(t,"applewebkit")}}],Ft=[{name:"Windows",search:qt("win"),versionRegexes:[/.*?windows\ nt\ ?([0-9]+)\.([0-9]+).*/]},{name:"iOS",search:function(t){return Mt.contains(t,"iphone")||Mt.contains(t,"ipad")},versionRegexes:[/.*?version\/\ ?([0-9]+)\.([0-9]+).*/,/.*cpu os ([0-9]+)_([0-9]+).*/,/.*cpu iphone os ([0-9]+)_([0-9]+).*/]},{name:"Android",search:qt("android"),versionRegexes:[/.*?android\ ?([0-9]+)\.([0-9]+).*/]},{name:"OSX",search:qt("os x"),versionRegexes:[/.*?os\ x\ ?([0-9]+)_([0-9]+).*/]},{name:"Linux",search:qt("linux"),versionRegexes:[]},{name:"Solaris",search:qt("sunos"),versionRegexes:[]},{name:"FreeBSD",search:qt("freebsd"),versionRegexes:[]}],jt={browsers:c.constant(zt),oses:c.constant(Ft)},Ht=function(t){var e,n,r,o,i,u,a,l,s,f,d,m=jt.browsers(),g=jt.oses(),p=Dt(m,t).fold(vt.unknown,vt.nu),h=At(g,t).fold(Rt.unknown,Rt.nu);return{browser:p,os:h,deviceType:(n=p,r=t,o=(e=h).isiOS()&&!0===/ipad/i.test(r),i=e.isiOS()&&!o,u=e.isAndroid()&&3===e.version.major,a=e.isAndroid()&&4===e.version.major,l=o||u||a&&!0===/mobile/i.test(r),s=e.isiOS()||e.isAndroid(),f=s&&!l,d=n.isSafari()&&e.isiOS()&&!1===/safari/i.test(r),{isiPad:c.constant(o),isiPhone:c.constant(i),isTablet:c.constant(l),isPhone:c.constant(f),isTouch:c.constant(s),isAndroid:e.isAndroid,isiOS:e.isiOS,isWebView:c.constant(d)})}},Vt={detect:st(function(){var t=navigator.userAgent;return Ht(t)})},Ut=function(t,e){return t.dom()===e.dom()},Gt=Vt.detect().browser.isIE()?function(t,e){return lt(t.dom(),e.dom())}:function(t,e){var n=t.dom(),r=e.dom();return n!==r&&n.contains(r)},Xt={eq:Ut,isEqualNode:function(t,e){return t.dom().isEqualNode(e.dom())},member:function(t,e){return A.exists(e,c.curry(Ut,t))},contains:Gt,is:et.is},Yt=function(t){return X.fromDom(t.dom().ownerDocument)},$t=function(t){var e=t.dom();return g.from(e.parentNode).map(X.fromDom)},Kt=function(t){var e=t.dom();return g.from(e.previousSibling).map(X.fromDom)},Jt=function(t){var e=t.dom();return g.from(e.nextSibling).map(X.fromDom)},Qt=function(t){var e=t.dom();return A.map(e.childNodes,X.fromDom)},Zt=function(t,e){var n=t.dom().childNodes;return g.from(n[e]).map(X.fromDom)},te=L.immutable("element","offset"),ee={owner:Yt,defaultView:function(t){var e=t.dom().ownerDocument.defaultView;return X.fromDom(e)},documentElement:function(t){var e=Yt(t);return X.fromDom(e.dom().documentElement)},parent:$t,findIndex:function(t){return $t(t).bind(function(e){var n=Qt(e);return A.findIndex(n,function(e){return Xt.eq(t,e)})})},parents:function(t,e){for(var n=W.isFunction(e)?e:c.constant(!1),r=t.dom(),o=[];null!==r.parentNode&&void 0!==r.parentNode;){var i=r.parentNode,u=X.fromDom(i);if(o.push(u),!0===n(u))break;r=i}return o},siblings:function(t){return $t(t).map(Qt).map(function(e){return A.filter(e,function(e){return!Xt.eq(t,e)})}).getOr([])},prevSibling:Kt,offsetParent:function(t){var e=t.dom();return g.from(e.offsetParent).map(X.fromDom)},prevSiblings:function(t){return A.reverse(nt(t,Kt))},nextSibling:Jt,nextSiblings:function(t){return nt(t,Jt)},children:Qt,child:Zt,firstChild:function(t){return Zt(t,0)},lastChild:function(t){return Zt(t,t.dom().childNodes.length-1)},childNodesCount:function(t){return t.dom().childNodes.length},hasChildNodes:function(t){return t.dom().hasChildNodes()},leaf:function(t,e){var n=Qt(t);return n.length>0&&e<n.length?te(n[e],0):te(t,e)}},ne=function(t,e,n){return A.bind(ee.children(t),function(t){return et.is(t,e)?n(t)?[t]:[]:ne(t,e,n)})},re={firstLayer:function(t,e){return ne(t,e,c.constant(!0))},filterFirstLayer:ne},oe=function(t){return t.dom().nodeName.toLowerCase()},ie=function(t){return t.dom().nodeType},ue=function(t){return function(e){return ie(e)===t}},ae=ue(K),ce=ue(J),le=ue($),se={name:oe,type:ie,value:function(t){return t.dom().nodeValue},isElement:ae,isText:ce,isDocument:le,isComment:function(t){return ie(t)===Y||"#comment"===oe(t)}},fe=function(t,e,n){if(!(W.isString(n)||W.isBoolean(n)||W.isNumber(n)))throw console.error("Invalid call to Attr.set. Key ",e,":: Value ",n,":: Element ",t),new Error("Attribute value was not simple");t.setAttribute(e,n+"")},de=function(t,e,n){fe(t.dom(),e,n)},me=function(t,e){var n=t.dom().getAttribute(e);return null===n?void 0:n},ge=function(t,e){var n=t.dom();return!(!n||!n.hasAttribute)&&n.hasAttribute(e)},pe={clone:function(t){return A.foldl(t.dom().attributes,function(t,e){return t[e.name]=e.value,t},{})},set:de,setAll:function(t,e){var n=t.dom();I.each(e,function(t,e){fe(n,e,t)})},get:me,has:ge,remove:function(t,e){t.dom().removeAttribute(e)},hasNone:function(t){var e=t.dom().attributes;return void 0===e||null===e||0===e.length},transfer:function(t,e,n){se.isElement(t)&&se.isElement(e)&&A.each(n,function(n){var r,o,i;o=e,ge(r=t,i=n)&&!ge(o,i)&&de(o,i,me(r,i))})}},he=st(function(){return ve(X.fromDom(document))}),ve=function(t){var e=t.dom().body;if(null===e||void 0===e)throw"Body is not available yet";return X.fromDom(e)},be={body:he,getBody:ve,inBody:function(t){var e=se.isText(t)?t.dom().parentNode:t.dom();return void 0!==e&&null!==e&&e.ownerDocument.body.contains(e)}},we=function(t,e){var n=[];return A.each(ee.children(t),function(t){e(t)&&(n=n.concat([t])),n=n.concat(we(t,e))}),n},ye={all:function(t){return we(be.body(),t)},ancestors:function(t,e,n){return A.filter(ee.parents(t,n),e)},siblings:function(t,e){return A.filter(ee.siblings(t),e)},children:function(t,e){return A.filter(ee.children(t),e)},descendants:we},xe={all:function(t){return et.all(t)},ancestors:function(t,e,n){return ye.ancestors(t,function(t){return et.is(t,e)},n)},siblings:function(t,e){return ye.siblings(t,function(t){return et.is(t,e)})},children:function(t,e){return ye.children(t,function(t){return et.is(t,e)})},descendants:function(t,e){return et.all(e,t)}};function Se(t,e,n,r,o){return t(n,r)?g.some(n):W.isFunction(o)&&o(n)?g.none():e(n,r,o)}var Ce,Re,Te,De,Ae,ke=function(t,e,n){for(var r=t.dom(),o=W.isFunction(n)?n:c.constant(!1);r.parentNode;){r=r.parentNode;var i=X.fromDom(r);if(e(i))return g.some(i);if(o(i))break}return g.none()},Ne=function(t,e){return A.find(t.dom().childNodes,c.compose(e,X.fromDom)).map(X.fromDom)},Oe=function(t,e){var n=function(t){for(var r=0;r<t.childNodes.length;r++){if(e(X.fromDom(t.childNodes[r])))return g.some(X.fromDom(t.childNodes[r]));var o=n(t.childNodes[r]);if(o.isSome())return o}return g.none()};return n(t.dom())},Ee={first:function(t){return Oe(be.body(),t)},ancestor:ke,closest:function(t,e,n){return Se(function(t){return e(t)},ke,t,e,n)},sibling:function(t,e){var n=t.dom();return n.parentNode?Ne(X.fromDom(n.parentNode),function(n){return!Xt.eq(t,n)&&e(n)}):g.none()},child:Ne,descendant:Oe},Be=function(t,e,n){return Ee.ancestor(t,function(t){return et.is(t,e)},n)},Ie={first:function(t){return et.one(t)},ancestor:Be,sibling:function(t,e){return Ee.sibling(t,function(t){return et.is(t,e)})},child:function(t,e){return Ee.child(t,function(t){return et.is(t,e)})},descendant:function(t,e){return et.one(e,t)},closest:function(t,e,n){return Se(et.is,Be,t,e,n)}},Pe=function(t,e,n){var r=void 0!==n?n:c.constant(!1);return r(e)?g.none():A.contains(t,se.name(e))?g.some(e):Ie.ancestor(e,t.join(","),function(t){return et.is(t,"table")||r(t)})},We=function(t,e){return ee.parent(e).map(function(e){return xe.children(e,t)})},_e=function(t,e){return parseInt(pe.get(t,e),10)},Me={cell:function(t,e){return Pe(["td","th"],t,e)},firstCell:function(t){return Ie.descendant(t,"th,td")},cells:function(t){return re.firstLayer(t,"th,td")},neighbourCells:c.curry(We,"th,td"),table:function(t,e){return Ie.closest(t,"table",e)},row:function(t,e){return Pe(["tr"],t,e)},rows:function(t){return re.firstLayer(t,"tr")},notCell:function(t,e){return Pe(["caption","tr","tbody","tfoot","thead"],t,e)},neighbourRows:c.curry(We,"tr"),attr:_e,grid:function(t,e,n){var r=_e(t,e),o=_e(t,n);return U.grid(r,o)}},Le=function(t){var e=Me.rows(t);return A.map(e,function(t){var e=t,n=ee.parent(e).bind(function(t){var e=se.name(t);return"tfoot"===e||"thead"===e||"tbody"===e?e:"tbody"}),r=A.map(Me.cells(t),function(t){var e=pe.has(t,"rowspan")?parseInt(pe.get(t,"rowspan"),10):1,n=pe.has(t,"colspan")?parseInt(pe.get(t,"colspan"),10):1;return U.detail(t,e,n)});return U.rowdata(e,r,n)})},qe=function(t,e){return A.map(t,function(t){var n=A.map(Me.cells(t),function(t){var e=pe.has(t,"rowspan")?parseInt(pe.get(t,"rowspan"),10):1,n=pe.has(t,"colspan")?parseInt(pe.get(t,"colspan"),10):1;return U.detail(t,e,n)});return U.rowdata(t,n,e.section())})},ze=function(t,e){return t+","+e},Fe=function(t,e){var n=A.bind(t.all(),function(t){return t.cells()});return A.filter(n,e)},je={generate:function(t){var e={},n=[],r=t.length,o=0;A.each(t,function(t,r){var i=[];A.each(t.cells(),function(t,n){for(var u=0;void 0!==e[ze(r,u)];)u++;for(var a=U.extended(t.element(),t.rowspan(),t.colspan(),r,u),c=0;c<t.colspan();c++)for(var l=0;l<t.rowspan();l++){var s=u+c,f=ze(r+l,s);e[f]=a,o=Math.max(o,s+1)}i.push(a)}),n.push(U.rowdata(t.element(),i,t.section()))});var i=U.grid(r,o);return{grid:c.constant(i),access:c.constant(e),all:c.constant(n)}},getAt:function(t,e,n){var r=t.access()[ze(e,n)];return void 0!==r?g.some(r):g.none()},findItem:function(t,e,n){var r=Fe(t,function(t){return n(e,t.element())});return r.length>0?g.some(r[0]):g.none()},filterItems:Fe,justCells:function(t){var e=A.map(t.all(),function(t){return t.cells()});return A.flatten(e)}},He={isSupported:function(t){return void 0!==t.style}},Ve=function(t,e,n){if(!W.isString(n))throw console.error("Invalid call to CSS.set. Property ",e,":: Value ",n,":: Element ",t),new Error("CSS value must be a string: "+n);He.isSupported(t)&&t.style.setProperty(e,n)},Ue=function(t,e){He.isSupported(t)&&t.style.removeProperty(e)},Ge=function(t,e,n){var r=t.dom();Ve(r,e,n)},Xe=function(t,e){return He.isSupported(t)?t.style.getPropertyValue(e):""},Ye=function(t,e){var n=t.dom(),r=Xe(n,e);return g.from(r).filter(function(t){return t.length>0})},$e={copy:function(t,e){var n=t.dom(),r=e.dom();He.isSupported(n)&&He.isSupported(r)&&(r.style.cssText=n.style.cssText)},set:Ge,preserve:function(t,e){var n=pe.get(t,"style"),r=e(t);return(void 0===n?pe.remove:pe.set)(t,"style",n),r},setAll:function(t,e){var n=t.dom();I.each(e,function(t,e){Ve(n,e,t)})},setOptions:function(t,e){var n=t.dom();I.each(e,function(t,e){t.fold(function(){Ue(n,e)},function(t){Ve(n,e,t)})})},remove:function(t,e){var n=t.dom();Ue(n,e),pe.has(t,"style")&&""===Mt.trim(pe.get(t,"style"))&&pe.remove(t,"style")},get:function(t,e){var n=t.dom(),r=window.getComputedStyle(n).getPropertyValue(e),o=""!==r||be.inBody(t)?r:Xe(n,e);return null===o?void 0:o},getRaw:Ye,getAllRaw:function(t){var e={},n=t.dom();if(He.isSupported(n))for(var r=0;r<n.style.length;r++){var o=n.style.item(r);e[o]=n.style[o]}return e},isValidValue:function(t,e,n){var r=X.fromTag(t);return Ge(r,e,n),Ye(r,e).isSome()},reflow:function(t){return t.dom().offsetWidth},transfer:function(t,e,n){se.isElement(t)&&se.isElement(e)&&A.each(n,function(n){var r,o;r=e,Ye(t,o=n).each(function(t){Ye(r,o).isNone()&&Ge(r,o,t)})})}},Ke=function(t,e){ee.parent(t).each(function(n){n.dom().insertBefore(e.dom(),t.dom())})},Je=function(t,e){t.dom().appendChild(e.dom())},Qe={before:Ke,after:function(t,e){ee.nextSibling(t).fold(function(){ee.parent(t).each(function(t){Je(t,e)})},function(t){Ke(t,e)})},prepend:function(t,e){ee.firstChild(t).fold(function(){Je(t,e)},function(n){t.dom().insertBefore(e.dom(),n.dom())})},append:Je,appendAt:function(t,e,n){ee.child(t,n).fold(function(){Je(t,e)},function(t){Ke(t,e)})},wrap:function(t,e){Ke(t,e),Je(e,t)}},Ze={before:function(t,e){A.each(e,function(e){Qe.before(t,e)})},after:function(t,e){A.each(e,function(n,r){var o=0===r?t:e[r-1];Qe.after(o,n)})},prepend:function(t,e){A.each(e.slice().reverse(),function(e){Qe.prepend(t,e)})},append:function(t,e){A.each(e,function(e){Qe.append(t,e)})}},tn=function(t){var e=t.dom();null!==e.parentNode&&e.parentNode.removeChild(e)},en={empty:function(t){t.dom().textContent="",A.each(ee.children(t),function(t){tn(t)})},remove:tn,unwrap:function(t){var e=ee.children(t);e.length>0&&Ze.before(t,e),tn(t)}},nn=L.immutable("minRow","minCol","maxRow","maxCol"),rn=function(t,e){var n,r,o,i,u,a,c,l,s,f,d=function(t){return et.is(t.element(),e)},m=Le(t),g=je.generate(m),p=(r=d,o=(n=g).grid().columns(),i=n.grid().rows(),u=o,a=0,c=0,I.each(n.access(),function(t){if(r(t)){var e=t.row(),n=e+t.rowspan()-1,o=t.column(),l=o+t.colspan()-1;e<i?i=e:n>a&&(a=n),o<u?u=o:l>c&&(c=l)}}),nn(i,u,a,c)),h="th:not("+e+"),td:not("+e+")",v=re.filterFirstLayer(t,"th,td",function(t){return et.is(t,h)});return A.each(v,en.remove),function(t,e,n,r){for(var o,i,u,a=e.grid().columns(),c=e.grid().rows(),l=0;l<c;l++)for(var s=!1,f=0;f<a;f++)l<n.minRow()||l>n.maxRow()||f<n.minCol()||f>n.maxCol()||(je.getAt(e,l,f).filter(r).isNone()?(o=s,i=t[l].element(),u=X.fromTag("td"),Qe.append(u,X.fromTag("br")),(o?Qe.append:Qe.prepend)(i,u)):s=!0)}(m,g,p,d),l=t,s=p,f=A.filter(re.firstLayer(l,"tr"),function(t){return 0===t.dom().childElementCount}),A.each(f,en.remove),s.minCol()!==s.maxCol()&&s.minRow()!==s.maxRow()||A.each(re.firstLayer(l,"th,td"),function(t){pe.remove(t,"rowspan"),pe.remove(t,"colspan")}),pe.remove(l,"width"),pe.remove(l,"height"),$e.remove(l,"width"),$e.remove(l,"height"),t},on=function(t,e){return X.fromDom(t.dom().cloneNode(e))},un=function(t){return on(t,!0)},an=function(t,e){var n=X.fromTag(e),r=pe.clone(t);return pe.setAll(n,r),n},cn=function(t){return on(t,!1)},ln=un,sn=function(t,e){var n=an(t,e),r=ee.children(un(t));return Ze.append(n,r),n},fn=(Ce=se.isText,Re="text",Te=function(t){return Ce(t)?g.from(t.dom().nodeValue):g.none()},De=Vt.detect().browser,{get:function(t){if(!Ce(t))throw new Error("Can only get "+Re+" value of a "+Re+" node");return Ae(t).getOr("")},getOption:Ae=De.isIE()&&10===De.version.major?function(t){try{return Te(t)}catch(t){return g.none()}}:Te,set:function(t,e){if(!Ce(t))throw new Error("Can only set raw "+Re+" value of a "+Re+" node");t.dom().nodeValue=e}}),dn={get:function(t){return fn.get(t)},getOption:function(t){return fn.getOption(t)},set:function(t,e){fn.set(t,e)}},mn=function(t){return"img"===se.name(t)?1:dn.getOption(t).fold(function(){return ee.children(t).length},function(t){return t.length})},gn=["img","br"],pn=mn,hn=function(t){var e;return e=t,dn.getOption(e).filter(function(t){return 0!==t.trim().length||t.indexOf(" ")>-1}).isSome()||A.contains(gn,se.name(t))},vn=function(t,e){var n=function(t){for(var r=ee.children(t),o=r.length-1;o>=0;o--){var i=r[o];if(e(i))return g.some(i);var u=n(i);if(u.isSome())return u}return g.none()};return n(t)},bn={first:function(t){return Ee.descendant(t,hn)},last:function(t){return vn(t,hn)}},wn=function(){var t=X.fromTag("td");return Qe.append(t,X.fromTag("br")),t},yn=function(t,e,n){var r=sn(t,e);return I.each(n,function(t,e){null===t?pe.remove(r,e):pe.set(r,e,t)}),r},xn=function(t){return t},Sn=function(t){return function(){return X.fromTag("tr",t.dom())}},Cn={cellOperations:function(t,e,n){return{row:Sn(e),cell:function(e){var r,o,i,u=ee.owner(e.element()),a=X.fromTag(se.name(e.element()),u.dom()),c=n.getOr(["strong","em","b","i","span","font","h1","h2","h3","h4","h5","h6","p","div"]),l=c.length>0?(r=e.element(),o=a,i=c,bn.first(r).map(function(t){var e=i.join(","),n=xe.ancestors(t,e,function(t){return Xt.eq(t,r)});return A.foldr(n,function(t,e){var n=cn(e);return Qe.append(t,n),n},o)}).getOr(o)):a;return Qe.append(l,X.fromTag("br")),$e.copy(e.element(),a),$e.remove(a,"height"),1!==e.colspan()&&$e.remove(e.element(),"width"),t(e.element(),a),a},replace:yn,gap:wn}},paste:function(t){return{row:Sn(t),cell:wn,replace:xn,gap:wn}}},Rn=function(t,e){var n=(e||document).createElement("div");return n.innerHTML=t,ee.children(X.fromDom(n))},Tn=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","li","table","thead","tbody","tfoot","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"];function Dn(){return{up:c.constant({selector:Ie.ancestor,closest:Ie.closest,predicate:Ee.ancestor,all:ee.parents}),down:c.constant({selector:xe.descendants,predicate:ye.descendants}),styles:c.constant({get:$e.get,getRaw:$e.getRaw,set:$e.set,remove:$e.remove}),attrs:c.constant({get:pe.get,set:pe.set,remove:pe.remove,copyTo:function(t,e){var n=pe.clone(t);pe.setAll(e,n)}}),insert:c.constant({before:Qe.before,after:Qe.after,afterAll:Ze.after,append:Qe.append,appendAll:Ze.append,prepend:Qe.prepend,wrap:Qe.wrap}),remove:c.constant({unwrap:en.unwrap,remove:en.remove}),create:c.constant({nu:X.fromTag,clone:function(t){return X.fromDom(t.dom().cloneNode(!1))},text:X.fromText}),query:c.constant({comparePosition:function(t,e){return t.dom().compareDocumentPosition(e.dom())},prevSibling:ee.prevSibling,nextSibling:ee.nextSibling}),property:c.constant({children:ee.children,name:se.name,parent:ee.parent,isText:se.isText,isComment:se.isComment,isElement:se.isElement,getText:dn.get,setText:dn.set,isBoundary:function(t){return!!se.isElement(t)&&("body"===se.name(t)||A.contains(Tn,se.name(t)))},isEmptyTag:function(t){return!!se.isElement(t)&&A.contains(["br","img","hr","input"],se.name(t))}}),eq:Xt.eq,is:Xt.is}}L.immutable("left","right");var An=function(t,e,n,r){var o=e(t,n);return A.foldr(r,function(n,r){var o=e(t,r);return kn(t,n,o)},o)},kn=function(t,e,n){return e.bind(function(e){return n.filter(c.curry(t.eq,e))})},Nn=function(t,e,n){return n.length>0?An(t,e,(r=n)[0],r.slice(1)):g.none();var r},On=function(t,e){return c.curry(t.eq,e)},En=function(t,e,n,r){var o=void 0!==r?r:c.constant(!1),i=[e].concat(t.up().all(e)),u=[n].concat(t.up().all(n)),a=function(t){return A.findIndex(t,o).fold(function(){return t},function(e){return t.slice(0,e+1)})},l=a(i),s=a(u),f=A.find(l,function(e){return A.exists(s,On(t,e))});return{firstpath:c.constant(l),secondpath:c.constant(s),shared:c.constant(f)}},Bn=En,In=function(t,e,n){return Nn(t,e,n)},Pn=function(t,e,n,r){return Bn(t,e,n,r)},Wn=Dn(),_n=function(t,e){return In(Wn,function(e,n){return t(n)},e)},Mn=function(t,e,n){return Pn(Wn,t,e,n)},Ln=function(t,e){return e.column()>=t.startCol()&&e.column()+e.colspan()-1<=t.finishCol()&&e.row()>=t.startRow()&&e.row()+e.rowspan()-1<=t.finishRow()},qn=function(t,e){var n=e.column(),r=e.column()+e.colspan()-1,o=e.row(),i=e.row()+e.rowspan()-1;return n<=t.finishCol()&&r>=t.startCol()&&o<=t.finishRow()&&i>=t.startRow()},zn=function(t,e){for(var n=!0,r=c.curry(Ln,e),o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)n=n&&je.getAt(t,o,i).exists(r);return n?g.some(e):g.none()},Fn=function(t,e,n){var r=je.findItem(t,e,Xt.eq),o=je.findItem(t,n,Xt.eq);return r.bind(function(t){return o.map(function(e){return n=t,r=e,U.bounds(Math.min(n.row(),r.row()),Math.min(n.column(),r.column()),Math.max(n.row()+n.rowspan()-1,r.row()+r.rowspan()-1),Math.max(n.column()+n.colspan()-1,r.column()+r.colspan()-1));var n,r})})},jn=Fn,Hn=function(t,e,n){return Fn(t,e,n).bind(function(e){return zn(t,e)})},Vn=function(t,e,n,r){return je.findItem(t,e,Xt.eq).bind(function(e){var o=n>0?e.row()+e.rowspan()-1:e.row(),i=r>0?e.column()+e.colspan()-1:e.column();return je.getAt(t,o+n,i+r).map(function(t){return t.element()})})},Un=function(t,e,n){return jn(t,e,n).map(function(e){var n=je.filterItems(t,c.curry(qn,e));return A.map(n,function(t){return t.element()})})},Gn=function(t,e){return je.findItem(t,e,function(t,e){return Xt.contains(e,t)}).bind(function(t){return t.element()})},Xn=function(t){var e=Le(t);return je.generate(e)},Yn=function(t,e,n){return Me.table(t).bind(function(r){var o=Xn(r);return Vn(o,t,e,n)})},$n=function(t,e,n){var r=Xn(t);return Un(r,e,n)},Kn=function(t,e,n,r,o){var i=Xn(t),u=Xt.eq(t,n)?e:Gn(i,e),a=Xt.eq(t,o)?r:Gn(i,r);return Un(i,u,a)},Jn=function(t,e,n){var r=Xn(t);return Hn(r,e,n)},Qn=function(t,e){return Ie.ancestor(t,"table")},Zn=L.immutableBag(["boxes","start","finish"],[]),tr=function(t,e,n){var r=function(t){return function(e){return n(e)||Xt.eq(e,t)}};return Xt.eq(t,e)?g.some(Zn({boxes:g.some([t]),start:t,finish:e})):Qn(t).bind(function(o){return Qn(e).bind(function(i){if(Xt.eq(o,i))return g.some(Zn({boxes:$n(o,t,e),start:t,finish:e}));if(Xt.contains(o,i)){var u=(a=xe.ancestors(e,"td,th",r(o))).length>0?a[a.length-1]:e;return g.some(Zn({boxes:Kn(o,t,o,e,i),start:t,finish:u}))}if(Xt.contains(i,o)){var a,c=(a=xe.ancestors(t,"td,th",r(i))).length>0?a[a.length-1]:t;return g.some(Zn({boxes:Kn(i,t,o,e,i),start:t,finish:c}))}return Mn(t,e).shared().bind(function(u){return Ie.closest(u,"table",n).bind(function(n){var u=xe.ancestors(e,"td,th",r(n)),a=u.length>0?u[u.length-1]:e,c=xe.ancestors(t,"td,th",r(n)),l=c.length>0?c[c.length-1]:t;return g.some(Zn({boxes:Kn(n,t,o,e,i),start:l,finish:a}))})})})})},er={identify:tr,retrieve:function(t,e){var n=xe.descendants(t,e);return n.length>0?g.some(n):g.none()},shiftSelection:function(t,e,n,r,o){return(i=t,u=o,A.find(i,function(t){return et.is(t,u)})).bind(function(t){return Yn(t,e,n).bind(function(t){return e=t,n=r,Ie.ancestor(e,"table").bind(function(t){return Ie.descendant(t,n).bind(function(t){return tr(t,e).bind(function(t){return t.boxes().map(function(e){return{boxes:c.constant(e),start:c.constant(t.start()),finish:c.constant(t.finish())}})})})});var e,n})});var i,u},getEdges:function(t,e,n){return Ie.descendant(t,e).bind(function(e){return Ie.descendant(t,n).bind(function(t){return _n(Qn,[e,t]).map(function(n){return{first:c.constant(e),last:c.constant(t),table:c.constant(n)}})})})}},nr={retrieve:function(t,e){return er.retrieve(t,e)},retrieveBox:function(t,e,n){return er.getEdges(t,e,n).bind(function(e){var n=function(e){return Xt.eq(t,e)},r=Ie.ancestor(e.first(),"thead,tfoot,tbody,table",n),o=Ie.ancestor(e.last(),"thead,tfoot,tbody,table",n);return r.bind(function(t){return o.bind(function(n){return Xt.eq(t,n)?Jn(e.table(),e.first(),e.last()):g.none()})})})}},rr="data-mce-selected",or="data-mce-first-selected",ir="data-mce-last-selected",ur={selected:c.constant(rr),selectedSelector:c.constant("td[data-mce-selected],th[data-mce-selected]"),attributeSelector:c.constant("[data-mce-selected]"),firstSelected:c.constant(or),firstSelectedSelector:c.constant("td[data-mce-first-selected],th[data-mce-first-selected]"),lastSelected:c.constant(ir),lastSelectedSelector:c.constant("td[data-mce-last-selected],th[data-mce-last-selected]")},ar=function(t){if(!W.isArray(t))throw new Error("cases must be an array");if(0===t.length)throw new Error("there must be at least one case");var e=[],n={};return A.each(t,function(r,o){var i=I.keys(r);if(1!==i.length)throw new Error("one and only one name per case");var u=i[0],a=r[u];if(void 0!==n[u])throw new Error("duplicate key detected:"+u);if("cata"===u)throw new Error("cannot have a case named cata (sorry)");if(!W.isArray(a))throw new Error("case arguments must be an array");e.push(u),n[u]=function(){var n=arguments.length;if(n!==a.length)throw new Error("Wrong number of arguments to case "+u+". Expected "+a.length+" ("+a+"), got "+n);for(var r=new Array(n),i=0;i<r.length;i++)r[i]=arguments[i];return{fold:function(){if(arguments.length!==t.length)throw new Error("Wrong number of arguments to fold. Expected "+t.length+", got "+arguments.length);return arguments[o].apply(null,r)},match:function(t){var n=I.keys(t);if(e.length!==n.length)throw new Error("Wrong number of arguments to match. Expected: "+e.join(",")+"\nActual: "+n.join(","));if(!A.forall(e,function(t){return A.contains(n,t)}))throw new Error("Not all branches were specified when using match. Specified: "+n.join(", ")+"\nRequired: "+e.join(", "));return t[u].apply(null,r)},log:function(t){console.log(t,{constructors:e,constructor:u,params:r})}}}}),n},cr=ar([{none:[]},{multiple:["elements"]},{single:["selection"]}]),lr={cata:function(t,e,n,r){return t.fold(e,n,r)},none:cr.none,multiple:cr.multiple,single:cr.single},sr=function(t,e){return lr.cata(e.get(),c.constant([]),c.identity,c.constant([t]))},fr=function(t,e){return lr.cata(e.get(),g.none,function(e,n){return 0===e.length?g.none():nr.retrieveBox(t,ur.firstSelectedSelector(),ur.lastSelectedSelector()).bind(function(t){return e.length>1?g.some({bounds:c.constant(t),cells:c.constant(e)}):g.none()})},g.none)},dr=function(t,e){var n=sr(t,e);return n.length>0&&A.forall(n,function(t){return pe.has(t,"rowspan")&&parseInt(pe.get(t,"rowspan"),10)>1||pe.has(t,"colspan")&&parseInt(pe.get(t,"colspan"),10)>1})?g.some(n):g.none()},mr=sr,gr=function(t){return{element:c.constant(t),mergable:g.none,unmergable:g.none,selection:c.constant([t])}},pr=L.immutable("element","clipboard","generators"),hr={noMenu:gr,forMenu:function(t,e,n){return{element:c.constant(n),mergable:c.constant(fr(e,t)),unmergable:c.constant(dr(n,t)),selection:c.constant(mr(n,t))}},notCell:function(t){return gr(t)},paste:pr,pasteRows:function(t,e,n,r,o){return{element:c.constant(n),mergable:g.none,unmergable:g.none,selection:c.constant(mr(n,t)),clipboard:c.constant(r),generators:c.constant(o)}}},vr={registerEvents:function(t,e,n,r){t.on("BeforeGetContent",function(n){!0===n.selection&&lr.cata(e.get(),c.noop,function(e){var r;n.preventDefault(),(r=e,Me.table(r[0]).map(ln).map(function(t){return[rn(t,ur.attributeSelector())]})).each(function(e){n.content=A.map(e,function(e){return n=e,t.selection.serializer.serialize(n.dom(),{});var n}).join("")})},c.noop)}),t.on("BeforeSetContent",function(e){!0===e.selection&&!0===e.paste&&g.from(t.dom.getParent(t.selection.getStart(),"th,td")).each(function(o){var i=X.fromDom(o);Me.table(i).bind(function(o){var u=A.filter(Rn(e.content),function(t){return"meta"!==se.name(t)});if(1===u.length&&"table"===se.name(u[0])){e.preventDefault();var a=X.fromDom(t.getDoc()),c=Cn.paste(a),l=hr.paste(i,u[0],c);n.pasteCells(o,l).each(function(e){t.selection.setRng(e),t.focus(),r.clear(o)})}})})})}},br={render:function(t,e,n,r){var o=X.fromTag("table");$e.setAll(o,{"border-collapse":"collapse",width:"100%"}),pe.set(o,"border","1");var i=X.fromTag("tbody");Qe.append(o,i);for(var u=[],a=0;a<t;a++){for(var c=X.fromTag("tr"),l=0;l<e;l++){var s=a<n||l<r?X.fromTag("th"):X.fromTag("td");l<r&&pe.set(s,"scope","row"),a<n&&pe.set(s,"scope","col"),Qe.append(s,X.fromTag("br")),$e.set(s,"width",100/e+"%"),Qe.append(c,s)}u.push(c)}return Ze.append(i,u),o}},wr=function(t){return t.dom().innerHTML},yr=function(t){var e=X.fromTag("div"),n=X.fromDom(t.dom().cloneNode(!0));return Qe.append(e,n),wr(e)},xr=function(t,e){t.selection.select(e.dom(),!0),t.selection.collapse(!0)},Sr={insert:function(t,e,n){var r,o=br.render(n,e,0,0);pe.set(o,"id","__mce");var i,u,a=yr(o);return t.insertContent(a),r=t.dom.get("__mce"),t.dom.setAttrib(r,"id",null),t.$("tr",r).each(function(e,n){t.fire("newrow",{node:n}),t.$("th,td",n).each(function(e,n){t.fire("newcell",{node:n})})}),t.dom.setAttribs(r,t.settings.table_default_attributes||{}),t.dom.setStyles(r,t.settings.table_default_styles||{}),i=t,u=X.fromDom(r),Ie.descendant(u,"td,th").each(c.curry(xr,i)),r}};function Cr(t,e){var n=function(n){var r=e(n);if(r<=0||null===r){var o=$e.get(n,t);return parseFloat(o)||0}return r},r=function(t,e){return A.foldl(e,function(e,n){var r=$e.get(t,n),o=void 0===r?0:parseInt(r,10);return isNaN(o)?e:e+o},0)};return{set:function(e,n){if(!W.isNumber(n)&&!n.match(/^[0-9]+$/))throw t+".set accepts only positive integer values. Value was "+n;var r=e.dom();He.isSupported(r)&&(r.style[t]=n+"px")},get:n,getOuter:n,aggregate:r,max:function(t,e,n){var o=r(t,n);return e>o?e-o:0}}}var Rr=Cr("height",function(t){return be.inBody(t)?t.dom().getBoundingClientRect().height:t.dom().offsetHeight}),Tr=function(t){return Rr.get(t)},Dr=function(t){return Rr.getOuter(t)},Ar=Cr("width",function(t){return t.dom().offsetWidth}),kr=function(t){return Ar.get(t)},Nr=function(t){return Ar.getOuter(t)},Or=Vt.detect(),Er=function(t,e,n){return r=$e.get(t,e),o=n,i=parseFloat(r),isNaN(i)?o:i;var r,o,i},Br=function(t){return Or.browser.isIE()||Or.browser.isEdge()?(n=Er(e=t,"padding-top",0),r=Er(e,"padding-bottom",0),o=Er(e,"border-top-width",0),i=Er(e,"border-bottom-width",0),u=e.dom().getBoundingClientRect().height,"border-box"===$e.get(e,"box-sizing")?u:u-n-r-(o+i)):Er(t,"height",Tr(t));var e,n,r,o,i,u},Ir=/(\d+(\.\d+)?)(\w|%)*/,Pr=/(\d+(\.\d+)?)%/,Wr=/(\d+(\.\d+)?)px|em/,_r=function(t,e){$e.set(t,"height",e+"px")},Mr=function(t,e,n,r){var o,i,u,a,c,l=parseInt(t,10);return Mt.endsWith(t,"%")&&"table"!==se.name(e)?(o=e,i=l,u=n,a=r,c=Me.table(o).map(function(t){var e=u(t);return Math.floor(i/100*e)}).getOr(i),a(o,c),c):l},Lr=function(t){var e,n=(e=t,$e.getRaw(e,"height").getOrThunk(function(){return Br(e)+"px"}));return n?Mr(n,t,Tr,_r):Tr(t)},qr=function(t,e){return pe.has(t,e)?parseInt(pe.get(t,e),10):1},zr=function(t){return $e.getRaw(t,"width").fold(function(){return g.from(pe.get(t,"width"))},function(t){return g.some(t)})},Fr=function(t,e){return t/e.pixelWidth()*100},jr={percentageBasedSizeRegex:c.constant(Pr),pixelBasedSizeRegex:c.constant(Wr),setPixelWidth:function(t,e){$e.set(t,"width",e+"px")},setPercentageWidth:function(t,e){$e.set(t,"width",e+"%")},setHeight:_r,getPixelWidth:function(t,e){return zr(t).fold(function(){var e=kr(t);return parseInt(e,10)},function(n){return function(t,e,n){if(Wr.test(e)){var r=Wr.exec(e);return parseInt(r[1],10)}if(Pr.test(e)){var o=Pr.exec(e),i=parseFloat(o[1]);return i/100*n.pixelWidth()}var u=kr(t);return parseInt(u,10)}(t,n,e)})},getPercentageWidth:function(t,e){return zr(t).fold(function(){var n=kr(t),r=parseInt(n,10);return Fr(r,e)},function(n){return function(t,e,n){if(Pr.test(e)){var r=Pr.exec(e);return parseFloat(r[1])}var o=kr(t),i=parseInt(o,10);return Fr(i,n)}(t,n,e)})},getGenericWidth:function(t){return zr(t).bind(function(t){if(Ir.test(t)){var e=Ir.exec(t);return g.some({width:c.constant(e[1]),unit:c.constant(e[3])})}return g.none()})},setGenericWidth:function(t,e,n){$e.set(t,"width",e+n)},getHeight:function(t){return n="rowspan",Lr(e=t)/qr(e,n);var e,n},getRawWidth:zr},Hr={halve:function(t,e){jr.getGenericWidth(t).each(function(n){var r=n.width()/2;jr.setGenericWidth(t,r,n.unit()),jr.setGenericWidth(e,r,n.unit())})}},Vr=function(t,e){var n=e||X.fromDom(document.documentElement);return Ee.ancestor(t,c.curry(Xt.eq,n)).isSome()},Ur=function(t){var e=t.dom();return e===e.window?t:se.isDocument(t)?e.defaultView||e.parentWindow:null},Gr=function(t,e){return{left:c.constant(t),top:c.constant(e),translate:function(n,r){return Gr(t+n,e+r)}}},Xr=function(t,e){return void 0!==t?t:void 0!==e?e:0},Yr=function(t){var e,n=t.dom(),r=n.ownerDocument,o=r.body,i=X.fromDom(r.documentElement);return o===n?Gr(o.offsetLeft,o.offsetTop):Vr(t,i)?(e=n.getBoundingClientRect(),Gr(e.left,e.top)):Gr(0,0)},$r=function(t){var e=t.dom().ownerDocument,n=e.body,r=Ur(X.fromDom(e)),o=e.documentElement,i=Xr(r.pageYOffset,o.scrollTop),u=Xr(r.pageXOffset,o.scrollLeft),a=Xr(o.clientTop,n.clientTop),c=Xr(o.clientLeft,n.clientLeft);return Yr(t).translate(u-c,i-a)},Kr=L.immutable("row","y"),Jr=L.immutable("col","x"),Qr=function(t){return $r(t).left()+Nr(t)},Zr=function(t){return $r(t).left()},to=function(t,e){return Jr(t,Zr(e))},eo=function(t,e){return Jr(t,Qr(e))},no=function(t){return $r(t).top()},ro=function(t,e,n){if(0===n.length)return[];var r=A.map(n.slice(1),function(e,n){return e.map(function(e){return t(n,e)})}),o=n[n.length-1].map(function(t){return e(n.length-1,t)});return r.concat([o])},oo={delta:c.identity,positions:c.curry(ro,function(t,e){return Kr(t,no(e))},function(t,e){return Kr(t,no(e)+Dr(e))}),edge:no},io={delta:c.identity,edge:Zr,positions:c.curry(ro,to,eo)},uo={height:oo,rtl:{delta:function(t,e){return-t},edge:Qr,positions:c.curry(ro,eo,to)},ltr:io},ao={ltr:uo.ltr,rtl:uo.rtl};function co(t){var e=function(e){return t(e).isRtl()?ao.rtl:ao.ltr};return{delta:function(t,n){return e(n).delta(t,n)},edge:function(t){return e(t).edge(t)},positions:function(t,n){return e(n).positions(t,n)}}}var lo={getGridSize:function(t){var e=Le(t);return je.generate(e).grid()}},so=function(t){var e=t,n=function(){return e};return{get:n,set:function(t){e=t},clone:function(){return so(n())}}},fo=function(t,e){return mo(t,e,{validate:W.isFunction,label:"function"})},mo=function(t,e,n){if(0===e.length)throw new Error("You must specify at least one required field.");return M.validateStrArr("required",e),M.checkDupes(e),function(r){var o=I.keys(r);A.forall(e,function(t){return A.contains(o,t)})||M.reqMessage(e,o),t(e,o);var i=A.filter(e,function(t){return!n.validate(r[t],t)});return i.length>0&&M.invalidTypeMessage(i,n.label),r}},go=c.noop,po={exactly:c.curry(fo,function(t,e){var n=A.filter(e,function(e){return!A.contains(t,e)});n.length>0&&M.unsuppMessage(n)}),ensure:c.curry(fo,go),ensureWith:c.curry(mo,go)},ho=function(t){var e=pe.has(t,"colspan")?parseInt(pe.get(t,"colspan"),10):1,n=pe.has(t,"rowspan")?parseInt(pe.get(t,"rowspan"),10):1;return{element:c.constant(t),colspan:c.constant(e),rowspan:c.constant(n)}},vo=po.exactly(["cell","row","replace","gap"]),bo=function(t,e){vo(t);var n=so(g.none()),r=void 0!==e?e:ho,o=function(e){var n,o=r(e);return n=o,t.cell(n)},i=function(t){var e=o(t);return n.get().isNone()&&n.set(g.some(e)),u=g.some({item:t,replacement:e}),e},u=g.none();return{getOrInit:function(t,e){return u.fold(function(){return i(t)},function(n){return e(t,n.item)?n.replacement:i(t)})},cursor:n.get}},wo=function(t,e){return function(n){var r=so(g.none());vo(n);var o=[],i=function(i){var u=n.replace(i,e,{scope:t});return o.push({item:i,sub:u}),r.get().isNone()&&r.set(g.some(u)),u};return{replaceOrInit:function(t,e){return(n=t,r=e,A.find(o,function(t){return r(t.item,n)})).fold(function(){return i(t)},function(n){return e(t,n.item)?n.sub:i(t)});var n,r},cursor:r.get}}},yo=function(t){vo(t);var e=so(g.none());return{combine:function(n){return e.get().isNone()&&e.set(g.some(n)),function(){var e=t.cell({element:c.constant(n),colspan:c.constant(1),rowspan:c.constant(1)});return $e.remove(e,"width"),$e.remove(n,"width"),e}},cursor:e.get}},xo=["body","p","div","article","aside","figcaption","figure","footer","header","nav","section","ol","ul","table","thead","tfoot","tbody","caption","tr","td","th","h1","h2","h3","h4","h5","h6","blockquote","pre","address"],So=function(t,e){var n=t.property().name(e);return A.contains(xo,n)},Co=function(t,e){return A.contains(["br","img","hr","input"],t.property().name(e))},Ro=So,To=function(t,e){var n=t.property().name(e);return A.contains(["ol","ul"],n)},Do=Co,Ao=Dn(),ko=function(t){return Ro(Ao,t)},No=function(t){return To(Ao,t)},Oo=function(t){return Do(Ao,t)},Eo=function(t){var e,n=function(t){return"br"===se.name(t)},r=function(t){return bn.last(t).bind(function(e){var r,o=(r=e,ee.nextSibling(r).map(function(t){return!!ko(t)||(Oo(t)?"img"!==se.name(t):void 0)}).getOr(!1));return ee.parent(e).map(function(r){return!0===o||(i=r,"li"===se.name(i)||Ee.ancestor(i,No).isSome())||n(e)||ko(r)&&!Xt.eq(t,r)?[]:[X.fromTag("br")];var i})}).getOr([])},o=0===(e=A.bind(t,function(t){var e,o=ee.children(t);return e=o,A.forall(e,function(t){return n(t)||se.isText(t)&&0===dn.get(t).trim().length})?[]:o.concat(r(t))})).length?[X.fromTag("br")]:e;en.empty(t[0]),Ze.append(t[0],o)},Bo=function(t){return function(){for(var e=new Array(arguments.length),n=0;n<e.length;n++)e[n]=arguments[n];if(0===e.length)throw new Error("Can't merge zero objects");for(var r={},o=0;o<e.length;o++){var i=e[o];for(var u in i)i.hasOwnProperty(u)&&(r[u]=t(r[u],i[u]))}return r}},Io=Bo(function(t,e){return W.isObject(t)&&W.isObject(e)?Io(t,e):e}),Po=Bo(function(t,e){return e}),Wo={deepMerge:Io,merge:Po},_o=function(t){for(var e=[],n=function(t){e.push(t)},r=0;r<t.length;r++)t[r].each(n);return e},Mo=function(t,e){for(var n=0;n<t.length;n++){var r=e(t[n],n);if(r.isSome())return r}return g.none()},Lo=function(t,e){return U.rowcells(e,t.section())},qo=function(t,e){return t.cells()[e]},zo={addCell:function(t,e,n){var r=t.cells(),o=r.slice(0,e),i=r.slice(e),u=o.concat([n]).concat(i);return Lo(t,u)},setCells:Lo,mutateCell:function(t,e,n){t.cells()[e]=n},getCell:qo,getCellElement:function(t,e){return qo(t,e).element()},mapCells:function(t,e){var n=t.cells(),r=A.map(n,e);return U.rowcells(r,t.section())},cellLength:function(t){return t.cells().length}},Fo=function(t,e){if(0===t.length)return 0;var n=t[0];return A.findIndex(t,function(t){return!e(n.element(),t.element())}).fold(function(){return t.length},function(t){return t})},jo=function(t,e,n,r){var o,i,u,a,l=(o=t,i=e,o[i]).cells().slice(n),s=Fo(l,r),f=(u=t,a=n,A.map(u,function(t){return zo.getCell(t,a)})).slice(e),d=Fo(f,r);return{colspan:c.constant(s),rowspan:c.constant(d)}},Ho=function(t,e){var n=A.map(t,function(t,e){return A.map(t.cells(),function(t,e){return!1})});return A.map(t,function(r,o){var i=A.bind(r.cells(),function(r,i){if(!1===n[o][i]){var u=jo(t,o,i,e);return function(t,e,r,o){for(var i=t;i<t+r;i++)for(var u=e;u<e+o;u++)n[i][u]=!0}(o,i,u.rowspan(),u.colspan()),[U.detailnew(r.element(),u.rowspan(),u.colspan(),r.isNew())]}return[]});return U.rowdetails(i,r.section())})},Vo=function(t,e,n){for(var r=[],o=0;o<t.grid().rows();o++){for(var i=[],u=0;u<t.grid().columns();u++){var a=je.getAt(t,o,u).map(function(t){return U.elementnew(t.element(),n)}).getOrThunk(function(){return U.elementnew(e.gap(),!0)});i.push(a)}var c=U.rowcells(i,t.all()[o].section());r.push(c)}return r},Uo=function(t,e,n,r){n===r?pe.remove(t,e):pe.set(t,e,n)},Go=function(t,e){var n=[],r=[],o=function(e,o){var i;e.length>0?function(e,o){var i=Ie.child(t,o).getOrThunk(function(){var e=X.fromTag(o,ee.owner(t).dom());return Qe.append(t,e),e});en.empty(i);var u=A.map(e,function(t){t.isNew()&&n.push(t.element());var e=t.element();return en.empty(e),A.each(t.cells(),function(t){t.isNew()&&r.push(t.element()),Uo(t.element(),"colspan",t.colspan(),1),Uo(t.element(),"rowspan",t.rowspan(),1),Qe.append(e,t.element())}),e});Ze.append(i,u)}(e,o):(i=o,Ie.child(t,i).bind(en.remove))},i=[],u=[],a=[];return A.each(e,function(t){switch(t.section()){case"thead":i.push(t);break;case"tbody":u.push(t);break;case"tfoot":a.push(t)}}),o(i,"thead"),o(u,"tbody"),o(a,"tfoot"),{newRows:c.constant(n),newCells:c.constant(r)}},Xo=function(t){return A.map(t,function(t){var e=cn(t.element());return A.each(t.cells(),function(t){var n=ln(t.element());Uo(n,"colspan",t.colspan(),1),Uo(n,"rowspan",t.rowspan(),1),Qe.append(e,n)}),e})},Yo=function(t,e){for(var n=[],r=0;r<t;r++)n.push(e(r));return n},$o=function(t,e){for(var n=[],r=t;r<e;r++)n.push(r);return n},Ko=function(t,e){if(e<0||e>=t.length-1)return g.none();var n=t[e].fold(function(){var n=A.reverse(t.slice(0,e));return Mo(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return g.some({value:t,delta:0})}),r=t[e+1].fold(function(){var n=t.slice(e+1);return Mo(n,function(t,e){return t.map(function(t){return{value:t,delta:e+1}})})},function(t){return g.some({value:t,delta:1})});return n.bind(function(t){return r.map(function(e){var n=e.delta+t.delta;return Math.abs(e.value-t.value)/n})})},Jo=function(t,e,n){var r=t();return A.find(r,e).orThunk(function(){return g.from(r[0]).orThunk(n)}).map(function(t){return t.element()})},Qo=function(t){var e=t.grid(),n=$o(0,e.columns()),r=$o(0,e.rows());return A.map(n,function(e){return Jo(function(){return A.bind(r,function(n){return je.getAt(t,n,e).filter(function(t){return t.column()===e}).fold(c.constant([]),function(t){return[t]})})},function(t){return 1===t.colspan()},function(){return je.getAt(t,0,e)})})},Zo=function(t){var e=t.grid(),n=$o(0,e.rows()),r=$o(0,e.columns());return A.map(n,function(e){return Jo(function(){return A.bind(r,function(n){return je.getAt(t,e,n).filter(function(t){return t.row()===e}).fold(c.constant([]),function(t){return[t]})})},function(t){return 1===t.rowspan()},function(){return je.getAt(t,e,0)})})},ti=function(t,e,n,r,o){var i=X.fromTag("div");return $e.setAll(i,{position:"absolute",left:e-r/2+"px",top:n+"px",height:o+"px",width:r+"px"}),pe.setAll(i,{"data-column":t,role:"presentation"}),i},ei=function(t,e,n,r,o){var i=X.fromTag("div");return $e.setAll(i,{position:"absolute",left:e+"px",top:n-o/2+"px",height:o+"px",width:r+"px"}),pe.setAll(i,{"data-row":t,role:"presentation"}),i},ni=function(t){var e=t.replace(/\./g,"-");return{resolve:function(t){return e+"-"+t}}},ri={resolve:ni("ephox-snooker").resolve},oi=function(t,e){var n=pe.get(t,e);return void 0===n||""===n?[]:n.split(" ")},ii=oi,ui=function(t,e,n){var r=oi(t,e).concat([n]);pe.set(t,e,r.join(" "))},ai=function(t,e,n){var r=A.filter(oi(t,e),function(t){return t!==n});r.length>0?pe.set(t,e,r.join(" ")):pe.remove(t,e)},ci=function(t){return ii(t,"class")},li=function(t,e){return ui(t,"class",e)},si=function(t,e){return ai(t,"class",e)},fi=ci,di=li,mi=si,gi=function(t,e){A.contains(ci(t),e)?si(t,e):li(t,e)},pi=function(t){return void 0!==t.dom().classList},hi=function(t,e){return pi(t)&&t.dom().classList.contains(e)},vi={add:function(t,e){pi(t)?t.dom().classList.add(e):di(t,e)},remove:function(t,e){var n;pi(t)?t.dom().classList.remove(e):mi(t,e),0===(pi(n=t)?n.dom().classList:fi(n)).length&&pe.remove(n,"class")},toggle:function(t,e){return pi(t)?t.dom().classList.toggle(e):gi(t,e)},toggler:function(t,e){var n,r,o,i,u,a,c=pi(t),l=t.dom().classList;return n=function(){c?l.remove(e):mi(t,e)},r=function(){c?l.add(e):di(t,e)},o=hi(t,e),i=o||!1,{on:u=function(){r(),i=!0},off:a=function(){n(),i=!1},toggle:function(){(i?a:u)()},isOn:function(){return i}}},has:hi},bi=ri.resolve("resizer-bar"),wi=ri.resolve("resizer-rows"),yi=ri.resolve("resizer-cols"),xi=function(t){var e=xe.descendants(t.parent(),"."+bi);A.each(e,en.remove)},Si=function(t,e,n){var r=t.origin();A.each(e,function(e,o){e.each(function(e){var o=n(r,e);vi.add(o,bi),Qe.append(t.parent(),o)})})},Ci=function(t,e,n,r,o,i){var u,a,c,l,s=$r(e),f=n.length>0?o.positions(n,e):[];u=t,a=f,c=s,l=Nr(e),Si(u,a,function(t,e){var n=ei(e.row(),c.left()-t.left(),e.y()-t.top(),l,7);return vi.add(n,wi),n});var d,m,g,p,h=r.length>0?i.positions(r,e):[];d=t,m=h,g=s,p=Dr(e),Si(d,m,function(t,e){var n=ti(e.col(),e.x()-t.left(),g.top()-t.top(),7,p);return vi.add(n,yi),n})},Ri=function(t,e){var n=xe.descendants(t.parent(),"."+bi);A.each(n,e)},Ti={refresh:function(t,e,n,r){xi(t);var o=Le(e),i=je.generate(o),u=Zo(i),a=Qo(i);Ci(t,e,u,a,n,r)},hide:function(t){Ri(t,function(t){$e.set(t,"display","none")})},show:function(t){Ri(t,function(t){$e.set(t,"display","block")})},destroy:xi,isRowBar:function(t){return vi.has(t,wi)},isColBar:function(t){return vi.has(t,yi)}},Di=function(t,e){return A.map(t,function(t){var n,r=(n=t.details(),Mo(n,function(t){return ee.parent(t.element()).map(function(t){var e=ee.parent(t).isNone();return U.elementnew(t,e)})}).getOrThunk(function(){return U.elementnew(e.row(),!0)}));return U.rowdatanew(r.element(),t.details(),t.section(),r.isNew())})},Ai=function(t,e){var n=Ho(t,Xt.eq);return Di(n,e)},ki=function(t,e){var n=A.flatten(A.map(t.all(),function(t){return t.cells()}));return A.find(n,function(t){return Xt.eq(e,t.element())})},Ni=function(t,e,n,r,o){return function(i,u,a,l,s){var f=Le(u),d=je.generate(f);return e(d,a).map(function(e){var n=Vo(d,l,!1),r=t(n,e,Xt.eq,o(l)),i=Ai(r.grid(),l);return{grid:c.constant(i),cursor:r.cursor}}).fold(function(){return g.none()},function(t){var e=Go(u,t.grid());return n(u,t.grid(),s),r(u),Ti.refresh(i,u,uo.height,s),g.some({cursor:t.cursor,newRows:e.newRows,newCells:e.newCells})})}},Oi=Ai,Ei=function(t,e){return Me.cell(e.element()).bind(function(e){return ki(t,e)})},Bi=function(t,e){var n=A.map(e.selection(),function(e){return Me.cell(e).bind(function(e){return ki(t,e)})}),r=_o(n);return r.length>0?g.some(r):g.none()},Ii=function(t,e){return Me.cell(e.element()).bind(function(n){return ki(t,n).map(function(t){return Wo.merge(t,{generators:e.generators,clipboard:e.clipboard})})})},Pi=function(t,e){var n=A.map(e.selection(),function(e){return Me.cell(e).bind(function(e){return ki(t,e)})}),r=_o(n);return r.length>0?g.some(Wo.merge({cells:r},{generators:e.generators,clipboard:e.clipboard})):g.none()},Wi=function(t,e){return e.mergable()},_i=function(t,e){return e.unmergable()},Mi=function(t){return{is:function(e){return t===e},isValue:c.constant(!0),isError:c.constant(!1),getOr:c.constant(t),getOrThunk:c.constant(t),getOrDie:c.constant(t),or:function(e){return Mi(t)},orThunk:function(e){return Mi(t)},fold:function(e,n){return n(t)},map:function(e){return Mi(e(t))},each:function(e){e(t)},bind:function(e){return e(t)},exists:function(e){return e(t)},forall:function(e){return e(t)},toOption:function(){return g.some(t)}}},Li=function(t){return{is:c.constant(!1),isValue:c.constant(!1),isError:c.constant(!0),getOr:c.identity,getOrThunk:function(t){return t()},getOrDie:function(){return c.die(t)()},or:function(t){return t},orThunk:function(t){return t()},fold:function(e,n){return e(t)},map:function(e){return Li(t)},each:c.noop,bind:function(e){return Li(t)},exists:c.constant(!1),forall:c.constant(!0),toOption:g.none}},qi={value:Mi,error:Li},zi=function(t,e){return A.map(t,function(){return U.elementnew(e.cell(),!0)})},Fi=function(t,e,n){return t.concat(Yo(e,function(e){return zo.setCells(t[t.length-1],zi(t[t.length-1].cells(),n))}))},ji=function(t,e,n){return A.map(t,function(t){return zo.setCells(t,t.cells().concat(zi($o(0,e),n)))})},Hi=function(t,e,n){if(t.row()>=e.length||t.column()>zo.cellLength(e[0]))return qi.error("invalid start address out of table bounds, row: "+t.row()+", column: "+t.column());var r=e.slice(t.row()),o=r[0].cells().slice(t.column()),i=zo.cellLength(n[0]),u=n.length;return qi.value({rowDelta:c.constant(r.length-u),colDelta:c.constant(o.length-i)})},Vi=function(t,e){var n=zo.cellLength(t[0]),r=zo.cellLength(e[0]);return{rowDelta:c.constant(0),colDelta:c.constant(n-r)}},Ui=function(t,e,n){var r=e.colDelta()<0?ji:c.identity;return(e.rowDelta()<0?Fi:c.identity)(r(t,Math.abs(e.colDelta()),n),Math.abs(e.rowDelta()),n)},Gi=function(t,e,n,r){if(0===t.length)return t;for(var o=e.startRow();o<=e.finishRow();o++)for(var i=e.startCol();i<=e.finishCol();i++)zo.mutateCell(t[o],i,U.elementnew(r(),!1));return t},Xi=function(t,e,n,r){for(var o=!0,i=0;i<t.length;i++)for(var u=0;u<zo.cellLength(t[0]);u++){var a=n(zo.getCellElement(t[i],u),e);!0===a&&!1===o?zo.mutateCell(t[i],u,U.elementnew(r(),!0)):!0===a&&(o=!1)}return t},Yi=function(t,e,n,r){if(e>0&&e<t.length){var o=t[e-1].cells(),i=(u=o,a=n,A.foldl(u,function(t,e){return A.exists(t,function(t){return a(t.element(),e.element())})?t:t.concat([e])},[]));A.each(i,function(o){for(var i=g.none(),u=e;u<t.length;u++)for(var a=0;a<zo.cellLength(t[0]);a++){var c=t[u].cells()[a];n(c.element(),o.element())&&(i.isNone()&&(i=g.some(r())),i.each(function(e){zo.mutateCell(t[u],a,U.elementnew(e,!0))}))}})}var u,a;return t},$i=function(t,e,n,r,o){return Hi(t,e,n).map(function(i){var u=Ui(e,i,r);return function(t,e,n,r,o){for(var i,u,a,l,s,f,d,m=t.row(),g=t.column(),p=m+n.length,h=g+zo.cellLength(n[0]),v=m;v<p;v++)for(var b=g;b<h;b++){i=e,u=v,a=b,l=o,s=void 0,f=void 0,s=zo.getCell(i[u],a),f=c.curry(l,s.element()),d=i[u],i.length>1&&zo.cellLength(d)>1&&(a>0&&f(zo.getCellElement(d,a-1))||a<d.length-1&&f(zo.getCellElement(d,a+1))||u>0&&f(zo.getCellElement(i[u-1],a))||u<i.length-1&&f(zo.getCellElement(i[u+1],a)))&&Xi(e,zo.getCellElement(e[v],b),o,r.cell);var w=zo.getCellElement(n[v-m],b-g),y=r.replace(w);zo.mutateCell(e[v],b,U.elementnew(y,!0))}return e}(t,u,n,r,o)})},Ki=function(t,e,n,r,o){Yi(e,t,o,r.cell);var i=Vi(n,e),u=Ui(n,i,r),a=Vi(e,u),c=Ui(e,a,r);return c.slice(0,t).concat(u).concat(c.slice(t,c.length))},Ji=function(t,e,n,r,o){var i=t.slice(0,e),u=t.slice(e),a=zo.mapCells(t[n],function(n,i){return e>0&&e<t.length&&r(zo.getCellElement(t[e-1],i),zo.getCellElement(t[e],i))?zo.getCell(t[e],i):U.elementnew(o(n.element(),r),!0)});return i.concat([a]).concat(u)},Qi=function(t,e,n,r,o){return A.map(t,function(t){var i=e>0&&e<zo.cellLength(t)&&r(zo.getCellElement(t,e-1),zo.getCellElement(t,e))?zo.getCell(t,e):U.elementnew(o(zo.getCellElement(t,n),r),!0);return zo.addCell(t,e,i)})},Zi=function(t,e,n,r,o){var i=n+1;return A.map(t,function(t,u){var a=u===e?U.elementnew(o(zo.getCellElement(t,n),r),!0):zo.getCell(t,n);return zo.addCell(t,i,a)})},tu=function(t,e,n,r,o){var i=e+1,u=t.slice(0,i),a=t.slice(i),c=zo.mapCells(t[e],function(t,e){return e===n?U.elementnew(o(t.element(),r),!0):t});return u.concat([c]).concat(a)},eu=function(t,e,n){return t.slice(0,e).concat(t.slice(n+1))},nu=function(t,e,n){var r=A.map(t,function(t){var r=t.cells().slice(0,e).concat(t.cells().slice(n+1));return U.rowcells(r,t.section())});return A.filter(r,function(t){return t.cells().length>0})},ru=function(t,e,n,r){return A.map(t,function(t){return zo.mapCells(t,function(t){return o=t,A.exists(e,function(t){return n(o.element(),t.element())})?U.elementnew(r(t.element(),n),!0):t;var o})})},ou=function(t,e,n,r){return void 0!==zo.getCellElement(t[e],n)&&e>0&&r(zo.getCellElement(t[e-1],n),zo.getCellElement(t[e],n))},iu=function(t,e,n){return e>0&&n(zo.getCellElement(t,e-1),zo.getCellElement(t,e))},uu=function(t,e,n,r){var o=A.bind(t,function(r,o){return ou(t,o,e,n)||iu(r,e,n)?[]:[zo.getCell(r,e)]});return ru(t,o,n,r)},au=function(t,e,n,r){var o=t[e],i=A.bind(o.cells(),function(r,i){return ou(t,e,i,n)||iu(o,i,n)?[]:[r]});return ru(t,i,n,r)},cu=function(t){return{fold:t}},lu=function(){return cu(function(t,e,n,r,o){return t()})},su=function(t){return cu(function(e,n,r,o,i){return n(t)})},fu=function(t,e){return cu(function(n,r,o,i,u){return o(t,e)})},du=function(t,e,n){return cu(function(r,o,i,u,a){return u(t,e,n)})},mu=function(t,e){return cu(function(n,r,o,i,u){return u(t,e)})},gu=function(t,e,n,r){var o,i,u=t.slice(0),a=(i=e,0===(o=t).length?lu():1===o.length?su(0):0===i?fu(0,1):i===o.length-1?mu(i-1,i):i>0&&i<o.length-1?du(i-1,i,i+1):lu()),l=function(t){return A.map(t,c.constant(0))},s=c.constant(l(u)),f=function(t,e){if(n>=0){var o=Math.max(r.minCellWidth(),u[e]-n);return l(u.slice(0,t)).concat([n,o-u[e]]).concat(l(u.slice(e+1)))}var i=Math.max(r.minCellWidth(),u[t]+n),a=u[t]-i;return l(u.slice(0,t)).concat([i-u[t],a]).concat(l(u.slice(e+1)))},d=f;return a.fold(s,function(t){return r.singleColumnWidth(u[t],n)},d,function(t,e,n){return f(e,n)},function(t,e){if(n>=0)return l(u.slice(0,e)).concat([n]);var o=Math.max(r.minCellWidth(),u[e]+n);return l(u.slice(0,e)).concat([o-u[e]])})},pu=function(t,e){return pe.has(t,e)&&parseInt(pe.get(t,e),10)>1},hu={hasColspan:function(t){return pu(t,"colspan")},hasRowspan:function(t){return pu(t,"rowspan")},minWidth:c.constant(10),minHeight:c.constant(10),getInt:function(t,e){return parseInt($e.get(t,e),10)}},vu=function(t,e,n){return $e.getRaw(t,e).fold(function(){return n(t)+"px"},function(t){return t})},bu=function(t){return vu(t,"width",jr.getPixelWidth)},wu=function(t){return vu(t,"height",jr.getHeight)},yu=function(t,e,n,r,o){var i=Qo(t),u=A.map(i,function(t){return t.map(e.edge)});return A.map(i,function(t,e){return t.filter(c.not(hu.hasColspan)).fold(function(){var t=Ko(u,e);return r(t)},function(t){return n(t,o)})})},xu=function(t){return t.map(function(t){return t+"px"}).getOr("")},Su=function(t,e,n,r){var o=Zo(t),i=A.map(o,function(t){return t.map(e.edge)});return A.map(o,function(t,e){return t.filter(c.not(hu.hasRowspan)).fold(function(){var t=Ko(i,e);return r(t)},function(t){return n(t)})})},Cu={getRawWidths:function(t,e){return yu(t,e,bu,xu)},getPixelWidths:function(t,e,n){return yu(t,e,jr.getPixelWidth,function(t){return t.getOrThunk(n.minCellWidth)},n)},getPercentageWidths:function(t,e,n){return yu(t,e,jr.getPercentageWidth,function(t){return t.fold(function(){return n.minCellWidth()},function(t){return t/n.pixelWidth()*100})},n)},getPixelHeights:function(t,e){return Su(t,e,jr.getHeight,function(t){return t.getOrThunk(hu.minHeight)})},getRawHeights:function(t,e){return Su(t,e,wu,xu)}},Ru=function(t,e,n){for(var r=0,o=t;o<e;o++)r+=void 0!==n[o]?n[o]:0;return r},Tu=function(t,e){var n=je.justCells(t);return A.map(n,function(t){var n=Ru(t.column(),t.column()+t.colspan(),e);return{element:t.element,width:c.constant(n),colspan:t.colspan}})},Du=function(t,e){var n=je.justCells(t);return A.map(n,function(t){var n=Ru(t.row(),t.row()+t.rowspan(),e);return{element:t.element,height:c.constant(n),rowspan:t.rowspan}})},Au=function(t,e){return A.map(t.all(),function(t,n){return{element:t.element,height:c.constant(e[n])}})},ku=function(t){var e=parseInt(t,10),n=c.identity;return{width:c.constant(e),pixelWidth:c.constant(e),getWidths:Cu.getPixelWidths,getCellDelta:n,singleColumnWidth:function(t,e){return[Math.max(hu.minWidth(),t+e)-t]},minCellWidth:hu.minWidth,setElementWidth:jr.setPixelWidth,setTableWidth:function(t,e,n){var r=A.foldr(e,function(t,e){return t+e},0);jr.setPixelWidth(t,r)}}},Nu=function(t,e){if(jr.percentageBasedSizeRegex().test(e)){var n=jr.percentageBasedSizeRegex().exec(e);return o=n[1],i=t,u=parseFloat(o),a=kr(i),{width:c.constant(u),pixelWidth:c.constant(a),getWidths:Cu.getPercentageWidths,getCellDelta:function(t){return t/a*100},singleColumnWidth:function(t,e){return[100-t]},minCellWidth:function(){return hu.minWidth()/a*100},setElementWidth:jr.setPercentageWidth,setTableWidth:function(t,e,n){var r=u+n;jr.setPercentageWidth(t,r)}}}if(jr.pixelBasedSizeRegex().test(e)){var r=jr.pixelBasedSizeRegex().exec(e);return ku(r[1])}var o,i,u,a,l=kr(t);return ku(l)},Ou=function(t){return jr.getRawWidth(t).fold(function(){var e=kr(t);return ku(e)},function(e){return Nu(t,e)})},Eu=function(t){return je.generate(t)},Bu=function(t){var e=Le(t);return Eu(e)},Iu={adjustWidth:function(t,e,n,r){var o=Ou(t),i=o.getCellDelta(e),u=Bu(t),a=o.getWidths(u,r,o),c=gu(a,n,i,o),l=A.map(c,function(t,e){return t+a[e]}),s=Tu(u,l);A.each(s,function(t){o.setElementWidth(t.element(),t.width())}),n===u.grid().columns()-1&&o.setTableWidth(t,l,i)},adjustHeight:function(t,e,n,r){var o=Bu(t),i=Cu.getPixelHeights(o,r),u=A.map(i,function(t,r){return n===r?Math.max(e+t,hu.minHeight()):t}),a=Du(o,u),c=Au(o,u);A.each(c,function(t){jr.setHeight(t.element(),t.height())}),A.each(a,function(t){jr.setHeight(t.element(),t.height())});var l,s=(l=u,A.foldr(l,function(t,e){return t+e},0));jr.setHeight(t,s)},adjustWidthTo:function(t,e,n){var r=Ou(t),o=Eu(e),i=r.getWidths(o,n,r),u=Tu(o,i);A.each(u,function(t){r.setElementWidth(t.element(),t.width())});var a=A.foldr(i,function(t,e){return e+t},0);u.length>0&&r.setElementWidth(t,a)}},Pu=function(t){0===Me.cells(t).length&&en.remove(t)},Wu=L.immutable("grid","cursor"),_u=function(t,e,n){return Mu(t,e,n).orThunk(function(){return Mu(t,0,0)})},Mu=function(t,e,n){return g.from(t[e]).bind(function(t){return g.from(t.cells()[n]).bind(function(t){return g.from(t.element())})})},Lu=function(t,e,n){return Wu(t,Mu(t,e,n))},qu=function(t){return A.foldl(t,function(t,e){return A.exists(t,function(t){return t.row()===e.row()})?t:t.concat([e])},[]).sort(function(t,e){return t.row()-e.row()})},zu=function(t){return A.foldl(t,function(t,e){return A.exists(t,function(t){return t.column()===e.column()})?t:t.concat([e])},[]).sort(function(t,e){return t.column()-e.column()})},Fu=function(t,e,n){var r=qe(t,n),o=je.generate(r);return Vo(o,e,!0)},ju=Iu.adjustWidthTo,Hu={insertRowBefore:Ni(function(t,e,n,r){var o=e.row(),i=e.row(),u=Ji(t,i,o,n,r.getOrInit);return Lu(u,i,e.column())},Ei,c.noop,c.noop,bo),insertRowsBefore:Ni(function(t,e,n,r){var o=e[0].row(),i=e[0].row(),u=qu(e),a=A.foldl(u,function(t,e){return Ji(t,i,o,n,r.getOrInit)},t);return Lu(a,i,e[0].column())},Bi,c.noop,c.noop,bo),insertRowAfter:Ni(function(t,e,n,r){var o=e.row(),i=e.row()+e.rowspan(),u=Ji(t,i,o,n,r.getOrInit);return Lu(u,i,e.column())},Ei,c.noop,c.noop,bo),insertRowsAfter:Ni(function(t,e,n,r){var o=qu(e),i=o[o.length-1].row(),u=o[o.length-1].row()+o[o.length-1].rowspan(),a=A.foldl(o,function(t,e){return Ji(t,u,i,n,r.getOrInit)},t);return Lu(a,u,e[0].column())},Bi,c.noop,c.noop,bo),insertColumnBefore:Ni(function(t,e,n,r){var o=e.column(),i=e.column(),u=Qi(t,i,o,n,r.getOrInit);return Lu(u,e.row(),i)},Ei,ju,c.noop,bo),insertColumnsBefore:Ni(function(t,e,n,r){var o=zu(e),i=o[0].column(),u=o[0].column(),a=A.foldl(o,function(t,e){return Qi(t,u,i,n,r.getOrInit)},t);return Lu(a,e[0].row(),u)},Bi,ju,c.noop,bo),insertColumnAfter:Ni(function(t,e,n,r){var o=e.column(),i=e.column()+e.colspan(),u=Qi(t,i,o,n,r.getOrInit);return Lu(u,e.row(),i)},Ei,ju,c.noop,bo),insertColumnsAfter:Ni(function(t,e,n,r){var o=e[e.length-1].column(),i=e[e.length-1].column()+e[e.length-1].colspan(),u=zu(e),a=A.foldl(u,function(t,e){return Qi(t,i,o,n,r.getOrInit)},t);return Lu(a,e[0].row(),i)},Bi,ju,c.noop,bo),splitCellIntoColumns:Ni(function(t,e,n,r){var o=Zi(t,e.row(),e.column(),n,r.getOrInit);return Lu(o,e.row(),e.column())},Ei,ju,c.noop,bo),splitCellIntoRows:Ni(function(t,e,n,r){var o=tu(t,e.row(),e.column(),n,r.getOrInit);return Lu(o,e.row(),e.column())},Ei,c.noop,c.noop,bo),eraseColumns:Ni(function(t,e,n,r){var o=zu(e),i=nu(t,o[0].column(),o[o.length-1].column()),u=_u(i,e[0].row(),e[0].column());return Wu(i,u)},Bi,ju,Pu,bo),eraseRows:Ni(function(t,e,n,r){var o=qu(e),i=eu(t,o[0].row(),o[o.length-1].row()),u=_u(i,e[0].row(),e[0].column());return Wu(i,u)},Bi,c.noop,Pu,bo),makeColumnHeader:Ni(function(t,e,n,r){var o=uu(t,e.column(),n,r.replaceOrInit);return Lu(o,e.row(),e.column())},Ei,c.noop,c.noop,wo("row","th")),unmakeColumnHeader:Ni(function(t,e,n,r){var o=uu(t,e.column(),n,r.replaceOrInit);return Lu(o,e.row(),e.column())},Ei,c.noop,c.noop,wo(null,"td")),makeRowHeader:Ni(function(t,e,n,r){var o=au(t,e.row(),n,r.replaceOrInit);return Lu(o,e.row(),e.column())},Ei,c.noop,c.noop,wo("col","th")),unmakeRowHeader:Ni(function(t,e,n,r){var o=au(t,e.row(),n,r.replaceOrInit);return Lu(o,e.row(),e.column())},Ei,c.noop,c.noop,wo(null,"td")),mergeCells:Ni(function(t,e,n,r){var o=e.cells();Eo(o);var i=Gi(t,e.bounds(),n,c.constant(o[0]));return Wu(i,g.from(o[0]))},Wi,c.noop,c.noop,yo),unmergeCells:Ni(function(t,e,n,r){var o=A.foldr(e,function(t,e){return Xi(t,e,n,r.combine(e))},t);return Wu(o,g.from(e[0]))},_i,ju,c.noop,yo),pasteCells:Ni(function(t,e,n,r){var o,i,u,a,c=(o=e.clipboard(),i=e.generators(),u=Le(o),a=je.generate(u),Vo(a,i,!0)),l=U.address(e.row(),e.column());return $i(l,t,c,e.generators(),n).fold(function(){return Wu(t,g.some(e.element()))},function(t){var n=_u(t,e.row(),e.column());return Wu(t,n)})},Ii,ju,c.noop,bo),pasteRowsBefore:Ni(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[0].row(),u=Fu(e.clipboard(),e.generators(),o),a=Ki(i,t,u,e.generators(),n),c=_u(a,e.cells[0].row(),e.cells[0].column());return Wu(a,c)},Pi,c.noop,c.noop,bo),pasteRowsAfter:Ni(function(t,e,n,r){var o=t[e.cells[0].row()],i=e.cells[e.cells.length-1].row()+e.cells[e.cells.length-1].rowspan(),u=Fu(e.clipboard(),e.generators(),o),a=Ki(i,t,u,e.generators(),n),c=_u(a,e.cells[0].row(),e.cells[0].column());return Wu(a,c)},Pi,c.noop,c.noop,bo)},Vu=function(t){return X.fromDom(t.getBody())},Uu={getBody:Vu,getIsRoot:function(t){return function(e){return Xt.eq(e,Vu(t))}},addSizeSuffix:function(t){return/^[0-9]+$/.test(t)&&(t+="px"),t},removePxSuffix:function(t){return t?t.replace(/px$/,""):""}},Gu=function(t){return"rtl"===$e.get(t,"direction")?"rtl":"ltr"},Xu={onDirection:function(t,e){return function(n){return"rtl"===Gu(n)?e:t}},getDirection:Gu},Yu={isRtl:c.constant(!1)},$u={isRtl:c.constant(!0)},Ku={directionAt:function(t){return"rtl"===Xu.getDirection(t)?$u:Yu}};function Ju(t,e){var n,r=function(t){return"table"===se.name(Uu.getBody(t))};!1!==t.settings.table_clone_elements&&("string"==typeof t.settings.table_clone_elements?n=t.settings.table_clone_elements.split(/[ ,]/):Array.isArray(t.settings.table_clone_elements)&&(n=t.settings.table_clone_elements));var o=g.from(n),i=function(e,n,r,i){return function(u,a){var c=xe.descendants(u,"td[data-mce-style],th[data-mce-style]");A.each(c,function(t){pe.remove(t,"data-mce-style")});var l=i(),s=X.fromDom(t.getDoc()),f=co(Ku.directionAt),d=Cn.cellOperations(r,s,o);return n(u)?e(l,u,a,d,f).bind(function(e){return A.each(e.newRows(),function(e){var n;n=e,t.fire("newrow",{node:n.dom()}),n.dom()}),A.each(e.newCells(),function(e){var n;n=e,t.fire("newcell",{node:n.dom()}),n.dom()}),e.cursor().map(function(e){var n=t.dom.createRng();return n.setStart(e.dom(),0),n.setEnd(e.dom(),0),n})}):g.none()}};return{deleteRow:i(Hu.eraseRows,function(e){var n=lo.getGridSize(e);return!1===r(t)||n.rows()>1},c.noop,e),deleteColumn:i(Hu.eraseColumns,function(e){var n=lo.getGridSize(e);return!1===r(t)||n.columns()>1},c.noop,e),insertRowsBefore:i(Hu.insertRowsBefore,c.always,c.noop,e),insertRowsAfter:i(Hu.insertRowsAfter,c.always,c.noop,e),insertColumnsBefore:i(Hu.insertColumnsBefore,c.always,Hr.halve,e),insertColumnsAfter:i(Hu.insertColumnsAfter,c.always,Hr.halve,e),mergeCells:i(Hu.mergeCells,c.always,c.noop,e),unmergeCells:i(Hu.unmergeCells,c.always,c.noop,e),pasteRowsBefore:i(Hu.pasteRowsBefore,c.always,c.noop,e),pasteRowsAfter:i(Hu.pasteRowsAfter,c.always,c.noop,e),pasteCells:i(Hu.pasteCells,c.always,c.noop,e)}}var Qu=function(t,e,n){var r=Le(t),o=je.generate(r);return Bi(o,e).map(function(t){var e=Vo(o,n,!1).slice(t[0].row(),t[t.length-1].row()+t[t.length-1].rowspan()),r=Oi(e,n);return Xo(r)})},Zu=tinymce.util.Tools.resolve("tinymce.util.Tools"),ta=tinymce.util.Tools.resolve("tinymce.Env"),ea={applyAlign:function(t,e,n){n&&t.formatter.apply("align"+n,{},e)},applyVAlign:function(t,e,n){n&&t.formatter.apply("valign"+n,{},e)},unApplyAlign:function(t,e){Zu.each("left center right".split(" "),function(n){t.formatter.remove("align"+n,{},e)})},unApplyVAlign:function(t,e){Zu.each("top middle bottom".split(" "),function(n){t.formatter.remove("valign"+n,{},e)})},getTDTHOverallStyle:function(t,e,n){var r;return r=function(e,r){for(var o=0;o<r.length;o++){var i=t.getStyle(r[o],n);if(void 0===e&&(e=i),e!==i)return""}return e}(r,t.select("td,th",e))}},na=function(t,e){var n=t.dom,r=e.control.rootControl,o=r.toJSON(),i=n.parseStyle(o.style);"style"===e.control.name()?(r.find("#borderStyle").value(i["border-style"]||"")[0].fire("select"),r.find("#borderColor").value(i["border-color"]||"")[0].fire("change"),r.find("#backgroundColor").value(i["background-color"]||"")[0].fire("change"),r.find("#width").value(i.width||"").fire("change"),r.find("#height").value(i.height||"").fire("change")):(i["border-style"]=o.borderStyle,i["border-color"]=o.borderColor,i["background-color"]=o.backgroundColor,i.width=o.width?Uu.addSizeSuffix(o.width):"",i.height=o.height?Uu.addSizeSuffix(o.height):""),r.find("#style").value(n.serializeStyle(n.parseStyle(n.serializeStyle(i))))},ra={createStyleForm:function(t){var e=function(){var e=t.settings.color_picker_callback;if(e)return function(n){return e.call(t,function(t){n.control.value(t).fire("change")},n.control.value())}};return{title:"Advanced",type:"form",defaults:{onchange:c.curry(na,t)},items:[{label:"Style",name:"style",type:"textbox"},{type:"form",padding:0,formItemDefaults:{layout:"grid",alignH:["start","right"]},defaults:{size:7},items:[{label:"Border style",type:"listbox",name:"borderStyle",width:90,onselect:c.curry(na,t),values:[{text:"Select...",value:""},{text:"Solid",value:"solid"},{text:"Dotted",value:"dotted"},{text:"Dashed",value:"dashed"},{text:"Double",value:"double"},{text:"Groove",value:"groove"},{text:"Ridge",value:"ridge"},{text:"Inset",value:"inset"},{text:"Outset",value:"outset"},{text:"None",value:"none"},{text:"Hidden",value:"hidden"}]},{label:"Border color",type:"colorbox",name:"borderColor",onaction:e()},{label:"Background color",type:"colorbox",name:"backgroundColor",onaction:e()}]}]}},buildListItems:function(t,e,n){var r=function(t,n){return n=n||[],Zu.each(t,function(t){var o={text:t.text||t.title};t.menu?o.menu=r(t.menu):(o.value=t.value,e&&e(o)),n.push(o)}),n};return r(t,n||[])},updateStyleField:na,extractAdvancedStyles:function(t,e){var n=t.parseStyle(t.getAttrib(e,"style")),r={};return n["border-style"]&&(r.borderStyle=n["border-style"]),n["border-color"]&&(r.borderColor=n["border-color"]),n["background-color"]&&(r.backgroundColor=n["background-color"]),r.style=t.serializeStyle(n),r}};function oa(t,e,n,r){if("TD"===e.tagName||"TH"===e.tagName)t.setStyle(e,n,r);else if(e.children)for(var o=0;o<e.children.length;o++)oa(t,e.children[o],n,r)}var ia=function(t,e,n){var r,o,i=t.dom;ra.updateStyleField(t,n),!1===(o=n.control.rootControl.toJSON()).class&&delete o.class,t.undoManager.transact(function(){e||(e=Sr.insert(t,o.cols||1,o.rows||1)),function(t,e,n){var r=t.dom,o={},i={};if(o.class=n.class,i.height=Uu.addSizeSuffix(n.height),r.getAttrib(e,"width")&&!t.settings.table_style_by_css?o.width=Uu.removePxSuffix(n.width):i.width=Uu.addSizeSuffix(n.width),t.settings.table_style_by_css?(i["border-width"]=Uu.addSizeSuffix(n.border),i["border-spacing"]=Uu.addSizeSuffix(n.cellspacing),Zu.extend(o,{"data-mce-border-color":n.borderColor,"data-mce-cell-padding":n.cellpadding,"data-mce-border":n.border})):Zu.extend(o,{border:n.border,cellpadding:n.cellpadding,cellspacing:n.cellspacing}),t.settings.table_style_by_css&&e.children)for(var u=0;u<e.children.length;u++)oa(r,e.children[u],{"border-width":Uu.addSizeSuffix(n.border),"border-color":n.borderColor,padding:Uu.addSizeSuffix(n.cellpadding)});n.style?Zu.extend(i,r.parseStyle(n.style)):i=Zu.extend({},r.parseStyle(r.getAttrib(e,"style")),i),o.style=r.serializeStyle(i),r.setAttribs(e,o)}(t,e,o),(r=i.select("caption",e)[0])&&!o.caption&&i.remove(r),!r&&o.caption&&((r=i.create("caption")).innerHTML=ta.ie?" ":'<br data-mce-bogus="1"/>',e.insertBefore(r,e.firstChild)),ea.unApplyAlign(t,e),o.align&&ea.applyAlign(t,e,o.align),t.focus(),t.addVisual()})},ua=function(t,e){var n,r,o,i,u,a,l,s,f,d=t.dom,m={};!0===e?(n=d.getParent(t.selection.getStart(),"table"))&&(l=n,s=(a=t).dom,f={width:s.getStyle(l,"width")||s.getAttrib(l,"width"),height:s.getStyle(l,"height")||s.getAttrib(l,"height"),cellspacing:s.getStyle(l,"border-spacing")||s.getAttrib(l,"cellspacing"),cellpadding:s.getAttrib(l,"data-mce-cell-padding")||s.getAttrib(l,"cellpadding")||ea.getTDTHOverallStyle(a.dom,l,"padding"),border:s.getAttrib(l,"data-mce-border")||s.getAttrib(l,"border")||ea.getTDTHOverallStyle(a.dom,l,"border"),borderColor:s.getAttrib(l,"data-mce-border-color"),caption:!!s.select("caption",l)[0],class:s.getAttrib(l,"class")},Zu.each("left center right".split(" "),function(t){a.formatter.matchNode(l,"align"+t)&&(f.align=t)}),!1!==a.settings.table_advtab&&Zu.extend(f,ra.extractAdvancedStyles(s,l)),m=f):(r={label:"Cols",name:"cols"},o={label:"Rows",name:"rows"}),t.settings.table_class_list&&(m.class&&(m.class=m.class.replace(/\s*mce\-item\-table\s*/g,"")),i={name:"class",type:"listbox",label:"Class",values:ra.buildListItems(t.settings.table_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"table",classes:[e.value]})})})}),u={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",labelGapCalc:!1,padding:0,layout:"grid",columns:2,defaults:{type:"textbox",maxWidth:50},items:!1!==t.settings.table_appearance_options?[r,o,{label:"Width",name:"width",onchange:c.curry(ra.updateStyleField,t)},{label:"Height",name:"height",onchange:c.curry(ra.updateStyleField,t)},{label:"Cell spacing",name:"cellspacing"},{label:"Cell padding",name:"cellpadding"},{label:"Border",name:"border"},{label:"Caption",name:"caption",type:"checkbox"}]:[r,o,{label:"Width",name:"width",onchange:c.curry(ra.updateStyleField,t)},{label:"Height",name:"height",onchange:c.curry(ra.updateStyleField,t)}]},{label:"Alignment",name:"align",type:"listbox",text:"None",values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},i]},!1!==t.settings.table_advtab?t.windowManager.open({title:"Table properties",data:m,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ra.createStyleForm(t)],onsubmit:c.curry(ia,t,n)}):t.windowManager.open({title:"Table properties",data:m,body:u,onsubmit:c.curry(ia,t,n)})},aa=function(t,e,n){var r=t.getParent(e,"table"),o=e.parentNode,i=t.select(n,r)[0];i||(i=t.create(n),r.firstChild?"CAPTION"===r.firstChild.nodeName?t.insertAfter(i,r.firstChild):r.insertBefore(i,r.firstChild):r.appendChild(i)),i.appendChild(e),o.hasChildNodes()||t.remove(o)};function ca(t,e,n){var r,o=t.dom;function i(t,e,n){n&&o.setAttrib(t,e,n)}ra.updateStyleField(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact(function(){Zu.each(e,function(n){var u,a,c;i(n,"scope",r.scope),i(n,"style",r.style),i(n,"class",r.class),u=n,a="height",(c=Uu.addSizeSuffix(r.height))&&o.setStyle(u,a,c),r.type!==n.parentNode.nodeName.toLowerCase()&&aa(t.dom,n,r.type),1===e.length&&ea.unApplyAlign(t,n),r.align&&ea.applyAlign(t,n,r.align)}),t.focus()})}var la=function(t){var e,n,r,o,i,u,a,l,s,f,d=t.dom,m=[];e=d.getParent(t.selection.getStart(),"table"),n=d.getParent(t.selection.getStart(),"td,th"),Zu.each(e.rows,function(t){Zu.each(t.cells,function(e){if(d.getAttrib(e,"data-mce-selected")||e===n)return m.push(t),!1})}),(r=m[0])&&(m.length>1?i={height:"",scope:"",class:"",align:"",type:r.parentNode.nodeName.toLowerCase()}:(l=r,s=(a=t).dom,(f={height:s.getStyle(l,"height")||s.getAttrib(l,"height"),scope:s.getAttrib(l,"scope"),class:s.getAttrib(l,"class")}).type=l.parentNode.nodeName.toLowerCase(),Zu.each("left center right".split(" "),function(t){a.formatter.matchNode(l,"align"+t)&&(f.align=t)}),!1!==a.settings.table_row_advtab&&Zu.extend(f,ra.extractAdvancedStyles(s,l)),i=f),t.settings.table_row_class_list&&(o={name:"class",type:"listbox",label:"Class",values:ra.buildListItems(t.settings.table_row_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"tr",classes:[e.value]})})})}),u={type:"form",columns:2,padding:0,defaults:{type:"textbox"},items:[{type:"listbox",name:"type",label:"Row type",text:"Header",maxWidth:null,values:[{text:"Header",value:"thead"},{text:"Body",value:"tbody"},{text:"Footer",value:"tfoot"}]},{type:"listbox",name:"align",label:"Alignment",text:"None",maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"Height",name:"height"},o]},!1!==t.settings.table_row_advtab?t.windowManager.open({title:"Row properties",data:i,bodyType:"tabpanel",body:[{title:"General",type:"form",items:u},ra.createStyleForm(t)],onsubmit:c.curry(ca,t,m)}):t.windowManager.open({title:"Row properties",data:i,body:u,onsubmit:c.curry(ca,t,m)}))},sa=function(t,e,n){var r,o=t.dom;function i(t,e,n){n&&o.setAttrib(t,e,n)}function u(t,e,n){n&&o.setStyle(t,e,n)}ra.updateStyleField(t,n),r=n.control.rootControl.toJSON(),t.undoManager.transact(function(){Zu.each(e,function(n){var a,c;i(n,"scope",r.scope),1===e.length?i(n,"style",r.style):(a=n,c=r.style,a.style.cssText+=";"+c),i(n,"class",r.class),u(n,"width",Uu.addSizeSuffix(r.width)),u(n,"height",Uu.addSizeSuffix(r.height)),r.type&&n.nodeName.toLowerCase()!==r.type&&(n=o.rename(n,r.type)),1===e.length&&(ea.unApplyAlign(t,n),ea.unApplyVAlign(t,n)),r.align&&ea.applyAlign(t,n,r.align),r.valign&&ea.applyVAlign(t,n,r.valign)}),t.focus()})},fa=function(t){var e,n,r,o=[];if(o=t.dom.select("td[data-mce-selected],th[data-mce-selected]"),e=t.dom.getParent(t.selection.getStart(),"td,th"),!o.length&&e&&o.push(e),e=e||o[0]){var i,u,a,l;o.length>1?n={width:"",height:"",scope:"",class:"",align:"",style:"",type:e.nodeName.toLowerCase()}:(u=e,a=(i=t).dom,(l={width:a.getStyle(u,"width")||a.getAttrib(u,"width"),height:a.getStyle(u,"height")||a.getAttrib(u,"height"),scope:a.getAttrib(u,"scope"),class:a.getAttrib(u,"class")}).type=u.nodeName.toLowerCase(),Zu.each("left center right".split(" "),function(t){i.formatter.matchNode(u,"align"+t)&&(l.align=t)}),Zu.each("top middle bottom".split(" "),function(t){i.formatter.matchNode(u,"valign"+t)&&(l.valign=t)}),!1!==i.settings.table_cell_advtab&&Zu.extend(l,ra.extractAdvancedStyles(a,u)),n=l),t.settings.table_cell_class_list&&(r={name:"class",type:"listbox",label:"Class",values:ra.buildListItems(t.settings.table_cell_class_list,function(e){e.value&&(e.textStyle=function(){return t.formatter.getCssText({block:"td",classes:[e.value]})})})});var s={type:"form",layout:"flex",direction:"column",labelGapCalc:"children",padding:0,items:[{type:"form",layout:"grid",columns:2,labelGapCalc:!1,padding:0,defaults:{type:"textbox",maxWidth:50},items:[{label:"Width",name:"width",onchange:c.curry(ra.updateStyleField,t)},{label:"Height",name:"height",onchange:c.curry(ra.updateStyleField,t)},{label:"Cell type",name:"type",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"Cell",value:"td"},{text:"Header cell",value:"th"}]},{label:"Scope",name:"scope",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Row",value:"row"},{text:"Column",value:"col"},{text:"Row group",value:"rowgroup"},{text:"Column group",value:"colgroup"}]},{label:"H Align",name:"align",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Left",value:"left"},{text:"Center",value:"center"},{text:"Right",value:"right"}]},{label:"V Align",name:"valign",type:"listbox",text:"None",minWidth:90,maxWidth:null,values:[{text:"None",value:""},{text:"Top",value:"top"},{text:"Middle",value:"middle"},{text:"Bottom",value:"bottom"}]}]},r]};!1!==t.settings.table_cell_advtab?t.windowManager.open({title:"Cell properties",bodyType:"tabpanel",data:n,body:[{title:"General",type:"form",items:s},ra.createStyleForm(t)],onsubmit:c.curry(sa,t,o)}):t.windowManager.open({title:"Cell properties",data:n,body:s,onsubmit:c.curry(sa,t,o)})}},da=Zu.each,ma=g.none(),ga={registerCommands:function(t,e,n,r){var o=Uu.getIsRoot(t),i=function(){return X.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"))},u=function(t){return Me.table(t,o)},a=function(e){var o=i();u(o).each(function(i){var u=hr.forMenu(r,i,o);e(i,u).each(function(e){t.selection.setRng(e),t.focus(),n.clear(i)})})},l=function(e){var n=i();return u(n).bind(function(e){var o=X.fromDom(t.getDoc()),i=hr.forMenu(r,e,n),u=Cn.cellOperations(c.noop,o,g.none());return Qu(e,i,u)})},s=function(e){ma.each(function(o){var a=A.map(o,function(t){return ln(t)}),c=i();u(c).bind(function(o){var i=X.fromDom(t.getDoc()),u=Cn.paste(i),l=hr.pasteRows(r,o,c,a,u);e(o,l).each(function(e){t.selection.setRng(e),t.focus(),n.clear(o)})})})};da({mceTableSplitCells:function(){a(e.unmergeCells)},mceTableMergeCells:function(){a(e.mergeCells)},mceTableInsertRowBefore:function(){a(e.insertRowsBefore)},mceTableInsertRowAfter:function(){a(e.insertRowsAfter)},mceTableInsertColBefore:function(){a(e.insertColumnsBefore)},mceTableInsertColAfter:function(){a(e.insertColumnsAfter)},mceTableDeleteCol:function(){a(e.deleteColumn)},mceTableDeleteRow:function(){a(e.deleteRow)},mceTableCutRow:function(t){ma=l(),a(e.deleteRow)},mceTableCopyRow:function(t){ma=l()},mceTablePasteRowBefore:function(t){s(e.pasteRowsBefore)},mceTablePasteRowAfter:function(t){s(e.pasteRowsAfter)},mceTableDelete:function(){var e=X.fromDom(t.dom.getParent(t.selection.getStart(),"th,td"));Me.table(e,o).filter(c.not(o)).each(function(e){var n=X.fromText("");Qe.after(e,n),en.remove(e);var r=t.dom.createRng();r.setStart(n.dom(),0),r.setEnd(n.dom(),0),t.selection.setRng(r)})}},function(e,n){t.addCommand(n,e)}),da({mceInsertTable:c.curry(ua,t),mceTableProps:c.curry(ua,t,!0),mceTableRowProps:c.curry(la,t),mceTableCellProps:c.curry(fa,t)},function(e,n){t.addCommand(n,function(t,n){e(n)})})},getClipboardRows:function(){return ma.fold(function(){},function(t){return A.map(t,function(t){return t.dom()})})},setClipboardRows:function(t){var e=A.map(t,X.fromDom);ma=g.from(e)}},pa={only:function(t){var e=g.from(t.dom().documentElement).map(X.fromDom).getOr(t);return{parent:c.constant(e),view:c.constant(t),origin:c.constant(Gr(0,0))}},detached:function(t,e){var n=c.curry($r,e);return{parent:c.constant(e),view:c.constant(t),origin:n}},body:function(t,e){return{parent:c.constant(e),view:c.constant(t),origin:c.constant(Gr(0,0))}}};function ha(t){var e=L.immutable.apply(null,t),n=[];return{bind:function(t){if(void 0===t)throw"Event bind error: undefined handler";n.push(t)},unbind:function(t){n=A.filter(n,function(e){return e!==t})},trigger:function(){var t=e.apply(null,arguments);A.each(n,function(e){e(t)})}}}var va={create:function(t){return{registry:I.map(t,function(t){return{bind:t.bind,unbind:t.unbind}}),trigger:I.map(t,function(t){return t.trigger})}}},ba={mode:po.exactly(["compare","extract","mutate","sink"]),sink:po.exactly(["element","start","stop","destroy"]),api:po.exactly(["forceDrop","drop","move","delayDrop"])},wa={resolve:ni("ephox-dragster").resolve},ya=function(t,e){return function(n){if(t(n)){var r,o,i,u,a,l,s,f=X.fromDom(n.target),d=function(){n.stopPropagation()},m=function(){n.preventDefault()},g=c.compose(m,d),p=(r=f,o=n.clientX,i=n.clientY,u=d,a=m,l=g,s=n,{target:c.constant(r),x:c.constant(o),y:c.constant(i),stop:u,prevent:a,kill:l,raw:c.constant(s)});e(p)}}},xa=function(t,e,n,r,o){var i=ya(n,r);return t.dom().addEventListener(e,i,o),{unbind:c.curry(Sa,t,e,i,o)}},Sa=function(t,e,n,r){t.dom().removeEventListener(e,n,r)},Ca=function(t,e,n,r){return xa(t,e,n,r,!1)},Ra=function(t,e,n,r){return xa(t,e,n,r,!0)},Ta=c.constant(!0),Da={bind:function(t,e,n){return Ca(t,e,Ta,n)},capture:function(t,e,n){return Ra(t,e,Ta,n)}},Aa=ba.mode({compare:function(t,e){return Gr(e.left()-t.left(),e.top()-t.top())},extract:function(t){return g.some(Gr(t.x(),t.y()))},sink:function(t,e){var n,r,o,i=(n=e,r=Wo.merge({layerClass:wa.resolve("blocker")},n),o=X.fromTag("div"),pe.set(o,"role","presentation"),$e.setAll(o,{position:"fixed",left:"0px",top:"0px",width:"100%",height:"100%"}),vi.add(o,wa.resolve("blocker")),vi.add(o,r.layerClass),{element:function(){return o},destroy:function(){en.remove(o)}}),u=Da.bind(i.element(),"mousedown",t.forceDrop),a=Da.bind(i.element(),"mouseup",t.drop),c=Da.bind(i.element(),"mousemove",t.move),l=Da.bind(i.element(),"mouseout",t.delayDrop);return ba.sink({element:i.element,start:function(t){Qe.append(t,i.element())},stop:function(){en.remove(i.element())},destroy:function(){i.destroy(),a.unbind(),c.unbind(),l.unbind(),u.unbind()}})},mutate:function(t,e){t.mutate(e.left(),e.top())}});function ka(){var t=g.none(),e=va.create({move:ha(["info"])});return{onEvent:function(n,r){r.extract(n).each(function(n){var o,i,u;(o=r,i=n,u=t.map(function(t){return o.compare(t,i)}),t=g.some(i),u).each(function(t){e.trigger.move(t)})})},reset:function(){t=g.none()},events:e.registry}}function Na(){var t={onEvent:function(t,e){},reset:c.noop},e=ka(),n=t;return{on:function(){n.reset(),n=e},off:function(){n.reset(),n=t},isOn:function(){return n===e},onEvent:function(t,e){n.onEvent(t,e)},events:e.events}}var Oa=function(t,e){var n=null;return{cancel:function(){null!==n&&(clearTimeout(n),n=null)},throttle:function(){var r=arguments;null!==n&&clearTimeout(n),n=setTimeout(function(){t.apply(null,r),n=null,r=null},e)}}},Ea=function(t,e,n){var r=!1,o=va.create({start:ha([]),stop:ha([])}),i=Na(),u=function(){l.stop(),i.isOn()&&(i.off(),o.trigger.stop())},a=Oa(u,200);i.events.move.bind(function(n){e.mutate(t,n.info())});var c=function(t){return function(){var e=Array.prototype.slice.call(arguments,0);if(r)return t.apply(null,e)}},l=e.sink(ba.api({forceDrop:u,drop:c(u),move:c(function(t,n){a.cancel(),i.onEvent(t,e)}),delayDrop:c(a.throttle)}),n);return{element:l.element,go:function(t){l.start(t),i.on(),o.trigger.start()},on:function(){r=!0},off:function(){r=!1},destroy:function(){l.destroy()},events:o.registry}},Ba={transform:function(t,e){var n=void 0!==e?e:{},r=void 0!==n.mode?n.mode:Aa;return Ea(t,r,e)}};function Ia(){var t,e=va.create({drag:ha(["xDelta","yDelta","target"])}),n=g.none(),r={mutate:function(e,n){t.trigger.drag(e,n)},events:(t=va.create({drag:ha(["xDelta","yDelta"])})).registry};return r.events.drag.bind(function(t){n.each(function(n){e.trigger.drag(t.xDelta(),t.yDelta(),n)})}),{assign:function(t){n=g.some(t)},get:function(){return n},mutate:r.mutate,events:e.registry}}var Pa={any:function(t){return Ie.first(t).isSome()},ancestor:function(t,e,n){return Ie.ancestor(t,e,n).isSome()},sibling:function(t,e){return Ie.sibling(t,e).isSome()},child:function(t,e){return Ie.child(t,e).isSome()},descendant:function(t,e){return Ie.descendant(t,e).isSome()},closest:function(t,e,n){return Ie.closest(t,e,n).isSome()}},Wa=ri.resolve("resizer-bar-dragging");function _a(t,e){var n=uo.height,r=function(t,e,n){var r=Ia(),o=Ba.transform(r,{}),i=g.none(),u=function(t,e){return g.from(pe.get(t,e))};r.events.drag.bind(function(t){u(t.target(),"data-row").each(function(e){var n=hu.getInt(t.target(),"top");$e.set(t.target(),"top",n+t.yDelta()+"px")}),u(t.target(),"data-column").each(function(e){var n=hu.getInt(t.target(),"left");$e.set(t.target(),"left",n+t.xDelta()+"px")})});var a=function(t,e){return hu.getInt(t,e)-parseInt(pe.get(t,"data-initial-"+e),10)};o.events.stop.bind(function(){r.get().each(function(r){i.each(function(o){u(r,"data-row").each(function(t){var e=a(r,"top");pe.remove(r,"data-initial-top"),m.trigger.adjustHeight(o,e,parseInt(t,10))}),u(r,"data-column").each(function(t){var e=a(r,"left");pe.remove(r,"data-initial-left"),m.trigger.adjustWidth(o,e,parseInt(t,10))}),Ti.refresh(t,o,n,e)})})});var l=function(e,n){m.trigger.startAdjust(),r.assign(e),pe.set(e,"data-initial-"+n,parseInt($e.get(e,n),10)),vi.add(e,Wa),$e.set(e,"opacity","0.2"),o.go(t.parent())},s=Da.bind(t.parent(),"mousedown",function(t){Ti.isRowBar(t.target())&&l(t.target(),"top"),Ti.isColBar(t.target())&&l(t.target(),"left")}),f=function(e){return Xt.eq(e,t.view())},d=Da.bind(t.view(),"mouseover",function(r){"table"===se.name(r.target())||Pa.ancestor(r.target(),"table",f)?(i="table"===se.name(r.target())?g.some(r.target()):Ie.ancestor(r.target(),"table",f)).each(function(r){Ti.refresh(t,r,n,e)}):be.inBody(r.target())&&Ti.destroy(t)}),m=va.create({adjustHeight:ha(["table","delta","row"]),adjustWidth:ha(["table","delta","column"]),startAdjust:ha([])});return{destroy:function(){s.unbind(),d.unbind(),o.destroy(),Ti.destroy(t)},refresh:function(r){Ti.refresh(t,r,n,e)},on:o.on,off:o.off,hideBars:c.curry(Ti.hide,t),showBars:c.curry(Ti.show,t),events:m.registry}}(t,e,n),o=va.create({beforeResize:ha(["table"]),afterResize:ha(["table"]),startDrag:ha([])});return r.events.adjustHeight.bind(function(t){o.trigger.beforeResize(t.table());var e=n.delta(t.delta(),t.table());Iu.adjustHeight(t.table(),e,t.row(),n),o.trigger.afterResize(t.table())}),r.events.startAdjust.bind(function(t){o.trigger.startDrag()}),r.events.adjustWidth.bind(function(t){o.trigger.beforeResize(t.table());var n=e.delta(t.delta(),t.table());Iu.adjustWidth(t.table(),n,t.column(),e),o.trigger.afterResize(t.table())}),{on:r.on,off:r.off,hideBars:r.hideBars,showBars:r.showBars,destroy:r.destroy,events:o.registry}}var Ma={get:function(t,e){return t.inline?pa.body(Uu.getBody(t),(n=X.fromTag("div"),$e.setAll(n,{position:"static",height:"0",width:"0",padding:"0",margin:"0",border:"0"}),Qe.append(be.body(),n),n)):pa.only(X.fromDom(t.getDoc()));var n},remove:function(t,e){t.inline&&en.remove(e.parent())}};function La(t){var e,n,r=g.none(),o=g.none(),i=g.none(),u=/(\d+(\.\d+)?)%/,a=function(t){return"TABLE"===t.nodeName};return t.on("init",function(){var e=co(Ku.directionAt),n=Ma.get(t);if(i=g.some(n),t.settings.object_resizing&&!1!==t.settings.table_resize_bars&&(!0===t.settings.object_resizing||"table"===t.settings.object_resizing)){var u=_a(n,e);u.on(),u.events.startDrag.bind(function(e){r=g.some(t.selection.getRng())}),u.events.afterResize.bind(function(e){var n=e.table(),o=xe.descendants(n,"td[data-mce-style],th[data-mce-style]");A.each(o,function(t){pe.remove(t,"data-mce-style")}),r.each(function(e){t.selection.setRng(e),t.focus()}),t.undoManager.add()}),o=g.some(u)}}),t.on("ObjectResizeStart",function(r){var o;a(r.target)&&(e=r.width,o=r.target,n=t.dom.getStyle(o,"width")||t.dom.getAttrib(o,"width"))}),t.on("ObjectResized",function(r){if(a(r.target)){var o=r.target;if(u.test(n)){var i=parseFloat(u.exec(n)[1]),c=r.width*i/e;t.dom.setStyle(o,"width",c+"%")}else{var l=[];Zu.each(o.rows,function(e){Zu.each(e.cells,function(e){var n=t.dom.getStyle(e,"width",!0);l.push({cell:e,width:n})})}),Zu.each(l,function(e){t.dom.setStyle(e.cell,"width",e.width),t.dom.setAttrib(e.cell,"width",null)})}}}),{lazyResize:function(){return o},lazyWire:function(){return i.getOr(pa.only(X.fromDom(t.getBody())))},destroy:function(){o.each(function(t){t.destroy()}),i.each(function(e){Ma.remove(t,e)})}}}var qa=function(t){return{fold:t}},za=function(t){return qa(function(e,n,r,o){return e(t)})},Fa=function(t){return qa(function(e,n,r,o){return n(t)})},ja=function(t,e){return qa(function(n,r,o,i){return o(t,e)})},Ha=function(t){return qa(function(e,n,r,o){return o(t)})},Va=function(t,e){return Me.table(t,e).bind(function(e){var n=Me.cells(e);return A.findIndex(n,function(e){return Xt.eq(t,e)}).map(function(t){return{index:c.constant(t),all:c.constant(n)}})})},Ua=function(t,e){return Va(t,e).fold(function(){return za(t)},function(e){return e.index()+1<e.all().length?ja(t,e.all()[e.index()+1]):Ha(t)})},Ga=function(t,e){return Va(t,e).fold(function(){return za()},function(e){return e.index()-1>=0?ja(t,e.all()[e.index()-1]):Fa(t)})},Xa=ar([{before:["element"]},{on:["element","offset"]},{after:["element"]}]),Ya={before:Xa.before,on:Xa.on,after:Xa.after,cata:function(t,e,n,r){return t.fold(e,n,r)},getStart:function(t){return t.fold(c.identity,c.identity,c.identity)}},$a=ar([{domRange:["rng"]},{relative:["startSitu","finishSitu"]},{exact:["start","soffset","finish","foffset"]}]),Ka=L.immutable("start","soffset","finish","foffset"),Ja={domRange:$a.domRange,relative:$a.relative,exact:$a.exact,exactFromRange:function(t){return $a.exact(t.start(),t.soffset(),t.finish(),t.foffset())},range:Ka,getWin:function(t){var e=t.match({domRange:function(t){return X.fromDom(t.startContainer)},relative:function(t,e){return Ya.getStart(t)},exact:function(t,e,n,r){return t}});return ee.defaultView(e)}},Qa=function(t,e,n,r){var o=ee.owner(t).dom().createRange();return o.setStart(t.dom(),e),o.setEnd(n.dom(),r),o},Za=function(t,e,n,r){var o=Qa(t,e,n,r),i=Xt.eq(t,n)&&e===r;return o.collapsed&&!i},tc=function(t,e){var n=(e||document).createDocumentFragment();return A.each(t,function(t){n.appendChild(t.dom())}),X.fromDom(n)},ec=function(t,e){t.selectNodeContents(e.dom())},nc=function(t){t.deleteContents()},rc=function(t){return{left:c.constant(t.left),top:c.constant(t.top),right:c.constant(t.right),bottom:c.constant(t.bottom),width:c.constant(t.width),height:c.constant(t.height)}},oc={create:function(t){return t.document.createRange()},replaceWith:function(t,e){nc(t),t.insertNode(e.dom())},selectNodeContents:function(t,e){var n=t.document.createRange();return ec(n,e),n},selectNodeContentsUsing:ec,relativeToNative:function(t,e,n){var r,o,i=t.document.createRange();return r=i,e.fold(function(t){r.setStartBefore(t.dom())},function(t,e){r.setStart(t.dom(),e)},function(t){r.setStartAfter(t.dom())}),o=i,n.fold(function(t){o.setEndBefore(t.dom())},function(t,e){o.setEnd(t.dom(),e)},function(t){o.setEndAfter(t.dom())}),i},exactToNative:function(t,e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},deleteContents:nc,cloneFragment:function(t){var e=t.cloneContents();return X.fromDom(e)},getFirstRect:function(t){var e=t.getClientRects(),n=e.length>0?e[0]:t.getBoundingClientRect();return n.width>0||n.height>0?g.some(n).map(rc):g.none()},getBounds:function(t){var e=t.getBoundingClientRect();return e.width>0||e.height>0?g.some(e).map(rc):g.none()},isWithin:function(t,e){return e.compareBoundaryPoints(t.END_TO_START,t)<1&&e.compareBoundaryPoints(t.START_TO_END,t)>-1},toString:function(t){return t.toString()}},ic=ar([{ltr:["start","soffset","finish","foffset"]},{rtl:["start","soffset","finish","foffset"]}]),uc=function(t,e,n){return e(X.fromDom(n.startContainer),n.startOffset,X.fromDom(n.endContainer),n.endOffset)},ac=function(t,e){var n,r,o,i=(n=t,e.match({domRange:function(t){return{ltr:c.constant(t),rtl:g.none}},relative:function(t,e){return{ltr:st(function(){return oc.relativeToNative(n,t,e)}),rtl:st(function(){return g.some(oc.relativeToNative(n,e,t))})}},exact:function(t,e,r,o){return{ltr:st(function(){return oc.exactToNative(n,t,e,r,o)}),rtl:st(function(){return g.some(oc.exactToNative(n,r,o,t,e))})}}}));return(o=(r=i).ltr()).collapsed?r.rtl().filter(function(t){return!1===t.collapsed}).map(function(t){return ic.rtl(X.fromDom(t.endContainer),t.endOffset,X.fromDom(t.startContainer),t.startOffset)}).getOrThunk(function(){return uc(0,ic.ltr,o)}):uc(0,ic.ltr,o)},cc={ltr:ic.ltr,rtl:ic.rtl,diagnose:ac,asLtrRange:function(t,e){return ac(t,e).match({ltr:function(e,n,r,o){var i=t.document.createRange();return i.setStart(e.dom(),n),i.setEnd(r.dom(),o),i},rtl:function(e,n,r,o){var i=t.document.createRange();return i.setStart(r.dom(),o),i.setEnd(e.dom(),n),i}})}},lc=function(t,e,n){return e>=t.left&&e<=t.right&&n>=t.top&&n<=t.bottom},sc=function(t,e,n,r,o){if(0===o)return 0;if(e===r)return o-1;for(var i=r,u=1;u<o;u++){var a=t(u),c=Math.abs(e-a.left);if(n>a.bottom);else{if(n<a.top||c>i)return u-1;i=c}}return 0},fc={locate:function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getClientRects();return Mo(i,function(t){return lc(t,n,r)?g.some(t):g.none()}).map(function(o){return i=t,u=e,a=n,c=r,l=o,s=function(t){var e=i.dom().createRange();return e.setStart(u.dom(),t),e.collapse(!0),e},f=dn.get(u).length,d=sc(function(t){return s(t).getBoundingClientRect()},a,c,l.right,f),s(d);var i,u,a,c,l,s,f,d})}},dc=function(t,e,n,r){var o=t.dom().createRange(),i=ee.children(e);return Mo(i,function(e){return o.selectNode(e.dom()),lc(o.getBoundingClientRect(),n,r)?mc(t,e,n,r):g.none()})},mc=function(t,e,n,r){return(se.isText(e)?fc.locate:dc)(t,e,n,r)},gc=function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return mc(t,e,u,a)},pc=function(t,e){return e-t.left<t.right-e},hc=function(t,e,n){var r=t.dom().createRange();return r.selectNode(e.dom()),r.collapse(n),r},vc=function(t,e,n){var r=t.dom().createRange();r.selectNode(e.dom());var o=r.getBoundingClientRect(),i=pc(o,n);return(!0===i?bn.first:bn.last)(e).map(function(e){return hc(t,e,i)})},bc=function(t,e,n){var r=e.dom().getBoundingClientRect(),o=pc(r,n);return g.some(hc(t,e,o))},wc=function(t,e,n){return(0===ee.children(e).length?bc:vc)(t,e,n)},yc=document.caretPositionFromPoint?function(t,e,n){return g.from(t.dom().caretPositionFromPoint(e,n)).bind(function(e){if(null===e.offsetNode)return g.none();var n=t.dom().createRange();return n.setStart(e.offsetNode,e.offset),n.collapse(),g.some(n)})}:document.caretRangeFromPoint?function(t,e,n){return g.from(t.dom().caretRangeFromPoint(e,n))}:function(t,e,n){return X.fromPoint(t,e,n).bind(function(r){var o=function(){return wc(t,r,e)};return 0===ee.children(r).length?o():function(t,e,n,r){var o=t.dom().createRange();o.selectNode(e.dom());var i=o.getBoundingClientRect(),u=Math.max(i.left,Math.min(i.right,n)),a=Math.max(i.top,Math.min(i.bottom,r));return gc(t,e,u,a)}(t,r,e,n).orThunk(o)})},xc=function(t,e,n){var r=X.fromDom(t.document);return yc(r,e,n).map(function(t){return Ja.range(X.fromDom(t.startContainer),t.startOffset,X.fromDom(t.endContainer),t.endOffset)})},Sc=function(t,e,n){var r,o,i,u,a,c,l=cc.asLtrRange(t,e),s=X.fromDom(l.commonAncestorContainer);return se.isElement(s)?(r=t,o=s,i=l,u=n,a=oc.create(r),c=(et.is(o,u)?[o]:[]).concat(xe.descendants(o,u)),A.filter(c,function(t){return oc.selectNodeContentsUsing(a,t),oc.isWithin(i,a)})):[]},Cc=function(t,e){var n=se.name(t);return"input"===n?Ya.after(t):A.contains(["br","img"],n)?0===e?Ya.before(t):Ya.after(t):Ya.on(t,e)},Rc=function(t,e){var n=t.fold(Ya.before,Cc,Ya.after),r=e.fold(Ya.before,Cc,Ya.after);return Ja.relative(n,r)},Tc=function(t,e,n,r){var o=Cc(t,e),i=Cc(n,r);return Ja.relative(o,i)},Dc=function(t){return t.match({domRange:function(t){var e=X.fromDom(t.startContainer),n=X.fromDom(t.endContainer);return Tc(e,t.startOffset,n,t.endOffset)},relative:Rc,exact:Tc})},Ac=Rc,kc=Tc,Nc=function(t,e){g.from(t.getSelection()).each(function(t){t.removeAllRanges(),t.addRange(e)})},Oc=function(t,e,n,r,o){var i=oc.exactToNative(t,e,n,r,o);Nc(t,i)},Ec=function(t,e){return cc.diagnose(t,e).match({ltr:function(e,n,r,o){Oc(t,e,n,r,o)},rtl:function(e,n,r,o){var i=t.getSelection();i.extend?(i.collapse(e.dom(),n),i.extend(r.dom(),o)):Oc(t,r,o,e,n)}})},Bc=function(t){var e=X.fromDom(t.anchorNode),n=X.fromDom(t.focusNode);return Za(e,t.anchorOffset,n,t.focusOffset)?g.some(Ja.range(X.fromDom(t.anchorNode),t.anchorOffset,X.fromDom(t.focusNode),t.focusOffset)):function(t){if(t.rangeCount>0){var e=t.getRangeAt(0),n=t.getRangeAt(t.rangeCount-1);return g.some(Ja.range(X.fromDom(e.startContainer),e.startOffset,X.fromDom(n.endContainer),n.endOffset))}return g.none()}(t)},Ic=function(t){var e=t.getSelection();return e.rangeCount>0?Bc(e):g.none()},Pc={setExact:function(t,e,n,r,o){var i=kc(e,n,r,o);Ec(t,i)},getExact:Ic,get:function(t){return Ic(t).map(function(t){return Ja.exact(t.start(),t.soffset(),t.finish(),t.foffset())})},setRelative:function(t,e,n){var r=Ac(e,n);Ec(t,r)},toNative:function(t){var e=Ja.getWin(t).dom(),n=function(t,n,r,o){return oc.exactToNative(e,t,n,r,o)},r=Dc(t);return cc.diagnose(e,r).match({ltr:n,rtl:n})},setToElement:function(t,e){var n=oc.selectNodeContents(t,e);Nc(t,n)},clear:function(t){t.getSelection().removeAllRanges()},clone:function(t,e){var n=cc.asLtrRange(t,e);return oc.cloneFragment(n)},replace:function(t,e,n){var r=cc.asLtrRange(t,e),o=tc(n,t.document);oc.replaceWith(r,o)},deleteAt:function(t,e){var n=cc.asLtrRange(t,e);oc.deleteContents(n)},forElement:function(t,e){var n=oc.selectNodeContents(t,e);return Ja.range(X.fromDom(n.startContainer),n.startOffset,X.fromDom(n.endContainer),n.endOffset)},getFirstRect:function(t,e){var n=cc.asLtrRange(t,e);return oc.getFirstRect(n)},getBounds:function(t,e){var n=cc.asLtrRange(t,e);return oc.getBounds(n)},getAtPoint:function(t,e,n){return xc(t,e,n)},findWithin:function(t,e,n){return Sc(t,e,n)},getAsString:function(t,e){var n=cc.asLtrRange(t,e);return oc.toString(n)},isCollapsed:function(t,e,n,r){return Xt.eq(t,n)&&e===r}},Wc=tinymce.util.Tools.resolve("tinymce.util.VK"),_c=function(t,e,n,r){return qc(t,e,Ua(n),r)},Mc=function(t,e,n,r){return qc(t,e,Ga(n),r)},Lc=function(t,e){var n=Ja.exact(e,0,e,0);return Pc.toNative(n)},qc=function(t,e,n,r,o){return n.fold(g.none,g.none,function(t,e){return bn.first(e).map(function(t){return Lc(0,t)})},function(n){return Me.table(n,e).bind(function(e){var o,i,u=hr.noMenu(n);return t.undoManager.transact(function(){r.insertRowsAfter(e,u)}),o=e,i=xe.descendants(o,"tr"),A.last(i).bind(function(t){return Ie.descendant(t,"td,th").map(function(t){return Lc(0,t)})})})})},zc=["table","li","dl"],Fc={handle:function(t,e,n,r){if(t.keyCode===Wc.TAB){var o=Uu.getBody(e),i=function(t){var e=se.name(t);return Xt.eq(t,o)||A.contains(zc,e)},u=e.selection.getRng();if(u.collapsed){var a=X.fromDom(u.startContainer);Me.cell(a,i).each(function(o){t.preventDefault(),(t.shiftKey?Mc:_c)(e,i,o,n,r).each(function(t){e.selection.setRng(t)})})}}}},jc={response:L.immutable("selection","kill")},Hc=function(t){return function(e){return e===t}},Vc=Hc(38),Uc=Hc(40),Gc={ltr:{isBackward:Hc(37),isForward:Hc(39)},rtl:{isBackward:Hc(39),isForward:Hc(37)},isUp:Vc,isDown:Uc,isNavigation:function(t){return t>=37&&t<=40}},Xc={convertToRange:function(t,e){var n=cc.asLtrRange(t,e);return{start:c.constant(X.fromDom(n.startContainer)),soffset:c.constant(n.startOffset),finish:c.constant(X.fromDom(n.endContainer)),foffset:c.constant(n.endOffset)}},makeSitus:function(t,e,n,r){return{start:c.constant(Ya.on(t,e)),finish:c.constant(Ya.on(n,r))}}},Yc=Vt.detect().browser.isSafari(),$c=function(t){var e=void 0!==t?t.dom():document,n=e.body.scrollLeft||e.documentElement.scrollLeft,r=e.body.scrollTop||e.documentElement.scrollTop;return Gr(n,r)},Kc=function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollTo(t,e)},Jc=function(t,e){Yc&&W.isFunction(t.dom().scrollIntoViewIfNeeded)?t.dom().scrollIntoViewIfNeeded(!1):t.dom().scrollIntoView(e)},Qc={get:$c,to:Kc,by:function(t,e,n){(void 0!==n?n.dom():document).defaultView.scrollBy(t,e)},preserve:function(t,e){var n=$c(t);e();var r=$c(t);n.top()===r.top()&&n.left()===r.left()||Kc(n.left(),n.top(),t)},capture:function(t){var e=g.none(),n=function(){e=g.some($c(t))};return n(),{save:n,restore:function(){e.each(function(e){Kc(e.left(),e.top(),t)})}}},intoView:Jc,intoViewIfNeeded:function(t,e){var n=e.dom().getBoundingClientRect(),r=t.dom().getBoundingClientRect();r.top<n.top?Jc(t,!0):r.bottom>n.bottom&&Jc(t,!1)},setToElement:function(t,e){var n=$r(e),r=X.fromDom(t.document);Kc(n.left(),n.top(),r)},scrollBarWidth:function(){var t=X.fromHtml('<div style="width: 100px; height: 100px; overflow: scroll; position: absolute; top: -9999px;"></div>');Qe.after(be.body(),t);var e=t.dom().offsetWidth-t.dom().clientWidth;return en.remove(t),e}};function Zc(t){return{elementFromPoint:function(e,n){return g.from(t.document.elementFromPoint(e,n)).map(X.fromDom)},getRect:function(t){return t.dom().getBoundingClientRect()},getRangedRect:function(e,n,r,o){var i=Ja.exact(e,n,r,o);return Pc.getFirstRect(t,i).map(function(t){return I.map(t,c.apply)})},getSelection:function(){return Pc.get(t).map(function(e){return Xc.convertToRange(t,e)})},fromSitus:function(e){var n=Ja.relative(e.start(),e.finish());return Xc.convertToRange(t,n)},situsFromPoint:function(e,n){return Pc.getAtPoint(t,e,n).map(function(t){return{start:c.constant(Ya.on(t.start(),t.soffset())),finish:c.constant(Ya.on(t.finish(),t.foffset()))}})},clearSelection:function(){Pc.clear(t)},setSelection:function(e){Pc.setExact(t,e.start(),e.soffset(),e.finish(),e.foffset())},setRelativeSelection:function(e,n){Pc.setRelative(t,e,n)},selectContents:function(e){Pc.setToElement(t,e)},getInnerHeight:function(){return t.innerHeight},getScrollY:function(){return Qc.get(X.fromDom(t.document)).top()},scrollBy:function(e,n){Qc.by(e,n,X.fromDom(t.document))}}}var tl=function(t,e,n,r,o){if(!Xt.eq(n,r))return er.identify(n,r,e).bind(function(e){var r=e.boxes().getOr([]);return r.length>0?(o(t,r,e.start(),e.finish()),g.some(jc.response(g.some(Xc.makeSitus(n,0,n,pn(n))),!0))):g.none()})},el={sync:function(t,e,n,r,o,i,u){return Xt.eq(n,o)&&r===i?g.none():Ie.closest(n,"td,th",e).bind(function(n){return Ie.closest(o,"td,th",e).bind(function(r){return tl(t,e,n,r,u)})})},detect:tl,update:function(t,e,n,r,o){return er.shiftSelection(r,t,e,o.firstSelectedSelector(),o.lastSelectedSelector()).map(function(t){return o.clear(n),o.selectRange(n,t.boxes(),t.start(),t.finish()),t.boxes()})}},nl=L.immutableBag(["left","top","right","bottom"],[]),rl={nu:nl,moveUp:function(t,e){return nl({left:t.left(),top:t.top()-e,right:t.right(),bottom:t.bottom()-e})},moveDown:function(t,e){return nl({left:t.left(),top:t.top()+e,right:t.right(),bottom:t.bottom()+e})},moveBottomTo:function(t,e){var n=t.bottom()-t.top();return nl({left:t.left(),top:e-n,right:t.right(),bottom:e})},moveTopTo:function(t,e){var n=t.bottom()-t.top();return nl({left:t.left(),top:e,right:t.right(),bottom:e+n})},getTop:function(t){return t.top()},getBottom:function(t){return t.bottom()},translate:function(t,e,n){return nl({left:t.left()+e,top:t.top()+n,right:t.right()+e,bottom:t.bottom()+n})},toString:function(t){return"("+t.left()+", "+t.top()+") -> ("+t.right()+", "+t.bottom()+")"}},ol=function(t){return rl.nu({left:t.left,top:t.top,right:t.right,bottom:t.bottom})},il=function(t,e){return g.some(t.getRect(e))},ul=function(t,e,n){return se.isElement(e)?il(t,e).map(ol):se.isText(e)?(r=t,o=e,i=n,i>=0&&i<pn(o)?r.getRangedRect(o,i,o,i+1):i>0?r.getRangedRect(o,i-1,o,i):g.none()).map(ol):g.none();var r,o,i},al=function(t,e){return se.isElement(e)?il(t,e).map(ol):se.isText(e)?t.getRangedRect(e,0,e,pn(e)).map(ol):g.none()},cl=L.immutable("item","mode"),ll=function(t,e,n,r){var o=void 0!==r?r:sl;return t.property().parent(e).map(function(t){return cl(t,o)})},sl=function(t,e,n,r){var o=void 0!==r?r:fl;return n.sibling(t,e).map(function(t){return cl(t,o)})},fl=function(t,e,n,r){var o=void 0!==r?r:fl,i=t.property().children(e);return n.first(i).map(function(t){return cl(t,o)})},dl=[{current:ll,next:sl,fallback:g.none()},{current:sl,next:fl,fallback:g.some(ll)},{current:fl,next:fl,fallback:g.some(sl)}],ml=function(t,e,n,r,o){return o=void 0!==o?o:dl,A.find(o,function(t){return t.current===n}).bind(function(n){return n.current(t,e,r,n.next).orThunk(function(){return n.fallback.bind(function(n){return ml(t,e,n,r)})})})},gl={backtrack:ll,sidestep:sl,advance:fl,go:ml},pl={left:function(){return{sibling:function(t,e){return t.query().prevSibling(e)},first:function(t){return t.length>0?g.some(t[t.length-1]):g.none()}}},right:function(){return{sibling:function(t,e){return t.query().nextSibling(e)},first:function(t){return t.length>0?g.some(t[0]):g.none()}}}},hl=function(t,e,n,r,o,i){return gl.go(t,e,r,o).bind(function(e){return i(e.item())?g.none():n(e.item())?g.some(e.item()):hl(t,e.item(),n,e.mode(),o,i)})},vl=function(t,e,n,r){return hl(t,e,n,gl.sidestep,pl.left(),r)},bl=function(t,e,n,r){return hl(t,e,n,gl.sidestep,pl.right(),r)},wl=function(t,e){return 0===t.property().children(e).length},yl=function(t,e,n,r){return vl(t,e,n,r)},xl=function(t,e,n,r){return bl(t,e,n,r)},Sl={before:function(t,e,n){return yl(t,e,c.curry(wl,t),n)},after:function(t,e,n){return xl(t,e,c.curry(wl,t),n)},seekLeft:yl,seekRight:xl,walkers:function(){return{left:pl.left,right:pl.right}},walk:function(t,e,n,r,o){return gl.go(t,e,n,r,o)},backtrack:gl.backtrack,sidestep:gl.sidestep,advance:gl.advance},Cl=Dn(),Rl={gather:function(t,e,n){return Sl.gather(Cl,t,e,n)},before:function(t,e){return Sl.before(Cl,t,e)},after:function(t,e){return Sl.after(Cl,t,e)},seekLeft:function(t,e,n){return Sl.seekLeft(Cl,t,e,n)},seekRight:function(t,e,n){return Sl.seekRight(Cl,t,e,n)},walkers:function(){return Sl.walkers()},walk:function(t,e,n,r){return Sl.walk(Cl,t,e,n,r)}},Tl=ar([{none:[]},{retry:["caret"]}]),Dl=function(t,e,n){return Ee.closest(e,ko).fold(c.constant(!1),function(e){return al(t,e).exists(function(t){return r=t,(e=n).left()<r.left()||Math.abs(r.right()-e.left())<1||e.left()>r.right();var e,r})})},Al={point:rl.getTop,adjuster:function(t,e,n,r,o){var i=rl.moveUp(o,5);return Math.abs(n.top()-r.top())<1?Tl.retry(i):n.bottom()<o.top()?Tl.retry(i):n.bottom()===o.top()?Tl.retry(rl.moveUp(o,1)):Dl(t,e,o)?Tl.retry(rl.translate(i,5,0)):Tl.none()},move:rl.moveUp,gather:Rl.before},kl={point:rl.getBottom,adjuster:function(t,e,n,r,o){var i=rl.moveDown(o,5);return Math.abs(n.bottom()-r.bottom())<1?Tl.retry(i):n.top()>o.bottom()?Tl.retry(i):n.top()===o.bottom()?Tl.retry(rl.moveDown(o,1)):Dl(t,e,o)?Tl.retry(rl.translate(i,5,0)):Tl.none()},move:rl.moveDown,gather:Rl.after},Nl=function(t,e,n,r,o){return 0===o?g.some(r):(c=t,l=r.left(),s=e.point(r),c.elementFromPoint(l,s).filter(function(t){return"table"===se.name(t)}).isSome()?(u=r,a=o-1,Nl(t,i=e,n,i.move(u,5),a)):t.situsFromPoint(r.left(),e.point(r)).bind(function(i){return i.start().fold(g.none,function(i,u){return al(t,i,u).bind(function(u){return e.adjuster(t,i,u,n,r).fold(g.none,function(r){return Nl(t,e,n,r,o-1)})}).orThunk(function(){return g.some(r)})},g.none)}));var i,u,a,c,l,s},Ol=function(t,e,n){var r,o,i,u=t.move(n,5),a=Nl(e,t,n,u,100).getOr(u);return(r=t,o=a,i=e,r.point(o)>i.getInnerHeight()?g.some(r.point(o)-i.getInnerHeight()):r.point(o)<0?g.some(-r.point(o)):g.none()).fold(function(){return e.situsFromPoint(a.left(),t.point(a))},function(n){return e.scrollBy(0,n),e.situsFromPoint(a.left(),t.point(a)-n)})},El={tryUp:c.curry(Ol,Al),tryDown:c.curry(Ol,kl),ieTryUp:function(t,e){return t.situsFromPoint(e.left(),e.top()-5)},ieTryDown:function(t,e){return t.situsFromPoint(e.left(),e.bottom()+5)},getJumpSize:c.constant(5)},Bl=ar([{none:["message"]},{success:[]},{failedUp:["cell"]},{failedDown:["cell"]}]),Il=function(t){return Ie.closest(t,"tr")},Pl={verify:function(t,e,n,r,o,i,u){return Ie.closest(r,"td,th",u).bind(function(n){return Ie.closest(e,"td,th",u).map(function(e){return Xt.eq(n,e)?Xt.eq(r,n)&&pn(n)===o?i(e):Bl.none("in same cell"):_n(Il,[n,e]).fold(function(){return o=e,u=n,a=(r=t).getRect(o),(c=r.getRect(u)).right>a.left&&c.left<a.right?Bl.success():i(e);var r,o,u,a,c},function(t){return i(e)})})}).getOr(Bl.none("default"))},cata:function(t,e,n,r,o){return t.fold(e,n,r,o)},adt:Bl},Wl={point:L.immutable("element","offset"),delta:L.immutable("element","deltaOffset"),range:L.immutable("element","start","finish"),points:L.immutable("begin","end"),text:L.immutable("element","text")},_l=(L.immutable("ancestor","descendants","element","index"),L.immutable("parent","children","element","index")),Ml=function(t,e){return A.findIndex(t,c.curry(Xt.eq,e))},Ll=function(t){return ee.parent(t).bind(function(e){var n=ee.children(e);return Ml(n,t).map(function(r){return _l(e,n,t,r)})})},ql=function(t){return"br"===se.name(t)},zl=function(t,e,n){return e(t,n).bind(function(t){return se.isText(t)&&0===dn.get(t).trim().length?zl(t,e,n):g.some(t)})},Fl=function(t,e,n,r){return(o=e,i=n,ee.child(o,i).filter(ql).orThunk(function(){return ee.child(o,i-1).filter(ql)})).bind(function(e){return r.traverse(e).fold(function(){return zl(e,r.gather,t).map(r.relative)},function(t){return Ll(t).map(function(t){return Ya.on(t.parent(),t.index())})})});var o,i},jl=function(t,e,n,r){var o,i,u;return(ql(e)?(o=t,i=e,(u=r).traverse(i).orThunk(function(){return zl(i,u.gather,o)}).map(u.relative)):Fl(t,e,n,r)).map(function(t){return{start:c.constant(t),finish:c.constant(t)}})},Hl=function(t){return Pl.cata(t,function(t){return g.none("BR ADT: none")},function(){return g.none()},function(t){return g.some(Wl.point(t,0))},function(t){return g.some(Wl.point(t,pn(t)))})},Vl=Vt.detect(),Ul=function(t,e,n,r,o,i){return 0===i?g.none():Yl(t,e,n,r,o).bind(function(u){var a=t.fromSitus(u),c=Pl.verify(t,n,r,a.finish(),a.foffset(),o.failure,e);return Pl.cata(c,function(){return g.none()},function(){return g.some(u)},function(u){return Xt.eq(n,u)&&0===r?Gl(t,n,r,rl.moveUp,o):Ul(t,e,u,0,o,i-1)},function(u){return Xt.eq(n,u)&&r===pn(u)?Gl(t,n,r,rl.moveDown,o):Ul(t,e,u,pn(u),o,i-1)})})},Gl=function(t,e,n,r,o){return ul(t,e,n).bind(function(e){return Xl(t,o,r(e,El.getJumpSize()))})},Xl=function(t,e,n){return Vl.browser.isChrome()||Vl.browser.isSafari()||Vl.browser.isFirefox()||Vl.browser.isEdge()?e.otherRetry(t,n):Vl.browser.isIE()?e.ieRetry(t,n):g.none()},Yl=function(t,e,n,r,o){return ul(t,n,r).bind(function(e){return Xl(t,o,e)})},$l=function(t,e,n){return(r=t,o=e,i=n,r.getSelection().bind(function(t){return jl(o,t.finish(),t.foffset(),i).fold(function(){return g.some(Wl.point(t.finish(),t.foffset()))},function(e){var n=r.fromSitus(e),u=Pl.verify(r,t.finish(),t.foffset(),n.finish(),n.foffset(),i.failure,o);return Hl(u)})})).bind(function(r){return Ul(t,e,r.element(),r.offset(),n,20).map(t.fromSitus)});var r,o,i},Kl=function(t,e,n){return Ee.ancestor(t,e,n).isSome()},Jl=Vt.detect(),Ql=function(t,e,n,r,o){return Ie.closest(r,"td,th",e).bind(function(r){return Ie.closest(r,"table",e).bind(function(i){return u=i,Kl(o,function(t){return ee.parent(t).exists(function(t){return Xt.eq(t,u)})})?$l(t,e,n).bind(function(t){return Ie.closest(t.finish(),"td,th",e).map(function(e){return{start:c.constant(r),finish:c.constant(e),range:c.constant(t)}})}):g.none();var u})})},Zl=function(t,e,n,r,o,i){return Jl.browser.isIE()?g.none():i(r,e).orThunk(function(){return Ql(t,e,n,r,o).map(function(t){var e=t.range();return jc.response(g.some(Xc.makeSitus(e.start(),e.soffset(),e.finish(),e.foffset())),!0)})})},ts=function(t,e,n,r,o,i,u){return Ql(t,n,r,o,i).bind(function(t){return el.detect(e,n,t.start(),t.finish(),u)})},es=function(t,e){return Ie.closest(t,"tr",e).bind(function(t){return Ie.closest(t,"table",e).bind(function(n){var r=xe.descendants(n,"tr");return Xt.eq(t,r[0])?Rl.seekLeft(n,function(t){return bn.last(t).isSome()},e).map(function(t){var e=pn(t);return jc.response(g.some(Xc.makeSitus(t,e,t,e)),!0)}):g.none()})})},ns=function(t,e){return Ie.closest(t,"tr",e).bind(function(t){return Ie.closest(t,"table",e).bind(function(n){var r=xe.descendants(n,"tr");return Xt.eq(t,r[r.length-1])?Rl.seekRight(n,function(t){return bn.first(t).isSome()},e).map(function(t){return jc.response(g.some(Xc.makeSitus(t,0,t,0)),!0)}):g.none()})})},rs=function(t,e){return Ie.closest(t,"td,th",e)},os={down:{traverse:ee.nextSibling,gather:Rl.after,relative:Ya.before,otherRetry:El.tryDown,ieRetry:El.ieTryDown,failure:Pl.adt.failedDown},up:{traverse:ee.prevSibling,gather:Rl.before,relative:Ya.before,otherRetry:El.tryUp,ieRetry:El.ieTryUp,failure:Pl.adt.failedUp}},is=L.immutable("rows","cols"),us={mouse:function(t,e,n,r){var o,i,u,a,c,l,s=Zc(t),f=(o=s,i=e,u=n,a=r,c=g.none(),l=function(){c=g.none()},{mousedown:function(t){a.clear(i),c=rs(t.target(),u)},mouseover:function(t){c.each(function(e){a.clear(i),rs(t.target(),u).each(function(t){er.identify(e,t,u).each(function(n){var r=n.boxes().getOr([]);(r.length>1||1===r.length&&!Xt.eq(e,t))&&(a.selectRange(i,r,n.start(),n.finish()),o.selectContents(t))})})})},mouseup:function(){c.each(l)}});return{mousedown:f.mousedown,mouseover:f.mouseover,mouseup:f.mouseup}},keyboard:function(t,e,n,r){var o=Zc(t),i=function(){return r.clear(e),g.none()};return{keydown:function(t,u,a,l,s,f){var d=t.raw().which,m=!0===t.raw().shiftKey;return er.retrieve(e,r.selectedSelector()).fold(function(){return Gc.isDown(d)&&m?c.curry(ts,o,e,n,os.down,l,u,r.selectRange):Gc.isUp(d)&&m?c.curry(ts,o,e,n,os.up,l,u,r.selectRange):Gc.isDown(d)?c.curry(Zl,o,n,os.down,l,u,ns):Gc.isUp(d)?c.curry(Zl,o,n,os.up,l,u,es):g.none},function(t){var n=function(n){return function(){return Mo(n,function(n){return el.update(n.rows(),n.cols(),e,t,r)}).fold(function(){return er.getEdges(e,r.firstSelectedSelector(),r.lastSelectedSelector()).map(function(t){var n=Gc.isDown(d)||f.isForward(d)?Ya.after:Ya.before;return o.setRelativeSelection(Ya.on(t.first(),0),n(t.table())),r.clear(e),jc.response(g.none(),!0)})},function(t){return g.some(jc.response(g.none(),!0))})}};return Gc.isDown(d)&&m?n([is(1,0)]):Gc.isUp(d)&&m?n([is(-1,0)]):f.isBackward(d)&&m?n([is(0,-1),is(-1,0)]):f.isForward(d)&&m?n([is(0,1),is(1,0)]):Gc.isNavigation(d)&&!1===m?i:g.none})()},keyup:function(t,o,i,u,a){return er.retrieve(e,r.selectedSelector()).fold(function(){var c=t.raw().which;return 0==(!0===t.raw().shiftKey)?g.none():Gc.isNavigation(c)?el.sync(e,n,o,i,u,a,r.selectRange):g.none()},g.none)}}}},as=function(t,e){A.each(e,function(e){vi.remove(t,e)})},cs=function(t){return function(e){vi.add(e,t)}},ls=function(t){return function(e){as(e,t)}},ss={byClass:function(t){var e=cs(t.selected()),n=ls([t.selected(),t.lastSelected(),t.firstSelected()]),r=function(e){var r=xe.descendants(e,t.selectedSelector());A.each(r,n)};return{clear:r,selectRange:function(n,o,i,u){r(n),A.each(o,e),vi.add(i,t.firstSelected()),vi.add(u,t.lastSelected())},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}},byAttr:function(t){var e=function(e){pe.remove(e,t.selected()),pe.remove(e,t.firstSelected()),pe.remove(e,t.lastSelected())},n=function(e){pe.set(e,t.selected(),"1")},r=function(n){var r=xe.descendants(n,t.selectedSelector());A.each(r,e)};return{clear:r,selectRange:function(e,o,i,u){r(e),A.each(o,n),pe.set(i,t.firstSelected(),"1"),pe.set(u,t.lastSelected(),"1")},selectedSelector:t.selectedSelector,firstSelectedSelector:t.firstSelectedSelector,lastSelectedSelector:t.lastSelectedSelector}}};function fs(t,e){var n=L.immutableBag(["mousedown","mouseover","mouseup","keyup","keydown"],[]),r=g.none(),o=ss.byAttr(ur);return t.on("init",function(i){var u=t.getWin(),a=Uu.getBody(t),l=Uu.getIsRoot(t),s=us.mouse(u,a,l,o),f=us.keyboard(u,a,l,o),d=function(e,n){n.kill()&&e.kill(),n.selection().each(function(e){var n=Ja.relative(e.start(),e.finish()),r=cc.asLtrRange(u,n);t.selection.setRng(r)})},m=function(e){var n=v(e);if(n.raw().shiftKey&&Gc.isNavigation(n.raw().which)){var r=t.selection.getRng(),o=X.fromDom(r.startContainer),i=X.fromDom(r.endContainer);f.keyup(n,o,r.startOffset,i,r.endOffset).each(function(t){d(n,t)})}},p=function(t){return!(pe.has(t,"data-mce-bogus")||"br"===se.name(t)||se.isText(t)&&0===dn.get(t).length)},h=function(n){var r,o,i=v(n);e().each(function(t){t.hideBars()}),40===n.which&&(r=X.fromDom(t.getBody()),o=function(t){return ee.prevSibling(t).bind(function(t){return p(t)?g.some(t):o(t)})},ee.lastChild(r).bind(function(t){return p(t)?g.some(t):o(t)})).each(function(e){"table"===se.name(e)&&(t.settings.forced_root_block?t.dom.add(t.getBody(),t.settings.forced_root_block,t.settings.forced_root_block_attrs,"<br/>"):t.dom.add(t.getBody(),"br"))});var u=t.selection.getRng(),a=X.fromDom(t.selection.getStart()),c=X.fromDom(u.startContainer),l=X.fromDom(u.endContainer),s=Ku.directionAt(a).isRtl()?Gc.rtl:Gc.ltr;f.keydown(i,c,u.startOffset,l,u.endOffset,s).each(function(t){d(i,t)}),e().each(function(t){t.showBars()})},v=function(t){var e=X.fromDom(t.target),n=function(){t.stopPropagation()},r=function(){t.preventDefault()},o=c.compose(r,n);return{target:c.constant(e),x:c.constant(t.x),y:c.constant(t.y),stop:n,prevent:r,kill:o,raw:c.constant(t)}},b=function(t){return 0===t.button},w=function(t){b(t)&&s.mousedown(v(t))},y=function(t){var e;(void 0===(e=t).buttons||0!=(1&e.buttons))&&s.mouseover(v(t))},x=function(t){b&&s.mouseup(v(t))};t.on("mousedown",w),t.on("mouseover",y),t.on("mouseup",x),t.on("keyup",m),t.on("keydown",h),t.on("nodechange",function(){var e=t.selection,n=X.fromDom(e.getStart()),r=X.fromDom(e.getEnd()),i=Me.table(n),u=Me.table(r);i.bind(function(t){return u.bind(function(e){return Xt.eq(t,e)?g.some(!0):g.none()})}).fold(function(){o.clear(a)},c.noop)}),r=g.some(n({mousedown:w,mouseover:y,mouseup:x,keyup:m,keydown:h}))}),{clear:o.clear,destroy:function(){r.each(function(t){})}}}var ds=Zu.each,ms={addButtons:function(t){var e=[];function n(e){return function(){t.execCommand(e)}}ds("inserttable tableprops deletetable | cell row column".split(" "),function(n){"|"===n?e.push({text:"-"}):e.push(t.menuItems[n])}),t.addButton("table",{type:"menubutton",title:"Table",menu:e}),t.addButton("tableprops",{title:"Table properties",onclick:c.curry(ua,t,!0),icon:"table"}),t.addButton("tabledelete",{title:"Delete table",onclick:n("mceTableDelete")}),t.addButton("tablecellprops",{title:"Cell properties",onclick:n("mceTableCellProps")}),t.addButton("tablemergecells",{title:"Merge cells",onclick:n("mceTableMergeCells")}),t.addButton("tablesplitcells",{title:"Split cell",onclick:n("mceTableSplitCells")}),t.addButton("tableinsertrowbefore",{title:"Insert row before",onclick:n("mceTableInsertRowBefore")}),t.addButton("tableinsertrowafter",{title:"Insert row after",onclick:n("mceTableInsertRowAfter")}),t.addButton("tabledeleterow",{title:"Delete row",onclick:n("mceTableDeleteRow")}),t.addButton("tablerowprops",{title:"Row properties",onclick:n("mceTableRowProps")}),t.addButton("tablecutrow",{title:"Cut row",onclick:n("mceTableCutRow")}),t.addButton("tablecopyrow",{title:"Copy row",onclick:n("mceTableCopyRow")}),t.addButton("tablepasterowbefore",{title:"Paste row before",onclick:n("mceTablePasteRowBefore")}),t.addButton("tablepasterowafter",{title:"Paste row after",onclick:n("mceTablePasteRowAfter")}),t.addButton("tableinsertcolbefore",{title:"Insert column before",onclick:n("mceTableInsertColBefore")}),t.addButton("tableinsertcolafter",{title:"Insert column after",onclick:n("mceTableInsertColAfter")}),t.addButton("tabledeletecol",{title:"Delete column",onclick:n("mceTableDeleteCol")})},addToolbars:function(t){var e=t.settings.table_toolbar;""!==e&&!1!==e&&(e||(e="tableprops tabledelete | tableinsertrowbefore tableinsertrowafter tabledeleterow | tableinsertcolbefore tableinsertcolafter tabledeletecol"),t.addContextToolbar(function(e){return t.dom.is(e,"table")&&t.getBody().contains(e)},e))}},gs={addMenuItems:function(t,e){var n=g.none(),r=[],o=[],i=[],u=[],a=function(t){t.disabled(!0)},l=function(t){t.disabled(!1)},s=function(){var t=this;r.push(t),n.fold(function(){a(t)},function(e){l(t)})},f=function(){var t=this;o.push(t),n.fold(function(){a(t)},function(e){l(t)})};t.on("init",function(){t.on("nodechange",function(c){var s=g.from(t.dom.getParent(t.selection.getStart(),"th,td"));(n=s.bind(function(t){var n=X.fromDom(t);return Me.table(n).map(function(t){return hr.forMenu(e,t,n)})})).fold(function(){A.each(r,a),A.each(o,a),A.each(i,a),A.each(u,a)},function(t){A.each(r,l),A.each(o,l),A.each(i,function(e){e.disabled(t.mergable().isNone())}),A.each(u,function(e){e.disabled(t.unmergable().isNone())})})})});var d=function(t,e,n,r){var o,i,u,a,c,l=r.getEl().getElementsByTagName("table")[0],s=r.isRtl()||"tl-tr"===r.parent().rel;for(l.nextSibling.innerHTML=e+1+" x "+(n+1),s&&(e=9-e),i=0;i<10;i++)for(o=0;o<10;o++)a=l.rows[i].childNodes[o].firstChild,c=(s?o>=e:o<=e)&&i<=n,t.dom.toggleClass(a,"mce-active",c),c&&(u=a);return u.parentNode},m=!1===t.settings.table_grid?{text:"Table",icon:"table",context:"table",onclick:c.curry(ua,t)}:{text:"Table",icon:"table",context:"table",ariaHideMenu:!0,onclick:function(e){e.aria&&(this.parent().hideAll(),e.stopImmediatePropagation(),ua(t))},onshow:function(){d(t,0,0,this.menu.items()[0])},onhide:function(){var e=this.menu.items()[0].getEl().getElementsByTagName("a");t.dom.removeClass(e,"mce-active"),t.dom.addClass(e[0],"mce-active")},menu:[{type:"container",html:function(){var t="";t='<table role="grid" class="mce-grid mce-grid-border" aria-readonly="true">';for(var e=0;e<10;e++){t+="<tr>";for(var n=0;n<10;n++)t+='<td role="gridcell" tabindex="-1"><a id="mcegrid'+(10*e+n)+'" href="#" data-mce-x="'+n+'" data-mce-y="'+e+'"></a></td>';t+="</tr>"}return t+="</table>",t+='<div class="mce-text-center" role="presentation">1 x 1</div>'}(),onPostRender:function(){this.lastX=this.lastY=0},onmousemove:function(e){var n,r,o=e.target;"A"===o.tagName.toUpperCase()&&(n=parseInt(o.getAttribute("data-mce-x"),10),r=parseInt(o.getAttribute("data-mce-y"),10),(this.isRtl()||"tl-tr"===this.parent().rel)&&(n=9-n),n===this.lastX&&r===this.lastY||(d(t,n,r,e.control),this.lastX=n,this.lastY=r))},onclick:function(e){var n=this;"A"===e.target.tagName.toUpperCase()&&(e.preventDefault(),e.stopPropagation(),n.parent().cancel(),t.undoManager.transact(function(){Sr.insert(t,n.lastX+1,n.lastY+1)}),t.addVisual())}}]};function p(e){return function(){t.execCommand(e)}}var h={text:"Table properties",context:"table",onPostRender:s,onclick:c.curry(ua,t,!0)},v={text:"Delete table",context:"table",onPostRender:s,cmd:"mceTableDelete"},b={text:"Row",context:"table",menu:[{text:"Insert row before",onclick:p("mceTableInsertRowBefore"),onPostRender:f},{text:"Insert row after",onclick:p("mceTableInsertRowAfter"),onPostRender:f},{text:"Delete row",onclick:p("mceTableDeleteRow"),onPostRender:f},{text:"Row properties",onclick:p("mceTableRowProps"),onPostRender:f},{text:"-"},{text:"Cut row",onclick:p("mceTableCutRow"),onPostRender:f},{text:"Copy row",onclick:p("mceTableCopyRow"),onPostRender:f},{text:"Paste row before",onclick:p("mceTablePasteRowBefore"),onPostRender:f},{text:"Paste row after",onclick:p("mceTablePasteRowAfter"),onPostRender:f}]},w={text:"Column",context:"table",menu:[{text:"Insert column before",onclick:p("mceTableInsertColBefore"),onPostRender:f},{text:"Insert column after",onclick:p("mceTableInsertColAfter"),onPostRender:f},{text:"Delete column",onclick:p("mceTableDeleteCol"),onPostRender:f}]},y={separator:"before",text:"Cell",context:"table",menu:[{text:"Cell properties",onclick:p("mceTableCellProps"),onPostRender:f},{text:"Merge cells",onclick:p("mceTableMergeCells"),onPostRender:function(){var t=this;i.push(t),n.fold(function(){a(t)},function(e){t.disabled(e.mergable().isNone())})}},{text:"Split cell",onclick:p("mceTableSplitCells"),onPostRender:function(){var t=this;u.push(t),n.fold(function(){a(t)},function(e){t.disabled(e.unmergable().isNone())})}}]};t.addMenuItem("inserttable",m),t.addMenuItem("tableprops",h),t.addMenuItem("deletetable",v),t.addMenuItem("row",b),t.addMenuItem("column",w),t.addMenuItem("cell",y)}};u.add("table",function(t){var e,n=La(t),r=fs(t,n.lazyResize),o=Ju(t,n.lazyWire),i=(e=t,{get:function(){var t=Uu.getBody(e);return nr.retrieve(t,ur.selectedSelector()).fold(function(){return void 0===e.selection.getStart()?lr.none():lr.single(e.selection)},function(t){return lr.multiple(t)})}});ga.registerCommands(t,o,r,i),vr.registerEvents(t,i,o,r),gs.addMenuItems(t,i),ms.addButtons(t),ms.addToolbars(t),t.on("PreInit",function(){t.serializer.addTempAttr(ur.firstSelected()),t.serializer.addTempAttr(ur.lastSelected())}),!1!==t.settings.table_tab_navigation&&t.on("keydown",function(e){Fc.handle(e,t,o,n.lazyWire)}),t.on("remove",function(){n.destroy(),r.destroy()}),this.insertTable=function(e,n){return Sr.insert(t,e,n)},this.setClipboardRows=ga.setClipboardRows,this.getClipboardRows=ga.getClipboardRows})}();